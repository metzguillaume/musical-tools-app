/*! For license information please see main.471b2b6b.js.LICENSE.txt */
(()=>{var e={4:(e,t,n)=>{"use strict";var s=n(853),r=n(43),a=n(950);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(o(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var h=Object.assign,m=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),w=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),_=Symbol.for("react.lazy");Symbol.for("react.scope");var S=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var T=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var A=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=A&&e[A]||e["@@iterator"])?e:null}var E=Symbol.for("react.client.reference");function D(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===E?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case b:return"Profiler";case x:return"StrictMode";case k:return"Suspense";case N:return"SuspenseList";case S:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case p:return"Portal";case w:return(e.displayName||"Context")+".Provider";case y:return(e._context.displayName||"Context")+".Consumer";case j:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case C:return null!==(t=e.displayName||null)?t:D(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return D(e(t))}catch(n){}}return null}var R=Array.isArray,I=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O={pending:!1,data:null,method:null,action:null},F=[],L=-1;function q(e){return{current:e}}function V(e){0>L||(e.current=F[L],F[L]=null,L--)}function z(e,t){L++,F[L]=e.current,e.current=t}var G=q(null),B=q(null),$=q(null),U=q(null);function W(e,t){switch(z($,t),z(B,e),z(G,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?rd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=ad(t=rd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}V(G),z(G,e)}function H(){V(G),V(B),V($)}function Q(e){null!==e.memoizedState&&z(U,e);var t=G.current,n=ad(t,e.type);t!==n&&(z(B,e),z(G,n))}function K(e){B.current===e&&(V(G),V(B)),U.current===e&&(V(U),Qd._currentValue=O)}var Y=Object.prototype.hasOwnProperty,X=s.unstable_scheduleCallback,Z=s.unstable_cancelCallback,J=s.unstable_shouldYield,ee=s.unstable_requestPaint,te=s.unstable_now,ne=s.unstable_getCurrentPriorityLevel,se=s.unstable_ImmediatePriority,re=s.unstable_UserBlockingPriority,ae=s.unstable_NormalPriority,oe=s.unstable_LowPriority,ie=s.unstable_IdlePriority,le=s.log,ce=s.unstable_setDisableYieldValue,ue=null,de=null;function he(e){if("function"===typeof le&&ce(e),de&&"function"===typeof de.setStrictMode)try{de.setStrictMode(ue,e)}catch(t){}}var me=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(fe(e)/pe|0)|0},fe=Math.log,pe=Math.LN2;var ge=256,xe=4194304;function be(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ve(e,t,n){var s=e.pendingLanes;if(0===s)return 0;var r=0,a=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var i=134217727&s;return 0!==i?0!==(s=i&~a)?r=be(s):0!==(o&=i)?r=be(o):n||0!==(n=i&~e)&&(r=be(n)):0!==(i=s&~a)?r=be(i):0!==o?r=be(o):n||0!==(n=s&~e)&&(r=be(n)),0===r?0:0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(n=t&-t)||32===a&&0!==(4194048&n))?t:r}function ye(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function we(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function je(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function ke(){var e=xe;return 0===(62914560&(xe<<=1))&&(xe=4194304),e}function Ne(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ce(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function _e(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-me(t);e.entangledLanes|=t,e.entanglements[s]=1073741824|e.entanglements[s]|4194090&n}function Se(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-me(n),r=1<<s;r&t|e[s]&t&&(e[s]|=t),n&=~r}}function Te(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ae(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Me(){var e=P.p;return 0!==e?e:void 0===(e=window.event)?32:ch(e.type)}var Ee=Math.random().toString(36).slice(2),De="__reactFiber$"+Ee,Re="__reactProps$"+Ee,Ie="__reactContainer$"+Ee,Pe="__reactEvents$"+Ee,Oe="__reactListeners$"+Ee,Fe="__reactHandles$"+Ee,Le="__reactResources$"+Ee,qe="__reactMarker$"+Ee;function Ve(e){delete e[De],delete e[Re],delete e[Pe],delete e[Oe],delete e[Fe]}function ze(e){var t=e[De];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ie]||n[De]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=vd(e);null!==e;){if(n=e[De])return n;e=vd(e)}return t}n=(e=n).parentNode}return null}function Ge(e){if(e=e[De]||e[Ie]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Be(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function $e(e){var t=e[Le];return t||(t=e[Le]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ue(e){e[qe]=!0}var We=new Set,He={};function Qe(e,t){Ke(e,t),Ke(e+"Capture",t)}function Ke(e,t){for(He[e]=t,e=0;e<t.length;e++)We.add(t[e])}var Ye,Xe,Ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Je={},et={};function tt(e,t,n){if(r=t,Y.call(et,r)||!Y.call(Je,r)&&(Ze.test(r)?et[r]=!0:(Je[r]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var s=t.toLowerCase().slice(0,5);if("data-"!==s&&"aria-"!==s)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var r}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function st(e,t,n,s){if(null===s)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+s)}}function rt(e){if(void 0===Ye)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ye=t&&t[1]||"",Xe=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Ye+e+Xe}var at=!1;function ot(e,t){if(!e||at)return"";at=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(r){var s=r}Reflect.construct(e,[],n)}else{try{n.call()}catch(a){s=a}e.call(n.prototype)}}else{try{throw Error()}catch(o){s=o}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(i){if(i&&s&&"string"===typeof i.stack)return[i.stack,s.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=s.DetermineComponentFrameRoot(),o=a[0],i=a[1];if(o&&i){var l=o.split("\n"),c=i.split("\n");for(r=s=0;s<l.length&&!l[s].includes("DetermineComponentFrameRoot");)s++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(s===l.length||r===c.length)for(s=l.length-1,r=c.length-1;1<=s&&0<=r&&l[s]!==c[r];)r--;for(;1<=s&&0<=r;s--,r--)if(l[s]!==c[r]){if(1!==s||1!==r)do{if(s--,0>--r||l[s]!==c[r]){var u="\n"+l[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=s&&0<=r);break}}}finally{at=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?rt(n):""}function it(e){switch(e.tag){case 26:case 27:case 5:return rt(e.type);case 16:return rt("Lazy");case 13:return rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return ot(e.type,!1);case 11:return ot(e.type.render,!1);case 1:return ot(e.type,!0);case 31:return rt("Activity");default:return""}}function lt(e){try{var t="";do{t+=it(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){s=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(e){s=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=ut(e)?e.checked?"true":"false":e.value),(e=s)!==n&&(t.setValue(e),!0)}function mt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var ft=/[\n"\\]/g;function pt(e){return e.replace(ft,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function gt(e,t,n,s,r,a,o,i){e.name="",null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?bt(e,o,ct(t)):null!=n?bt(e,o,ct(n)):null!=s&&e.removeAttribute("value"),null==r&&null!=a&&(e.defaultChecked=!!a),null!=r&&(e.checked=r&&"function"!==typeof r&&"symbol"!==typeof r),null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.name=""+ct(i):e.removeAttribute("name")}function xt(e,t,n,s,r,a,o,i){if(null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.type=a),null!=t||null!=n){if(!("submit"!==a&&"reset"!==a||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,i||t===e.value||(e.value=t),e.defaultValue=t}s="function"!==typeof(s=null!=s?s:r)&&"symbol"!==typeof s&&!!s,e.checked=i?e.checked:!!s,e.defaultChecked=!!s,null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.name=o)}function bt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function vt(e,t,n,s){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&s&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(s&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function yt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,n,s){if(null==t){if(null!=s){if(null!=n)throw Error(o(92));if(R(s)){if(1<s.length)throw Error(o(93));s=s[0]}n=s}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(s=e.textContent)===n&&""!==s&&null!==s&&(e.value=s)}function jt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var kt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nt(e,t,n){var s=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?s?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":s?e.setProperty(t,n):"number"!==typeof n||0===n||kt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Ct(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(o(62));if(e=e.style,null!=n){for(var s in n)!n.hasOwnProperty(s)||null!=t&&t.hasOwnProperty(s)||(0===s.indexOf("--")?e.setProperty(s,""):"float"===s?e.cssFloat="":e[s]="");for(var r in t)s=t[r],t.hasOwnProperty(r)&&n[r]!==s&&Nt(e,r,s)}else for(var a in t)t.hasOwnProperty(a)&&Nt(e,a,t[a])}function _t(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var St=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Tt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function At(e){return Tt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Mt=null;function Et(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Dt=null,Rt=null;function It(e){var t=Ge(e);if(t&&(e=t.stateNode)){var n=e[Re]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+pt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=s[Re]||null;if(!r)throw Error(o(90));gt(s,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)(s=n[t]).form===e.form&&ht(s)}break e;case"textarea":yt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&vt(e,!!n.multiple,t,!1)}}}var Pt=!1;function Ot(e,t,n){if(Pt)return e(t,n);Pt=!0;try{return e(t)}finally{if(Pt=!1,(null!==Dt||null!==Rt)&&(zc(),Dt&&(t=Dt,e=Rt,Rt=Dt=null,It(t),e)))for(t=0;t<e.length;t++)It(e[t])}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var s=n[Re]||null;if(null===s)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(s=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!s;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Lt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),qt=!1;if(Lt)try{var Vt={};Object.defineProperty(Vt,"passive",{get:function(){qt=!0}}),window.addEventListener("test",Vt,Vt),window.removeEventListener("test",Vt,Vt)}catch(Rh){qt=!1}var zt=null,Gt=null,Bt=null;function $t(){if(Bt)return Bt;var e,t,n=Gt,s=n.length,r="value"in zt?zt.value:zt.textContent,a=r.length;for(e=0;e<s&&n[e]===r[e];e++);var o=s-e;for(t=1;t<=o&&n[s-t]===r[a-t];t++);return Bt=r.slice(e,1<t?1-t:void 0)}function Ut(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Wt(){return!0}function Ht(){return!1}function Qt(e){function t(t,n,s,r,a){for(var o in this._reactName=t,this._targetInst=s,this.type=n,this.nativeEvent=r,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Wt:Ht,this.isPropagationStopped=Ht,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Wt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Wt)},persist:function(){},isPersistent:Wt}),t}var Kt,Yt,Xt,Zt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jt=Qt(Zt),en=h({},Zt,{view:0,detail:0}),tn=Qt(en),nn=h({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xt&&(Xt&&"mousemove"===e.type?(Kt=e.screenX-Xt.screenX,Yt=e.screenY-Xt.screenY):Yt=Kt=0,Xt=e),Kt)},movementY:function(e){return"movementY"in e?e.movementY:Yt}}),sn=Qt(nn),rn=Qt(h({},nn,{dataTransfer:0})),an=Qt(h({},en,{relatedTarget:0})),on=Qt(h({},Zt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Qt(h({},Zt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=Qt(h({},Zt,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=hn[e])&&!!t[e]}function fn(){return mn}var pn=Qt(h({},en,{key:function(e){if(e.key){var t=un[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Ut(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fn,charCode:function(e){return"keypress"===e.type?Ut(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Ut(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=Qt(h({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),xn=Qt(h({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fn})),bn=Qt(h({},Zt,{propertyName:0,elapsedTime:0,pseudoElement:0})),vn=Qt(h({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),yn=Qt(h({},Zt,{newState:0,oldState:0})),wn=[9,13,27,32],jn=Lt&&"CompositionEvent"in window,kn=null;Lt&&"documentMode"in document&&(kn=document.documentMode);var Nn=Lt&&"TextEvent"in window&&!kn,Cn=Lt&&(!jn||kn&&8<kn&&11>=kn),_n=String.fromCharCode(32),Sn=!1;function Tn(e,t){switch(e){case"keyup":return-1!==wn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function An(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Mn=!1;var En={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!En[e.type]:"textarea"===t}function Rn(e,t,n,s){Dt?Rt?Rt.push(s):Rt=[s]:Dt=s,0<(t=$u(t,"onChange")).length&&(n=new Jt("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var In=null,Pn=null;function On(e){Ou(e,0)}function Fn(e){if(ht(Be(e)))return e}function Ln(e,t){if("change"===e)return t}var qn=!1;if(Lt){var Vn;if(Lt){var zn="oninput"in document;if(!zn){var Gn=document.createElement("div");Gn.setAttribute("oninput","return;"),zn="function"===typeof Gn.oninput}Vn=zn}else Vn=!1;qn=Vn&&(!document.documentMode||9<document.documentMode)}function Bn(){In&&(In.detachEvent("onpropertychange",$n),Pn=In=null)}function $n(e){if("value"===e.propertyName&&Fn(Pn)){var t=[];Rn(t,Pn,e,Et(e)),Ot(On,t)}}function Un(e,t,n){"focusin"===e?(Bn(),Pn=n,(In=t).attachEvent("onpropertychange",$n)):"focusout"===e&&Bn()}function Wn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(Pn)}function Hn(e,t){if("click"===e)return Fn(t)}function Qn(e,t){if("input"===e||"change"===e)return Fn(t)}var Kn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Yn(e,t){if(Kn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Y.call(t,r)||!Kn(e[r],t[r]))return!1}return!0}function Xn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zn(e,t){var n,s=Xn(e);for(e=0;s;){if(3===s.nodeType){if(n=e+s.textContent.length,e<=t&&n>=t)return{node:s,offset:t-e};e=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Xn(s)}}function Jn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Jn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function es(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(s){n=!1}if(!n)break;t=mt((e=t.contentWindow).document)}return t}function ts(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ns=Lt&&"documentMode"in document&&11>=document.documentMode,ss=null,rs=null,as=null,os=!1;function is(e,t,n){var s=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;os||null==ss||ss!==mt(s)||("selectionStart"in(s=ss)&&ts(s)?s={start:s.selectionStart,end:s.selectionEnd}:s={anchorNode:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset},as&&Yn(as,s)||(as=s,0<(s=$u(rs,"onSelect")).length&&(t=new Jt("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=ss)))}function ls(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cs={animationend:ls("Animation","AnimationEnd"),animationiteration:ls("Animation","AnimationIteration"),animationstart:ls("Animation","AnimationStart"),transitionrun:ls("Transition","TransitionRun"),transitionstart:ls("Transition","TransitionStart"),transitioncancel:ls("Transition","TransitionCancel"),transitionend:ls("Transition","TransitionEnd")},us={},ds={};function hs(e){if(us[e])return us[e];if(!cs[e])return e;var t,n=cs[e];for(t in n)if(n.hasOwnProperty(t)&&t in ds)return us[e]=n[t];return e}Lt&&(ds=document.createElement("div").style,"AnimationEvent"in window||(delete cs.animationend.animation,delete cs.animationiteration.animation,delete cs.animationstart.animation),"TransitionEvent"in window||delete cs.transitionend.transition);var ms=hs("animationend"),fs=hs("animationiteration"),ps=hs("animationstart"),gs=hs("transitionrun"),xs=hs("transitionstart"),bs=hs("transitioncancel"),vs=hs("transitionend"),ys=new Map,ws="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function js(e,t){ys.set(e,t),Qe(t,[e])}ws.push("scrollEnd");var ks=new WeakMap;function Ns(e,t){if("object"===typeof e&&null!==e){var n=ks.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},ks.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Cs=[],_s=0,Ss=0;function Ts(){for(var e=_s,t=Ss=_s=0;t<e;){var n=Cs[t];Cs[t++]=null;var s=Cs[t];Cs[t++]=null;var r=Cs[t];Cs[t++]=null;var a=Cs[t];if(Cs[t++]=null,null!==s&&null!==r){var o=s.pending;null===o?r.next=r:(r.next=o.next,o.next=r),s.pending=r}0!==a&&Ds(n,r,a)}}function As(e,t,n,s){Cs[_s++]=e,Cs[_s++]=t,Cs[_s++]=n,Cs[_s++]=s,Ss|=s,e.lanes|=s,null!==(e=e.alternate)&&(e.lanes|=s)}function Ms(e,t,n,s){return As(e,t,n,s),Rs(e)}function Es(e,t){return As(e,null,null,t),Rs(e)}function Ds(e,t,n){e.lanes|=n;var s=e.alternate;null!==s&&(s.lanes|=n);for(var r=!1,a=e.return;null!==a;)a.childLanes|=n,null!==(s=a.alternate)&&(s.childLanes|=n),22===a.tag&&(null===(e=a.stateNode)||1&e._visibility||(r=!0)),e=a,a=a.return;return 3===e.tag?(a=e.stateNode,r&&null!==t&&(r=31-me(n),null===(s=(e=a.hiddenUpdates)[r])?e[r]=[t]:s.push(t),t.lane=536870912|n),a):null}function Rs(e){if(50<Dc)throw Dc=0,Rc=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Is={};function Ps(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Os(e,t,n,s){return new Ps(e,t,n,s)}function Fs(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ls(e,t){var n=e.alternate;return null===n?((n=Os(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function qs(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Vs(e,t,n,s,r,a){var i=0;if(s=e,"function"===typeof e)Fs(e)&&(i=1);else if("string"===typeof e)i=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,G.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case S:return(e=Os(31,n,t,r)).elementType=S,e.lanes=a,e;case g:return zs(n.children,r,a,t);case x:i=8,r|=24;break;case b:return(e=Os(12,n,t,2|r)).elementType=b,e.lanes=a,e;case k:return(e=Os(13,n,t,r)).elementType=k,e.lanes=a,e;case N:return(e=Os(19,n,t,r)).elementType=N,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case v:case w:i=10;break e;case y:i=9;break e;case j:i=11;break e;case C:i=14;break e;case _:i=16,s=null;break e}i=29,n=Error(o(130,null===e?"null":typeof e,"")),s=null}return(t=Os(i,n,t,r)).elementType=e,t.type=s,t.lanes=a,t}function zs(e,t,n,s){return(e=Os(7,e,s,t)).lanes=n,e}function Gs(e,t,n){return(e=Os(6,e,null,t)).lanes=n,e}function Bs(e,t,n){return(t=Os(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var $s=[],Us=0,Ws=null,Hs=0,Qs=[],Ks=0,Ys=null,Xs=1,Zs="";function Js(e,t){$s[Us++]=Hs,$s[Us++]=Ws,Ws=e,Hs=t}function er(e,t,n){Qs[Ks++]=Xs,Qs[Ks++]=Zs,Qs[Ks++]=Ys,Ys=e;var s=Xs;e=Zs;var r=32-me(s)-1;s&=~(1<<r),n+=1;var a=32-me(t)+r;if(30<a){var o=r-r%5;a=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Xs=1<<32-me(t)+r|n<<r|s,Zs=a+e}else Xs=1<<a|n<<r|s,Zs=e}function tr(e){null!==e.return&&(Js(e,1),er(e,1,0))}function nr(e){for(;e===Ws;)Ws=$s[--Us],$s[Us]=null,Hs=$s[--Us],$s[Us]=null;for(;e===Ys;)Ys=Qs[--Ks],Qs[Ks]=null,Zs=Qs[--Ks],Qs[Ks]=null,Xs=Qs[--Ks],Qs[Ks]=null}var sr=null,rr=null,ar=!1,or=null,ir=!1,lr=Error(o(519));function cr(e){throw pr(Ns(Error(o(418,"")),e)),lr}function ur(e){var t=e.stateNode,n=e.type,s=e.memoizedProps;switch(t[De]=e,t[Re]=s,n){case"dialog":Fu("cancel",t),Fu("close",t);break;case"iframe":case"object":case"embed":Fu("load",t);break;case"video":case"audio":for(n=0;n<Iu.length;n++)Fu(Iu[n],t);break;case"source":Fu("error",t);break;case"img":case"image":case"link":Fu("error",t),Fu("load",t);break;case"details":Fu("toggle",t);break;case"input":Fu("invalid",t),xt(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0),dt(t);break;case"select":Fu("invalid",t);break;case"textarea":Fu("invalid",t),wt(t,s.value,s.defaultValue,s.children),dt(t)}"string"!==typeof(n=s.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===s.suppressHydrationWarning||Yu(t.textContent,n)?(null!=s.popover&&(Fu("beforetoggle",t),Fu("toggle",t)),null!=s.onScroll&&Fu("scroll",t),null!=s.onScrollEnd&&Fu("scrollend",t),null!=s.onClick&&(t.onclick=Xu),t=!0):t=!1,t||cr(e)}function dr(e){for(sr=e.return;sr;)switch(sr.tag){case 5:case 13:return void(ir=!1);case 27:case 3:return void(ir=!0);default:sr=sr.return}}function hr(e){if(e!==sr)return!1;if(!ar)return dr(e),ar=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||od(e.type,e.memoizedProps)),t=!t),t&&rr&&cr(e),dr(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){rr=xd(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}rr=null}}else 27===n?(n=rr,md(e.type)?(e=bd,bd=null,rr=e):rr=n):rr=sr?xd(e.stateNode.nextSibling):null;return!0}function mr(){rr=sr=null,ar=!1}function fr(){var e=or;return null!==e&&(null===vc?vc=e:vc.push.apply(vc,e),or=null),e}function pr(e){null===or?or=[e]:or.push(e)}var gr=q(null),xr=null,br=null;function vr(e,t,n){z(gr,t._currentValue),t._currentValue=n}function yr(e){e._currentValue=gr.current,V(gr)}function wr(e,t,n){for(;null!==e;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==s&&(s.childLanes|=t)):null!==s&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function jr(e,t,n,s){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var a=r.dependencies;if(null!==a){var i=r.child;a=a.firstContext;e:for(;null!==a;){var l=a;a=r;for(var c=0;c<t.length;c++)if(l.context===t[c]){a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),wr(a.return,n,e),s||(i=null);break e}a=l.next}}else if(18===r.tag){if(null===(i=r.return))throw Error(o(341));i.lanes|=n,null!==(a=i.alternate)&&(a.lanes|=n),wr(i,n,e),i=null}else i=r.child;if(null!==i)i.return=r;else for(i=r;null!==i;){if(i===e){i=null;break}if(null!==(r=i.sibling)){r.return=i.return,i=r;break}i=i.return}r=i}}function kr(e,t,n,s){e=null;for(var r=t,a=!1;null!==r;){if(!a)if(0!==(524288&r.flags))a=!0;else if(0!==(262144&r.flags))break;if(10===r.tag){var i=r.alternate;if(null===i)throw Error(o(387));if(null!==(i=i.memoizedProps)){var l=r.type;Kn(r.pendingProps.value,i.value)||(null!==e?e.push(l):e=[l])}}else if(r===U.current){if(null===(i=r.alternate))throw Error(o(387));i.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(Qd):e=[Qd])}r=r.return}null!==e&&jr(t,e,n,s),t.flags|=262144}function Nr(e){for(e=e.firstContext;null!==e;){if(!Kn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Cr(e){xr=e,br=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function _r(e){return Tr(xr,e)}function Sr(e,t){return null===xr&&Cr(e),Tr(e,t)}function Tr(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===br){if(null===e)throw Error(o(308));br=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else br=br.next=t;return n}var Ar="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Mr=s.unstable_scheduleCallback,Er=s.unstable_NormalPriority,Dr={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Rr(){return{controller:new Ar,data:new Map,refCount:0}}function Ir(e){e.refCount--,0===e.refCount&&Mr(Er,function(){e.controller.abort()})}var Pr=null,Or=0,Fr=0,Lr=null;function qr(){if(0===--Or&&null!==Pr){null!==Lr&&(Lr.status="fulfilled");var e=Pr;Pr=null,Fr=0,Lr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Vr=I.S;I.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Pr){var n=Pr=[];Or=0,Fr=Au(),Lr={status:"pending",value:void 0,then:function(e){n.push(e)}}}Or++,t.then(qr,qr)}(0,t),null!==Vr&&Vr(e,t)};var zr=q(null);function Gr(){var e=zr.current;return null!==e?e:sc.pooledCache}function Br(e,t){z(zr,null===t?zr.current:t.pool)}function $r(){var e=Gr();return null===e?null:{parent:Dr._currentValue,pool:e}}var Ur=Error(o(460)),Wr=Error(o(474)),Hr=Error(o(542)),Qr={then:function(){}};function Kr(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Yr(){}function Xr(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Yr,Yr),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ea(e=t.reason),e;default:if("string"===typeof t.status)t.then(Yr,Yr);else{if(null!==(e=sc)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ea(e=t.reason),e}throw Zr=t,Ur}}var Zr=null;function Jr(){if(null===Zr)throw Error(o(459));var e=Zr;return Zr=null,e}function ea(e){if(e===Ur||e===Hr)throw Error(o(483))}var ta=!1;function na(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ra(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function aa(e,t,n){var s=e.updateQueue;if(null===s)return null;if(s=s.shared,0!==(2&nc)){var r=s.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),s.pending=t,t=Rs(e),Ds(e,null,n),t}return As(e,s,t,n),Rs(e)}function oa(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var s=t.lanes;n|=s&=e.pendingLanes,t.lanes=n,Se(e,n)}}function ia(e,t){var n=e.updateQueue,s=e.alternate;if(null!==s&&n===(s=s.updateQueue)){var r=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===a?r=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?r=a=t:a=a.next=t}else r=a=t;return n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:s.shared,callbacks:s.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var la=!1;function ca(){if(la){if(null!==Lr)throw Lr}}function ua(e,t,n,s){la=!1;var r=e.updateQueue;ta=!1;var a=r.firstBaseUpdate,o=r.lastBaseUpdate,i=r.shared.pending;if(null!==i){r.shared.pending=null;var l=i,c=l.next;l.next=null,null===o?a=c:o.next=c,o=l;var u=e.alternate;null!==u&&((i=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===i?u.firstBaseUpdate=c:i.next=c,u.lastBaseUpdate=l))}if(null!==a){var d=r.baseState;for(o=0,u=c=l=null,i=a;;){var m=-536870913&i.lane,f=m!==i.lane;if(f?(ac&m)===m:(s&m)===m){0!==m&&m===Fr&&(la=!0),null!==u&&(u=u.next={lane:0,tag:i.tag,payload:i.payload,callback:null,next:null});e:{var p=e,g=i;m=t;var x=n;switch(g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(x,d,m);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(m="function"===typeof(p=g.payload)?p.call(x,d,m):p)||void 0===m)break e;d=h({},d,m);break e;case 2:ta=!0}}null!==(m=i.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=r.callbacks)?r.callbacks=[m]:f.push(m))}else f={lane:m,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,o|=m;if(null===(i=i.next)){if(null===(i=r.shared.pending))break;i=(f=i).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}null===u&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null===a&&(r.shared.lanes=0),mc|=o,e.lanes=o,e.memoizedState=d}}function da(e,t){if("function"!==typeof e)throw Error(o(191,e));e.call(t)}function ha(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)da(n[e],t)}var ma=q(null),fa=q(0);function pa(e,t){z(fa,e=dc),z(ma,t),dc=e|t.baseLanes}function ga(){z(fa,dc),z(ma,ma.current)}function xa(){dc=fa.current,V(ma),V(fa)}var ba=0,va=null,ya=null,wa=null,ja=!1,ka=!1,Na=!1,Ca=0,_a=0,Sa=null,Ta=0;function Aa(){throw Error(o(321))}function Ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Kn(e[n],t[n]))return!1;return!0}function Ea(e,t,n,s,r,a){return ba=a,va=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,I.H=null===e||null===e.memoizedState?Wo:Ho,Na=!1,a=n(s,r),Na=!1,ka&&(a=Ra(t,n,s,r)),Da(e),a}function Da(e){I.H=Uo;var t=null!==ya&&null!==ya.next;if(ba=0,wa=ya=va=null,ja=!1,_a=0,Sa=null,t)throw Error(o(300));null===e||Si||null!==(e=e.dependencies)&&Nr(e)&&(Si=!0)}function Ra(e,t,n,s){va=e;var r=0;do{if(ka&&(Sa=null),_a=0,ka=!1,25<=r)throw Error(o(301));if(r+=1,wa=ya=null,null!=e.updateQueue){var a=e.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,null!=a.memoCache&&(a.memoCache.index=0)}I.H=Qo,a=t(n,s)}while(ka);return a}function Ia(){var e=I.H,t=e.useState()[0];return t="function"===typeof t.then?Va(t):t,e=e.useState()[0],(null!==ya?ya.memoizedState:null)!==e&&(va.flags|=1024),t}function Pa(){var e=0!==Ca;return Ca=0,e}function Oa(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Fa(e){if(ja){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}ja=!1}ba=0,wa=ya=va=null,ka=!1,_a=Ca=0,Sa=null}function La(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===wa?va.memoizedState=wa=e:wa=wa.next=e,wa}function qa(){if(null===ya){var e=va.alternate;e=null!==e?e.memoizedState:null}else e=ya.next;var t=null===wa?va.memoizedState:wa.next;if(null!==t)wa=t,ya=e;else{if(null===e){if(null===va.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(ya=e).memoizedState,baseState:ya.baseState,baseQueue:ya.baseQueue,queue:ya.queue,next:null},null===wa?va.memoizedState=wa=e:wa=wa.next=e}return wa}function Va(e){var t=_a;return _a+=1,null===Sa&&(Sa=[]),e=Xr(Sa,e,t),t=va,null===(null===wa?t.memoizedState:wa.next)&&(t=t.alternate,I.H=null===t||null===t.memoizedState?Wo:Ho),e}function za(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Va(e);if(e.$$typeof===w)return _r(e)}throw Error(o(438,String(e)))}function Ga(e){var t=null,n=va.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var s=va.alternate;null!==s&&(null!==(s=s.updateQueue)&&(null!=(s=s.memoCache)&&(t={data:s.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},va.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),s=0;s<e;s++)n[s]=T;return t.index++,n}function Ba(e,t){return"function"===typeof t?t(e):t}function $a(e){return Ua(qa(),ya,e)}function Ua(e,t,n){var s=e.queue;if(null===s)throw Error(o(311));s.lastRenderedReducer=n;var r=e.baseQueue,a=s.pending;if(null!==a){if(null!==r){var i=r.next;r.next=a.next,a.next=i}t.baseQueue=r=a,s.pending=null}if(a=e.baseState,null===r)e.memoizedState=a;else{var l=i=null,c=null,u=t=r.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(ac&h)===h:(ba&h)===h){var m=u.revertLane;if(0===m)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Fr&&(d=!0);else{if((ba&m)===m){u=u.next,m===Fr&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,i=a):c=c.next=h,va.lanes|=m,mc|=m}h=u.action,Na&&n(a,h),a=u.hasEagerState?u.eagerState:n(a,h)}else m={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=m,i=a):c=c.next=m,va.lanes|=h,mc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?i=a:c.next=l,!Kn(a,e.memoizedState)&&(Si=!0,d&&null!==(n=Lr)))throw n;e.memoizedState=a,e.baseState=i,e.baseQueue=c,s.lastRenderedState=a}return null===r&&(s.lanes=0),[e.memoizedState,s.dispatch]}function Wa(e){var t=qa(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,a=t.memoizedState;if(null!==r){n.pending=null;var i=r=r.next;do{a=e(a,i.action),i=i.next}while(i!==r);Kn(a,t.memoizedState)||(Si=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,s]}function Ha(e,t,n){var s=va,r=qa(),a=ar;if(a){if(void 0===n)throw Error(o(407));n=n()}else n=t();var i=!Kn((ya||r).memoizedState,n);if(i&&(r.memoizedState=n,Si=!0),r=r.queue,xo(2048,8,Ya.bind(null,s,r,e),[e]),r.getSnapshot!==t||i||null!==wa&&1&wa.memoizedState.tag){if(s.flags|=2048,fo(9,{destroy:void 0,resource:void 0},Ka.bind(null,s,r,n,t),null),null===sc)throw Error(o(349));a||0!==(124&ba)||Qa(s,t,n)}return n}function Qa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=va.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},va.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ka(e,t,n,s){t.value=n,t.getSnapshot=s,Xa(t)&&Za(e)}function Ya(e,t,n){return n(function(){Xa(t)&&Za(e)})}function Xa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Kn(e,n)}catch(s){return!0}}function Za(e){var t=Es(e,2);null!==t&&Oc(t,e,2)}function Ja(e){var t=La();if("function"===typeof e){var n=e;if(e=n(),Na){he(!0);try{n()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:e},t}function eo(e,t,n,s){return e.baseState=n,Ua(e,ya,"function"===typeof s?s:Ba)}function to(e,t,n,s,r){if(Go(e))throw Error(o(485));if(null!==(e=t.action)){var a={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){a.listeners.push(e)}};null!==I.T?n(!0):a.isTransition=!1,s(a),null===(n=t.pending)?(a.next=t.pending=a,no(t,a)):(a.next=n.next,t.pending=n.next=a)}}function no(e,t){var n=t.action,s=t.payload,r=e.state;if(t.isTransition){var a=I.T,o={};I.T=o;try{var i=n(r,s),l=I.S;null!==l&&l(o,i),so(e,t,i)}catch(c){ao(e,t,c)}finally{I.T=a}}else try{so(e,t,a=n(r,s))}catch(u){ao(e,t,u)}}function so(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){ro(e,t,n)},function(n){return ao(e,t,n)}):ro(e,t,n)}function ro(e,t,n){t.status="fulfilled",t.value=n,oo(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,no(e,n)))}function ao(e,t,n){var s=e.pending;if(e.pending=null,null!==s){s=s.next;do{t.status="rejected",t.reason=n,oo(t),t=t.next}while(t!==s)}e.action=null}function oo(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function io(e,t){return t}function lo(e,t){if(ar){var n=sc.formState;if(null!==n){e:{var s=va;if(ar){if(rr){t:{for(var r=rr,a=ir;8!==r.nodeType;){if(!a){r=null;break t}if(null===(r=xd(r.nextSibling))){r=null;break t}}r="F!"===(a=r.data)||"F"===a?r:null}if(r){rr=xd(r.nextSibling),s="F!"===r.data;break e}}cr(s)}s=!1}s&&(t=n[0])}}return(n=La()).memoizedState=n.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:io,lastRenderedState:t},n.queue=s,n=qo.bind(null,va,s),s.dispatch=n,s=Ja(!1),a=zo.bind(null,va,!1,s.queue),r={state:t,dispatch:null,action:e,pending:null},(s=La()).queue=r,n=to.bind(null,va,r,a,n),r.dispatch=n,s.memoizedState=e,[t,n,!1]}function co(e){return uo(qa(),ya,e)}function uo(e,t,n){if(t=Ua(e,t,io)[0],e=$a(Ba)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var s=Va(t)}catch(o){if(o===Ur)throw Hr;throw o}else s=t;var r=(t=qa()).queue,a=r.dispatch;return n!==t.memoizedState&&(va.flags|=2048,fo(9,{destroy:void 0,resource:void 0},ho.bind(null,r,n),null)),[s,a,e]}function ho(e,t){e.action=t}function mo(e){var t=qa(),n=ya;if(null!==n)return uo(t,n,e);qa(),t=t.memoizedState;var s=(n=qa()).queue.dispatch;return n.memoizedState=e,[t,s,!1]}function fo(e,t,n,s){return e={tag:e,create:n,deps:s,inst:t,next:null},null===(t=va.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},va.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function po(){return qa().memoizedState}function go(e,t,n,s){var r=La();s=void 0===s?null:s,va.flags|=e,r.memoizedState=fo(1|t,{destroy:void 0,resource:void 0},n,s)}function xo(e,t,n,s){var r=qa();s=void 0===s?null:s;var a=r.memoizedState.inst;null!==ya&&null!==s&&Ma(s,ya.memoizedState.deps)?r.memoizedState=fo(t,a,n,s):(va.flags|=e,r.memoizedState=fo(1|t,a,n,s))}function bo(e,t){go(8390656,8,e,t)}function vo(e,t){xo(2048,8,e,t)}function yo(e,t){return xo(4,2,e,t)}function wo(e,t){return xo(4,4,e,t)}function jo(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function ko(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,xo(4,4,jo.bind(null,t,e),n)}function No(){}function Co(e,t){var n=qa();t=void 0===t?null:t;var s=n.memoizedState;return null!==t&&Ma(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function _o(e,t){var n=qa();t=void 0===t?null:t;var s=n.memoizedState;if(null!==t&&Ma(t,s[1]))return s[0];if(s=e(),Na){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[s,t],s}function So(e,t,n){return void 0===n||0!==(1073741824&ba)?e.memoizedState=t:(e.memoizedState=n,e=Pc(),va.lanes|=e,mc|=e,n)}function To(e,t,n,s){return Kn(n,t)?n:null!==ma.current?(e=So(e,n,s),Kn(e,t)||(Si=!0),e):0===(42&ba)?(Si=!0,e.memoizedState=n):(e=Pc(),va.lanes|=e,mc|=e,t)}function Ao(e,t,n,s,r){var a=P.p;P.p=0!==a&&8>a?a:8;var o=I.T,i={};I.T=i,zo(e,!1,t,n);try{var l=r(),c=I.S;if(null!==c&&c(i,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)Vo(e,t,function(e,t){var n=[],s={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){s.status="fulfilled",s.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(s.status="rejected",s.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),s}(l,s),Ic());else Vo(e,t,s,Ic())}catch(u){Vo(e,t,{then:function(){},status:"rejected",reason:u},Ic())}finally{P.p=a,I.T=o}}function Mo(){}function Eo(e,t,n,s){if(5!==e.tag)throw Error(o(476));var r=Do(e).queue;Ao(e,r,t,O,null===n?Mo:function(){return Ro(e),n(s)})}function Do(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:O,baseState:O,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:O},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Ro(e){Vo(e,Do(e).next.queue,{},Ic())}function Io(){return _r(Qd)}function Po(){return qa().memoizedState}function Oo(){return qa().memoizedState}function Fo(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Ic(),s=aa(t,e=ra(n),n);return null!==s&&(Oc(s,t,n),oa(s,t,n)),t={cache:Rr()},void(e.payload=t)}t=t.return}}function Lo(e,t,n){var s=Ic();n={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Go(e)?Bo(t,n):null!==(n=Ms(e,t,n,s))&&(Oc(n,e,s),$o(n,t,s))}function qo(e,t,n){Vo(e,t,n,Ic())}function Vo(e,t,n,s){var r={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Go(e))Bo(t,r);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,i=a(o,n);if(r.hasEagerState=!0,r.eagerState=i,Kn(i,o))return As(e,t,r,0),null===sc&&Ts(),!1}catch(l){}if(null!==(n=Ms(e,t,r,s)))return Oc(n,e,s),$o(n,t,s),!0}return!1}function zo(e,t,n,s){if(s={lane:2,revertLane:Au(),action:s,hasEagerState:!1,eagerState:null,next:null},Go(e)){if(t)throw Error(o(479))}else null!==(t=Ms(e,n,s,2))&&Oc(t,e,2)}function Go(e){var t=e.alternate;return e===va||null!==t&&t===va}function Bo(e,t){ka=ja=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function $o(e,t,n){if(0!==(4194048&n)){var s=t.lanes;n|=s&=e.pendingLanes,t.lanes=n,Se(e,n)}}var Uo={readContext:_r,use:za,useCallback:Aa,useContext:Aa,useEffect:Aa,useImperativeHandle:Aa,useLayoutEffect:Aa,useInsertionEffect:Aa,useMemo:Aa,useReducer:Aa,useRef:Aa,useState:Aa,useDebugValue:Aa,useDeferredValue:Aa,useTransition:Aa,useSyncExternalStore:Aa,useId:Aa,useHostTransitionStatus:Aa,useFormState:Aa,useActionState:Aa,useOptimistic:Aa,useMemoCache:Aa,useCacheRefresh:Aa},Wo={readContext:_r,use:za,useCallback:function(e,t){return La().memoizedState=[e,void 0===t?null:t],e},useContext:_r,useEffect:bo,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,go(4194308,4,jo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return go(4194308,4,e,t)},useInsertionEffect:function(e,t){go(4,2,e,t)},useMemo:function(e,t){var n=La();t=void 0===t?null:t;var s=e();if(Na){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[s,t],s},useReducer:function(e,t,n){var s=La();if(void 0!==n){var r=n(t);if(Na){he(!0);try{n(t)}finally{he(!1)}}}else r=t;return s.memoizedState=s.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},s.queue=e,e=e.dispatch=Lo.bind(null,va,e),[s.memoizedState,e]},useRef:function(e){return e={current:e},La().memoizedState=e},useState:function(e){var t=(e=Ja(e)).queue,n=qo.bind(null,va,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:No,useDeferredValue:function(e,t){return So(La(),e,t)},useTransition:function(){var e=Ja(!1);return e=Ao.bind(null,va,e.queue,!0,!1),La().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var s=va,r=La();if(ar){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===sc)throw Error(o(349));0!==(124&ac)||Qa(s,t,n)}r.memoizedState=n;var a={value:n,getSnapshot:t};return r.queue=a,bo(Ya.bind(null,s,a,e),[e]),s.flags|=2048,fo(9,{destroy:void 0,resource:void 0},Ka.bind(null,s,a,n,t),null),n},useId:function(){var e=La(),t=sc.identifierPrefix;if(ar){var n=Zs;t="\xab"+t+"R"+(n=(Xs&~(1<<32-me(Xs)-1)).toString(32)+n),0<(n=Ca++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=Ta++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Io,useFormState:lo,useActionState:lo,useOptimistic:function(e){var t=La();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=zo.bind(null,va,!0,n),n.dispatch=t,[e,t]},useMemoCache:Ga,useCacheRefresh:function(){return La().memoizedState=Fo.bind(null,va)}},Ho={readContext:_r,use:za,useCallback:Co,useContext:_r,useEffect:vo,useImperativeHandle:ko,useInsertionEffect:yo,useLayoutEffect:wo,useMemo:_o,useReducer:$a,useRef:po,useState:function(){return $a(Ba)},useDebugValue:No,useDeferredValue:function(e,t){return To(qa(),ya.memoizedState,e,t)},useTransition:function(){var e=$a(Ba)[0],t=qa().memoizedState;return["boolean"===typeof e?e:Va(e),t]},useSyncExternalStore:Ha,useId:Po,useHostTransitionStatus:Io,useFormState:co,useActionState:co,useOptimistic:function(e,t){return eo(qa(),0,e,t)},useMemoCache:Ga,useCacheRefresh:Oo},Qo={readContext:_r,use:za,useCallback:Co,useContext:_r,useEffect:vo,useImperativeHandle:ko,useInsertionEffect:yo,useLayoutEffect:wo,useMemo:_o,useReducer:Wa,useRef:po,useState:function(){return Wa(Ba)},useDebugValue:No,useDeferredValue:function(e,t){var n=qa();return null===ya?So(n,e,t):To(n,ya.memoizedState,e,t)},useTransition:function(){var e=Wa(Ba)[0],t=qa().memoizedState;return["boolean"===typeof e?e:Va(e),t]},useSyncExternalStore:Ha,useId:Po,useHostTransitionStatus:Io,useFormState:mo,useActionState:mo,useOptimistic:function(e,t){var n=qa();return null!==ya?eo(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Ga,useCacheRefresh:Oo},Ko=null,Yo=0;function Xo(e){var t=Yo;return Yo+=1,null===Ko&&(Ko=[]),Xr(Ko,e,t)}function Zo(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Jo(e,t){if(t.$$typeof===m)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ei(e){return(0,e._init)(e._payload)}function ti(e){function t(t,n){if(e){var s=t.deletions;null===s?(t.deletions=[n],t.flags|=16):s.push(n)}}function n(n,s){if(!e)return null;for(;null!==s;)t(n,s),s=s.sibling;return null}function s(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=Ls(e,t)).index=0,e.sibling=null,e}function a(t,n,s){return t.index=s,e?null!==(s=t.alternate)?(s=s.index)<n?(t.flags|=67108866,n):s:(t.flags|=67108866,n):(t.flags|=1048576,n)}function i(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,s){return null===t||6!==t.tag?((t=Gs(n,e.mode,s)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,s){var a=n.type;return a===g?d(e,t,n.props.children,s,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===_&&ei(a)===t.type)?(Zo(t=r(t,n.props),n),t.return=e,t):(Zo(t=Vs(n.type,n.key,n.props,null,e.mode,s),n),t.return=e,t)}function u(e,t,n,s){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bs(n,e.mode,s)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,s,a){return null===t||7!==t.tag?((t=zs(n,e.mode,s,a)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Gs(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case f:return Zo(n=Vs(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case p:return(t=Bs(t,e.mode,n)).return=e,t;case _:return h(e,t=(0,t._init)(t._payload),n)}if(R(t)||M(t))return(t=zs(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,Xo(t),n);if(t.$$typeof===w)return h(e,Sr(e,t),n);Jo(e,t)}return null}function m(e,t,n,s){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==r?null:l(e,t,""+n,s);if("object"===typeof n&&null!==n){switch(n.$$typeof){case f:return n.key===r?c(e,t,n,s):null;case p:return n.key===r?u(e,t,n,s):null;case _:return m(e,t,n=(r=n._init)(n._payload),s)}if(R(n)||M(n))return null!==r?null:d(e,t,n,s,null);if("function"===typeof n.then)return m(e,t,Xo(n),s);if(n.$$typeof===w)return m(e,t,Sr(e,n),s);Jo(e,n)}return null}function x(e,t,n,s,r){if("string"===typeof s&&""!==s||"number"===typeof s||"bigint"===typeof s)return l(t,e=e.get(n)||null,""+s,r);if("object"===typeof s&&null!==s){switch(s.$$typeof){case f:return c(t,e=e.get(null===s.key?n:s.key)||null,s,r);case p:return u(t,e=e.get(null===s.key?n:s.key)||null,s,r);case _:return x(e,t,n,s=(0,s._init)(s._payload),r)}if(R(s)||M(s))return d(t,e=e.get(n)||null,s,r,null);if("function"===typeof s.then)return x(e,t,n,Xo(s),r);if(s.$$typeof===w)return x(e,t,n,Sr(t,s),r);Jo(t,s)}return null}function b(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case f:e:{for(var v=u.key;null!==c;){if(c.key===v){if((v=u.type)===g){if(7===c.tag){n(l,c.sibling),(d=r(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===v||"object"===typeof v&&null!==v&&v.$$typeof===_&&ei(v)===c.type){n(l,c.sibling),Zo(d=r(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===g?((d=zs(u.props.children,l.mode,d,u.key)).return=l,l=d):(Zo(d=Vs(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return i(l);case p:e:{for(v=u.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=r(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Bs(u,l.mode,d)).return=l,l=d}return i(l);case _:return b(l,c,u=(v=u._init)(u._payload),d)}if(R(u))return function(r,o,i,l){for(var c=null,u=null,d=o,f=o=0,p=null;null!==d&&f<i.length;f++){d.index>f?(p=d,d=null):p=d.sibling;var g=m(r,d,i[f],l);if(null===g){null===d&&(d=p);break}e&&d&&null===g.alternate&&t(r,d),o=a(g,o,f),null===u?c=g:u.sibling=g,u=g,d=p}if(f===i.length)return n(r,d),ar&&Js(r,f),c;if(null===d){for(;f<i.length;f++)null!==(d=h(r,i[f],l))&&(o=a(d,o,f),null===u?c=d:u.sibling=d,u=d);return ar&&Js(r,f),c}for(d=s(d);f<i.length;f++)null!==(p=x(d,r,f,i[f],l))&&(e&&null!==p.alternate&&d.delete(null===p.key?f:p.key),o=a(p,o,f),null===u?c=p:u.sibling=p,u=p);return e&&d.forEach(function(e){return t(r,e)}),ar&&Js(r,f),c}(l,c,u,d);if(M(u)){if("function"!==typeof(v=M(u)))throw Error(o(150));return function(r,i,l,c){if(null==l)throw Error(o(151));for(var u=null,d=null,f=i,p=i=0,g=null,b=l.next();null!==f&&!b.done;p++,b=l.next()){f.index>p?(g=f,f=null):g=f.sibling;var v=m(r,f,b.value,c);if(null===v){null===f&&(f=g);break}e&&f&&null===v.alternate&&t(r,f),i=a(v,i,p),null===d?u=v:d.sibling=v,d=v,f=g}if(b.done)return n(r,f),ar&&Js(r,p),u;if(null===f){for(;!b.done;p++,b=l.next())null!==(b=h(r,b.value,c))&&(i=a(b,i,p),null===d?u=b:d.sibling=b,d=b);return ar&&Js(r,p),u}for(f=s(f);!b.done;p++,b=l.next())null!==(b=x(f,r,p,b.value,c))&&(e&&null!==b.alternate&&f.delete(null===b.key?p:b.key),i=a(b,i,p),null===d?u=b:d.sibling=b,d=b);return e&&f.forEach(function(e){return t(r,e)}),ar&&Js(r,p),u}(l,c,u=v.call(u),d)}if("function"===typeof u.then)return b(l,c,Xo(u),d);if(u.$$typeof===w)return b(l,c,Sr(l,u),d);Jo(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=r(c,u)).return=l,l=d):(n(l,c),(d=Gs(u,l.mode,d)).return=l,l=d),i(l)):n(l,c)}return function(e,t,n,s){try{Yo=0;var r=b(e,t,n,s);return Ko=null,r}catch(o){if(o===Ur||o===Hr)throw o;var a=Os(29,o,null,e.mode);return a.lanes=s,a.return=e,a}}}var ni=ti(!0),si=ti(!1),ri=q(null),ai=null;function oi(e){var t=e.alternate;z(ui,1&ui.current),z(ri,e),null===ai&&(null===t||null!==ma.current||null!==t.memoizedState)&&(ai=e)}function ii(e){if(22===e.tag){if(z(ui,ui.current),z(ri,e),null===ai){var t=e.alternate;null!==t&&null!==t.memoizedState&&(ai=e)}}else li()}function li(){z(ui,ui.current),z(ri,ri.current)}function ci(e){V(ri),ai===e&&(ai=null),V(ui)}var ui=q(0);function di(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||gd(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function hi(e,t,n,s){n=null===(n=n(s,t=e.memoizedState))||void 0===n?t:h({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var mi={enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Ic(),r=ra(s);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=aa(e,r,s))&&(Oc(t,e,s),oa(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Ic(),r=ra(s);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=aa(e,r,s))&&(Oc(t,e,s),oa(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ic(),s=ra(n);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=aa(e,s,n))&&(Oc(t,e,n),oa(t,e,n))}};function fi(e,t,n,s,r,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(s,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!Yn(n,s)||!Yn(r,a))}function pi(e,t,n,s){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,s),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&mi.enqueueReplaceState(t,t.state,null)}function gi(e,t){var n=t;if("ref"in t)for(var s in n={},t)"ref"!==s&&(n[s]=t[s]);if(e=e.defaultProps)for(var r in n===t&&(n=h({},n)),e)void 0===n[r]&&(n[r]=e[r]);return n}var xi="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function bi(e){xi(e)}function vi(e){console.error(e)}function yi(e){xi(e)}function wi(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function ji(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(s){setTimeout(function(){throw s})}}function ki(e,t,n){return(n=ra(n)).tag=3,n.payload={element:null},n.callback=function(){wi(e,t)},n}function Ni(e){return(e=ra(e)).tag=3,e}function Ci(e,t,n,s){var r=n.type.getDerivedStateFromError;if("function"===typeof r){var a=s.value;e.payload=function(){return r(a)},e.callback=function(){ji(t,n,s)}}var o=n.stateNode;null!==o&&"function"===typeof o.componentDidCatch&&(e.callback=function(){ji(t,n,s),"function"!==typeof r&&(null===Nc?Nc=new Set([this]):Nc.add(this));var e=s.stack;this.componentDidCatch(s.value,{componentStack:null!==e?e:""})})}var _i=Error(o(461)),Si=!1;function Ti(e,t,n,s){t.child=null===e?si(t,null,n,s):ni(t,e.child,n,s)}function Ai(e,t,n,s,r){n=n.render;var a=t.ref;if("ref"in s){var o={};for(var i in s)"ref"!==i&&(o[i]=s[i])}else o=s;return Cr(t),s=Ea(e,t,n,o,a,r),i=Pa(),null===e||Si?(ar&&i&&tr(t),t.flags|=1,Ti(e,t,s,r),t.child):(Oa(e,t,r),Ki(e,t,r))}function Mi(e,t,n,s,r){if(null===e){var a=n.type;return"function"!==typeof a||Fs(a)||void 0!==a.defaultProps||null!==n.compare?((e=Vs(n.type,null,s,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ei(e,t,a,s,r))}if(a=e.child,!Yi(e,r)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:Yn)(o,s)&&e.ref===t.ref)return Ki(e,t,r)}return t.flags|=1,(e=Ls(a,s)).ref=t.ref,e.return=t,t.child=e}function Ei(e,t,n,s,r){if(null!==e){var a=e.memoizedProps;if(Yn(a,s)&&e.ref===t.ref){if(Si=!1,t.pendingProps=s=a,!Yi(e,r))return t.lanes=e.lanes,Ki(e,t,r);0!==(131072&e.flags)&&(Si=!0)}}return Pi(e,t,n,s,r)}function Di(e,t,n){var s=t.pendingProps,r=s.children,a=null!==e?e.memoizedState:null;if("hidden"===s.mode){if(0!==(128&t.flags)){if(s=null!==a?a.baseLanes|n:n,null!==e){for(r=t.child=e.child,a=0;null!==r;)a=a|r.lanes|r.childLanes,r=r.sibling;t.childLanes=a&~s}else t.childLanes=0,t.child=null;return Ri(e,t,s,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Ri(e,t,null!==a?a.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Br(0,null!==a?a.cachePool:null),null!==a?pa(t,a):ga(),ii(t)}else null!==a?(Br(0,a.cachePool),pa(t,a),li(),t.memoizedState=null):(null!==e&&Br(0,null),ga(),li());return Ti(e,t,r,n),t.child}function Ri(e,t,n,s){var r=Gr();return r=null===r?null:{parent:Dr._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},null!==e&&Br(0,null),ga(),ii(t),null!==e&&kr(e,t,s,!0),null}function Ii(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(o(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Pi(e,t,n,s,r){return Cr(t),n=Ea(e,t,n,s,void 0,r),s=Pa(),null===e||Si?(ar&&s&&tr(t),t.flags|=1,Ti(e,t,n,r),t.child):(Oa(e,t,r),Ki(e,t,r))}function Oi(e,t,n,s,r,a){return Cr(t),t.updateQueue=null,n=Ra(t,s,n,r),Da(e),s=Pa(),null===e||Si?(ar&&s&&tr(t),t.flags|=1,Ti(e,t,n,a),t.child):(Oa(e,t,a),Ki(e,t,a))}function Fi(e,t,n,s,r){if(Cr(t),null===t.stateNode){var a=Is,o=n.contextType;"object"===typeof o&&null!==o&&(a=_r(o)),a=new n(s,a),t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,a.updater=mi,t.stateNode=a,a._reactInternals=t,(a=t.stateNode).props=s,a.state=t.memoizedState,a.refs={},na(t),o=n.contextType,a.context="object"===typeof o&&null!==o?_r(o):Is,a.state=t.memoizedState,"function"===typeof(o=n.getDerivedStateFromProps)&&(hi(t,n,o,s),a.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(o=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),o!==a.state&&mi.enqueueReplaceState(a,a.state,null),ua(t,s,a,r),ca(),a.state=t.memoizedState),"function"===typeof a.componentDidMount&&(t.flags|=4194308),s=!0}else if(null===e){a=t.stateNode;var i=t.memoizedProps,l=gi(n,i);a.props=l;var c=a.context,u=n.contextType;o=Is,"object"===typeof u&&null!==u&&(o=_r(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate,i=t.pendingProps!==i,u||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(i||c!==o)&&pi(t,a,s,o),ta=!1;var h=t.memoizedState;a.state=h,ua(t,s,a,r),ca(),c=t.memoizedState,i||h!==c||ta?("function"===typeof d&&(hi(t,n,d,s),c=t.memoizedState),(l=ta||fi(t,n,l,s,h,c,o))?(u||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),a.props=s,a.state=c,a.context=o,s=l):("function"===typeof a.componentDidMount&&(t.flags|=4194308),s=!1)}else{a=t.stateNode,sa(e,t),u=gi(n,o=t.memoizedProps),a.props=u,d=t.pendingProps,h=a.context,c=n.contextType,l=Is,"object"===typeof c&&null!==c&&(l=_r(c)),(c="function"===typeof(i=n.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&pi(t,a,s,l),ta=!1,h=t.memoizedState,a.state=h,ua(t,s,a,r),ca();var m=t.memoizedState;o!==d||h!==m||ta||null!==e&&null!==e.dependencies&&Nr(e.dependencies)?("function"===typeof i&&(hi(t,n,i,s),m=t.memoizedState),(u=ta||fi(t,n,u,s,h,m,l)||null!==e&&null!==e.dependencies&&Nr(e.dependencies))?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(s,m,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(s,m,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=m),a.props=s,a.state=m,a.context=l,s=u):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return a=s,Ii(e,t),s=0!==(128&t.flags),a||s?(a=t.stateNode,n=s&&"function"!==typeof n.getDerivedStateFromError?null:a.render(),t.flags|=1,null!==e&&s?(t.child=ni(t,e.child,null,r),t.child=ni(t,null,n,r)):Ti(e,t,n,r),t.memoizedState=a.state,e=t.child):e=Ki(e,t,r),e}function Li(e,t,n,s){return mr(),t.flags|=256,Ti(e,t,n,s),t.child}var qi={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vi(e){return{baseLanes:e,cachePool:$r()}}function zi(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=gc),e}function Gi(e,t,n){var s,r=t.pendingProps,a=!1,i=0!==(128&t.flags);if((s=i)||(s=(null===e||null!==e.memoizedState)&&0!==(2&ui.current)),s&&(a=!0,t.flags&=-129),s=0!==(32&t.flags),t.flags&=-33,null===e){if(ar){if(a?oi(t):li(),ar){var l,c=rr;if(l=c){e:{for(l=c,c=ir;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=xd(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Ys?{id:Xs,overflow:Zs}:null,retryLane:536870912,hydrationErrors:null},(l=Os(18,null,null,0)).stateNode=c,l.return=t,t.child=l,sr=t,rr=null,l=!0):l=!1}l||cr(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return gd(c)?t.lanes=32:t.lanes=536870912,null;ci(t)}return c=r.children,r=r.fallback,a?(li(),c=$i({mode:"hidden",children:c},a=t.mode),r=zs(r,a,n,null),c.return=t,r.return=t,c.sibling=r,t.child=c,(a=t.child).memoizedState=Vi(n),a.childLanes=zi(e,s,n),t.memoizedState=qi,r):(oi(t),Bi(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(i)256&t.flags?(oi(t),t.flags&=-257,t=Ui(e,t,n)):null!==t.memoizedState?(li(),t.child=e.child,t.flags|=128,t=null):(li(),a=r.fallback,c=t.mode,r=$i({mode:"visible",children:r.children},c),(a=zs(a,c,n,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,ni(t,e.child,null,n),(r=t.child).memoizedState=Vi(n),r.childLanes=zi(e,s,n),t.memoizedState=qi,t=a);else if(oi(t),gd(c)){if(s=c.nextSibling&&c.nextSibling.dataset)var u=s.dgst;s=u,(r=Error(o(419))).stack="",r.digest=s,pr({value:r,source:null,stack:null}),t=Ui(e,t,n)}else if(Si||kr(e,t,n,!1),s=0!==(n&e.childLanes),Si||s){if(null!==(s=sc)&&(0!==(r=0!==((r=0!==(42&(r=n&-n))?1:Te(r))&(s.suspendedLanes|n))?0:r)&&r!==l.retryLane))throw l.retryLane=r,Es(e,r),Oc(s,e,r),_i;"$?"===c.data||Hc(),t=Ui(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,rr=xd(c.nextSibling),sr=t,ar=!0,or=null,ir=!1,null!==e&&(Qs[Ks++]=Xs,Qs[Ks++]=Zs,Qs[Ks++]=Ys,Xs=e.id,Zs=e.overflow,Ys=t),(t=Bi(t,r.children)).flags|=4096);return t}return a?(li(),a=r.fallback,c=t.mode,u=(l=e.child).sibling,(r=Ls(l,{mode:"hidden",children:r.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?a=Ls(u,a):(a=zs(a,c,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,null===(c=e.child.memoizedState)?c=Vi(n):(null!==(l=c.cachePool)?(u=Dr._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=$r(),c={baseLanes:c.baseLanes|n,cachePool:l}),a.memoizedState=c,a.childLanes=zi(e,s,n),t.memoizedState=qi,r):(oi(t),e=(n=e.child).sibling,(n=Ls(n,{mode:"visible",children:r.children})).return=t,n.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n)}function Bi(e,t){return(t=$i({mode:"visible",children:t},e.mode)).return=e,e.child=t}function $i(e,t){return(e=Os(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Ui(e,t,n){return ni(t,e.child,null,n),(e=Bi(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Wi(e,t,n){e.lanes|=t;var s=e.alternate;null!==s&&(s.lanes|=t),wr(e.return,t,n)}function Hi(e,t,n,s,r){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=r)}function Qi(e,t,n){var s=t.pendingProps,r=s.revealOrder,a=s.tail;if(Ti(e,t,s.children,n),0!==(2&(s=ui.current)))s=1&s|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Wi(e,n,t);else if(19===e.tag)Wi(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}switch(z(ui,s),r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===di(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Hi(t,!1,r,n,a);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===di(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Hi(t,!0,n,null,a);break;case"together":Hi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ki(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),mc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(kr(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Ls(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ls(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Yi(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Nr(e))}function Xi(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Si=!0;else{if(!Yi(e,n)&&0===(128&t.flags))return Si=!1,function(e,t,n){switch(t.tag){case 3:W(t,t.stateNode.containerInfo),vr(0,Dr,e.memoizedState.cache),mr();break;case 27:case 5:Q(t);break;case 4:W(t,t.stateNode.containerInfo);break;case 10:vr(0,t.type,t.memoizedProps.value);break;case 13:var s=t.memoizedState;if(null!==s)return null!==s.dehydrated?(oi(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Gi(e,t,n):(oi(t),null!==(e=Ki(e,t,n))?e.sibling:null);oi(t);break;case 19:var r=0!==(128&e.flags);if((s=0!==(n&t.childLanes))||(kr(e,t,n,!1),s=0!==(n&t.childLanes)),r){if(s)return Qi(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),z(ui,ui.current),s)break;return null;case 22:case 23:return t.lanes=0,Di(e,t,n);case 24:vr(0,Dr,e.memoizedState.cache)}return Ki(e,t,n)}(e,t,n);Si=0!==(131072&e.flags)}else Si=!1,ar&&0!==(1048576&t.flags)&&er(t,Hs,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var s=t.elementType,r=s._init;if(s=r(s._payload),t.type=s,"function"!==typeof s){if(void 0!==s&&null!==s){if((r=s.$$typeof)===j){t.tag=11,t=Ai(null,t,s,e,n);break e}if(r===C){t.tag=14,t=Mi(null,t,s,e,n);break e}}throw t=D(s)||s,Error(o(306,t,""))}Fs(s)?(e=gi(s,e),t.tag=1,t=Fi(null,t,s,e,n)):(t.tag=0,t=Pi(null,t,s,e,n))}return t;case 0:return Pi(e,t,t.type,t.pendingProps,n);case 1:return Fi(e,t,s=t.type,r=gi(s,t.pendingProps),n);case 3:e:{if(W(t,t.stateNode.containerInfo),null===e)throw Error(o(387));s=t.pendingProps;var a=t.memoizedState;r=a.element,sa(e,t),ua(t,s,null,n);var i=t.memoizedState;if(s=i.cache,vr(0,Dr,s),s!==a.cache&&jr(t,[Dr],n,!0),ca(),s=i.element,a.isDehydrated){if(a={element:s,isDehydrated:!1,cache:i.cache},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Li(e,t,s,n);break e}if(s!==r){pr(r=Ns(Error(o(424)),t)),t=Li(e,t,s,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(rr=xd(e.firstChild),sr=t,ar=!0,or=null,ir=!0,n=si(t,null,s,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(mr(),s===r){t=Ki(e,t,n);break e}Ti(e,t,s,n)}t=t.child}return t;case 26:return Ii(e,t),null===e?(n=Td(t.type,null,t.pendingProps,null))?t.memoizedState=n:ar||(n=t.type,e=t.pendingProps,(s=sd($.current).createElement(n))[De]=t,s[Re]=e,ed(s,n,e),Ue(s),t.stateNode=s):t.memoizedState=Td(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Q(t),null===e&&ar&&(s=t.stateNode=yd(t.type,t.pendingProps,$.current),sr=t,ir=!0,r=rr,md(t.type)?(bd=r,rr=xd(s.firstChild)):rr=r),Ti(e,t,t.pendingProps.children,n),Ii(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ar&&((r=s=rr)&&(null!==(s=function(e,t,n,s){for(;1===e.nodeType;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(s){if(!e[qe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(a=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(a!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((a=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&a&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var a=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===a)return e}if(null===(e=xd(e.nextSibling)))break}return null}(s,t.type,t.pendingProps,ir))?(t.stateNode=s,sr=t,rr=xd(s.firstChild),ir=!1,r=!0):r=!1),r||cr(t)),Q(t),r=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,s=a.children,od(r,a)?s=null:null!==i&&od(r,i)&&(t.flags|=32),null!==t.memoizedState&&(r=Ea(e,t,Ia,null,null,n),Qd._currentValue=r),Ii(e,t),Ti(e,t,s,n),t.child;case 6:return null===e&&ar&&((e=n=rr)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=xd(e.nextSibling)))return null}return e}(n,t.pendingProps,ir))?(t.stateNode=n,sr=t,rr=null,e=!0):e=!1),e||cr(t)),null;case 13:return Gi(e,t,n);case 4:return W(t,t.stateNode.containerInfo),s=t.pendingProps,null===e?t.child=ni(t,null,s,n):Ti(e,t,s,n),t.child;case 11:return Ai(e,t,t.type,t.pendingProps,n);case 7:return Ti(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ti(e,t,t.pendingProps.children,n),t.child;case 10:return s=t.pendingProps,vr(0,t.type,s.value),Ti(e,t,s.children,n),t.child;case 9:return r=t.type._context,s=t.pendingProps.children,Cr(t),s=s(r=_r(r)),t.flags|=1,Ti(e,t,s,n),t.child;case 14:return Mi(e,t,t.type,t.pendingProps,n);case 15:return Ei(e,t,t.type,t.pendingProps,n);case 19:return Qi(e,t,n);case 31:return s=t.pendingProps,n=t.mode,s={mode:s.mode,children:s.children},null===e?((n=$i(s,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Ls(e.child,s)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Di(e,t,n);case 24:return Cr(t),s=_r(Dr),null===e?(null===(r=Gr())&&(r=sc,a=Rr(),r.pooledCache=a,a.refCount++,null!==a&&(r.pooledCacheLanes|=n),r=a),t.memoizedState={parent:s,cache:r},na(t),vr(0,Dr,r)):(0!==(e.lanes&n)&&(sa(e,t),ua(t,null,null,n),ca()),r=e.memoizedState,a=t.memoizedState,r.parent!==s?(r={parent:s,cache:s},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),vr(0,Dr,s)):(s=a.cache,vr(0,Dr,s),s!==r.cache&&jr(t,[Dr],n,!0))),Ti(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function Zi(e){e.flags|=4}function Ji(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!zd(t)){if(null!==(t=ri.current)&&((4194048&ac)===ac?null!==ai:(62914560&ac)!==ac&&0===(536870912&ac)||t!==ai))throw Zr=Qr,Wr;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?ke():536870912,e.lanes|=t,xc|=t)}function tl(e,t){if(!ar)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;null!==n;)null!==n.alternate&&(s=n),n=n.sibling;null===s?t||null===e.tail?e.tail=null:e.tail.sibling=null:s.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,s=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,s|=65011712&r.subtreeFlags,s|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function sl(e,t,n){var s=t.pendingProps;switch(nr(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,s=null,null!==e&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),yr(Dr),H(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hr(t)?Zi(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,fr())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Zi(t),null!==n?(nl(t),Ji(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Zi(t),nl(t),Ji(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==s&&Zi(t),nl(t),t.flags&=-16777217),null;case 27:K(t),n=$.current;var r=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==s&&Zi(t);else{if(!s){if(null===t.stateNode)throw Error(o(166));return nl(t),null}e=G.current,hr(t)?ur(t):(e=yd(r,s,n),t.stateNode=e,Zi(t))}return nl(t),null;case 5:if(K(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==s&&Zi(t);else{if(!s){if(null===t.stateNode)throw Error(o(166));return nl(t),null}if(e=G.current,hr(t))ur(t);else{switch(r=sd($.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=r.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof s.is?r.createElement("select",{is:s.is}):r.createElement("select"),s.multiple?e.multiple=!0:s.size&&(e.size=s.size);break;default:e="string"===typeof s.is?r.createElement(n,{is:s.is}):r.createElement(n)}}e[De]=t,e[Re]=s;e:for(r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&27!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;null===r.sibling;){if(null===r.return||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(ed(e,n,s),n){case"button":case"input":case"select":case"textarea":e=!!s.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Zi(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==s&&Zi(t);else{if("string"!==typeof s&&null===t.stateNode)throw Error(o(166));if(e=$.current,hr(t)){if(e=t.stateNode,n=t.memoizedProps,s=null,null!==(r=sr))switch(r.tag){case 27:case 5:s=r.memoizedProps}e[De]=t,(e=!!(e.nodeValue===n||null!==s&&!0===s.suppressHydrationWarning||Yu(e.nodeValue,n)))||cr(t)}else(e=sd(e).createTextNode(s))[De]=t,t.stateNode=e}return nl(t),null;case 13:if(s=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=hr(t),null!==s&&null!==s.dehydrated){if(null===e){if(!r)throw Error(o(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(o(317));r[De]=t}else mr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),r=!1}else r=fr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(ci(t),t):(ci(t),null)}if(ci(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==s,e=null!==e&&null!==e.memoizedState,n){r=null,null!==(s=t.child).alternate&&null!==s.alternate.memoizedState&&null!==s.alternate.memoizedState.cachePool&&(r=s.alternate.memoizedState.cachePool.pool);var a=null;null!==s.memoizedState&&null!==s.memoizedState.cachePool&&(a=s.memoizedState.cachePool.pool),a!==r&&(s.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return H(),null===e&&Vu(t.stateNode.containerInfo),nl(t),null;case 10:return yr(t.type),nl(t),null;case 19:if(V(ui),null===(r=t.memoizedState))return nl(t),null;if(s=0!==(128&t.flags),null===(a=r.rendering))if(s)tl(r,!1);else{if(0!==hc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(a=di(e))){for(t.flags|=128,tl(r,!1),e=a.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)qs(n,e),n=n.sibling;return z(ui,1&ui.current|2),t.child}e=e.sibling}null!==r.tail&&te()>jc&&(t.flags|=128,s=!0,tl(r,!1),t.lanes=4194304)}else{if(!s)if(null!==(e=di(a))){if(t.flags|=128,s=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate&&!ar)return nl(t),null}else 2*te()-r.renderingStartTime>jc&&536870912!==n&&(t.flags|=128,s=!0,tl(r,!1),t.lanes=4194304);r.isBackwards?(a.sibling=t.child,t.child=a):(null!==(e=r.last)?e.sibling=a:t.child=a,r.last=a)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=te(),t.sibling=null,e=ui.current,z(ui,s?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return ci(t),xa(),s=null!==t.memoizedState,null!==e?null!==e.memoizedState!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),s=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(s=t.memoizedState.cachePool.pool),s!==n&&(t.flags|=2048),null!==e&&V(zr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),yr(Dr),nl(t),null;case 25:case 30:return null}throw Error(o(156,t.tag))}function rl(e,t){switch(nr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return yr(Dr),H(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return K(t),null;case 13:if(ci(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));mr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return V(ui),null;case 4:return H(),null;case 10:return yr(t.type),null;case 22:case 23:return ci(t),xa(),null!==e&&V(zr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return yr(Dr),null;default:return null}}function al(e,t){switch(nr(t),t.tag){case 3:yr(Dr),H();break;case 26:case 27:case 5:K(t);break;case 4:H();break;case 13:ci(t);break;case 19:V(ui);break;case 10:yr(t.type);break;case 22:case 23:ci(t),xa(),null!==e&&V(zr);break;case 24:yr(Dr)}}function ol(e,t){try{var n=t.updateQueue,s=null!==n?n.lastEffect:null;if(null!==s){var r=s.next;n=r;do{if((n.tag&e)===e){s=void 0;var a=n.create,o=n.inst;s=a(),o.destroy=s}n=n.next}while(n!==r)}}catch(i){uu(t,t.return,i)}}function il(e,t,n){try{var s=t.updateQueue,r=null!==s?s.lastEffect:null;if(null!==r){var a=r.next;s=a;do{if((s.tag&e)===e){var o=s.inst,i=o.destroy;if(void 0!==i){o.destroy=void 0,r=t;var l=n,c=i;try{c()}catch(u){uu(r,l,u)}}}s=s.next}while(s!==a)}}catch(u){uu(t,t.return,u)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{ha(t,n)}catch(s){uu(e,e.return,s)}}}function cl(e,t,n){n.props=gi(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(s){uu(e,t,s)}}function ul(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;default:s=e.stateNode}"function"===typeof n?e.refCleanup=n(s):n.current=s}}catch(r){uu(e,t,r)}}function dl(e,t){var n=e.ref,s=e.refCleanup;if(null!==n)if("function"===typeof s)try{s()}catch(r){uu(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(a){uu(e,t,a)}else n.current=null}function hl(e){var t=e.type,n=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(r){uu(e,e.return,r)}}function ml(e,t,n){try{var s=e.stateNode;!function(e,t,n,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,a=null,i=null,l=null,c=null,u=null,d=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&null!=h)switch(f){case"checked":case"value":break;case"defaultValue":c=h;default:s.hasOwnProperty(f)||Zu(e,t,f,null,s,h)}}for(var m in s){var f=s[m];if(h=n[m],s.hasOwnProperty(m)&&(null!=f||null!=h))switch(m){case"type":a=f;break;case"name":r=f;break;case"checked":u=f;break;case"defaultChecked":d=f;break;case"value":i=f;break;case"defaultValue":l=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(o(137,t));break;default:f!==h&&Zu(e,t,m,f,s,h)}}return void gt(e,i,l,c,u,d,a,r);case"select":for(a in f=i=l=m=null,n)if(c=n[a],n.hasOwnProperty(a)&&null!=c)switch(a){case"value":break;case"multiple":f=c;default:s.hasOwnProperty(a)||Zu(e,t,a,null,s,c)}for(r in s)if(a=s[r],c=n[r],s.hasOwnProperty(r)&&(null!=a||null!=c))switch(r){case"value":m=a;break;case"defaultValue":l=a;break;case"multiple":i=a;default:a!==c&&Zu(e,t,r,a,s,c)}return t=l,n=i,s=f,void(null!=m?vt(e,!!n,m,!1):!!s!==!!n&&(null!=t?vt(e,!!n,t,!0):vt(e,!!n,n?[]:"",!1)));case"textarea":for(l in f=m=null,n)if(r=n[l],n.hasOwnProperty(l)&&null!=r&&!s.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Zu(e,t,l,null,s,r)}for(i in s)if(r=s[i],a=n[i],s.hasOwnProperty(i)&&(null!=r||null!=a))switch(i){case"value":m=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(o(91));break;default:r!==a&&Zu(e,t,i,r,s,a)}return void yt(e,m,f);case"option":for(var p in n)if(m=n[p],n.hasOwnProperty(p)&&null!=m&&!s.hasOwnProperty(p))if("selected"===p)e.selected=!1;else Zu(e,t,p,null,s,m);for(c in s)if(m=s[c],f=n[c],s.hasOwnProperty(c)&&m!==f&&(null!=m||null!=f))if("selected"===c)e.selected=m&&"function"!==typeof m&&"symbol"!==typeof m;else Zu(e,t,c,m,s,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)m=n[g],n.hasOwnProperty(g)&&null!=m&&!s.hasOwnProperty(g)&&Zu(e,t,g,null,s,m);for(u in s)if(m=s[u],f=n[u],s.hasOwnProperty(u)&&m!==f&&(null!=m||null!=f))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(o(137,t));break;default:Zu(e,t,u,m,s,f)}return;default:if(_t(t)){for(var x in n)m=n[x],n.hasOwnProperty(x)&&void 0!==m&&!s.hasOwnProperty(x)&&Ju(e,t,x,void 0,s,m);for(d in s)m=s[d],f=n[d],!s.hasOwnProperty(d)||m===f||void 0===m&&void 0===f||Ju(e,t,d,m,s,f);return}}for(var b in n)m=n[b],n.hasOwnProperty(b)&&null!=m&&!s.hasOwnProperty(b)&&Zu(e,t,b,null,s,m);for(h in s)m=s[h],f=n[h],!s.hasOwnProperty(h)||m===f||null==m&&null==f||Zu(e,t,h,m,s,f)}(s,e.type,n,t),s[Re]=t}catch(r){uu(e,e.return,r)}}function fl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&md(e.type)||4===e.tag}function pl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||fl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&md(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function gl(e,t,n){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Xu));else if(4!==s&&(27===s&&md(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(gl(e,t,n),e=e.sibling;null!==e;)gl(e,t,n),e=e.sibling}function xl(e,t,n){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==s&&(27===s&&md(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(xl(e,t,n),e=e.sibling;null!==e;)xl(e,t,n),e=e.sibling}function bl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var s=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);ed(t,s,n),t[De]=e,t[Re]=n}catch(a){uu(e,e.return,a)}}var vl=!1,yl=!1,wl=!1,jl="function"===typeof WeakSet?WeakSet:Set,kl=null;function Nl(e,t,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:Fl(e,n),4&s&&ol(5,n);break;case 1:if(Fl(e,n),4&s)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(o){uu(n,n.return,o)}else{var r=gi(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(i){uu(n,n.return,i)}}64&s&&ll(n),512&s&&ul(n,n.return);break;case 3:if(Fl(e,n),64&s&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{ha(e,t)}catch(o){uu(n,n.return,o)}}break;case 27:null===t&&4&s&&bl(n);case 26:case 5:Fl(e,n),null===t&&4&s&&hl(n),512&s&&ul(n,n.return);break;case 12:Fl(e,n);break;case 13:Fl(e,n),4&s&&Ml(e,n),64&s&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var s=function(){t(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}(e,n=fu.bind(null,n))));break;case 22:if(!(s=null!==n.memoizedState||vl)){t=null!==t&&null!==t.memoizedState||yl,r=vl;var a=yl;vl=s,(yl=t)&&!a?ql(e,n,0!==(8772&n.subtreeFlags)):Fl(e,n),vl=r,yl=a}break;case 30:break;default:Fl(e,n)}}function Cl(e){var t=e.alternate;null!==t&&(e.alternate=null,Cl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ve(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var _l=null,Sl=!1;function Tl(e,t,n){for(n=n.child;null!==n;)Al(e,t,n),n=n.sibling}function Al(e,t,n){if(de&&"function"===typeof de.onCommitFiberUnmount)try{de.onCommitFiberUnmount(ue,n)}catch(a){}switch(n.tag){case 26:yl||dl(n,t),Tl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:yl||dl(n,t);var s=_l,r=Sl;md(n.type)&&(_l=n.stateNode,Sl=!1),Tl(e,t,n),wd(n.stateNode),_l=s,Sl=r;break;case 5:yl||dl(n,t);case 6:if(s=_l,r=Sl,_l=null,Tl(e,t,n),Sl=r,null!==(_l=s))if(Sl)try{(9===_l.nodeType?_l.body:"HTML"===_l.nodeName?_l.ownerDocument.body:_l).removeChild(n.stateNode)}catch(o){uu(n,t,o)}else try{_l.removeChild(n.stateNode)}catch(o){uu(n,t,o)}break;case 18:null!==_l&&(Sl?(fd(9===(e=_l).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Sh(e)):fd(_l,n.stateNode));break;case 4:s=_l,r=Sl,_l=n.stateNode.containerInfo,Sl=!0,Tl(e,t,n),_l=s,Sl=r;break;case 0:case 11:case 14:case 15:yl||il(2,n,t),yl||il(4,n,t),Tl(e,t,n);break;case 1:yl||(dl(n,t),"function"===typeof(s=n.stateNode).componentWillUnmount&&cl(n,t,s)),Tl(e,t,n);break;case 21:Tl(e,t,n);break;case 22:yl=(s=yl)||null!==n.memoizedState,Tl(e,t,n),yl=s;break;default:Tl(e,t,n)}}function Ml(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Sh(e)}catch(n){uu(t,t.return,n)}}function El(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new jl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new jl),t;default:throw Error(o(435,e.tag))}}(e);t.forEach(function(t){var s=pu.bind(null,e,t);n.has(t)||(n.add(t),t.then(s,s))})}function Dl(e,t){var n=t.deletions;if(null!==n)for(var s=0;s<n.length;s++){var r=n[s],a=e,i=t,l=i;e:for(;null!==l;){switch(l.tag){case 27:if(md(l.type)){_l=l.stateNode,Sl=!1;break e}break;case 5:_l=l.stateNode,Sl=!1;break e;case 3:case 4:_l=l.stateNode.containerInfo,Sl=!0;break e}l=l.return}if(null===_l)throw Error(o(160));Al(a,i,r),_l=null,Sl=!1,null!==(a=r.alternate)&&(a.return=null),r.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Il(t,e),t=t.sibling}var Rl=null;function Il(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Dl(t,e),Pl(e),4&s&&(il(3,e,e.return),ol(3,e),il(5,e,e.return));break;case 1:Dl(t,e),Pl(e),512&s&&(yl||null===n||dl(n,n.return)),64&s&&vl&&(null!==(e=e.updateQueue)&&(null!==(s=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?s:n.concat(s))));break;case 26:var r=Rl;if(Dl(t,e),Pl(e),512&s&&(yl||null===n||dl(n,n.return)),4&s){var a=null!==n?n.memoizedState:null;if(s=e.memoizedState,null===n)if(null===s)if(null===e.stateNode){e:{s=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(s){case"title":(!(a=r.getElementsByTagName("title")[0])||a[qe]||a[De]||"http://www.w3.org/2000/svg"===a.namespaceURI||a.hasAttribute("itemprop"))&&(a=r.createElement(s),r.head.insertBefore(a,r.querySelector("head > title"))),ed(a,s,n),a[De]=e,Ue(a),s=a;break e;case"link":var i=qd("link","href",r).get(s+(n.href||""));if(i)for(var l=0;l<i.length;l++)if((a=i[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&a.getAttribute("rel")===(null==n.rel?null:n.rel)&&a.getAttribute("title")===(null==n.title?null:n.title)&&a.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){i.splice(l,1);break t}ed(a=r.createElement(s),s,n),r.head.appendChild(a);break;case"meta":if(i=qd("meta","content",r).get(s+(n.content||"")))for(l=0;l<i.length;l++)if((a=i[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&a.getAttribute("name")===(null==n.name?null:n.name)&&a.getAttribute("property")===(null==n.property?null:n.property)&&a.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&a.getAttribute("charset")===(null==n.charSet?null:n.charSet)){i.splice(l,1);break t}ed(a=r.createElement(s),s,n),r.head.appendChild(a);break;default:throw Error(o(468,s))}a[De]=e,Ue(a),s=a}e.stateNode=s}else Vd(r,e.type,e.stateNode);else e.stateNode=Id(r,s,e.memoizedProps);else a!==s?(null===a?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):a.count--,null===s?Vd(r,e.type,e.stateNode):Id(r,s,e.memoizedProps)):null===s&&null!==e.stateNode&&ml(e,e.memoizedProps,n.memoizedProps)}break;case 27:Dl(t,e),Pl(e),512&s&&(yl||null===n||dl(n,n.return)),null!==n&&4&s&&ml(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Dl(t,e),Pl(e),512&s&&(yl||null===n||dl(n,n.return)),32&e.flags){r=e.stateNode;try{jt(r,"")}catch(f){uu(e,e.return,f)}}4&s&&null!=e.stateNode&&ml(e,r=e.memoizedProps,null!==n?n.memoizedProps:r),1024&s&&(wl=!0);break;case 6:if(Dl(t,e),Pl(e),4&s){if(null===e.stateNode)throw Error(o(162));s=e.memoizedProps,n=e.stateNode;try{n.nodeValue=s}catch(f){uu(e,e.return,f)}}break;case 3:if(Ld=null,r=Rl,Rl=Nd(t.containerInfo),Dl(t,e),Rl=r,Pl(e),4&s&&null!==n&&n.memoizedState.isDehydrated)try{Sh(t.containerInfo)}catch(f){uu(e,e.return,f)}wl&&(wl=!1,Ol(e));break;case 4:s=Rl,Rl=Nd(e.stateNode.containerInfo),Dl(t,e),Pl(e),Rl=s;break;case 12:default:Dl(t,e),Pl(e);break;case 13:Dl(t,e),Pl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(wc=te()),4&s&&(null!==(s=e.updateQueue)&&(e.updateQueue=null,El(e,s)));break;case 22:r=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=vl,d=yl;if(vl=u||r,yl=d||c,Dl(t,e),yl=d,vl=u,Pl(e),8192&s)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===n||c||vl||yl||Ll(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(a=c.stateNode,r)"function"===typeof(i=a.style).setProperty?i.setProperty("display","none","important"):i.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,m=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==m||"boolean"===typeof m?"":(""+m).trim()}}catch(f){uu(c,c.return,f)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(f){uu(c,c.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&s&&(null!==(s=e.updateQueue)&&(null!==(n=s.retryQueue)&&(s.retryQueue=null,El(e,n))));break;case 19:Dl(t,e),Pl(e),4&s&&(null!==(s=e.updateQueue)&&(e.updateQueue=null,El(e,s)));case 30:case 21:}}function Pl(e){var t=e.flags;if(2&t){try{for(var n,s=e.return;null!==s;){if(fl(s)){n=s;break}s=s.return}if(null==n)throw Error(o(160));switch(n.tag){case 27:var r=n.stateNode;xl(e,pl(e),r);break;case 5:var a=n.stateNode;32&n.flags&&(jt(a,""),n.flags&=-33),xl(e,pl(e),a);break;case 3:case 4:var i=n.stateNode.containerInfo;gl(e,pl(e),i);break;default:throw Error(o(161))}}catch(l){uu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ol(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ol(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Fl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Nl(e,t.alternate,t),t=t.sibling}function Ll(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:il(4,t,t.return),Ll(t);break;case 1:dl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&cl(t,t.return,n),Ll(t);break;case 27:wd(t.stateNode);case 26:case 5:dl(t,t.return),Ll(t);break;case 22:null===t.memoizedState&&Ll(t);break;default:Ll(t)}e=e.sibling}}function ql(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var s=t.alternate,r=e,a=t,o=a.flags;switch(a.tag){case 0:case 11:case 15:ql(r,a,n),ol(4,a);break;case 1:if(ql(r,a,n),"function"===typeof(r=(s=a).stateNode).componentDidMount)try{r.componentDidMount()}catch(c){uu(s,s.return,c)}if(null!==(r=(s=a).updateQueue)){var i=s.stateNode;try{var l=r.shared.hiddenCallbacks;if(null!==l)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)da(l[r],i)}catch(c){uu(s,s.return,c)}}n&&64&o&&ll(a),ul(a,a.return);break;case 27:bl(a);case 26:case 5:ql(r,a,n),n&&null===s&&4&o&&hl(a),ul(a,a.return);break;case 12:ql(r,a,n);break;case 13:ql(r,a,n),n&&4&o&&Ml(r,a);break;case 22:null===a.memoizedState&&ql(r,a,n),ul(a,a.return);break;case 30:break;default:ql(r,a,n)}t=t.sibling}}function Vl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ir(n))}function zl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ir(e))}function Gl(e,t,n,s){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Bl(e,t,n,s),t=t.sibling}function Bl(e,t,n,s){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Gl(e,t,n,s),2048&r&&ol(9,t);break;case 1:case 13:default:Gl(e,t,n,s);break;case 3:Gl(e,t,n,s),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ir(e)));break;case 12:if(2048&r){Gl(e,t,n,s),e=t.stateNode;try{var a=t.memoizedProps,o=a.id,i=a.onPostCommit;"function"===typeof i&&i(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){uu(t,t.return,l)}}else Gl(e,t,n,s);break;case 23:break;case 22:a=t.stateNode,o=t.alternate,null!==t.memoizedState?2&a._visibility?Gl(e,t,n,s):Ul(e,t):2&a._visibility?Gl(e,t,n,s):(a._visibility|=2,$l(e,t,n,s,0!==(10256&t.subtreeFlags))),2048&r&&Vl(o,t);break;case 24:Gl(e,t,n,s),2048&r&&zl(t.alternate,t)}}function $l(e,t,n,s,r){for(r=r&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var a=e,o=t,i=n,l=s,c=o.flags;switch(o.tag){case 0:case 11:case 15:$l(a,o,i,l,r),ol(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?2&u._visibility?$l(a,o,i,l,r):Ul(a,o):(u._visibility|=2,$l(a,o,i,l,r)),r&&2048&c&&Vl(o.alternate,o);break;case 24:$l(a,o,i,l,r),r&&2048&c&&zl(o.alternate,o);break;default:$l(a,o,i,l,r)}t=t.sibling}}function Ul(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,s=t,r=s.flags;switch(s.tag){case 22:Ul(n,s),2048&r&&Vl(s.alternate,s);break;case 24:Ul(n,s),2048&r&&zl(s.alternate,s);break;default:Ul(n,s)}t=t.sibling}}var Wl=8192;function Hl(e){if(e.subtreeFlags&Wl)for(e=e.child;null!==e;)Ql(e),e=e.sibling}function Ql(e){switch(e.tag){case 26:Hl(e),e.flags&Wl&&null!==e.memoizedState&&function(e,t,n){if(null===Gd)throw Error(o(475));var s=Gd;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var r=Ad(n.href),a=e.querySelector(Md(r));if(a)return null!==(e=a._p)&&"object"===typeof e&&"function"===typeof e.then&&(s.count++,s=$d.bind(s),e.then(s,s)),t.state.loading|=4,t.instance=a,void Ue(a);a=e.ownerDocument||e,n=Ed(n),(r=jd.get(r))&&Od(n,r),Ue(a=a.createElement("link"));var i=a;i._p=new Promise(function(e,t){i.onload=e,i.onerror=t}),ed(a,"link",n),t.instance=a}null===s.stylesheets&&(s.stylesheets=new Map),s.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(s.count++,t=$d.bind(s),e.addEventListener("load",t),e.addEventListener("error",t))}}(Rl,e.memoizedState,e.memoizedProps);break;case 5:default:Hl(e);break;case 3:case 4:var t=Rl;Rl=Nd(e.stateNode.containerInfo),Hl(e),Rl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Wl,Wl=16777216,Hl(e),Wl=t):Hl(e))}}function Kl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Yl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var s=t[n];kl=s,Jl(s,e)}Kl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Xl(e),e=e.sibling}function Xl(e){switch(e.tag){case 0:case 11:case 15:Yl(e),2048&e.flags&&il(9,e,e.return);break;case 3:case 12:default:Yl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Zl(e)):Yl(e)}}function Zl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var s=t[n];kl=s,Jl(s,e)}Kl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:il(8,t,t.return),Zl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Zl(t));break;default:Zl(t)}e=e.sibling}}function Jl(e,t){for(;null!==kl;){var n=kl;switch(n.tag){case 0:case 11:case 15:il(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var s=n.memoizedState.cachePool.pool;null!=s&&s.refCount++}break;case 24:Ir(n.memoizedState.cache)}if(null!==(s=n.child))s.return=n,kl=s;else e:for(n=e;null!==kl;){var r=(s=kl).sibling,a=s.return;if(Cl(s),s===n){kl=null;break e}if(null!==r){r.return=a,kl=r;break e}kl=a}}}var ec={getCacheForType:function(e){var t=_r(Dr),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tc="function"===typeof WeakMap?WeakMap:Map,nc=0,sc=null,rc=null,ac=0,oc=0,ic=null,lc=!1,cc=!1,uc=!1,dc=0,hc=0,mc=0,fc=0,pc=0,gc=0,xc=0,bc=null,vc=null,yc=!1,wc=0,jc=1/0,kc=null,Nc=null,Cc=0,_c=null,Sc=null,Tc=0,Ac=0,Mc=null,Ec=null,Dc=0,Rc=null;function Ic(){if(0!==(2&nc)&&0!==ac)return ac&-ac;if(null!==I.T){return 0!==Fr?Fr:Au()}return Me()}function Pc(){0===gc&&(gc=0===(536870912&ac)||ar?je():536870912);var e=ri.current;return null!==e&&(e.flags|=32),gc}function Oc(e,t,n){(e!==sc||2!==oc&&9!==oc)&&null===e.cancelPendingCommit||(Bc(e,0),Vc(e,ac,gc,!1)),Ce(e,n),0!==(2&nc)&&e===sc||(e===sc&&(0===(2&nc)&&(fc|=n),4===hc&&Vc(e,ac,gc,!1)),ju(e))}function Fc(e,t,n){if(0!==(6&nc))throw Error(o(327));for(var s=!n&&0===(124&t)&&0===(t&e.expiredLanes)||ye(e,t),r=s?function(e,t){var n=nc;nc|=2;var s=Uc(),r=Wc();sc!==e||ac!==t?(kc=null,jc=te()+500,Bc(e,t)):cc=ye(e,t);e:for(;;)try{if(0!==oc&&null!==rc){t=rc;var a=ic;t:switch(oc){case 1:oc=0,ic=null,Jc(e,t,a,1);break;case 2:case 9:if(Kr(a)){oc=0,ic=null,Zc(t);break}t=function(){2!==oc&&9!==oc||sc!==e||(oc=7),ju(e)},a.then(t,t);break e;case 3:oc=7;break e;case 4:oc=5;break e;case 7:Kr(a)?(oc=0,ic=null,Zc(t)):(oc=0,ic=null,Jc(e,t,a,7));break;case 5:var i=null;switch(rc.tag){case 26:i=rc.memoizedState;case 5:case 27:var l=rc;if(!i||zd(i)){oc=0,ic=null;var c=l.sibling;if(null!==c)rc=c;else{var u=l.return;null!==u?(rc=u,eu(u)):rc=null}break t}}oc=0,ic=null,Jc(e,t,a,5);break;case 6:oc=0,ic=null,Jc(e,t,a,6);break;case 8:Gc(),hc=6;break e;default:throw Error(o(462))}}Yc();break}catch(d){$c(e,d)}return br=xr=null,I.H=s,I.A=r,nc=n,null!==rc?0:(sc=null,ac=0,Ts(),hc)}(e,t):Qc(e,t,!0),a=s;;){if(0===r){cc&&!s&&Vc(e,t,0,!1);break}if(n=e.current.alternate,!a||qc(n)){if(2===r){if(a=t,e.errorRecoveryDisabledLanes&a)var i=0;else i=0!==(i=-536870913&e.pendingLanes)?i:536870912&i?536870912:0;if(0!==i){t=i;e:{var l=e;r=bc;var c=l.current.memoizedState.isDehydrated;if(c&&(Bc(l,i).flags|=256),2!==(i=Qc(l,i,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=a,fc|=a,r=4;break e}a=vc,vc=r,null!==a&&(null===vc?vc=a:vc.push.apply(vc,a))}r=i}if(a=!1,2!==r)continue}}if(1===r){Bc(e,0),Vc(e,t,0,!0);break}e:{switch(s=e,a=r){case 0:case 1:throw Error(o(345));case 4:if((4194048&t)!==t)break;case 6:Vc(s,t,gc,!lc);break e;case 2:vc=null;break;case 3:case 5:break;default:throw Error(o(329))}if((62914560&t)===t&&10<(r=wc+300-te())){if(Vc(s,t,gc,!lc),0!==ve(s,0,!0))break e;s.timeoutHandle=ld(Lc.bind(null,s,n,vc,kc,yc,t,gc,fc,xc,lc,a,2,-0,0),r)}else Lc(s,n,vc,kc,yc,t,gc,fc,xc,lc,a,0,-0,0)}break}r=Qc(e,t,!1),a=!1}ju(e)}function Lc(e,t,n,s,r,a,i,l,c,u,d,h,m,f){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(Gd={stylesheets:null,count:0,unsuspend:Bd},Ql(t),null!==(h=function(){if(null===Gd)throw Error(o(475));var e=Gd;return e.stylesheets&&0===e.count&&Wd(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Wd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=h(nu.bind(null,e,t,a,n,s,r,i,l,c,d,1,m,f)),void Vc(e,a,i,!u);nu(e,t,a,n,s,r,i,l,c)}function qc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var s=0;s<n.length;s++){var r=n[s],a=r.getSnapshot;r=r.value;try{if(!Kn(a(),r))return!1}catch(o){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Vc(e,t,n,s){t&=~pc,t&=~fc,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var r=t;0<r;){var a=31-me(r),o=1<<a;s[a]=-1,r&=~o}0!==n&&_e(e,n,t)}function zc(){return 0!==(6&nc)||(ku(0,!1),!1)}function Gc(){if(null!==rc){if(0===oc)var e=rc.return;else br=xr=null,Fa(e=rc),Ko=null,Yo=0,e=rc;for(;null!==e;)al(e.alternate,e),e=e.return;rc=null}}function Bc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,cd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Gc(),sc=e,rc=n=Ls(e.current,null),ac=t,oc=0,ic=null,lc=!1,cc=ye(e,t),uc=!1,xc=gc=pc=fc=mc=hc=0,vc=bc=null,yc=!1,0!==(8&t)&&(t|=32&t);var s=e.entangledLanes;if(0!==s)for(e=e.entanglements,s&=t;0<s;){var r=31-me(s),a=1<<r;t|=e[r],s&=~a}return dc=t,Ts(),n}function $c(e,t){va=null,I.H=Uo,t===Ur||t===Hr?(t=Jr(),oc=3):t===Wr?(t=Jr(),oc=4):oc=t===_i?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,ic=t,null===rc&&(hc=1,wi(e,Ns(t,e.current)))}function Uc(){var e=I.H;return I.H=Uo,null===e?Uo:e}function Wc(){var e=I.A;return I.A=ec,e}function Hc(){hc=4,lc||(4194048&ac)!==ac&&null!==ri.current||(cc=!0),0===(134217727&mc)&&0===(134217727&fc)||null===sc||Vc(sc,ac,gc,!1)}function Qc(e,t,n){var s=nc;nc|=2;var r=Uc(),a=Wc();sc===e&&ac===t||(kc=null,Bc(e,t)),t=!1;var o=hc;e:for(;;)try{if(0!==oc&&null!==rc){var i=rc,l=ic;switch(oc){case 8:Gc(),o=6;break e;case 3:case 2:case 9:case 6:null===ri.current&&(t=!0);var c=oc;if(oc=0,ic=null,Jc(e,i,l,c),n&&cc){o=0;break e}break;default:c=oc,oc=0,ic=null,Jc(e,i,l,c)}}Kc(),o=hc;break}catch(u){$c(e,u)}return t&&e.shellSuspendCounter++,br=xr=null,nc=s,I.H=r,I.A=a,null===rc&&(sc=null,ac=0,Ts()),o}function Kc(){for(;null!==rc;)Xc(rc)}function Yc(){for(;null!==rc&&!J();)Xc(rc)}function Xc(e){var t=Xi(e.alternate,e,dc);e.memoizedProps=e.pendingProps,null===t?eu(e):rc=t}function Zc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Oi(n,t,t.pendingProps,t.type,void 0,ac);break;case 11:t=Oi(n,t,t.pendingProps,t.type.render,t.ref,ac);break;case 5:Fa(t);default:al(n,t),t=Xi(n,t=rc=qs(t,dc),dc)}e.memoizedProps=e.pendingProps,null===t?eu(e):rc=t}function Jc(e,t,n,s){br=xr=null,Fa(t),Ko=null,Yo=0;var r=t.return;try{if(function(e,t,n,s,r){if(n.flags|=32768,null!==s&&"object"===typeof s&&"function"===typeof s.then){if(null!==(t=n.alternate)&&kr(t,n,r,!0),null!==(n=ri.current)){switch(n.tag){case 13:return null===ai?Hc():null===n.alternate&&0===hc&&(hc=3),n.flags&=-257,n.flags|=65536,n.lanes=r,s===Qr?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([s]):t.add(s),du(e,s,r)),!1;case 22:return n.flags|=65536,s===Qr?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([s]):n.add(s),du(e,s,r)),!1}throw Error(o(435,n.tag))}return du(e,s,r),Hc(),!1}if(ar)return null!==(t=ri.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,s!==lr&&pr(Ns(e=Error(o(422),{cause:s}),n))):(s!==lr&&pr(Ns(t=Error(o(423),{cause:s}),n)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,s=Ns(s,n),ia(e,r=ki(e.stateNode,s,r)),4!==hc&&(hc=2)),!1;var a=Error(o(520),{cause:s});if(a=Ns(a,n),null===bc?bc=[a]:bc.push(a),4!==hc&&(hc=2),null===t)return!0;s=Ns(s,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,ia(n,e=ki(n.stateNode,s,e)),!1;case 1:if(t=n.type,a=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==a&&"function"===typeof a.componentDidCatch&&(null===Nc||!Nc.has(a))))return n.flags|=65536,r&=-r,n.lanes|=r,Ci(r=Ni(r),e,n,s),ia(n,r),!1}n=n.return}while(null!==n);return!1}(e,r,t,n,ac))return hc=1,wi(e,Ns(n,e.current)),void(rc=null)}catch(a){if(null!==r)throw rc=r,a;return hc=1,wi(e,Ns(n,e.current)),void(rc=null)}32768&t.flags?(ar||1===s?e=!0:cc||0!==(536870912&ac)?e=!1:(lc=e=!0,(2===s||9===s||3===s||6===s)&&(null!==(s=ri.current)&&13===s.tag&&(s.flags|=16384))),tu(t,e)):eu(t)}function eu(e){var t=e;do{if(0!==(32768&t.flags))return void tu(t,lc);e=t.return;var n=sl(t.alternate,t,dc);if(null!==n)return void(rc=n);if(null!==(t=t.sibling))return void(rc=t);rc=t=e}while(null!==t);0===hc&&(hc=5)}function tu(e,t){do{var n=rl(e.alternate,e);if(null!==n)return n.flags&=32767,void(rc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(rc=e);rc=e=n}while(null!==e);hc=6,rc=null}function nu(e,t,n,s,r,a,i,l,c){e.cancelPendingCommit=null;do{iu()}while(0!==Cc);if(0!==(6&nc))throw Error(o(327));if(null!==t){if(t===e.current)throw Error(o(177));if(a=t.lanes|t.childLanes,function(e,t,n,s,r,a){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var i=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-me(n),d=1<<u;i[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var m=h[u];null!==m&&(m.lane&=-536870913)}n&=~d}0!==s&&_e(e,s,0),0!==a&&0===r&&0!==e.tag&&(e.suspendedLanes|=a&~(o&~t))}(e,n,a|=Ss,i,l,c),e===sc&&(rc=sc=null,ac=0),Sc=t,_c=e,Tc=n,Ac=a,Mc=r,Ec=s,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,X(ae,function(){return lu(),null})):(e.callbackNode=null,e.callbackPriority=0),s=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||s){s=I.T,I.T=null,r=P.p,P.p=2,i=nc,nc|=4;try{!function(e,t){if(e=e.containerInfo,td=nh,ts(e=es(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var s=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(s&&0!==s.rangeCount){n=s.anchorNode;var r=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{n.nodeType,a.nodeType}catch(g){n=null;break e}var i=0,l=-1,c=-1,u=0,d=0,h=e,m=null;t:for(;;){for(var f;h!==n||0!==r&&3!==h.nodeType||(l=i+r),h!==a||0!==s&&3!==h.nodeType||(c=i+s),3===h.nodeType&&(i+=h.nodeValue.length),null!==(f=h.firstChild);)m=h,h=f;for(;;){if(h===e)break t;if(m===n&&++u===r&&(l=i),m===a&&++d===s&&(c=i),null!==(f=h.nextSibling))break;m=(h=m).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nd={focusedElem:e,selectionRange:n},nh=!1,kl=t;null!==kl;)if(e=(t=kl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,kl=e;else for(;null!==kl;){switch(a=(t=kl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==a){e=void 0,n=t,r=a.memoizedProps,a=a.memoizedState,s=n.stateNode;try{var p=gi(n.type,r,(n.elementType,n.type));e=s.getSnapshotBeforeUpdate(p,a),s.__reactInternalSnapshotBeforeUpdate=e}catch(x){uu(n,n.return,x)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))pd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":pd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,kl=e;break}kl=t.return}}(e,t)}finally{nc=i,P.p=r,I.T=s}}Cc=1,su(),ru(),au()}}function su(){if(1===Cc){Cc=0;var e=_c,t=Sc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=I.T,I.T=null;var s=P.p;P.p=2;var r=nc;nc|=4;try{Il(t,e);var a=nd,o=es(e.containerInfo),i=a.focusedElem,l=a.selectionRange;if(o!==i&&i&&i.ownerDocument&&Jn(i.ownerDocument.documentElement,i)){if(null!==l&&ts(i)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in i)i.selectionStart=c,i.selectionEnd=Math.min(u,i.value.length);else{var d=i.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var m=h.getSelection(),f=i.textContent.length,p=Math.min(l.start,f),g=void 0===l.end?p:Math.min(l.end,f);!m.extend&&p>g&&(o=g,g=p,p=o);var x=Zn(i,p),b=Zn(i,g);if(x&&b&&(1!==m.rangeCount||m.anchorNode!==x.node||m.anchorOffset!==x.offset||m.focusNode!==b.node||m.focusOffset!==b.offset)){var v=d.createRange();v.setStart(x.node,x.offset),m.removeAllRanges(),p>g?(m.addRange(v),m.extend(b.node,b.offset)):(v.setEnd(b.node,b.offset),m.addRange(v))}}}}for(d=[],m=i;m=m.parentNode;)1===m.nodeType&&d.push({element:m,left:m.scrollLeft,top:m.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<d.length;i++){var y=d[i];y.element.scrollLeft=y.left,y.element.scrollTop=y.top}}nh=!!td,nd=td=null}finally{nc=r,P.p=s,I.T=n}}e.current=t,Cc=2}}function ru(){if(2===Cc){Cc=0;var e=_c,t=Sc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=I.T,I.T=null;var s=P.p;P.p=2;var r=nc;nc|=4;try{Nl(e,t.alternate,t)}finally{nc=r,P.p=s,I.T=n}}Cc=3}}function au(){if(4===Cc||3===Cc){Cc=0,ee();var e=_c,t=Sc,n=Tc,s=Ec;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Cc=5:(Cc=0,Sc=_c=null,ou(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(Nc=null),Ae(n),t=t.stateNode,de&&"function"===typeof de.onCommitFiberRoot)try{de.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==s){t=I.T,r=P.p,P.p=2,I.T=null;try{for(var a=e.onRecoverableError,o=0;o<s.length;o++){var i=s[o];a(i.value,{componentStack:i.stack})}}finally{I.T=t,P.p=r}}0!==(3&Tc)&&iu(),ju(e),r=e.pendingLanes,0!==(4194090&n)&&0!==(42&r)?e===Rc?Dc++:(Dc=0,Rc=e):Dc=0,ku(0,!1)}}function ou(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ir(t)))}function iu(e){return su(),ru(),au(),lu()}function lu(){if(5!==Cc)return!1;var e=_c,t=Ac;Ac=0;var n=Ae(Tc),s=I.T,r=P.p;try{P.p=32>n?32:n,I.T=null,n=Mc,Mc=null;var a=_c,i=Tc;if(Cc=0,Sc=_c=null,Tc=0,0!==(6&nc))throw Error(o(331));var l=nc;if(nc|=4,Xl(a.current),Bl(a,a.current,i,n),nc=l,ku(0,!1),de&&"function"===typeof de.onPostCommitFiberRoot)try{de.onPostCommitFiberRoot(ue,a)}catch(c){}return!0}finally{P.p=r,I.T=s,ou(e,t)}}function cu(e,t,n){t=Ns(n,t),null!==(e=aa(e,t=ki(e.stateNode,t,2),2))&&(Ce(e,2),ju(e))}function uu(e,t,n){if(3===e.tag)cu(e,e,n);else for(;null!==t;){if(3===t.tag){cu(t,e,n);break}if(1===t.tag){var s=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof s.componentDidCatch&&(null===Nc||!Nc.has(s))){e=Ns(n,e),null!==(s=aa(t,n=Ni(2),2))&&(Ci(n,s,t,e),Ce(s,2),ju(s));break}}t=t.return}}function du(e,t,n){var s=e.pingCache;if(null===s){s=e.pingCache=new tc;var r=new Set;s.set(t,r)}else void 0===(r=s.get(t))&&(r=new Set,s.set(t,r));r.has(n)||(uc=!0,r.add(n),e=hu.bind(null,e,t,n),t.then(e,e))}function hu(e,t,n){var s=e.pingCache;null!==s&&s.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,sc===e&&(ac&n)===n&&(4===hc||3===hc&&(62914560&ac)===ac&&300>te()-wc?0===(2&nc)&&Bc(e,0):pc|=n,xc===ac&&(xc=0)),ju(e)}function mu(e,t){0===t&&(t=ke()),null!==(e=Es(e,t))&&(Ce(e,t),ju(e))}function fu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),mu(e,n)}function pu(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==s&&s.delete(t),mu(e,n)}var gu=null,xu=null,bu=!1,vu=!1,yu=!1,wu=0;function ju(e){e!==xu&&null===e.next&&(null===xu?gu=xu=e:xu=xu.next=e),vu=!0,bu||(bu=!0,dd(function(){0!==(6&nc)?X(se,Nu):Cu()}))}function ku(e,t){if(!yu&&vu){yu=!0;do{for(var n=!1,s=gu;null!==s;){if(!t)if(0!==e){var r=s.pendingLanes;if(0===r)var a=0;else{var o=s.suspendedLanes,i=s.pingedLanes;a=(1<<31-me(42|e)+1)-1,a=201326741&(a&=r&~(o&~i))?201326741&a|1:a?2|a:0}0!==a&&(n=!0,Tu(s,a))}else a=ac,0===(3&(a=ve(s,s===sc?a:0,null!==s.cancelPendingCommit||-1!==s.timeoutHandle)))||ye(s,a)||(n=!0,Tu(s,a));s=s.next}}while(n);yu=!1}}function Nu(){Cu()}function Cu(){vu=bu=!1;var e=0;0!==wu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==id&&(id=e,!0);return id=null,!1}()&&(e=wu),wu=0);for(var t=te(),n=null,s=gu;null!==s;){var r=s.next,a=_u(s,t);0===a?(s.next=null,null===n?gu=r:n.next=r,null===r&&(xu=n)):(n=s,(0!==e||0!==(3&a))&&(vu=!0)),s=r}ku(e,!1)}function _u(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,r=e.expirationTimes,a=-62914561&e.pendingLanes;0<a;){var o=31-me(a),i=1<<o,l=r[o];-1===l?0!==(i&n)&&0===(i&s)||(r[o]=we(i,t)):l<=t&&(e.expiredLanes|=i),a&=~i}if(n=ac,n=ve(e,e===(t=sc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),s=e.callbackNode,0===n||e===t&&(2===oc||9===oc)||null!==e.cancelPendingCommit)return null!==s&&null!==s&&Z(s),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||ye(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==s&&Z(s),Ae(n)){case 2:case 8:n=re;break;case 32:default:n=ae;break;case 268435456:n=ie}return s=Su.bind(null,e),n=X(n,s),e.callbackPriority=t,e.callbackNode=n,t}return null!==s&&null!==s&&Z(s),e.callbackPriority=2,e.callbackNode=null,2}function Su(e,t){if(0!==Cc&&5!==Cc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(iu()&&e.callbackNode!==n)return null;var s=ac;return 0===(s=ve(e,e===sc?s:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Fc(e,s,t),_u(e,te()),null!=e.callbackNode&&e.callbackNode===n?Su.bind(null,e):null)}function Tu(e,t){if(iu())return null;Fc(e,t,!0)}function Au(){return 0===wu&&(wu=je()),wu}function Mu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:At(""+e)}function Eu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Du=0;Du<ws.length;Du++){var Ru=ws[Du];js(Ru.toLowerCase(),"on"+(Ru[0].toUpperCase()+Ru.slice(1)))}js(ms,"onAnimationEnd"),js(fs,"onAnimationIteration"),js(ps,"onAnimationStart"),js("dblclick","onDoubleClick"),js("focusin","onFocus"),js("focusout","onBlur"),js(gs,"onTransitionRun"),js(xs,"onTransitionStart"),js(bs,"onTransitionCancel"),js(vs,"onTransitionEnd"),Ke("onMouseEnter",["mouseout","mouseover"]),Ke("onMouseLeave",["mouseout","mouseover"]),Ke("onPointerEnter",["pointerout","pointerover"]),Ke("onPointerLeave",["pointerout","pointerover"]),Qe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Iu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Iu));function Ou(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var s=e[n],r=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var o=s.length-1;0<=o;o--){var i=s[o],l=i.instance,c=i.currentTarget;if(i=i.listener,l!==a&&r.isPropagationStopped())break e;a=i,r.currentTarget=c;try{a(r)}catch(u){xi(u)}r.currentTarget=null,a=l}else for(o=0;o<s.length;o++){if(l=(i=s[o]).instance,c=i.currentTarget,i=i.listener,l!==a&&r.isPropagationStopped())break e;a=i,r.currentTarget=c;try{a(r)}catch(u){xi(u)}r.currentTarget=null,a=l}}}}function Fu(e,t){var n=t[Pe];void 0===n&&(n=t[Pe]=new Set);var s=e+"__bubble";n.has(s)||(zu(t,e,2,!1),n.add(s))}function Lu(e,t,n){var s=0;t&&(s|=4),zu(n,e,s,t)}var qu="_reactListening"+Math.random().toString(36).slice(2);function Vu(e){if(!e[qu]){e[qu]=!0,We.forEach(function(t){"selectionchange"!==t&&(Pu.has(t)||Lu(t,!1,e),Lu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[qu]||(t[qu]=!0,Lu("selectionchange",!1,t))}}function zu(e,t,n,s){switch(ch(t)){case 2:var r=sh;break;case 8:r=rh;break;default:r=ah}n=r.bind(null,t,n,e),r=void 0,!qt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),s?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Gu(e,t,n,s,r){var a=s;if(0===(1&t)&&0===(2&t)&&null!==s)e:for(;;){if(null===s)return;var o=s.tag;if(3===o||4===o){var i=s.stateNode.containerInfo;if(i===r)break;if(4===o)for(o=s.return;null!==o;){var c=o.tag;if((3===c||4===c)&&o.stateNode.containerInfo===r)return;o=o.return}for(;null!==i;){if(null===(o=ze(i)))return;if(5===(c=o.tag)||6===c||26===c||27===c){s=a=o;continue e}i=i.parentNode}}s=s.return}Ot(function(){var s=a,r=Et(n),o=[];e:{var i=ys.get(e);if(void 0!==i){var c=Jt,u=e;switch(e){case"keypress":if(0===Ut(n))break e;case"keydown":case"keyup":c=pn;break;case"focusin":u="focus",c=an;break;case"focusout":u="blur",c=an;break;case"beforeblur":case"afterblur":c=an;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=rn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=xn;break;case ms:case fs:case ps:c=on;break;case vs:c=bn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=vn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=gn;break;case"toggle":case"beforetoggle":c=yn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),m=d?null!==i?i+"Capture":null:i;d=[];for(var f,p=s;null!==p;){var g=p;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===m||null!=(g=Ft(p,m))&&d.push(Bu(p,g,f)),h)break;p=p.return}0<d.length&&(i=new c(i,u,null,n,r),o.push({event:i,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||n===Mt||!(u=n.relatedTarget||n.fromElement)||!ze(u)&&!u[Ie])&&(c||i)&&(i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window,c?(c=s,null!==(u=(u=n.relatedTarget||n.toElement)?ze(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=s),c!==u)){if(d=sn,g="onMouseLeave",m="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(d=gn,g="onPointerLeave",m="onPointerEnter",p="pointer"),h=null==c?i:Be(c),f=null==u?i:Be(u),(i=new d(g,p+"leave",c,n,r)).target=h,i.relatedTarget=f,g=null,ze(r)===s&&((d=new d(m,p+"enter",u,n,r)).target=f,d.relatedTarget=h,g=d),h=g,c&&u)e:{for(m=u,p=0,f=d=c;f;f=Uu(f))p++;for(f=0,g=m;g;g=Uu(g))f++;for(;0<p-f;)d=Uu(d),p--;for(;0<f-p;)m=Uu(m),f--;for(;p--;){if(d===m||null!==m&&d===m.alternate)break e;d=Uu(d),m=Uu(m)}d=null}else d=null;null!==c&&Wu(o,i,c,d,!1),null!==u&&null!==h&&Wu(o,h,u,d,!0)}if("select"===(c=(i=s?Be(s):window).nodeName&&i.nodeName.toLowerCase())||"input"===c&&"file"===i.type)var x=Ln;else if(Dn(i))if(qn)x=Qn;else{x=Wn;var b=Un}else!(c=i.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==i.type&&"radio"!==i.type?s&&_t(s.elementType)&&(x=Ln):x=Hn;switch(x&&(x=x(e,s))?Rn(o,x,n,r):(b&&b(e,i,s),"focusout"===e&&s&&"number"===i.type&&null!=s.memoizedProps.value&&bt(i,"number",i.value)),b=s?Be(s):window,e){case"focusin":(Dn(b)||"true"===b.contentEditable)&&(ss=b,rs=s,as=null);break;case"focusout":as=rs=ss=null;break;case"mousedown":os=!0;break;case"contextmenu":case"mouseup":case"dragend":os=!1,is(o,n,r);break;case"selectionchange":if(ns)break;case"keydown":case"keyup":is(o,n,r)}var v;if(jn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Mn?Tn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Cn&&"ko"!==n.locale&&(Mn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Mn&&(v=$t()):(Gt="value"in(zt=r)?zt.value:zt.textContent,Mn=!0)),0<(b=$u(s,y)).length&&(y=new cn(y,e,null,n,r),o.push({event:y,listeners:b}),v?y.data=v:null!==(v=An(n))&&(y.data=v))),(v=Nn?function(e,t){switch(e){case"compositionend":return An(t);case"keypress":return 32!==t.which?null:(Sn=!0,_n);case"textInput":return(e=t.data)===_n&&Sn?null:e;default:return null}}(e,n):function(e,t){if(Mn)return"compositionend"===e||!jn&&Tn(e,t)?(e=$t(),Bt=Gt=zt=null,Mn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(y=$u(s,"onBeforeInput")).length&&(b=new cn("onBeforeInput","beforeinput",null,n,r),o.push({event:b,listeners:y}),b.data=v)),function(e,t,n,s,r){if("submit"===t&&n&&n.stateNode===r){var a=Mu((r[Re]||null).action),o=s.submitter;o&&null!==(t=(t=o[Re]||null)?Mu(t.formAction):o.getAttribute("formAction"))&&(a=t,o=null);var i=new Jt("action","action",null,s,r);e.push({event:i,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(0!==wu){var e=o?Eu(r,o):new FormData(r);Eo(n,{pending:!0,data:e,method:r.method,action:a},null,e)}}else"function"===typeof a&&(i.preventDefault(),e=o?Eu(r,o):new FormData(r),Eo(n,{pending:!0,data:e,method:r.method,action:a},a,e))},currentTarget:r}]})}}(o,e,s,n,r)}Ou(o,t)})}function Bu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function $u(e,t){for(var n=t+"Capture",s=[];null!==e;){var r=e,a=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===a||(null!=(r=Ft(e,n))&&s.unshift(Bu(e,r,a)),null!=(r=Ft(e,t))&&s.push(Bu(e,r,a))),3===e.tag)return s;e=e.return}return[]}function Uu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Wu(e,t,n,s,r){for(var a=t._reactName,o=[];null!==n&&n!==s;){var i=n,l=i.alternate,c=i.stateNode;if(i=i.tag,null!==l&&l===s)break;5!==i&&26!==i&&27!==i||null===c||(l=c,r?null!=(c=Ft(n,a))&&o.unshift(Bu(n,c,l)):r||null!=(c=Ft(n,a))&&o.push(Bu(n,c,l))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Hu=/\r\n?/g,Qu=/\u0000|\uFFFD/g;function Ku(e){return("string"===typeof e?e:""+e).replace(Hu,"\n").replace(Qu,"")}function Yu(e,t){return t=Ku(t),Ku(e)===t}function Xu(){}function Zu(e,t,n,s,r,a){switch(n){case"children":"string"===typeof s?"body"===t||"textarea"===t&&""===s||jt(e,s):("number"===typeof s||"bigint"===typeof s)&&"body"!==t&&jt(e,""+s);break;case"className":nt(e,"class",s);break;case"tabIndex":nt(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,s);break;case"style":Ct(e,s,a);break;case"data":if("object"!==t){nt(e,"data",s);break}case"src":case"href":if(""===s&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==s||"function"===typeof s||"symbol"===typeof s||"boolean"===typeof s){e.removeAttribute(n);break}s=At(""+s),e.setAttribute(n,s);break;case"action":case"formAction":if("function"===typeof s){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof a&&("formAction"===n?("input"!==t&&Zu(e,t,"name",r.name,r,null),Zu(e,t,"formEncType",r.formEncType,r,null),Zu(e,t,"formMethod",r.formMethod,r,null),Zu(e,t,"formTarget",r.formTarget,r,null)):(Zu(e,t,"encType",r.encType,r,null),Zu(e,t,"method",r.method,r,null),Zu(e,t,"target",r.target,r,null))),null==s||"symbol"===typeof s||"boolean"===typeof s){e.removeAttribute(n);break}s=At(""+s),e.setAttribute(n,s);break;case"onClick":null!=s&&(e.onclick=Xu);break;case"onScroll":null!=s&&Fu("scroll",e);break;case"onScrollEnd":null!=s&&Fu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=s){if("object"!==typeof s||!("__html"in s))throw Error(o(61));if(null!=(n=s.__html)){if(null!=r.children)throw Error(o(60));e.innerHTML=n}}break;case"multiple":e.multiple=s&&"function"!==typeof s&&"symbol"!==typeof s;break;case"muted":e.muted=s&&"function"!==typeof s&&"symbol"!==typeof s;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==s||"function"===typeof s||"boolean"===typeof s||"symbol"===typeof s){e.removeAttribute("xlink:href");break}n=At(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=s&&"function"!==typeof s&&"symbol"!==typeof s?e.setAttribute(n,""+s):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&"function"!==typeof s&&"symbol"!==typeof s?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===s?e.setAttribute(n,""):!1!==s&&null!=s&&"function"!==typeof s&&"symbol"!==typeof s?e.setAttribute(n,s):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&!isNaN(s)&&1<=s?e.setAttribute(n,s):e.removeAttribute(n);break;case"rowSpan":case"start":null==s||"function"===typeof s||"symbol"===typeof s||isNaN(s)?e.removeAttribute(n):e.setAttribute(n,s);break;case"popover":Fu("beforetoggle",e),Fu("toggle",e),tt(e,"popover",s);break;case"xlinkActuate":st(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":st(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":st(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":st(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":st(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":st(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":st(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":st(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":st(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":tt(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=St.get(n)||n,s)}}function Ju(e,t,n,s,r,a){switch(n){case"style":Ct(e,s,a);break;case"dangerouslySetInnerHTML":if(null!=s){if("object"!==typeof s||!("__html"in s))throw Error(o(61));if(null!=(n=s.__html)){if(null!=r.children)throw Error(o(60));e.innerHTML=n}}break;case"children":"string"===typeof s?jt(e,s):("number"===typeof s||"bigint"===typeof s)&&jt(e,""+s);break;case"onScroll":null!=s&&Fu("scroll",e);break;case"onScrollEnd":null!=s&&Fu("scrollend",e);break;case"onClick":null!=s&&(e.onclick=Xu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:He.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),"function"===typeof(a=null!=(a=e[Re]||null)?a[n]:null)&&e.removeEventListener(t,a,r),"function"!==typeof s)?n in e?e[n]=s:!0===s?e.setAttribute(n,""):tt(e,n,s):("function"!==typeof a&&null!==a&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,s,r)))}}function ed(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fu("error",e),Fu("load",e);var s,r=!1,a=!1;for(s in n)if(n.hasOwnProperty(s)){var i=n[s];if(null!=i)switch(s){case"src":r=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Zu(e,t,s,i,n,null)}}return a&&Zu(e,t,"srcSet",n.srcSet,n,null),void(r&&Zu(e,t,"src",n.src,n,null));case"input":Fu("invalid",e);var l=s=i=a=null,c=null,u=null;for(r in n)if(n.hasOwnProperty(r)){var d=n[r];if(null!=d)switch(r){case"name":a=d;break;case"type":i=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":s=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(o(137,t));break;default:Zu(e,t,r,d,n,null)}}return xt(e,s,l,c,u,i,a,!1),void dt(e);case"select":for(a in Fu("invalid",e),r=i=s=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":s=l;break;case"defaultValue":i=l;break;case"multiple":r=l;default:Zu(e,t,a,l,n,null)}return t=s,n=i,e.multiple=!!r,void(null!=t?vt(e,!!r,t,!1):null!=n&&vt(e,!!r,n,!0));case"textarea":for(i in Fu("invalid",e),s=a=r=null,n)if(n.hasOwnProperty(i)&&null!=(l=n[i]))switch(i){case"value":r=l;break;case"defaultValue":a=l;break;case"children":s=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(o(91));break;default:Zu(e,t,i,l,n,null)}return wt(e,r,a,s),void dt(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(r=n[c]))if("selected"===c)e.selected=r&&"function"!==typeof r&&"symbol"!==typeof r;else Zu(e,t,c,r,n,null);return;case"dialog":Fu("beforetoggle",e),Fu("toggle",e),Fu("cancel",e),Fu("close",e);break;case"iframe":case"object":Fu("load",e);break;case"video":case"audio":for(r=0;r<Iu.length;r++)Fu(Iu[r],e);break;case"image":Fu("error",e),Fu("load",e);break;case"details":Fu("toggle",e);break;case"embed":case"source":case"link":Fu("error",e),Fu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(r=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Zu(e,t,u,r,n,null)}return;default:if(_t(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(r=n[d])&&Ju(e,t,d,r,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(r=n[l])&&Zu(e,t,l,r,n,null))}var td=null,nd=null;function sd(e){return 9===e.nodeType?e:e.ownerDocument}function rd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ad(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function od(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var id=null;var ld="function"===typeof setTimeout?setTimeout:void 0,cd="function"===typeof clearTimeout?clearTimeout:void 0,ud="function"===typeof Promise?Promise:void 0,dd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ud?function(e){return ud.resolve(null).then(e).catch(hd)}:ld;function hd(e){setTimeout(function(){throw e})}function md(e){return"head"===e}function fd(e,t){var n=t,s=0,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0<s&&8>s){n=s;var o=e.ownerDocument;if(1&n&&wd(o.documentElement),2&n&&wd(o.body),4&n)for(wd(n=o.head),o=n.firstChild;o;){var i=o.nextSibling,l=o.nodeName;o[qe]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=i}}if(0===r)return e.removeChild(a),void Sh(t);r--}else"$"===n||"$?"===n||"$!"===n?r++:s=n.charCodeAt(0)-48;else s=0;n=a}while(n);Sh(t)}function pd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":pd(n),Ve(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function gd(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function xd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var bd=null;function vd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function yd(e,t,n){switch(t=sd(n),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}function wd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ve(e)}var jd=new Map,kd=new Set;function Nd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Cd=P.d;P.d={f:function(){var e=Cd.f(),t=zc();return e||t},r:function(e){var t=Ge(e);null!==t&&5===t.tag&&"form"===t.type?Ro(t):Cd.r(e)},D:function(e){Cd.D(e),Sd("dns-prefetch",e,null)},C:function(e,t){Cd.C(e,t),Sd("preconnect",e,t)},L:function(e,t,n){Cd.L(e,t,n);var s=_d;if(s&&e&&t){var r='link[rel="preload"][as="'+pt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(r+='[imagesrcset="'+pt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(r+='[imagesizes="'+pt(n.imageSizes)+'"]')):r+='[href="'+pt(e)+'"]';var a=r;switch(t){case"style":a=Ad(e);break;case"script":a=Dd(e)}jd.has(a)||(e=h({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),jd.set(a,e),null!==s.querySelector(r)||"style"===t&&s.querySelector(Md(a))||"script"===t&&s.querySelector(Rd(a))||(ed(t=s.createElement("link"),"link",e),Ue(t),s.head.appendChild(t)))}},m:function(e,t){Cd.m(e,t);var n=_d;if(n&&e){var s=t&&"string"===typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+pt(s)+'"][href="'+pt(e)+'"]',a=r;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":a=Dd(e)}if(!jd.has(a)&&(e=h({rel:"modulepreload",href:e},t),jd.set(a,e),null===n.querySelector(r))){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Rd(a)))return}ed(s=n.createElement("link"),"link",e),Ue(s),n.head.appendChild(s)}}},X:function(e,t){Cd.X(e,t);var n=_d;if(n&&e){var s=$e(n).hoistableScripts,r=Dd(e),a=s.get(r);a||((a=n.querySelector(Rd(r)))||(e=h({src:e,async:!0},t),(t=jd.get(r))&&Fd(e,t),Ue(a=n.createElement("script")),ed(a,"link",e),n.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},s.set(r,a))}},S:function(e,t,n){Cd.S(e,t,n);var s=_d;if(s&&e){var r=$e(s).hoistableStyles,a=Ad(e);t=t||"default";var o=r.get(a);if(!o){var i={loading:0,preload:null};if(o=s.querySelector(Md(a)))i.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},n),(n=jd.get(a))&&Od(e,n);var l=o=s.createElement("link");Ue(l),ed(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){i.loading|=1}),l.addEventListener("error",function(){i.loading|=2}),i.loading|=4,Pd(o,t,s)}o={type:"stylesheet",instance:o,count:1,state:i},r.set(a,o)}}},M:function(e,t){Cd.M(e,t);var n=_d;if(n&&e){var s=$e(n).hoistableScripts,r=Dd(e),a=s.get(r);a||((a=n.querySelector(Rd(r)))||(e=h({src:e,async:!0,type:"module"},t),(t=jd.get(r))&&Fd(e,t),Ue(a=n.createElement("script")),ed(a,"link",e),n.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},s.set(r,a))}}};var _d="undefined"===typeof document?null:document;function Sd(e,t,n){var s=_d;if(s&&"string"===typeof t&&t){var r=pt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"===typeof n&&(r+='[crossorigin="'+n+'"]'),kd.has(r)||(kd.add(r),e={rel:e,crossOrigin:n,href:t},null===s.querySelector(r)&&(ed(t=s.createElement("link"),"link",e),Ue(t),s.head.appendChild(t)))}}function Td(e,t,n,s){var r,a,i,l,c=(c=$.current)?Nd(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Ad(n.href),(s=(n=$e(c).hoistableStyles).get(t))||(s={type:"style",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Ad(n.href);var u=$e(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Md(e)))&&!u._p&&(d.instance=u,d.state.loading=5),jd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},jd.set(e,n),u||(r=c,a=e,i=n,l=d.state,r.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=r.createElement("link"),l.preload=a,a.addEventListener("load",function(){return l.loading|=1}),a.addEventListener("error",function(){return l.loading|=2}),ed(a,"link",i),Ue(a),r.head.appendChild(a))))),t&&null===s)throw Error(o(528,""));return d}if(t&&null!==s)throw Error(o(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Dd(n),(s=(n=$e(c).hoistableScripts).get(t))||(s={type:"script",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Ad(e){return'href="'+pt(e)+'"'}function Md(e){return'link[rel="stylesheet"]['+e+"]"}function Ed(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Dd(e){return'[src="'+pt(e)+'"]'}function Rd(e){return"script[async]"+e}function Id(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+pt(n.href)+'"]');if(s)return t.instance=s,Ue(s),s;var r=h({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ue(s=(e.ownerDocument||e).createElement("style")),ed(s,"style",r),Pd(s,n.precedence,e),t.instance=s;case"stylesheet":r=Ad(n.href);var a=e.querySelector(Md(r));if(a)return t.state.loading|=4,t.instance=a,Ue(a),a;s=Ed(n),(r=jd.get(r))&&Od(s,r),Ue(a=(e.ownerDocument||e).createElement("link"));var i=a;return i._p=new Promise(function(e,t){i.onload=e,i.onerror=t}),ed(a,"link",s),t.state.loading|=4,Pd(a,n.precedence,e),t.instance=a;case"script":return a=Dd(n.src),(r=e.querySelector(Rd(a)))?(t.instance=r,Ue(r),r):(s=n,(r=jd.get(a))&&Fd(s=h({},n),r),Ue(r=(e=e.ownerDocument||e).createElement("script")),ed(r,"link",s),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(s=t.instance,t.state.loading|=4,Pd(s,n.precedence,e));return t.instance}function Pd(e,t,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=s.length?s[s.length-1]:null,a=r,o=0;o<s.length;o++){var i=s[o];if(i.dataset.precedence===t)a=i;else if(a!==r)break}a?a.parentNode.insertBefore(e,a.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Od(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Fd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Ld=null;function qd(e,t,n){if(null===Ld){var s=new Map,r=Ld=new Map;r.set(n,s)}else(s=(r=Ld).get(n))||(s=new Map,r.set(n,s));if(s.has(e))return s;for(s.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var a=n[r];if(!(a[qe]||a[De]||"link"===e&&"stylesheet"===a.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==a.namespaceURI){var o=a.getAttribute(t)||"";o=e+o;var i=s.get(o);i?i.push(a):s.set(o,[a])}}return s}function Vd(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function zd(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Gd=null;function Bd(){}function $d(){if(this.count--,0===this.count)if(this.stylesheets)Wd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Ud=null;function Wd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Ud=new Map,t.forEach(Hd,e),Ud=null,$d.call(e))}function Hd(e,t){if(!(4&t.state.loading)){var n=Ud.get(e);if(n)var s=n.get(null);else{n=new Map,Ud.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),a=0;a<r.length;a++){var o=r[a];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),s=o)}s&&n.set(null,s)}o=(r=t.instance).getAttribute("data-precedence"),(a=n.get(o)||s)===s&&n.set(null,r),n.set(o,r),this.count++,s=$d.bind(this),r.addEventListener("load",s),r.addEventListener("error",s),a?a.parentNode.insertBefore(r,a.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var Qd={$$typeof:w,Provider:null,Consumer:null,_currentValue:O,_currentValue2:O,_threadCount:0};function Kd(e,t,n,s,r,a,o,i){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ne(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ne(0),this.hiddenUpdates=Ne(null),this.identifierPrefix=s,this.onUncaughtError=r,this.onCaughtError=a,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=i,this.incompleteTransitions=new Map}function Yd(e,t,n,s,r,a,o,i,l,c,u,d){return e=new Kd(e,t,n,o,i,l,c,d),t=1,!0===a&&(t|=24),a=Os(3,null,null,t),e.current=a,a.stateNode=e,(t=Rr()).refCount++,e.pooledCache=t,t.refCount++,a.memoizedState={element:s,isDehydrated:n,cache:t},na(a),e}function Xd(e){return e?e=Is:Is}function Zd(e,t,n,s,r,a){r=Xd(r),null===s.context?s.context=r:s.pendingContext=r,(s=ra(t)).payload={element:n},null!==(a=void 0===a?null:a)&&(s.callback=a),null!==(n=aa(e,s,t))&&(Oc(n,0,t),oa(n,e,t))}function Jd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function eh(e,t){Jd(e,t),(e=e.alternate)&&Jd(e,t)}function th(e){if(13===e.tag){var t=Es(e,67108864);null!==t&&Oc(t,0,67108864),eh(e,67108864)}}var nh=!0;function sh(e,t,n,s){var r=I.T;I.T=null;var a=P.p;try{P.p=2,ah(e,t,n,s)}finally{P.p=a,I.T=r}}function rh(e,t,n,s){var r=I.T;I.T=null;var a=P.p;try{P.p=8,ah(e,t,n,s)}finally{P.p=a,I.T=r}}function ah(e,t,n,s){if(nh){var r=oh(s);if(null===r)Gu(e,t,s,ih,n),bh(e,s);else if(function(e,t,n,s,r){switch(t){case"focusin":return dh=vh(dh,e,t,n,s,r),!0;case"dragenter":return hh=vh(hh,e,t,n,s,r),!0;case"mouseover":return mh=vh(mh,e,t,n,s,r),!0;case"pointerover":var a=r.pointerId;return fh.set(a,vh(fh.get(a)||null,e,t,n,s,r)),!0;case"gotpointercapture":return a=r.pointerId,ph.set(a,vh(ph.get(a)||null,e,t,n,s,r)),!0}return!1}(r,e,t,n,s))s.stopPropagation();else if(bh(e,s),4&t&&-1<xh.indexOf(e)){for(;null!==r;){var a=Ge(r);if(null!==a)switch(a.tag){case 3:if((a=a.stateNode).current.memoizedState.isDehydrated){var o=be(a.pendingLanes);if(0!==o){var i=a;for(i.pendingLanes|=2,i.entangledLanes|=2;o;){var l=1<<31-me(o);i.entanglements[1]|=l,o&=~l}ju(a),0===(6&nc)&&(jc=te()+500,ku(0,!1))}}break;case 13:null!==(i=Es(a,2))&&Oc(i,0,2),zc(),eh(a,2)}if(null===(a=oh(s))&&Gu(e,t,s,ih,n),a===r)break;r=a}null!==r&&s.stopPropagation()}else Gu(e,t,s,null,n)}}function oh(e){return lh(e=Et(e))}var ih=null;function lh(e){if(ih=null,null!==(e=ze(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return ih=e,null}function ch(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case se:return 2;case re:return 8;case ae:case oe:return 32;case ie:return 268435456;default:return 32}default:return 32}}var uh=!1,dh=null,hh=null,mh=null,fh=new Map,ph=new Map,gh=[],xh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bh(e,t){switch(e){case"focusin":case"focusout":dh=null;break;case"dragenter":case"dragleave":hh=null;break;case"mouseover":case"mouseout":mh=null;break;case"pointerover":case"pointerout":fh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ph.delete(t.pointerId)}}function vh(e,t,n,s,r,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:a,targetContainers:[r]},null!==t&&(null!==(t=Ge(t))&&th(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function yh(e){var t=ze(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=P.p;try{return P.p=e,t()}finally{P.p=n}}(e.priority,function(){if(13===n.tag){var e=Ic();e=Te(e);var t=Es(n,e);null!==t&&Oc(t,0,e),eh(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function wh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=oh(e.nativeEvent);if(null!==n)return null!==(t=Ge(n))&&th(t),e.blockedOn=n,!1;var s=new(n=e.nativeEvent).constructor(n.type,n);Mt=s,n.target.dispatchEvent(s),Mt=null,t.shift()}return!0}function jh(e,t,n){wh(e)&&n.delete(t)}function kh(){uh=!1,null!==dh&&wh(dh)&&(dh=null),null!==hh&&wh(hh)&&(hh=null),null!==mh&&wh(mh)&&(mh=null),fh.forEach(jh),ph.forEach(jh)}function Nh(e,t){e.blockedOn===t&&(e.blockedOn=null,uh||(uh=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,kh)))}var Ch=null;function _h(e){Ch!==e&&(Ch=e,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Ch===e&&(Ch=null);for(var t=0;t<e.length;t+=3){var n=e[t],s=e[t+1],r=e[t+2];if("function"!==typeof s){if(null===lh(s||n))continue;break}var a=Ge(n);null!==a&&(e.splice(t,3),t-=3,Eo(a,{pending:!0,data:r,method:n.method,action:s},s,r))}}))}function Sh(e){function t(t){return Nh(t,e)}null!==dh&&Nh(dh,e),null!==hh&&Nh(hh,e),null!==mh&&Nh(mh,e),fh.forEach(t),ph.forEach(t);for(var n=0;n<gh.length;n++){var s=gh[n];s.blockedOn===e&&(s.blockedOn=null)}for(;0<gh.length&&null===(n=gh[0]).blockedOn;)yh(n),null===n.blockedOn&&gh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(s=0;s<n.length;s+=3){var r=n[s],a=n[s+1],o=r[Re]||null;if("function"===typeof a)o||_h(n);else if(o){var i=null;if(a&&a.hasAttribute("formAction")){if(r=a,o=a[Re]||null)i=o.formAction;else if(null!==lh(r))continue}else i=o.action;"function"===typeof i?n[s+1]=i:(n.splice(s,3),s-=3),_h(n)}}}function Th(e){this._internalRoot=e}function Ah(e){this._internalRoot=e}Ah.prototype.render=Th.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Zd(t.current,Ic(),e,t,null,null)},Ah.prototype.unmount=Th.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Zd(e.current,2,null,e,null,null),zc(),t[Ie]=null}},Ah.prototype.unstable_scheduleHydration=function(e){if(e){var t=Me();e={blockedOn:null,target:e,priority:t};for(var n=0;n<gh.length&&0!==t&&t<gh[n].priority;n++);gh.splice(n,0,e),0===n&&yh(e)}};var Mh=r.version;if("19.1.0"!==Mh)throw Error(o(527,Mh,"19.1.0"));P.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(s=r.return)){n=s;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return u(r),e;if(a===s)return u(r),t;a=a.sibling}throw Error(o(188))}if(n.return!==s.return)n=r,s=a;else{for(var i=!1,c=r.child;c;){if(c===n){i=!0,n=r,s=a;break}if(c===s){i=!0,s=r,n=a;break}c=c.sibling}if(!i){for(c=a.child;c;){if(c===n){i=!0,n=a,s=r;break}if(c===s){i=!0,s=a,n=r;break}c=c.sibling}if(!i)throw Error(o(189))}}if(n.alternate!==s)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Eh={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.1.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Dh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dh.isDisabled&&Dh.supportsFiber)try{ue=Dh.inject(Eh),de=Dh}catch(Ih){}}t.createRoot=function(e,t){if(!i(e))throw Error(o(299));var n=!1,s="",r=bi,a=vi,l=yi;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(s=t.identifierPrefix),void 0!==t.onUncaughtError&&(r=t.onUncaughtError),void 0!==t.onCaughtError&&(a=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Yd(e,1,!1,null,0,n,s,r,a,l,0,null),e[Ie]=t.current,Vu(e),new Th(t)},t.hydrateRoot=function(e,t,n){if(!i(e))throw Error(o(299));var s=!1,r="",a=bi,l=vi,c=yi,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onUncaughtError&&(a=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Yd(e,1,!0,t,0,s,r,a,l,c,0,u)).context=Xd(null),n=t.current,(r=ra(s=Te(s=Ic()))).callback=null,aa(n,r,s),n=s,t.current.lanes=n,Ce(t,n),ju(t),e[Ie]=t.current,Vu(e),new Ah(t)},t.version="19.1.0"},43:(e,t,n)=>{"use strict";e.exports=n(288)},45:(e,t,n)=>{var s=n(738).default;e.exports=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},79:e=>{e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=Array(t);n<t;n++)s[n]=e[n];return s},e.exports.__esModule=!0,e.exports.default=e.exports},122:(e,t,n)=>{var s=n(79);e.exports=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},156:e=>{e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var s,r,a,o,i=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(s=a.call(n)).done)&&(i.push(s.value),i.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return i}},e.exports.__esModule=!0,e.exports.default=e.exports},288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function b(){}function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=x.prototype;var y=v.prototype=new b;y.constructor=v,p(y,x.prototype),y.isPureReactComponent=!0;var w=Array.isArray,j={H:null,A:null,T:null,S:null,V:null},k=Object.prototype.hasOwnProperty;function N(e,t,s,r,a,o){return s=o.ref,{$$typeof:n,type:e,key:t,ref:void 0!==s?s:null,props:o}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function S(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(){}function A(e,t,r,a,o){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(i){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case s:u=!0;break;case h:return A((u=e._init)(e._payload),t,r,a,o)}}if(u)return o=o(e),u=""===a?"."+S(e,0):a,w(o)?(r="",null!=u&&(r=u.replace(_,"$&/")+"/"),A(o,t,r,"",function(e){return e})):null!=o&&(C(o)&&(l=o,c=r+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(_,"$&/")+"/")+u,o=N(l.type,c,void 0,0,0,l.props)),t.push(o)),1;u=0;var d,f=""===a?".":a+":";if(w(e))for(var p=0;p<e.length;p++)u+=A(a=e[p],t,r,i=f+S(a,p),o);else if("function"===typeof(p=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=m&&d[m]||d["@@iterator"])?d:null))for(e=p.call(e),p=0;!(a=e.next()).done;)u+=A(a=a.value,t,r,i=f+S(a,p++),o);else if("object"===i){if("function"===typeof e.then)return A(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(T,T):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,r,a,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function M(e,t,n){if(null==e)return e;var s=[],r=0;return A(e,s,"","",function(e){return t.call(n,e,r++)}),s}function E(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function R(){}t.Children={map:M,forEach:function(e,t,n){M(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return M(e,function(){t++}),t},toArray:function(e){return M(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=r,t.Profiler=o,t.PureComponent=v,t.StrictMode=a,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return j.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var s=p({},e.props),r=e.key;if(null!=t)for(a in void 0!==t.ref&&void 0,void 0!==t.key&&(r=""+t.key),t)!k.call(t,a)||"key"===a||"__self"===a||"__source"===a||"ref"===a&&void 0===t.ref||(s[a]=t[a]);var a=arguments.length-2;if(1===a)s.children=n;else if(1<a){for(var o=Array(a),i=0;i<a;i++)o[i]=arguments[i+2];s.children=o}return N(e.type,r,void 0,0,0,s)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:i,_context:e},e},t.createElement=function(e,t,n){var s,r={},a=null;if(null!=t)for(s in void 0!==t.key&&(a=""+t.key),t)k.call(t,s)&&"key"!==s&&"__self"!==s&&"__source"!==s&&(r[s]=t[s]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var i=Array(o),l=0;l<o;l++)i[l]=arguments[l+2];r.children=i}if(e&&e.defaultProps)for(s in o=e.defaultProps)void 0===r[s]&&(r[s]=o[s]);return N(e,a,void 0,0,0,r)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:E}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=j.T,n={};j.T=n;try{var s=e(),r=j.S;null!==r&&r(n,s),"object"===typeof s&&null!==s&&"function"===typeof s.then&&s.then(R,D)}catch(a){D(a)}finally{j.T=t}},t.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},t.use=function(e){return j.H.use(e)},t.useActionState=function(e,t,n){return j.H.useActionState(e,t,n)},t.useCallback=function(e,t){return j.H.useCallback(e,t)},t.useContext=function(e){return j.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return j.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var s=j.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return s.useEffect(e,t)},t.useId=function(){return j.H.useId()},t.useImperativeHandle=function(e,t,n){return j.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return j.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return j.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return j.H.useMemo(e,t)},t.useOptimistic=function(e,t){return j.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return j.H.useReducer(e,t,n)},t.useRef=function(e){return j.H.useRef(e)},t.useState=function(e){return j.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return j.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return j.H.useTransition()},t.version="19.1.0"},383:e=>{e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{var s=n(736);function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},672:(e,t,n)=>{"use strict";var s=n(43);function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var o={d:{f:a,r:function(){throw Error(r(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},i=Symbol.for("react.portal");var l=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(r(299));return function(e,t,n){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:i,key:null==s?null:""+s,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=o.p;try{if(l.T=null,o.p=2,e)return e()}finally{l.T=t,o.p=n,o.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,s=c(n,t.crossOrigin),r="string"===typeof t.integrity?t.integrity:void 0,a="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?o.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:s,integrity:r,fetchPriority:a}):"script"===n&&o.d.X(e,{crossOrigin:s,integrity:r,fetchPriority:a,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,s=c(n,t.crossOrigin);o.d.L(e,n,{crossOrigin:s,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.0"},715:(e,t,n)=>{var s=n(987),r=n(156),a=n(122),o=n(752);e.exports=function(e,t){return s(e)||r(e,t)||a(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},736:(e,t,n)=>{var s=n(738).default,r=n(45);e.exports=function(e){var t=r(e,"string");return"symbol"==s(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},752:e=>{e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function r(e,t,s){var r=null;if(void 0!==s&&(r=""+s),void 0!==t.key&&(r=""+t.key),"key"in t)for(var a in s={},t)"key"!==a&&(s[a]=t[a]);else s=t;return t=s.ref,{$$typeof:n,type:e,key:r,ref:void 0!==t?t:null,props:s}}t.Fragment=s,t.jsx=r,t.jsxs=r},853:(e,t,n)=>{"use strict";e.exports=n(896)},896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var s=n-1>>>1,r=e[s];if(!(0<a(r,t)))break e;e[s]=t,e[n]=r,n=s}}function s(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var s=0,r=e.length,o=r>>>1;s<o;){var i=2*(s+1)-1,l=e[i],c=i+1,u=e[c];if(0>a(l,n))c<r&&0>a(u,l)?(e[s]=u,e[c]=n,s=c):(e[s]=l,e[i]=n,s=i);else{if(!(c<r&&0>a(u,n)))break e;e[s]=u,e[c]=n,s=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,h=null,m=3,f=!1,p=!1,g=!1,x=!1,b="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=s(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=s(u)}}function j(e){if(g=!1,w(e),!p)if(null!==s(c))p=!0,N||(N=!0,k());else{var t=s(u);null!==t&&D(j,t.startTime-e)}}var k,N=!1,C=-1,_=5,S=-1;function T(){return!!x||!(t.unstable_now()-S<_)}function A(){if(x=!1,N){var e=t.unstable_now();S=e;var n=!0;try{e:{p=!1,g&&(g=!1,v(C),C=-1),f=!0;var a=m;try{t:{for(w(e),h=s(c);null!==h&&!(h.expirationTime>e&&T());){var o=h.callback;if("function"===typeof o){h.callback=null,m=h.priorityLevel;var i=o(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof i){h.callback=i,w(e),n=!0;break t}h===s(c)&&r(c),w(e)}else r(c);h=s(c)}if(null!==h)n=!0;else{var l=s(u);null!==l&&D(j,l.startTime-e),n=!1}}break e}finally{h=null,m=a,f=!1}n=void 0}}finally{n?k():N=!1}}}if("function"===typeof y)k=function(){y(A)};else if("undefined"!==typeof MessageChannel){var M=new MessageChannel,E=M.port2;M.port1.onmessage=A,k=function(){E.postMessage(null)}}else k=function(){b(A,0)};function D(e,n){C=b(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},t.unstable_requestPaint=function(){x=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},t.unstable_scheduleCallback=function(e,r,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:a,expirationTime:i=a+i,sortIndex:-1},a>o?(e.sortIndex=a,n(u,e),null===s(c)&&e===s(u)&&(g?(v(C),C=-1):g=!0,D(j,a-o))):(e.sortIndex=i,n(c,e),p||f||(p=!0,N||(N=!0,k()))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)},960:(e,t,n)=>{"use strict";e.exports=n(799)},987:e=>{e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},998:function(e,t,n){!function(e,t,n,s){"use strict";var r=function(e,t,n){return{endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}},a=function(e,t,n){return{endTime:t,insertTime:n,type:"linearRampToValue",value:e}},o=function(e,t){return{startTime:t,type:"setValue",value:e}},i=function(e,t,n){return{duration:n,startTime:t,type:"setValueCurve",values:e}},l=function(e,t,n){var s=n.startTime,r=n.target,a=n.timeConstant;return r+(t-r)*Math.exp((s-e)/a)},c=function(e){return"exponentialRampToValue"===e.type},u=function(e){return"linearRampToValue"===e.type},d=function(e){return c(e)||u(e)},h=function(e){return"setValue"===e.type},m=function(e){return"setValueCurve"===e.type},f=function(e,t,n,s){var r=e[t];return void 0===r?s:d(r)||h(r)?r.value:m(r)?r.values[r.values.length-1]:l(n,f(e,t-1,r.startTime,s),r)},p=function(e,t,n,s,r){return void 0===n?[s.insertTime,r]:d(n)?[n.endTime,n.value]:h(n)?[n.startTime,n.value]:m(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,f(e,t-1,n.startTime,r)]},g=function(e){return"cancelAndHold"===e.type},x=function(e){return"cancelScheduledValues"===e.type},b=function(e){return g(e)||x(e)?e.cancelTime:c(e)||u(e)?e.endTime:e.startTime},v=function(e,t,n,s){var r=s.endTime,a=s.value;return n===a?a:0<n&&0<a||n<0&&a<0?n*Math.pow(a/n,(e-t)/(r-t)):0},y=function(e,t,n,s){return n+(e-t)/(s.endTime-t)*(s.value-n)},w=function(e,t){var n=Math.floor(t),s=Math.ceil(t);return n===s?e[n]:(1-(t-n))*e[n]+(1-(s-t))*e[s]},j=function(e,t){var n=t.duration,s=t.startTime,r=t.values,a=(e-s)/n*(r.length-1);return w(r,a)},k=function(e){return"setTarget"===e.type},N=function(){function e(t){n(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return s(e,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(e){var t=b(e);if(g(e)||x(e)){var n=this._automationEvents.findIndex(function(n){return x(e)&&m(n)?n.startTime+n.duration>=t:b(n)>=t}),s=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),g(e)){var l=this._automationEvents[this._automationEvents.length-1];if(void 0!==s&&d(s)){if(void 0!==l&&k(l))throw new Error("The internal list is malformed.");var h=void 0===l?s.insertTime:m(l)?l.startTime+l.duration:b(l),f=void 0===l?this._defaultValue:m(l)?l.values[l.values.length-1]:l.value,p=c(s)?v(t,h,f,s):y(t,h,f,s),w=c(s)?r(p,t,this._currenTime):a(p,t,this._currenTime);this._automationEvents.push(w)}if(void 0!==l&&k(l)&&this._automationEvents.push(o(this.getValue(t),t)),void 0!==l&&m(l)&&l.startTime+l.duration>t){var j=t-l.startTime,N=(l.values.length-1)/l.duration,C=Math.max(2,1+Math.ceil(j*N)),_=j/(C-1)*N,S=l.values.slice(0,C);if(_<1)for(var T=1;T<C;T+=1){var A=_*T%1;S[T]=l.values[T-1]*(1-A)+l.values[T]*A}this._automationEvents[this._automationEvents.length-1]=i(S,l.startTime,j)}}}else{var M=this._automationEvents.findIndex(function(e){return b(e)>t}),E=-1===M?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[M-1];if(void 0!==E&&m(E)&&b(E)+E.duration>t)return!1;var D=c(e)?r(e.value,e.endTime,this._currenTime):u(e)?a(e.value,t,this._currenTime):e;if(-1===M)this._automationEvents.push(D);else{if(m(e)&&t+e.duration>b(this._automationEvents[M]))return!1;this._automationEvents.splice(M,0,D)}}return!0}},{key:"flush",value:function(e){var t=this._automationEvents.findIndex(function(t){return b(t)>e});if(t>1){var n=this._automationEvents.slice(t-1),s=n[0];k(s)&&n.unshift(o(f(this._automationEvents,t-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(e){if(0===this._automationEvents.length)return this._defaultValue;var n=this._automationEvents.findIndex(function(t){return b(t)>e}),s=this._automationEvents[n],r=(-1===n?this._automationEvents.length:n)-1,a=this._automationEvents[r];if(void 0!==a&&k(a)&&(void 0===s||!d(s)||s.insertTime>e))return l(e,f(this._automationEvents,r-1,a.startTime,this._defaultValue),a);if(void 0!==a&&h(a)&&(void 0===s||!d(s)))return a.value;if(void 0!==a&&m(a)&&(void 0===s||!d(s)||a.startTime+a.duration>e))return e<a.startTime+a.duration?j(e,a):a.values[a.values.length-1];if(void 0!==a&&d(a)&&(void 0===s||!d(s)))return a.value;if(void 0!==s&&c(s)){var o=p(this._automationEvents,r,a,s,this._defaultValue),i=t(o,2),g=i[0],x=i[1];return v(e,g,x,s)}if(void 0!==s&&u(s)){var w=p(this._automationEvents,r,a,s,this._defaultValue),N=t(w,2),C=N[0],_=N[1];return y(e,C,_,s)}return this._defaultValue}}])}(),C=function(e){return{cancelTime:e,type:"cancelAndHold"}},_=function(e){return{cancelTime:e,type:"cancelScheduledValues"}},S=function(e,t){return{endTime:t,type:"exponentialRampToValue",value:e}},T=function(e,t){return{endTime:t,type:"linearRampToValue",value:e}},A=function(e,t,n){return{startTime:t,target:e,timeConstant:n,type:"setTarget"}};e.AutomationEventList=N,e.createCancelAndHoldAutomationEvent=C,e.createCancelScheduledValuesAutomationEvent=_,e.createExponentialRampToValueAutomationEvent=S,e.createLinearRampToValueAutomationEvent=T,e.createSetTargetAutomationEvent=A,e.createSetValueAutomationEvent=o,e.createSetValueCurveAutomationEvent=i}(t,n(715),n(383),n(579))}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var a=t[s]={exports:{}};return e[s].call(a.exports,a,a.exports,n),a.exports}n.m=e,n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,s)=>(n.f[s](e,t),t),[])),n.u=e=>"static/js/"+e+".267d8d01.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="musical-tools-app:";n.l=(s,r,a,o)=>{if(e[s])e[s].push(r);else{var i,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==s||d.getAttribute("data-webpack")==t+a){i=d;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.setAttribute("data-webpack",t+a),i.src=s),e[s]=[r];var h=(t,n)=>{i.onerror=i.onload=null,clearTimeout(m);var r=e[s];if(delete e[s],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach(e=>e(n)),t)return t(n)},m=setTimeout(h.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=h.bind(null,i.onerror),i.onload=h.bind(null,i.onload),l&&document.head.appendChild(i)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/musical-tools-app/",(()=>{var e={792:0};n.f.j=(t,s)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)s.push(r[2]);else{var a=new Promise((n,s)=>r=e[t]=[n,s]);s.push(r[2]=a);var o=n.p+n.u(t),i=new Error;n.l(o,s=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=s&&("load"===s.type?"missing":s.type),o=s&&s.target&&s.target.src;i.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",i.name="ChunkLoadError",i.type=a,i.request=o,r[1](i)}},"chunk-"+t,t)}};var t=(t,s)=>{var r,a,o=s[0],i=s[1],l=s[2],c=0;if(o.some(t=>0!==e[t])){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(l)l(n)}for(t&&t(s);c<o.length;c++)a=o[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},s=self.webpackChunkmusical_tools_app=self.webpackChunkmusical_tools_app||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),(()=>{"use strict";var e=n(43),t=n(391);const s="15.1.22";var r=n(998);const a=new WeakSet,o=new WeakMap,i=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,m=new WeakMap,f=new WeakMap,p={construct:()=>p},g=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,x=(e,t)=>{const n=[];let s=e.replace(/^[\s]+/,""),r=s.match(g);for(;null!==r;){const e=r[1].slice(1,-1),a=r[0].replace(/([\s]+)?;?$/,"").replace(e,new URL(e,t).toString());n.push(a),s=s.slice(r[0].length).replace(/^[\s]+/,""),r=s.match(g)}return[n.join(";"),s]},b=e=>{if(void 0!==e&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},v=e=>{if(!(e=>{try{new new Proxy(e,p)}catch{return!1}return!0})(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!==typeof e.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},y=(e,t)=>{const n=e.get(t);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},w=(e,t)=>{const n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[s]=n;return e.delete(s),s},j=(e,t,n,s)=>{const r=y(e,t),a=w(r,e=>e[0]===n&&e[1]===s);return 0===r.size&&e.delete(t),a},k=e=>y(d,e),N=e=>{if(a.has(e))throw new Error("The AudioNode is already stored.");a.add(e),k(e).forEach(e=>e(!0))},C=e=>"port"in e,_=e=>{if(!a.has(e))throw new Error("The AudioNode is not stored.");a.delete(e),k(e).forEach(e=>e(!1))},S=(e,t)=>{!C(e)&&t.every(e=>0===e.size)&&_(e)},T={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},A=(e,t)=>e.context===t,M=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},E=()=>new DOMException("","IndexSizeError"),D=e=>{var t;e.getChannelData=(t=e.getChannelData,n=>{try{return t.call(e,n)}catch(s){if(12===s.code)throw E();throw s}})},R={numberOfChannels:1},I=-34028234663852886e22,P=-I,O=e=>a.has(e),F={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},L=e=>y(o,e),q=e=>y(l,e),V=(e,t)=>{const{activeInputs:n}=L(e);n.forEach(n=>n.forEach(n=>{let[s]=n;t.includes(e)||V(s,[...t,e])}));const s=(e=>"playbackRate"in e)(e)?[e.playbackRate]:C(e)?Array.from(e.parameters.values()):(e=>"frequency"in e&&"gain"in e)(e)?[e.Q,e.detune,e.frequency,e.gain]:(e=>"offset"in e)(e)?[e.offset]:(e=>!("frequency"in e)&&"gain"in e)(e)?[e.gain]:(e=>"detune"in e&&"frequency"in e&&!("gain"in e))(e)?[e.detune,e.frequency]:(e=>"pan"in e)(e)?[e.pan]:[];for(const r of s){const e=q(r);void 0!==e&&e.activeInputs.forEach(e=>{let[n]=e;return V(n,t)})}O(e)&&_(e)},z=e=>{V(e.destination,[])},G=e=>void 0===e||"number"===typeof e||"string"===typeof e&&("balanced"===e||"interactive"===e||"playback"===e),B=e=>"context"in e,$=e=>B(e[0]),U=(e,t,n,s)=>{for(const r of e)if(n(r)){if(s)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0},W=(e,t,n,s)=>{let[r,a]=n;U(e,[t,r,a],e=>e[0]===t&&e[1]===r,s)},H=(e,t,n)=>{let[s,r,a]=t;const o=e.get(s);void 0===o?e.set(s,new Set([[r,a]])):U(o,[r,a],e=>e[0]===r,n)},Q=e=>"inputs"in e,K=(e,t,n,s)=>{if(Q(t)){const r=t.inputs[s];return e.connect(r,n,0),[r,n,0]}return e.connect(t,n,s),[t,n,s]},Y=(e,t,n)=>{for(const s of e)if(s[0]===t&&s[1]===n)return e.delete(s),s;return null},X=(e,t)=>{if(!k(e).delete(t))throw new Error("Missing the expected event listener.")},Z=(e,t,n)=>{const s=y(e,t),r=w(s,e=>e[0]===n);return 0===s.size&&e.delete(t),r},J=(e,t,n,s)=>{Q(t)?e.disconnect(t.inputs[s],n,0):e.disconnect(t,n,s)},ee=e=>y(i,e),te=e=>y(c,e),ne=e=>h.has(e),se=e=>!a.has(e),re=(e,t)=>new Promise(n=>{if(null!==t)n(!0);else{const t=e.createScriptProcessor(256,1,1),s=e.createGain(),r=e.createBuffer(1,2,44100),a=r.getChannelData(0);a[0]=1,a[1]=1;const o=e.createBufferSource();o.buffer=r,o.loop=!0,o.connect(t).connect(e.destination),o.connect(s),o.disconnect(s),t.onaudioprocess=s=>{const r=s.inputBuffer.getChannelData(0);Array.prototype.some.call(r,e=>1===e)?n(!0):n(!1),o.stop(),t.onaudioprocess=null,o.disconnect(t),t.disconnect(e.destination)},o.start()}}),ae=(e,t)=>{const n=new Map;for(const s of e)for(const e of s){const t=n.get(e);n.set(e,void 0===t?1:t+1)}n.forEach((e,n)=>t(n,e))},oe=e=>"context"in e,ie=e=>{const t=new Map;e.connect=(e=>function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=oe(n)?e(n,s,r):e(n,s),o=t.get(n);return void 0===o?t.set(n,[{input:r,output:s}]):o.every(e=>e.input!==r||e.output!==s)&&o.push({input:r,output:s}),a})(e.connect.bind(e)),e.disconnect=(n=>(s,r,a)=>{if(n.apply(e),void 0===s)t.clear();else if("number"===typeof s)for(const[e,n]of t){const r=n.filter(e=>e.output!==s);0===r.length?t.delete(e):t.set(e,r)}else if(t.has(s))if(void 0===r)t.delete(s);else{const e=t.get(s);if(void 0!==e){const n=e.filter(e=>e.output!==r&&(e.input!==a||void 0===a));0===n.length?t.delete(s):t.set(s,n)}}for(const[n,o]of t)o.forEach(t=>{oe(n)?e.connect(n,t.output,t.input):e.connect(n,t.output)})})(e.disconnect)},le=(e,t,n,s)=>{const{activeInputs:r,passiveInputs:a}=q(t),{outputs:o}=L(e),i=k(e),l=o=>{const i=ee(e),l=te(t);if(o){const t=Z(a,e,n);W(r,e,t,!1),s||ne(e)||i.connect(l,n)}else{const t=((e,t,n)=>w(e,e=>e[0]===t&&e[1]===n))(r,e,n);H(a,t,!1),s||ne(e)||i.disconnect(l,n)}};return!!U(o,[t,n],e=>e[0]===t&&e[1]===n,!0)&&(i.add(l),O(e)?W(r,e,[n,l],!0):H(a,[e,n,l],!0),!0)},ce=(e,t,n,s,r)=>{const[a,o]=((e,t,n,s)=>{const{activeInputs:r,passiveInputs:a}=L(t),o=Y(r[s],e,n);if(null===o)return[j(a,e,n,s)[2],!1];return[o[2],!0]})(e,n,s,r);if(null!==a&&(X(e,a),!o||t||ne(e)||J(ee(e),ee(n),s,r)),O(n)){const{activeInputs:e}=L(n);S(n,e)}},ue=(e,t,n,s)=>{const[r,a]=((e,t,n)=>{const{activeInputs:s,passiveInputs:r}=q(t),a=Y(s,e,n);if(null===a)return[Z(r,e,n)[1],!1];return[a[2],!0]})(e,n,s);null!==r&&(X(e,r),!a||t||ne(e)||ee(e).disconnect(te(n),s))};class de{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._map.forEach((n,s)=>e.call(t,n,s,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const he={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function me(e,t,n,s,r){if("function"===typeof e.copyFromChannel)0===t[n].byteLength&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],s,r);else{const a=e.getChannelData(s);if(0===t[n].byteLength)t[n]=a.slice(r,r+128);else{const e=new Float32Array(a.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(e)}}}const fe=(e,t,n,s,r)=>{"function"===typeof e.copyToChannel?0!==t[n].byteLength&&e.copyToChannel(t[n],s,r):0!==t[n].byteLength&&e.getChannelData(s).set(t[n],r)},pe=(e,t)=>{const n=[];for(let s=0;s<e;s+=1){const e=[],r="number"===typeof t?t:t[s];for(let t=0;t<r;t+=1)e.push(new Float32Array(128));n.push(e)}return n},ge=async(e,t,n,s,r,a,o)=>{const i=null===t?128*Math.ceil(e.context.length/128):t.length,l=s.channelCount*s.numberOfInputs,c=r.reduce((e,t)=>e+t,0),u=0===c?null:n.createBuffer(c,i,n.sampleRate);if(void 0===a)throw new Error("Missing the processor constructor.");const d=L(e),h=await((e,t)=>{const n=y(f,e),s=ee(t);return y(n,s)})(n,e),m=pe(s.numberOfInputs,s.channelCount),p=pe(s.numberOfOutputs,r),g=Array.from(e.parameters.keys()).reduce((e,t)=>({...e,[t]:new Float32Array(128)}),{});for(let f=0;f<i;f+=128){if(s.numberOfInputs>0&&null!==t)for(let e=0;e<s.numberOfInputs;e+=1)for(let n=0;n<s.channelCount;n+=1)me(t,m[e],n,n,f);void 0!==a.parameterDescriptors&&null!==t&&a.parameterDescriptors.forEach((e,n)=>{let{name:s}=e;me(t,g,s,l+n,f)});for(let e=0;e<s.numberOfInputs;e+=1)for(let t=0;t<r[e];t+=1)0===p[e][t].byteLength&&(p[e][t]=new Float32Array(128));try{const e=m.map((e,t)=>0===d.activeInputs[t].size?[]:e),t=o(f/n.sampleRate,n.sampleRate,()=>h.process(e,p,g));if(null!==u)for(let n=0,a=0;n<s.numberOfOutputs;n+=1){for(let e=0;e<r[n];e+=1)fe(u,p[n],e,a+e,f);a+=r[n]}if(!t)break}catch(x){e.dispatchEvent(new ErrorEvent("processorerror",{colno:x.colno,filename:x.filename,lineno:x.lineno,message:x.message}));break}}return u},xe={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},be={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},ve={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ye={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},we={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},je=e=>{const{port1:t,port2:n}=new MessageChannel;return new Promise(s=>{const r=()=>{n.onmessage=null,t.close(),n.close(),s()};n.onmessage=()=>r();try{t.postMessage(e,[e])}catch{}finally{r()}})},ke={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ne=(e,t,n)=>{const s=t[n];if(void 0===s)throw e();return s},Ce={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},_e={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Se=()=>new DOMException("","InvalidStateError"),Te=()=>new DOMException("","InvalidAccessError"),Ae={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Me=(e,t,n,s,r,a,o,i,l,c,u)=>{const d=c.length;let h=i;for(let m=0;m<d;m+=1){let i=n[0]*c[m];for(let t=1;t<r;t+=1){const s=h-t&l-1;i+=n[t]*a[s],i-=e[t]*o[s]}for(let e=r;e<s;e+=1)i+=n[e]*a[h-e&l-1];for(let n=r;n<t;n+=1)i-=e[n]*o[h-n&l-1];a[h]=c[m],o[h]=i,h=h+1&l-1,u[m]=i}return h},Ee={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},De=e=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=e.decodeAudioData(t.buffer,()=>{});return void 0!==n&&(n.catch(()=>{}),!0)}catch{}return!1},Re={numberOfChannels:1},Ie=(e,t,n)=>{const s=t[n];void 0!==s&&s!==e[n]&&(e[n]=s)},Pe=(e,t)=>{Ie(e,t,"channelCount"),Ie(e,t,"channelCountMode"),Ie(e,t,"channelInterpretation")},Oe=e=>"function"===typeof e.getFloatTimeDomainData,Fe=(e,t,n)=>{const s=t[n];void 0!==s&&s!==e[n].value&&(e[n].value=s)},Le=e=>{e.start=(t=>function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if("number"===typeof r&&r<0||s<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,s,r)})(e.start)},qe=e=>{var t;e.stop=(t=e.stop,function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})},Ve=(e,t)=>null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t))))),ze=async(e,t)=>{const n=await(e=>new Promise((t,n)=>{const{port1:s,port2:r}=new MessageChannel;s.onmessage=e=>{let{data:n}=e;s.close(),r.close(),t(n)},s.onmessageerror=e=>{let{data:t}=e;s.close(),r.close(),n(t)},r.postMessage(e)}))(t);return new e(n)},Ge=(e,t)=>{const n=e.createBiquadFilter();return Pe(n,t),Fe(n,t,"Q"),Fe(n,t,"detune"),Fe(n,t,"frequency"),Fe(n,t,"gain"),Ie(n,t,"type"),n},Be=(e,t)=>{const n=e.createChannelSplitter(t.numberOfOutputs);return Pe(n,t),(e=>{const t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw Se()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:e=>{if("explicit"!==e)throw Se()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:e=>{if("discrete"!==e)throw Se()}})})(n),n},$e=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e),Ue=(e,t)=>{const n=e.createDelay(t.maxDelayTime);return Pe(n,t),Fe(n,t,"delayTime"),n},We=(e,t)=>{const n=e.createGain();return Pe(n,t),Fe(n,t,"gain"),n};function He(e,t){const n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}function Qe(e,t){return[e[0]*t[0]-e[1]*t[1],e[0]*t[1]+e[1]*t[0]]}function Ke(e,t){let n=[0,0];for(let s=e.length-1;s>=0;s-=1)n=Qe(n,t),n[0]+=e[s];return n}const Ye=(e,t,n,s)=>e.createScriptProcessor(t,n,s),Xe=()=>new DOMException("","NotSupportedError"),Ze={numberOfChannels:1},Je={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},et={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},tt={disableNormalization:!1},nt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},st=()=>new DOMException("","UnknownError"),rt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},at=(e,t,n)=>void 0===e.copyFromChannel?e.getChannelData(n)[0]:(e.copyFromChannel(t,n),t[0]),ot=e=>{if(null===e)return!1;const t=e.length;return t%2!==0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0},it=(e,t,n,s)=>{let r=e;for(;!r.hasOwnProperty(t);)r=Object.getPrototypeOf(r);const{get:a,set:o}=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(e,t,{get:n(a),set:s(o)})},lt=(e,t,n)=>{try{e.setValueAtTime(t,n)}catch(s){if(9!==s.code)throw s;lt(e,t,n+1e-7)}},ct=e=>{const t=e.createOscillator();try{t.start(-1)}catch(n){return n instanceof RangeError}return!1},ut=e=>{const t=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},dt=e=>{const t=e.createOscillator();try{t.stop(-1)}catch(n){return n instanceof RangeError}return!1},ht=(e,t)=>{const n=t.createGain();e.connect(n);const s=(t=>()=>{t.call(e,n),e.removeEventListener("ended",s)})(e.disconnect);e.addEventListener("ended",s),$e(e,n),e.stop=(t=>{let s=!1;return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(s)try{t.call(e,r)}catch{n.gain.setValueAtTime(0,r)}else t.call(e,r),s=!0}})(e.stop)},mt=(e,t)=>n=>{const s={value:e};return Object.defineProperties(n,{currentTarget:s,target:s}),"function"===typeof t?t.call(e,n):t.handleEvent.call(e,n)},ft=(e=>(t,n,s,r)=>{let[a,o,i]=s;e(t[o],[n,a,i],e=>e[0]===n&&e[1]===a,r)})(U),pt=(e=>(t,n,s,r)=>{let[a,o,i]=s;const l=t.get(a);void 0===l?t.set(a,new Set([[o,n,i]])):e(l,[o,n,i],e=>e[0]===o&&e[1]===n,r)})(U),gt=(e=>(t,n,s,r)=>e(t[r],e=>e[0]===n&&e[1]===s))(w),xt=new WeakMap,bt=(e=>t=>{var n;return null!==(n=e.get(t))&&void 0!==n?n:0})(xt),vt=(yt=new Map,wt=new WeakMap,(e,t)=>{const n=wt.get(e);if(void 0!==n)return n;const s=yt.get(e);if(void 0!==s)return s;try{const n=t();return n instanceof Promise?(yt.set(e,n),n.catch(()=>!1).then(t=>(yt.delete(e),wt.set(e,t),t))):(wt.set(e,n),n)}catch{return wt.set(e,!1),!1}});var yt,wt;const jt="undefined"===typeof window?null:window,kt=((e,t)=>(n,s)=>{const r=n.createAnalyser();if(Pe(r,s),!(s.maxDecibels>s.minDecibels))throw t();return Ie(r,s,"fftSize"),Ie(r,s,"maxDecibels"),Ie(r,s,"minDecibels"),Ie(r,s,"smoothingTimeConstant"),e(Oe,()=>Oe(r))||(e=>{e.getFloatTimeDomainData=t=>{const n=new Uint8Array(t.length);e.getByteTimeDomainData(n);const s=Math.max(n.length,e.fftSize);for(let e=0;e<s;e+=1)t[e]=.0078125*(n[e]-128);return t}})(r),r})(vt,E),Nt=(e=>t=>{const n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(L),Ct=((e,t,n)=>async(s,r,a)=>{const o=e(s);await Promise.all(o.activeInputs.map((e,o)=>Array.from(e).map(async e=>{let[i,l]=e;const c=t(i),u=await c.render(i,r),d=s.context.destination;n(i)||s===d&&n(s)||u.connect(a,l,o)})).reduce((e,t)=>[...e,...t],[]))})(L,Nt,ne),_t=((e,t,n)=>()=>{const s=new WeakMap;return{render(r,a){const o=s.get(a);return void 0!==o?Promise.resolve(o):(async(r,a)=>{let o=t(r);if(!A(o,a)){const t={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=e(a,t)}return s.set(a,o),await n(r,a,o),o})(r,a)}}})(kt,ee,Ct),St=(Tt=u,e=>{const t=Tt.get(e);if(void 0===t)throw Se();return t});var Tt;const At=(e=>null===e?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null)(jt),Mt=(e=>t=>null!==e&&t instanceof e)(At),Et=new WeakMap,Dt=(e=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(t,n,s){if(null!==n){let r=this._listeners.get(n);void 0===r&&(r=e(this,n),"function"===typeof n&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(t,r,s)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const s=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===s?null:s,n)}})(mt),Rt=(e=>null===e?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null)(jt),It=(e=>t=>null!==e&&t instanceof e)(Rt),Pt=(e=>t=>null!==e&&"function"===typeof e.AudioNode&&t instanceof e.AudioNode)(jt),Ot=(e=>t=>null!==e&&"function"===typeof e.AudioParam&&t instanceof e.AudioParam)(jt),Ft=(e=>null===e?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null)(jt),Lt=((e,t,n,s,r,a,o,l,c,u,h,m,f,p,g,x)=>class extends u{constructor(t,s,r,a){super(r),this._context=t,this._nativeAudioNode=r;const o=h(t);m(o)&&!0!==n(re,()=>re(o,x))&&ie(r),i.set(this,r),d.set(this,new Set),"closed"!==t.state&&s&&N(this),e(this,a,r)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(e){this._nativeAudioNode.channelCount=e}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(e){this._nativeAudioNode.channelCountMode=e}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(e){this._nativeAudioNode.channelInterpretation=e}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw r();const l=h(this._context),u=g(l);if(f(e)||p(e))throw a();if(B(e)){const r=ee(e);try{const t=K(this._nativeAudioNode,r,n,i),s=se(this);(u||s)&&this._nativeAudioNode.disconnect(...t),"closed"!==this.context.state&&!s&&se(e)&&N(e)}catch(m){if(12===m.code)throw a();throw m}if(t(this,e,n,i,u)){const t=c([this],e);ae(t,s(u))}return e}const d=te(e);if("playbackRate"===d.name&&1024===d.maxValue)throw o();try{this._nativeAudioNode.connect(d,n),(u||se(this))&&this._nativeAudioNode.disconnect(d,n)}catch(m){if(12===m.code)throw a();throw m}if(le(this,e,n,u)){const t=c([this],e);ae(t,s(u))}}disconnect(e,t,n){let s;const o=h(this._context),i=g(o);if(void 0===e)s=((e,t)=>{const n=L(e),s=[];for(const r of n.outputs)$(r)?ce(e,t,...r):ue(e,t,...r),s.push(r[0]);return n.outputs.clear(),s})(this,i);else if("number"===typeof e){if(e<0||e>=this.numberOfOutputs)throw r();s=((e,t,n)=>{const s=L(e),r=[];for(const a of s.outputs)a[1]===n&&($(a)?ce(e,t,...a):ue(e,t,...a),r.push(a[0]),s.outputs.delete(a));return r})(this,i,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs))throw r();if(B(e)&&void 0!==n&&(n<0||n>=e.numberOfInputs))throw r();if(s=((e,t,n,s,r)=>{const a=L(e);return Array.from(a.outputs).filter(e=>e[0]===n&&(void 0===s||e[1]===s)&&(void 0===r||e[2]===r)).map(n=>($(n)?ce(e,t,...n):ue(e,t,...n),a.outputs.delete(n),n[0]))})(this,i,e,t,n),0===s.length)throw a()}for(const r of s){const e=c([this],r);ae(e,l)}}})((qt=o,(e,t,n)=>{const s=[];for(let r=0;r<n.numberOfInputs;r+=1)s.push(new Set);qt.set(e,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:t})}),((e,t,n,s,r,a,o,i,l,c,u,d,h)=>{const m=new WeakMap;return(f,p,g,x,b)=>{const{activeInputs:v,passiveInputs:y}=a(p),{outputs:w}=a(f),k=i(f),C=a=>{const i=l(p),c=l(f);if(a){const t=j(y,f,g,x);e(v,f,t,!1),b||d(f)||n(c,i,g,x),h(p)&&N(p)}else{const e=s(v,f,g,x);t(y,x,e,!1),b||d(f)||r(c,i,g,x);const n=o(p);if(0===n)u(p)&&S(p,v);else{const e=m.get(p);void 0!==e&&clearTimeout(e),m.set(p,setTimeout(()=>{u(p)&&S(p,v)},1e3*n))}}};return!!c(w,[p,g,x],e=>e[0]===p&&e[1]===g&&e[2]===x,!0)&&(k.add(C),u(f)?e(v,f,[g,x,C],!0):t(y,x,[f,g,C],!0),!0)}})(ft,pt,K,gt,J,L,bt,k,ee,U,O,ne,se),vt,((e,t,n,s,r,a)=>o=>(i,l)=>{const c=e.get(i);if(void 0===c){if(!o&&a(i)){const e=s(i),{outputs:a}=n(i);for(const n of a)if($(n)){const r=s(n[0]);t(e,r,n[1],n[2])}else{const t=r(n[0]);e.disconnect(t,n[1])}}e.set(i,l)}else e.set(i,c+l)})(h,J,L,ee,te,O),E,Te,Xe,((e,t,n,s,r,a,o,i)=>(l,c)=>{const u=t.get(l);if(void 0===u)throw new Error("Missing the expected cycle count.");const d=a(l.context),h=i(d);if(u===c){if(t.delete(l),!h&&o(l)){const t=s(l),{outputs:a}=n(l);for(const n of a)if($(n)){const r=s(n[0]);e(t,r,n[1],n[2])}else{const e=r(n[0]);t.connect(e,n[1])}}}else t.set(l,u-c)})(K,h,L,ee,te,St,O,Mt),((e,t,n)=>function s(r,a){const o=B(a)?a:n(e,a);if((e=>"delayTime"in e)(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];const{outputs:i}=t(o);return Array.from(i).map(e=>s([...r,o],e[0])).reduce((e,t)=>e.concat(t),[])})(Et,L,y),Dt,St,It,Pt,Ot,Mt,Ft);var qt;const Vt=((e,t,n,s,r,a)=>class extends e{constructor(e,n){const o=r(e),i={...T,...n},l=s(o,i);super(e,!1,l,a(o)?t():null),this._nativeAnalyserNode=l}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(e){this._nativeAnalyserNode.fftSize=e}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(e){const t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(e){const t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(e){this._nativeAnalyserNode.smoothingTimeConstant=e}getByteFrequencyData(e){this._nativeAnalyserNode.getByteFrequencyData(e)}getByteTimeDomainData(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}getFloatFrequencyData(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}getFloatTimeDomainData(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}})(Lt,_t,E,kt,St,Mt),zt=new WeakSet,Gt=(e=>null===e?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null)(jt),Bt=($t=new Uint32Array(1),e=>($t[0]=e,$t[0]));var $t;const Ut=((e,t)=>n=>{n.copyFromChannel=function(s,r){const a=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),o=e(r);if(o>=n.numberOfChannels)throw t();const i=n.length,l=n.getChannelData(o),c=s.length;for(let e=a<0?-a:0;e+a<i&&e<c;e+=1)s[e]=l[e+a]},n.copyToChannel=function(s,r){const a=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),o=e(r);if(o>=n.numberOfChannels)throw t();const i=n.length,l=n.getChannelData(o),c=s.length;for(let e=a<0?-a:0;e+a<i&&e<c;e+=1)l[e+a]=s[e]}})(Bt,E),Wt=(e=>t=>{t.copyFromChannel=(n=>function(s,r){const a=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),o=e(r);if(a<t.length)return n.call(t,s,o,a)})(t.copyFromChannel),t.copyToChannel=(n=>function(s,r){const a=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),o=e(r);if(a<t.length)return n.call(t,s,o,a)})(t.copyToChannel)})(Bt),Ht=((e,t,n,s,r,a,o,i)=>{let l=null;return class c{constructor(c){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:d,sampleRate:h}={...R,...c};null===l&&(l=new r(1,1,44100));const m=null!==s&&t(a,a)?new s({length:u,numberOfChannels:d,sampleRate:h}):l.createBuffer(d,u,h);if(0===m.numberOfChannels)throw n();return"function"!==typeof m.copyFromChannel?(o(m),D(m)):t(M,()=>M(m))||i(m),e.add(m),m}static[Symbol.hasInstance](t){return null!==t&&"object"===typeof t&&Object.getPrototypeOf(t)===c.prototype||e.has(t)}}})(zt,vt,Xe,Gt,At,(e=>()=>{if(null===e)return!1;try{new e({length:1,sampleRate:44100})}catch{return!1}return!0})(Gt),Ut,Wt),Qt=(e=>(t,n)=>{const s=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(s).connect(t.destination);const r=()=>{n.removeEventListener("ended",r),n.disconnect(s),s.disconnect()};n.addEventListener("ended",r)})(We),Kt=((e,t,n)=>async(s,r,a)=>{const o=t(s);await Promise.all(Array.from(o.activeInputs).map(async t=>{let[s,o]=t;const i=e(s),l=await i.render(s,r);n(s)||l.connect(a,o)}))})(Nt,q,ne),Yt=(e=>(t,n,s)=>e(n,t,s))(Kt),Xt=((e,t,n,s,r,a,o,i,l,c,u)=>(d,h)=>{const m=d.createBufferSource();return Pe(m,h),Fe(m,h,"playbackRate"),Ie(m,h,"buffer"),Ie(m,h,"loop"),Ie(m,h,"loopEnd"),Ie(m,h,"loopStart"),t(n,()=>n(d))||(e=>{e.start=(t=>{let n=!1;return function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0;if(n)throw Se();t.call(e,s,r,a),n=!0}})(e.start)})(m),t(s,()=>s(d))||l(m),t(r,()=>r(d))||c(m,d),t(a,()=>a(d))||Le(m),t(o,()=>o(d))||u(m,d),t(i,()=>i(d))||qe(m),e(d,m),m})(Qt,vt,e=>{const t=e.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},e=>{const t=e.createBufferSource(),n=e.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch{return!1}return!0},e=>{const t=e.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},ct,ut,dt,e=>{e.start=(t=>function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;const a=e.buffer,o=null===a?s:Math.min(a.duration,s);null!==a&&o>a.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,o,r)})(e.start)},(e=>(t,n)=>{const s=n.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=s),e(t,"buffer",e=>()=>{const n=e.call(t);return n===s?null:n},e=>n=>e.call(t,null===n?s:n))})(it),ht),Zt=((e,t)=>(n,s,r)=>(e(s).replay(r),t(s,n,r)))((e=>t=>{const n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(q),Kt),Jt=((e,t,n,s,r)=>()=>{const a=new WeakMap;let o=null,i=null;return{set start(e){o=e},set stop(e){i=e},render(l,c){const u=a.get(c);return void 0!==u?Promise.resolve(u):(async(l,c)=>{let u=n(l);const d=A(u,c);if(!d){const e={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,loop:u.loop,loopEnd:u.loopEnd,loopStart:u.loopStart,playbackRate:u.playbackRate.value};u=t(c,e),null!==o&&u.start(...o),null!==i&&u.stop(i)}return a.set(c,u),d?await e(c,l.playbackRate,u.playbackRate):await s(c,l.playbackRate,u.playbackRate),await r(l,c,u),u})(l,c)}}})(Yt,Xt,ee,Zt,Ct),en=((e,t,n,s,a,o,i,l,c,u,d,h,m)=>function(f,p,g){let x=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,b=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const v=g.value,y=new r.AutomationEventList(v),w=p?s(y):null,j={get defaultValue(){return v},get maxValue(){return null===x?g.maxValue:x},get minValue(){return null===b?g.minValue:b},get value(){return g.value},set value(e){g.value=e,j.setValueAtTime(e,f.context.currentTime)},cancelAndHoldAtTime(e){if("function"===typeof g.cancelAndHoldAtTime)null===w&&y.flush(f.context.currentTime),y.add(a(e)),g.cancelAndHoldAtTime(e);else{const t=Array.from(y).pop();null===w&&y.flush(f.context.currentTime),y.add(a(e));const n=Array.from(y).pop();g.cancelScheduledValues(e),t!==n&&void 0!==n&&("exponentialRampToValue"===n.type?g.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?g.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?g.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&g.setValueCurveAtTime(n.values,n.startTime,n.duration))}return j},cancelScheduledValues:e=>(null===w&&y.flush(f.context.currentTime),y.add(o(e)),g.cancelScheduledValues(e),j),exponentialRampToValueAtTime(e,t){if(0===e)throw new RangeError;if(!Number.isFinite(t)||t<0)throw new RangeError;const n=f.context.currentTime;return null===w&&y.flush(n),0===Array.from(y).length&&(y.add(u(v,n)),g.setValueAtTime(v,n)),y.add(i(e,t)),g.exponentialRampToValueAtTime(e,t),j},linearRampToValueAtTime(e,t){const n=f.context.currentTime;return null===w&&y.flush(n),0===Array.from(y).length&&(y.add(u(v,n)),g.setValueAtTime(v,n)),y.add(l(e,t)),g.linearRampToValueAtTime(e,t),j},setTargetAtTime:(e,t,n)=>(null===w&&y.flush(f.context.currentTime),y.add(c(e,t,n)),g.setTargetAtTime(e,t,n),j),setValueAtTime:(e,t)=>(null===w&&y.flush(f.context.currentTime),y.add(u(e,t)),g.setValueAtTime(e,t),j),setValueCurveAtTime(e,t,n){const s=e instanceof Float32Array?e:new Float32Array(e);if(null!==h&&"webkitAudioContext"===h.name){const e=t+n,r=f.context.sampleRate,a=Math.ceil(t*r),o=Math.floor(e*r),i=o-a,l=new Float32Array(i);for(let u=0;u<i;u+=1){const e=(s.length-1)/n*((a+u)/r-t),o=Math.floor(e),i=Math.ceil(e);l[u]=o===i?s[o]:(1-(e-o))*s[o]+(1-(i-e))*s[i]}null===w&&y.flush(f.context.currentTime),y.add(d(l,t,n)),g.setValueCurveAtTime(l,t,n);const c=o/r;c<e&&m(j,l[l.length-1],c),m(j,s[s.length-1],e)}else null===w&&y.flush(f.context.currentTime),y.add(d(s,t,n)),g.setValueCurveAtTime(s,t,n);return j}};return n.set(j,g),t.set(j,f),e(j,w),j})((tn=l,(e,t)=>{tn.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})}),Et,c,e=>({replay(t){for(const n of e)if("exponentialRampToValue"===n.type){const{endTime:e,value:s}=n;t.exponentialRampToValueAtTime(s,e)}else if("linearRampToValue"===n.type){const{endTime:e,value:s}=n;t.linearRampToValueAtTime(s,e)}else if("setTarget"===n.type){const{startTime:e,target:s,timeConstant:r}=n;t.setTargetAtTime(s,e,r)}else if("setValue"===n.type){const{startTime:e,value:s}=n;t.setValueAtTime(s,e)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:e,startTime:s,values:r}=n;t.setValueCurveAtTime(r,s,e)}}}}),r.createCancelAndHoldAutomationEvent,r.createCancelScheduledValuesAutomationEvent,r.createExponentialRampToValueAutomationEvent,r.createLinearRampToValueAutomationEvent,r.createSetTargetAutomationEvent,r.createSetValueAutomationEvent,r.createSetValueCurveAutomationEvent,Rt,lt);var tn;const nn=((e,t,n,s,r,a,o,i)=>class extends e{constructor(e,s){const i=a(e),l={...F,...s},c=r(i,l),u=o(i),d=u?t():null;super(e,!1,c,d),this._audioBufferSourceNodeRenderer=d,this._isBufferNullified=!1,this._isBufferSet=null!==l.buffer,this._nativeAudioBufferSourceNode=c,this._onended=null,this._playbackRate=n(this,u,c.playbackRate,P,I)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(e){if(this._nativeAudioBufferSourceNode.buffer=e,null!==e){if(this._isBufferSet)throw s();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(e){this._nativeAudioBufferSourceNode.loop=e}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(e){this._nativeAudioBufferSourceNode.loopEnd=e}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(e){this._nativeAudioBufferSourceNode.loopStart=e}get onended(){return this._onended}set onended(e){const t="function"===typeof e?i(this,e):null;this._nativeAudioBufferSourceNode.onended=t;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===t?e:n}get playbackRate(){return this._playbackRate}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(this._nativeAudioBufferSourceNode.start(e,t,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[e,t]:[e,t,n]),"closed"!==this.context.state){N(this);const e=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",e),O(this)&&_(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",e)}}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}})(Lt,Jt,en,Se,Xt,St,Mt,mt),sn=((e,t,n,s,r,a,o,i)=>class extends e{constructor(e,n){const s=a(e),l=o(s),c=r(s,n,l);super(e,!1,c,l?t(i):null),this._isNodeOfNativeOfflineAudioContext=l,this._nativeAudioDestinationNode=c}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(e){if(this._isNodeOfNativeOfflineAudioContext)throw s();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=e}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(e){if(this._isNodeOfNativeOfflineAudioContext)throw s();this._nativeAudioDestinationNode.channelCountMode=e}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(Lt,e=>{const t=new WeakMap;return{render(n,s){const r=t.get(s);return void 0!==r?Promise.resolve(r):(async(n,s)=>{const r=s.destination;return t.set(s,r),await e(n,s,r),r})(n,s)}}},E,Se,((e,t)=>(n,s,r)=>{const a=n.destination;if(a.channelCount!==s)try{a.channelCount=s}catch{}r&&"explicit"!==a.channelCountMode&&(a.channelCountMode="explicit"),0===a.maxChannelCount&&Object.defineProperty(a,"maxChannelCount",{value:s});const o=e(n,{channelCount:s,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,gain:1});return t(o,"channelCount",e=>()=>e.call(o),e=>t=>{e.call(o,t);try{a.channelCount=t}catch(n){if(t>a.maxChannelCount)throw n}}),t(o,"channelCountMode",e=>()=>e.call(o),e=>t=>{e.call(o,t),a.channelCountMode=t}),t(o,"channelInterpretation",e=>()=>e.call(o),e=>t=>{e.call(o,t),a.channelInterpretation=t}),Object.defineProperty(o,"maxChannelCount",{get:()=>a.maxChannelCount}),o.connect(a),o})(We,it),St,Mt,Ct),rn=((e,t,n,s,r)=>()=>{const a=new WeakMap;return{render(o,i){const l=a.get(i);return void 0!==l?Promise.resolve(l):(async(o,i)=>{let l=n(o);const c=A(l,i);if(!c){const e={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=t(i,e)}return a.set(i,l),c?(await e(i,o.Q,l.Q),await e(i,o.detune,l.detune),await e(i,o.frequency,l.frequency),await e(i,o.gain,l.gain)):(await s(i,o.Q,l.Q),await s(i,o.detune,l.detune),await s(i,o.frequency,l.frequency),await s(i,o.gain,l.gain)),await r(o,i,l),l})(o,i)}}})(Yt,Ge,ee,Zt,Ct),an=(e=>(t,n)=>e.set(t,n))(xt),on=((e,t,n,s,r,a,o,i)=>class extends e{constructor(e,s){const l=a(e),c={...xe,...s},u=r(l,c),d=o(l);super(e,!1,u,d?n():null),this._Q=t(this,d,u.Q,P,I),this._detune=t(this,d,u.detune,1200*Math.log2(P),-1200*Math.log2(P)),this._frequency=t(this,d,u.frequency,e.sampleRate/2,0),this._gain=t(this,d,u.gain,40*Math.log10(P),I),this._nativeBiquadFilterNode=u,i(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(e){this._nativeBiquadFilterNode.type=e}getFrequencyResponse(e,t,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(e,t,n)}catch(r){if(11===r.code)throw s();throw r}if(e.length!==t.length||t.length!==n.length)throw s()}})(Lt,en,rn,Te,Ge,St,Mt,an),ln=((e,t)=>(n,s,r)=>{const a=new Set;return n.connect=(r=>function(o){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const c=0===a.size;if(t(o))return r.call(n,o,i,l),e(a,[o,i,l],e=>e[0]===o&&e[1]===i&&e[2]===l,!0),c&&s(),o;r.call(n,o,i),e(a,[o,i],e=>e[0]===o&&e[1]===i,!0),c&&s()})(n.connect),n.disconnect=(e=>(s,o,i)=>{const l=a.size>0;if(void 0===s)e.apply(n),a.clear();else if("number"===typeof s){e.call(n,s);for(const e of a)e[1]===s&&a.delete(e)}else{t(s)?e.call(n,s,o,i):e.call(n,s,o);for(const e of a)e[0]!==s||void 0!==o&&e[1]!==o||void 0!==i&&e[2]!==i||a.delete(e)}const c=0===a.size;l&&c&&r()})(n.disconnect),n})(U,Pt),cn=((e,t)=>(n,s)=>{s.channelCount=1,s.channelCountMode="explicit",Object.defineProperty(s,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const r=n.createBufferSource();t(s,()=>{const e=s.numberOfInputs;for(let t=0;t<e;t+=1)r.connect(s,0,t)},()=>r.disconnect(s))})(Se,ln),un=((e,t)=>(n,s)=>{const r=n.createChannelMerger(s.numberOfInputs);return null!==e&&"webkitAudioContext"===e.name&&t(n,r),Pe(r,s),r})(Rt,cn),dn=((e,t,n)=>()=>{const s=new WeakMap;return{render(r,a){const o=s.get(a);return void 0!==o?Promise.resolve(o):(async(r,a)=>{let o=t(r);if(!A(o,a)){const t={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=e(a,t)}return s.set(a,o),await n(r,a,o),o})(r,a)}}})(un,ee,Ct),hn=((e,t,n,s,r)=>class extends e{constructor(e,a){const o=s(e),i={...be,...a};super(e,!1,n(o,i),r(o)?t():null)}})(Lt,dn,un,St,Mt),mn=((e,t,n)=>()=>{const s=new WeakMap;return{render(r,a){const o=s.get(a);return void 0!==o?Promise.resolve(o):(async(r,a)=>{let o=t(r);if(!A(o,a)){const t={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=e(a,t)}return s.set(a,o),await n(r,a,o),o})(r,a)}}})(Be,ee,Ct),fn=((e,t,n,s,r,a)=>class extends e{constructor(e,o){const i=s(e),l=a({...ve,...o});super(e,!1,n(i,l),r(i)?t():null)}})(Lt,mn,Be,St,Mt,e=>({...e,channelCount:e.numberOfOutputs})),pn=((e,t,n,s)=>(r,a)=>{let{offset:o,...i}=a;const l=r.createBuffer(1,2,44100),c=t(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(r,{...i,gain:o}),d=l.getChannelData(0);d[0]=1,d[1]=1,c.buffer=l,c.loop=!0;const h={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(e){u.channelCount=e},get channelCountMode(){return u.channelCountMode},set channelCountMode(e){u.channelCountMode=e},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(e){u.channelInterpretation=e},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return c.onended},set onended(e){c.onended=e},addEventListener(){return c.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent(){return c.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener(){return c.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;c.start.call(c,e)},stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;c.stop.call(c,e)}};return e(r,c),s($e(h,u),()=>c.connect(u),()=>c.disconnect(u))})(Qt,Xt,We,ln),gn=((e,t,n,s,r)=>(a,o)=>{if(void 0===a.createConstantSource)return n(a,o);const i=a.createConstantSource();return Pe(i,o),Fe(i,o,"offset"),t(s,()=>s(a))||Le(i),t(r,()=>r(a))||qe(i),e(a,i),i})(Qt,vt,pn,ct,dt),xn=((e,t,n,s,r)=>()=>{const a=new WeakMap;let o=null,i=null;return{set start(e){o=e},set stop(e){i=e},render(l,c){const u=a.get(c);return void 0!==u?Promise.resolve(u):(async(l,c)=>{let u=n(l);const d=A(u,c);if(!d){const e={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,offset:u.offset.value};u=t(c,e),null!==o&&u.start(o),null!==i&&u.stop(i)}return a.set(c,u),d?await e(c,l.offset,u.offset):await s(c,l.offset,u.offset),await r(l,c,u),u})(l,c)}}})(Yt,gn,ee,Zt,Ct),bn=((e,t,n,s,r,a,o)=>class extends e{constructor(e,o){const i=r(e),l={...ye,...o},c=s(i,l),u=a(i),d=u?n():null;super(e,!1,c,d),this._constantSourceNodeRenderer=d,this._nativeConstantSourceNode=c,this._offset=t(this,u,c.offset,P,I),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(e){const t="function"===typeof e?o(this,e):null;this._nativeConstantSourceNode.onended=t;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===t?e:n}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeConstantSourceNode.start(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=e),"closed"!==this.context.state){N(this);const e=()=>{this._nativeConstantSourceNode.removeEventListener("ended",e),O(this)&&_(this)};this._nativeConstantSourceNode.addEventListener("ended",e)}}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}})(Lt,en,xn,gn,St,Mt,mt),vn=((e,t)=>(n,s)=>{const r=n.createConvolver();if(Pe(r,s),s.disableNormalization===r.normalize&&(r.normalize=!s.disableNormalization),Ie(r,s,"buffer"),s.channelCount>2)throw e();if(t(r,"channelCount",e=>()=>e.call(r),t=>n=>{if(n>2)throw e();return t.call(r,n)}),"max"===s.channelCountMode)throw e();return t(r,"channelCountMode",e=>()=>e.call(r),t=>n=>{if("max"===n)throw e();return t.call(r,n)}),r})(Xe,it),yn=((e,t,n)=>()=>{const s=new WeakMap;return{render(r,a){const o=s.get(a);return void 0!==o?Promise.resolve(o):(async(r,a)=>{let o=t(r);if(!A(o,a)){const t={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=e(a,t)}return s.set(a,o),Q(o)?await n(r,a,o.inputs[0]):await n(r,a,o),o})(r,a)}}})(vn,ee,Ct),wn=((e,t,n,s,r,a)=>class extends e{constructor(e,o){const i=s(e),l={...we,...o},c=n(i,l);super(e,!1,c,r(i)?t():null),this._isBufferNullified=!1,this._nativeConvolverNode=c,null!==l.buffer&&a(this,l.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){const e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,e.sampleRate),this._isBufferNullified=!0,a(this,0)}else this._isBufferNullified=!1,a(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(e){this._nativeConvolverNode.normalize=e}})(Lt,yn,vn,St,Mt,an),jn=((e,t,n,s,r)=>a=>{const o=new WeakMap;return{render(i,l){const c=o.get(l);return void 0!==c?Promise.resolve(c):(async(i,l)=>{let c=n(i);const u=A(c,l);if(!u){const e={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,delayTime:c.delayTime.value,maxDelayTime:a};c=t(l,e)}return o.set(l,c),u?await e(l,i.delayTime,c.delayTime):await s(l,i.delayTime,c.delayTime),await r(i,l,c),c})(i,l)}}})(Yt,Ue,ee,Zt,Ct),kn=((e,t,n,s,r,a,o)=>class extends e{constructor(e,i){const l=r(e),c={...ke,...i},u=s(l,c),d=a(l);super(e,!1,u,d?n(c.maxDelayTime):null),this._delayTime=t(this,d,u.delayTime),o(this,c.maxDelayTime)}get delayTime(){return this._delayTime}})(Lt,en,jn,Ue,St,Mt,an),Nn=(e=>(t,n)=>{const s=t.createDynamicsCompressor();if(Pe(s,n),n.channelCount>2)throw e();if("max"===n.channelCountMode)throw e();return Fe(s,n,"attack"),Fe(s,n,"knee"),Fe(s,n,"ratio"),Fe(s,n,"release"),Fe(s,n,"threshold"),s})(Xe),Cn=((e,t,n,s,r)=>()=>{const a=new WeakMap;return{render(o,i){const l=a.get(i);return void 0!==l?Promise.resolve(l):(async(o,i)=>{let l=n(o);const c=A(l,i);if(!c){const e={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=t(i,e)}return a.set(i,l),c?(await e(i,o.attack,l.attack),await e(i,o.knee,l.knee),await e(i,o.ratio,l.ratio),await e(i,o.release,l.release),await e(i,o.threshold,l.threshold)):(await s(i,o.attack,l.attack),await s(i,o.knee,l.knee),await s(i,o.ratio,l.ratio),await s(i,o.release,l.release),await s(i,o.threshold,l.threshold)),await r(o,i,l),l})(o,i)}}})(Yt,Nn,ee,Zt,Ct),_n=((e,t,n,s,r,a,o,i)=>class extends e{constructor(e,r){const l=a(e),c={...Ce,...r},u=s(l,c),d=o(l);super(e,!1,u,d?n():null),this._attack=t(this,d,u.attack),this._knee=t(this,d,u.knee),this._nativeDynamicsCompressorNode=u,this._ratio=t(this,d,u.ratio),this._release=t(this,d,u.release),this._threshold=t(this,d,u.threshold),i(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(e){const t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(e){const t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"===typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(Lt,en,Cn,Nn,Xe,St,Mt,an),Sn=((e,t,n,s,r)=>()=>{const a=new WeakMap;return{render(o,i){const l=a.get(i);return void 0!==l?Promise.resolve(l):(async(o,i)=>{let l=n(o);const c=A(l,i);if(!c){const e={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=t(i,e)}return a.set(i,l),c?await e(i,o.gain,l.gain):await s(i,o.gain,l.gain),await r(o,i,l),l})(o,i)}}})(Yt,We,ee,Zt,Ct),Tn=((e,t,n,s,r,a)=>class extends e{constructor(e,o){const i=r(e),l={..._e,...o},c=s(i,l),u=a(i);super(e,!1,c,u?n():null),this._gain=t(this,u,c.gain,P,I)}get gain(){return this._gain}})(Lt,en,Sn,We,St,Mt),An=((e,t,n,s)=>(r,a,o)=>{let{channelCount:i,channelCountMode:l,channelInterpretation:c,feedback:u,feedforward:d}=o;const h=Ve(a,r.sampleRate),m=u instanceof Float64Array?u:new Float64Array(u),f=d instanceof Float64Array?d:new Float64Array(d),p=m.length,g=f.length,x=Math.min(p,g);if(0===p||p>20)throw s();if(0===m[0])throw t();if(0===g||g>20)throw s();if(0===f[0])throw t();if(1!==m[0]){for(let e=0;e<g;e+=1)f[e]/=m[0];for(let e=1;e<p;e+=1)m[e]/=m[0]}const b=n(r,h,i,i);b.channelCount=i,b.channelCountMode=l,b.channelInterpretation=c;const v=[],y=[],w=[];for(let e=0;e<i;e+=1){v.push(0);const e=new Float32Array(32),t=new Float32Array(32);e.fill(0),t.fill(0),y.push(e),w.push(t)}b.onaudioprocess=e=>{const t=e.inputBuffer,n=e.outputBuffer,s=t.numberOfChannels;for(let r=0;r<s;r+=1){const e=t.getChannelData(r),s=n.getChannelData(r);v[r]=Me(m,p,f,g,x,y[r],w[r],v[r],32,e,s)}};const j=r.sampleRate/2;return $e({get bufferSize(){return h},get channelCount(){return b.channelCount},set channelCount(e){b.channelCount=e},get channelCountMode(){return b.channelCountMode},set channelCountMode(e){b.channelCountMode=e},get channelInterpretation(){return b.channelInterpretation},set channelInterpretation(e){b.channelInterpretation=e},get context(){return b.context},get inputs(){return[b]},get numberOfInputs(){return b.numberOfInputs},get numberOfOutputs(){return b.numberOfOutputs},addEventListener(){return b.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent(){return b.dispatchEvent(arguments.length<=0?void 0:arguments[0])},getFrequencyResponse(t,n,s){if(t.length!==n.length||n.length!==s.length)throw e();const r=t.length;for(let e=0;e<r;e+=1){const r=-Math.PI*(t[e]/j),a=[Math.cos(r),Math.sin(r)],o=He(Ke(f,a),Ke(m,a));n[e]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),s[e]=Math.atan2(o[1],o[0])}},removeEventListener(){return b.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},b)})(Te,Se,Ye,Xe),Mn=((e,t,n,s)=>r=>e(De,()=>De(r))?Promise.resolve(e(s,s)).then(e=>{if(!e){const e=n(r,512,0,1);r.oncomplete=()=>{e.onaudioprocess=null,e.disconnect()},e.onaudioprocess=()=>r.currentTime,e.connect(r.destination)}return r.startRendering()}):new Promise(e=>{const n=t(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=t=>{n.disconnect(),e(t.renderedBuffer)},n.connect(r.destination),r.startRendering()}))(vt,We,Ye,((e,t)=>()=>{if(null===t)return Promise.resolve(!1);const n=new t(1,1,44100),s=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(e=>{n.oncomplete=()=>{s.disconnect(),e(0!==n.currentTime)},n.startRendering()})})(We,At)),En=((e,t,n,s,r)=>(a,o)=>{const i=new WeakMap;let l=null;const c=async(c,u)=>{let d=null,h=t(c);const m=A(h,u);if(void 0===u.createIIRFilter?d=e(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(h=u.createIIRFilter(o,a)),i.set(u,null===d?h:d),null!==d){if(null===l){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const e=new n(c.context.destination.channelCount,c.context.length,u.sampleRate);l=(async()=>{await s(c,e,e.destination);return((e,t,n,s)=>{const r=n instanceof Float64Array?n:new Float64Array(n),a=s instanceof Float64Array?s:new Float64Array(s),o=r.length,i=a.length,l=Math.min(o,i);if(1!==r[0]){for(let e=0;e<o;e+=1)a[e]/=r[0];for(let e=1;e<i;e+=1)r[e]/=r[0]}const c=new Float32Array(32),u=new Float32Array(32),d=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),h=e.numberOfChannels;for(let m=0;m<h;m+=1){const t=e.getChannelData(m),n=d.getChannelData(m);c.fill(0),u.fill(0),Me(r,o,a,i,l,c,u,0,32,t,n)}return d})(await r(e),u,a,o)})()}const e=await l;return d.buffer=e,d.start(0),d}return await s(c,u,h),h};return{render(e,t){const n=i.get(t);return void 0!==n?Promise.resolve(n):c(e,t)}}})(Xt,ee,At,Ct,Mn),Dn=(e=>(t,n,s)=>{if(void 0===t.createIIRFilter)return e(t,n,s);const r=t.createIIRFilter(s.feedforward,s.feedback);return Pe(r,s),r})(An),Rn=((e,t,n,s,r,a)=>class extends e{constructor(e,o){const i=s(e),l=r(i),c={...Ae,...o},u=t(i,l?null:e.baseLatency,c);super(e,!1,u,l?n(c.feedback,c.feedforward):null),(e=>{var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,(n,s,r)=>{if(n.length!==s.length||s.length!==r.length)throw Te();return t.call(e,n,s,r)})})(u),this._nativeIIRFilterNode=u,a(this,1)}getFrequencyResponse(e,t,n){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,n)}})(Lt,Dn,En,St,Mt,an),In=((e,t,n,s,r,a,o,i)=>(l,c)=>{const u=c.listener,{forwardX:d,forwardY:h,forwardZ:m,positionX:f,positionY:p,positionZ:g,upX:x,upY:b,upZ:v}=void 0===u.forwardX?(()=>{const d=new Float32Array(1),h=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),m=o(c);let f=!1,p=[0,0,-1,0,1,0],g=[0,0,0];const x=()=>{if(f)return;f=!0;const e=s(c,256,9,0);e.onaudioprocess=e=>{let{inputBuffer:t}=e;const n=[a(t,d,0),a(t,d,1),a(t,d,2),a(t,d,3),a(t,d,4),a(t,d,5)];n.some((e,t)=>e!==p[t])&&(u.setOrientation(...n),p=n);const s=[a(t,d,6),a(t,d,7),a(t,d,8)];s.some((e,t)=>e!==g[t])&&(u.setPosition(...s),g=s)},h.connect(e)},b=e=>t=>{t!==p[e]&&(p[e]=t,u.setOrientation(...p))},v=e=>t=>{t!==g[e]&&(g[e]=t,u.setPosition(...g))},y=(t,s,a)=>{const o=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:s});o.connect(h,0,t),o.start(),Object.defineProperty(o.offset,"defaultValue",{get:()=>s});const u=e({context:l},m,o.offset,P,I);var d,f,p,g,b,v,y;return i(u,"value",e=>()=>e.call(u),e=>t=>{try{e.call(u,t)}catch(n){if(9!==n.code)throw n}x(),m&&a(t)}),u.cancelAndHoldAtTime=(d=u.cancelAndHoldAtTime,m?()=>{throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=d.apply(u,t);return x(),s}),u.cancelScheduledValues=(f=u.cancelScheduledValues,m?()=>{throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=f.apply(u,t);return x(),s}),u.exponentialRampToValueAtTime=(p=u.exponentialRampToValueAtTime,m?()=>{throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=p.apply(u,t);return x(),s}),u.linearRampToValueAtTime=(g=u.linearRampToValueAtTime,m?()=>{throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=g.apply(u,t);return x(),s}),u.setTargetAtTime=(b=u.setTargetAtTime,m?()=>{throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=b.apply(u,t);return x(),s}),u.setValueAtTime=(v=u.setValueAtTime,m?()=>{throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=v.apply(u,t);return x(),s}),u.setValueCurveAtTime=(y=u.setValueCurveAtTime,m?()=>{throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=y.apply(u,t);return x(),s}),u};return{forwardX:y(0,0,b(0)),forwardY:y(1,0,b(1)),forwardZ:y(2,-1,b(2)),positionX:y(6,0,v(0)),positionY:y(7,0,v(1)),positionZ:y(8,0,v(2)),upX:y(3,0,b(3)),upY:y(4,1,b(4)),upZ:y(5,0,b(5))}})():u;return{get forwardX(){return d},get forwardY(){return h},get forwardZ(){return m},get positionX(){return f},get positionY(){return p},get positionZ(){return g},get upX(){return x},get upY(){return b},get upZ(){return v}}})(en,un,gn,Ye,Xe,at,Mt,it),Pn=new WeakMap,On=((e,t,n,s,r,a)=>class extends n{constructor(n,a){super(n),this._nativeContext=n,u.set(this,n),s(n)&&r.set(n,new Set),this._destination=new e(this,a),this._listener=t(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(e){const t="function"===typeof e?a(this,e):null;this._nativeContext.onstatechange=t;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===t?e:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(sn,In,Dt,Mt,Pn,mt),Fn=((e,t,n,s,r,a)=>(o,i)=>{const l=o.createOscillator();return Pe(l,i),Fe(l,i,"detune"),Fe(l,i,"frequency"),void 0!==i.periodicWave?l.setPeriodicWave(i.periodicWave):Ie(l,i,"type"),t(n,()=>n(o))||Le(l),t(s,()=>s(o))||a(l,o),t(r,()=>r(o))||qe(l),e(o,l),l})(Qt,vt,ct,ut,dt,ht),Ln=((e,t,n,s,r)=>()=>{const a=new WeakMap;let o=null,i=null,l=null;return{set periodicWave(e){o=e},set start(e){i=e},set stop(e){l=e},render(c,u){const d=a.get(u);return void 0!==d?Promise.resolve(d):(async(c,u)=>{let d=n(c);const h=A(d,u);if(!h){const e={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:null===o?void 0:o,type:d.type};d=t(u,e),null!==i&&d.start(i),null!==l&&d.stop(l)}return a.set(u,d),h?(await e(u,c.detune,d.detune),await e(u,c.frequency,d.frequency)):(await s(u,c.detune,d.detune),await s(u,c.frequency,d.frequency)),await r(c,u,d),d})(c,u)}}})(Yt,Fn,ee,Zt,Ct),qn=((e,t,n,s,r,a,o)=>class extends e{constructor(e,o){const i=r(e),l={...Je,...o},c=n(i,l),u=a(i),d=u?s():null,h=e.sampleRate/2;super(e,!1,c,d),this._detune=t(this,u,c.detune,153600,-153600),this._frequency=t(this,u,c.frequency,h,-h),this._nativeOscillatorNode=c,this._onended=null,this._oscillatorNodeRenderer=d,null!==this._oscillatorNodeRenderer&&void 0!==l.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=l.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(e){const t="function"===typeof e?o(this,e):null;this._nativeOscillatorNode.onended=t;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===t?e:n}get type(){return this._nativeOscillatorNode.type}set type(e){this._nativeOscillatorNode.type=e,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeOscillatorNode.start(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=e),"closed"!==this.context.state){N(this);const e=()=>{this._nativeOscillatorNode.removeEventListener("ended",e),O(this)&&_(this)};this._nativeOscillatorNode.addEventListener("ended",e)}}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}})(Lt,en,Fn,Ln,St,Mt,mt),Vn=(e=>(t,n)=>{const s=e(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=t.createBuffer(1,2,44100);return s.buffer=r,s.loop=!0,s.connect(n),s.start(),()=>{s.stop(),s.disconnect(n)}})(Xt),zn=((e,t,n,s,r)=>(a,o)=>{let{curve:i,oversample:l,...c}=o;const u=a.createWaveShaper(),d=a.createWaveShaper();Pe(u,c),Pe(d,c);const h=n(a,{...c,gain:1}),m=n(a,{...c,gain:-1}),f=n(a,{...c,gain:1}),p=n(a,{...c,gain:-1});let g=null,x=!1,b=null;const v={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(e){h.channelCount=e,m.channelCount=e,u.channelCount=e,f.channelCount=e,d.channelCount=e,p.channelCount=e},get channelCountMode(){return u.channelCountMode},set channelCountMode(e){h.channelCountMode=e,m.channelCountMode=e,u.channelCountMode=e,f.channelCountMode=e,d.channelCountMode=e,p.channelCountMode=e},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(e){h.channelInterpretation=e,m.channelInterpretation=e,u.channelInterpretation=e,f.channelInterpretation=e,d.channelInterpretation=e,p.channelInterpretation=e},get context(){return u.context},get curve(){return b},set curve(n){if(null!==n&&n.length<2)throw t();if(null===n)u.curve=n,d.curve=n;else{const e=n.length,t=new Float32Array(e+2-e%2),s=new Float32Array(e+2-e%2);t[0]=n[0],s[0]=-n[e-1];const r=Math.ceil((e+1)/2),a=(e+1)/2-1;for(let o=1;o<r;o+=1){const i=o/r*a,l=Math.floor(i),c=Math.ceil(i);t[o]=l===c?n[l]:(1-(i-l))*n[l]+(1-(c-i))*n[c],s[o]=l===c?-n[e-1-l]:-(1-(i-l))*n[e-1-l]-(1-(c-i))*n[e-1-c]}t[r]=e%2===1?n[r-1]:(n[r-2]+n[r-1])/2,u.curve=t,d.curve=s}b=n,x&&(s(b)&&null===g?g=e(a,h):null!==g&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(e){u.oversample=e,d.oversample=e},addEventListener(){return h.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent(){return h.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener(){return h.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};null!==i&&(v.curve=i instanceof Float32Array?i:new Float32Array(i)),l!==v.oversample&&(v.oversample=l);return r($e(v,f),()=>{h.connect(u).connect(f),h.connect(m).connect(d).connect(p).connect(f),x=!0,s(b)&&(g=e(a,h))},()=>{h.disconnect(u),u.disconnect(f),h.disconnect(m),m.disconnect(d),d.disconnect(p),p.disconnect(f),x=!1,null!==g&&(g(),g=null)})})(Vn,Se,We,ot,ln),Gn=((e,t,n,s,r,a,o)=>(i,l)=>{const c=i.createWaveShaper();if(null!==a&&"webkitAudioContext"===a.name&&void 0===i.createGain().gain.automationRate)return n(i,l);Pe(c,l);const u=null===l.curve||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(null!==u&&u.length<2)throw t();Ie(c,{curve:u},"curve"),Ie(c,l,"oversample");let d=null,h=!1;o(c,"curve",e=>()=>e.call(c),t=>n=>(t.call(c,n),h&&(s(n)&&null===d?d=e(i,c):s(n)||null===d||(d(),d=null)),n));return r(c,()=>{h=!0,s(c.curve)&&(d=e(i,c))},()=>{h=!1,null!==d&&(d(),d=null)})})(Vn,Se,zn,ot,ln,Rt,it),Bn=((e,t,n,s,r,a,o,i,l,c)=>(u,d)=>{let{coneInnerAngle:h,coneOuterAngle:m,coneOuterGain:f,distanceModel:p,maxDistance:g,orientationX:x,orientationY:b,orientationZ:v,panningModel:y,positionX:w,positionY:j,positionZ:k,refDistance:N,rolloffFactor:C,..._}=d;const S=u.createPanner();if(_.channelCount>2)throw o();if("max"===_.channelCountMode)throw o();Pe(S,_);const T={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},A=n(u,{...T,channelInterpretation:"speakers",numberOfInputs:6}),M=s(u,{..._,gain:1}),E=s(u,{...T,gain:1}),D=s(u,{...T,gain:0}),R=s(u,{...T,gain:0}),I=s(u,{...T,gain:0}),P=s(u,{...T,gain:0}),O=s(u,{...T,gain:0}),F=r(u,256,6,1),L=a(u,{...T,curve:new Float32Array([1,1]),oversample:"none"});let q=[x,b,v],V=[w,j,k];const z=new Float32Array(1);F.onaudioprocess=e=>{let{inputBuffer:t}=e;const n=[l(t,z,0),l(t,z,1),l(t,z,2)];n.some((e,t)=>e!==q[t])&&(S.setOrientation(...n),q=n);const s=[l(t,z,3),l(t,z,4),l(t,z,5)];s.some((e,t)=>e!==V[t])&&(S.setPosition(...s),V=s)},Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"defaultValue",{get:()=>0});const G={get bufferSize(){},get channelCount(){return S.channelCount},set channelCount(e){if(e>2)throw o();M.channelCount=e,S.channelCount=e},get channelCountMode(){return S.channelCountMode},set channelCountMode(e){if("max"===e)throw o();M.channelCountMode=e,S.channelCountMode=e},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(e){M.channelInterpretation=e,S.channelInterpretation=e},get coneInnerAngle(){return S.coneInnerAngle},set coneInnerAngle(e){S.coneInnerAngle=e},get coneOuterAngle(){return S.coneOuterAngle},set coneOuterAngle(e){S.coneOuterAngle=e},get coneOuterGain(){return S.coneOuterGain},set coneOuterGain(e){if(e<0||e>1)throw t();S.coneOuterGain=e},get context(){return S.context},get distanceModel(){return S.distanceModel},set distanceModel(e){S.distanceModel=e},get inputs(){return[M]},get maxDistance(){return S.maxDistance},set maxDistance(e){if(e<0)throw new RangeError;S.maxDistance=e},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},get orientationX(){return E.gain},get orientationY(){return D.gain},get orientationZ(){return R.gain},get panningModel(){return S.panningModel},set panningModel(e){S.panningModel=e},get positionX(){return I.gain},get positionY(){return P.gain},get positionZ(){return O.gain},get refDistance(){return S.refDistance},set refDistance(e){if(e<0)throw new RangeError;S.refDistance=e},get rolloffFactor(){return S.rolloffFactor},set rolloffFactor(e){if(e<0)throw new RangeError;S.rolloffFactor=e},addEventListener(){return M.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent(){return M.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener(){return M.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};h!==G.coneInnerAngle&&(G.coneInnerAngle=h),m!==G.coneOuterAngle&&(G.coneOuterAngle=m),f!==G.coneOuterGain&&(G.coneOuterGain=f),p!==G.distanceModel&&(G.distanceModel=p),g!==G.maxDistance&&(G.maxDistance=g),x!==G.orientationX.value&&(G.orientationX.value=x),b!==G.orientationY.value&&(G.orientationY.value=b),v!==G.orientationZ.value&&(G.orientationZ.value=v),y!==G.panningModel&&(G.panningModel=y),w!==G.positionX.value&&(G.positionX.value=w),j!==G.positionY.value&&(G.positionY.value=j),k!==G.positionZ.value&&(G.positionZ.value=k),N!==G.refDistance&&(G.refDistance=N),C!==G.rolloffFactor&&(G.rolloffFactor=C),1===q[0]&&0===q[1]&&0===q[2]||S.setOrientation(...q),0===V[0]&&0===V[1]&&0===V[2]||S.setPosition(...V);return c($e(G,S),()=>{M.connect(S),e(M,L,0,0),L.connect(E).connect(A,0,0),L.connect(D).connect(A,0,1),L.connect(R).connect(A,0,2),L.connect(I).connect(A,0,3),L.connect(P).connect(A,0,4),L.connect(O).connect(A,0,5),A.connect(F).connect(u.destination)},()=>{M.disconnect(S),i(M,L,0,0),L.disconnect(E),E.disconnect(A),L.disconnect(D),D.disconnect(A),L.disconnect(R),R.disconnect(A),L.disconnect(I),I.disconnect(A),L.disconnect(P),P.disconnect(A),L.disconnect(O),O.disconnect(A),A.disconnect(F),F.disconnect(u.destination)})})(K,Se,un,We,Ye,Gn,Xe,J,at,ln),$n=(e=>(t,n)=>{const s=t.createPanner();return void 0===s.orientationX?e(t,n):(Pe(s,n),Fe(s,n,"orientationX"),Fe(s,n,"orientationY"),Fe(s,n,"orientationZ"),Fe(s,n,"positionX"),Fe(s,n,"positionY"),Fe(s,n,"positionZ"),Ie(s,n,"coneInnerAngle"),Ie(s,n,"coneOuterAngle"),Ie(s,n,"coneOuterGain"),Ie(s,n,"distanceModel"),Ie(s,n,"maxDistance"),Ie(s,n,"panningModel"),Ie(s,n,"refDistance"),Ie(s,n,"rolloffFactor"),s)})(Bn),Un=((e,t,n,s,r,a,o,i,l,c)=>()=>{const u=new WeakMap;let d=null;return{render(h,m){const f=u.get(m);return void 0!==f?Promise.resolve(f):(async(h,m)=>{let f=null,p=a(h);const g={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation},x={...g,coneInnerAngle:p.coneInnerAngle,coneOuterAngle:p.coneOuterAngle,coneOuterGain:p.coneOuterGain,distanceModel:p.distanceModel,maxDistance:p.maxDistance,panningModel:p.panningModel,refDistance:p.refDistance,rolloffFactor:p.rolloffFactor},b=A(p,m);if("bufferSize"in p)f=s(m,{...g,gain:1});else if(!b){const e={...x,orientationX:p.orientationX.value,orientationY:p.orientationY.value,orientationZ:p.orientationZ.value,positionX:p.positionX.value,positionY:p.positionY.value,positionZ:p.positionZ.value};p=r(m,e)}if(u.set(m,null===f?p:f),null!==f){if(null===d){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const e=new o(6,h.context.length,m.sampleRate),s=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});s.connect(e.destination),d=(async()=>{const t=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(t,s)=>{const r=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===s?1:0});return await i(e,t,r.offset),r}));for(let e=0;e<6;e+=1)t[e].connect(s,0,e),t[e].start(0);return c(e)})()}const e=await d,a=s(m,{...g,gain:1});await l(h,m,a);const u=[];for(let t=0;t<e.numberOfChannels;t+=1)u.push(e.getChannelData(t));let p=[u[0][0],u[1][0],u[2][0]],b=[u[3][0],u[4][0],u[5][0]],v=s(m,{...g,gain:1}),y=r(m,{...x,orientationX:p[0],orientationY:p[1],orientationZ:p[2],positionX:b[0],positionY:b[1],positionZ:b[2]});a.connect(v).connect(y.inputs[0]),y.connect(f);for(let t=128;t<e.length;t+=128){const e=[u[0][t],u[1][t],u[2][t]],n=[u[3][t],u[4][t],u[5][t]];if(e.some((e,t)=>e!==p[t])||n.some((e,t)=>e!==b[t])){p=e,b=n;const o=t/m.sampleRate;v.gain.setValueAtTime(0,o),v=s(m,{...g,gain:0}),y=r(m,{...x,orientationX:p[0],orientationY:p[1],orientationZ:p[2],positionX:b[0],positionY:b[1],positionZ:b[2]}),v.gain.setValueAtTime(1,o),a.connect(v).connect(y.inputs[0]),y.connect(f)}}return f}return b?(await e(m,h.orientationX,p.orientationX),await e(m,h.orientationY,p.orientationY),await e(m,h.orientationZ,p.orientationZ),await e(m,h.positionX,p.positionX),await e(m,h.positionY,p.positionY),await e(m,h.positionZ,p.positionZ)):(await i(m,h.orientationX,p.orientationX),await i(m,h.orientationY,p.orientationY),await i(m,h.orientationZ,p.orientationZ),await i(m,h.positionX,p.positionX),await i(m,h.positionY,p.positionY),await i(m,h.positionZ,p.positionZ)),Q(p)?await l(h,m,p.inputs[0]):await l(h,m,p),p})(h,m)}}})(Yt,un,gn,We,$n,ee,At,Zt,Ct,Mn),Wn=((e,t,n,s,r,a,o)=>class extends e{constructor(e,i){const l=r(e),c={...et,...i},u=n(l,c),d=a(l);super(e,!1,u,d?s():null),this._nativePannerNode=u,this._orientationX=t(this,d,u.orientationX,P,I),this._orientationY=t(this,d,u.orientationY,P,I),this._orientationZ=t(this,d,u.orientationZ,P,I),this._positionX=t(this,d,u.positionX,P,I),this._positionY=t(this,d,u.positionY,P,I),this._positionZ=t(this,d,u.positionZ,P,I),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(e){this._nativePannerNode.coneInnerAngle=e}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(e){this._nativePannerNode.coneOuterAngle=e}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(e){this._nativePannerNode.coneOuterGain=e}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(e){this._nativePannerNode.distanceModel=e}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(e){this._nativePannerNode.maxDistance=e}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(e){this._nativePannerNode.panningModel=e}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(e){this._nativePannerNode.refDistance=e}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(e){this._nativePannerNode.rolloffFactor=e}})(Lt,en,$n,Un,St,Mt,an),Hn=(e=>(t,n)=>{let{disableNormalization:s,imag:r,real:a}=n;const o=r instanceof Float32Array?r:new Float32Array(r),i=a instanceof Float32Array?a:new Float32Array(a),l=t.createPeriodicWave(i,o,{disableNormalization:s});if(Array.from(r).length<2)throw e();return l})(E),Qn=((e,t,n,s)=>class r{constructor(r,a){const o=t(r),i=s({...tt,...a}),l=e(o,i);return n.add(l),l}static[Symbol.hasInstance](e){return null!==e&&"object"===typeof e&&Object.getPrototypeOf(e)===r.prototype||n.has(e)}})(Hn,St,new WeakSet,e=>{const{imag:t,real:n}=e;return void 0===t?void 0===n?{...e,imag:[0,0],real:[0,0]}:{...e,imag:Array.from(n,()=>0),real:n}:void 0===n?{...e,imag:t,real:Array.from(t,()=>0)}:{...e,imag:t,real:n}}),Kn=((e,t,n,s,r,a)=>{const o=16385,i=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},d=(e,a,d,h,m)=>{if(1===a)return((e,t,r,a)=>{const d=new Float32Array(o),h=new Float32Array(o);for(let n=0;n<o;n+=1){const e=n/16384*l;d[n]=Math.cos(e),h[n]=Math.sin(e)}const m=n(e,{...c,gain:0}),f=s(e,{...u,curve:d}),p=s(e,{...u,curve:i}),g=n(e,{...c,gain:0}),x=s(e,{...u,curve:h});return{connectGraph(){t.connect(m),t.connect(void 0===p.inputs?p:p.inputs[0]),t.connect(g),p.connect(r),r.connect(void 0===f.inputs?f:f.inputs[0]),r.connect(void 0===x.inputs?x:x.inputs[0]),f.connect(m.gain),x.connect(g.gain),m.connect(a,0,0),g.connect(a,0,1)},disconnectGraph(){t.disconnect(m),t.disconnect(void 0===p.inputs?p:p.inputs[0]),t.disconnect(g),p.disconnect(r),r.disconnect(void 0===f.inputs?f:f.inputs[0]),r.disconnect(void 0===x.inputs?x:x.inputs[0]),f.disconnect(m.gain),x.disconnect(g.gain),m.disconnect(a,0,0),g.disconnect(a,0,1)}}})(e,d,h,m);if(2===a)return((e,r,a,d)=>{const h=new Float32Array(o),m=new Float32Array(o),f=new Float32Array(o),p=new Float32Array(o),g=Math.floor(8192.5);for(let t=0;t<o;t+=1)if(t>g){const e=(t-g)/(16384-g)*l;h[t]=Math.cos(e),m[t]=Math.sin(e),f[t]=0,p[t]=1}else{const e=t/(16384-g)*l;h[t]=1,m[t]=0,f[t]=Math.cos(e),p[t]=Math.sin(e)}const x=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),b=n(e,{...c,gain:0}),v=s(e,{...u,curve:h}),y=n(e,{...c,gain:0}),w=s(e,{...u,curve:m}),j=s(e,{...u,curve:i}),k=n(e,{...c,gain:0}),N=s(e,{...u,curve:f}),C=n(e,{...c,gain:0}),_=s(e,{...u,curve:p});return{connectGraph(){r.connect(x),r.connect(void 0===j.inputs?j:j.inputs[0]),x.connect(b,0),x.connect(y,0),x.connect(k,1),x.connect(C,1),j.connect(a),a.connect(void 0===v.inputs?v:v.inputs[0]),a.connect(void 0===w.inputs?w:w.inputs[0]),a.connect(void 0===N.inputs?N:N.inputs[0]),a.connect(void 0===_.inputs?_:_.inputs[0]),v.connect(b.gain),w.connect(y.gain),N.connect(k.gain),_.connect(C.gain),b.connect(d,0,0),k.connect(d,0,0),y.connect(d,0,1),C.connect(d,0,1)},disconnectGraph(){r.disconnect(x),r.disconnect(void 0===j.inputs?j:j.inputs[0]),x.disconnect(b,0),x.disconnect(y,0),x.disconnect(k,1),x.disconnect(C,1),j.disconnect(a),a.disconnect(void 0===v.inputs?v:v.inputs[0]),a.disconnect(void 0===w.inputs?w:w.inputs[0]),a.disconnect(void 0===N.inputs?N:N.inputs[0]),a.disconnect(void 0===_.inputs?_:_.inputs[0]),v.disconnect(b.gain),w.disconnect(y.gain),N.disconnect(k.gain),_.disconnect(C.gain),b.disconnect(d,0,0),k.disconnect(d,0,0),y.disconnect(d,0,1),C.disconnect(d,0,1)}}})(e,d,h,m);throw r()};return(t,s)=>{let{channelCount:o,channelCountMode:i,pan:l,...c}=s;if("max"===i)throw r();const u=e(t,{...c,channelCount:1,channelCountMode:i,numberOfInputs:2}),h=n(t,{...c,channelCount:o,channelCountMode:i,gain:1}),m=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:l});let{connectGraph:f,disconnectGraph:p}=d(t,o,h,m,u);Object.defineProperty(m.gain,"defaultValue",{get:()=>0}),Object.defineProperty(m.gain,"maxValue",{get:()=>1}),Object.defineProperty(m.gain,"minValue",{get:()=>-1});const g={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(e){h.channelCount!==e&&(x&&p(),({connectGraph:f,disconnectGraph:p}=d(t,e,h,m,u)),x&&f()),h.channelCount=e},get channelCountMode(){return h.channelCountMode},set channelCountMode(e){if("clamped-max"===e||"max"===e)throw r();h.channelCountMode=e},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(e){h.channelInterpretation=e},get context(){return h.context},get inputs(){return[h]},get numberOfInputs(){return h.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get pan(){return m.gain},addEventListener(){return h.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent(){return h.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener(){return h.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};let x=!1;return a($e(g,u),()=>{f(),x=!0},()=>{p(),x=!1})}})(un,Be,We,Gn,Xe,ln),Yn=((e,t)=>(n,s)=>{const r=s.channelCountMode;if("clamped-max"===r)throw t();if(void 0===n.createStereoPanner)return e(n,s);const a=n.createStereoPanner();return Pe(a,s),Fe(a,s,"pan"),Object.defineProperty(a,"channelCountMode",{get:()=>r,set:e=>{if(e!==r)throw t()}}),a})(Kn,Xe),Xn=((e,t,n,s,r)=>()=>{const a=new WeakMap;return{render(o,i){const l=a.get(i);return void 0!==l?Promise.resolve(l):(async(o,i)=>{let l=n(o);const c=A(l,i);if(!c){const e={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=t(i,e)}return a.set(i,l),c?await e(i,o.pan,l.pan):await s(i,o.pan,l.pan),Q(l)?await r(o,i,l.inputs[0]):await r(o,i,l),l})(o,i)}}})(Yt,Yn,ee,Zt,Ct),Zn=((e,t,n,s,r,a)=>class extends e{constructor(e,o){const i=r(e),l={...nt,...o},c=n(i,l),u=a(i);super(e,!1,c,u?s():null),this._pan=t(this,u,c.pan)}get pan(){return this._pan}})(Lt,en,Yn,Xn,St,Mt),Jn=((e,t,n)=>()=>{const s=new WeakMap;return{render(r,a){const o=s.get(a);return void 0!==o?Promise.resolve(o):(async(r,a)=>{let o=t(r);if(!A(o,a)){const t={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=e(a,t)}return s.set(a,o),Q(o)?await n(r,a,o.inputs[0]):await n(r,a,o),o})(r,a)}}})(Gn,ee,Ct),es=((e,t,n,s,r,a,o)=>class extends e{constructor(e,t){const i=r(e),l={...rt,...t},c=n(i,l);super(e,!0,c,a(i)?s():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=c,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(e){this._nativeWaveShaperNode.oversample=e}})(Lt,Se,Gn,Jn,St,Mt,an),ts=(e=>null!==e&&e.isSecureContext)(jt),ns=(e=>(t,n,s)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get:()=>Math.round(t*n)},currentTime:{configurable:!0,get:()=>t}});try{return s()}finally{null!==e&&(delete e.currentFrame,delete e.currentTime)}})(jt),ss=new WeakMap,rs=((e,t)=>n=>{let s=e.get(n);if(void 0!==s)return s;if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");return s=new t(1,1,44100),e.set(n,s),s})(ss,At),as=ts?((e,t,n,s,r,a,o,i,l,c,u,d,h)=>{let f=0;return function(p,g){let y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{credentials:"omit"};const w=u.get(p);if(void 0!==w&&w.has(g))return Promise.resolve();const j=c.get(p);if(void 0!==j){const e=j.get(g);if(void 0!==e)return e}const k=a(p),N=void 0===k.audioWorklet?r(g).then(e=>{let[t,s]=e;const[r,a]=x(t,s);return n(`${r};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${a}\n})})(window,'_AWGS')`)}).then(()=>{const e=h._AWGS.pop();if(void 0===e)throw new SyntaxError;s(k.currentTime,k.sampleRate,()=>e(class{},void 0,(e,n)=>{if(""===e.trim())throw t();const s=m.get(k);if(void 0!==s){if(s.has(e))throw t();v(n),b(n.parameterDescriptors),s.set(e,n)}else v(n),b(n.parameterDescriptors),m.set(k,new Map([[e,n]]))},k.sampleRate,void 0,void 0))}):Promise.all([r(g),Promise.resolve(e(d,d))]).then(e=>{let[[t,n],s]=e;const r=f+1;f=r;const[a,c]=x(t,n),u=new Blob([`${a};((AudioWorkletProcessor,registerProcessor)=>{${c}\n})(${s?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${s?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${s?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${r}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),d=URL.createObjectURL(u);return k.audioWorklet.addModule(d,y).then(()=>{if(i(k))return k;const e=o(k);return e.audioWorklet.addModule(d,y).then(()=>e)}).then(e=>{if(null===l)throw new SyntaxError;try{new l(e,`__sac${r}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(d))});return void 0===j?c.set(p,new Map([[g,N]])):j.set(g,N),N.then(()=>{const e=u.get(p);void 0===e?u.set(p,new Set([g])):e.add(g)}).finally(()=>{const e=c.get(p);void 0!==e&&e.delete(g)}),N}})(vt,Xe,(e=>t=>new Promise((n,s)=>{if(null===e)return void s(new SyntaxError);const r=e.document.head;if(null===r)s(new SyntaxError);else{const a=e.document.createElement("script"),o=new Blob([t],{type:"application/javascript"}),i=URL.createObjectURL(o),l=e.onerror,c=()=>{e.onerror=l,URL.revokeObjectURL(i)};e.onerror=(t,n,r,a,o)=>n===i||n===e.location.href&&1===r&&1===a?(c(),s(o),!1):null!==l?l(t,n,r,a,o):void 0,a.onerror=()=>{c(),s(new SyntaxError)},a.onload=()=>{c(),n()},a.src=i,a.type="module",r.appendChild(a)}}))(jt),ns,(e=>async t=>{try{const e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw e()})(()=>new DOMException("","AbortError")),St,rs,Mt,Ft,new WeakMap,new WeakMap,((e,t)=>async()=>{if(null===e)return!0;if(null===t)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new t(1,128,44100),r=URL.createObjectURL(n);let a=!1,o=!1;try{await s.audioWorklet.addModule(r);const t=new e(s,"a",{numberOfOutputs:0}),n=s.createOscillator();t.port.onmessage=()=>a=!0,t.onprocessorerror=()=>o=!0,n.connect(t),n.start(0),await s.startRendering(),await new Promise(e=>setTimeout(e))}catch{}finally{URL.revokeObjectURL(r)}return a&&!o})(Ft,At),jt):void 0,os=((e,t)=>n=>e(n)||t(n))(It,Mt),is=((e,t,n,s,r,a,o,i,l,c,u)=>(d,h)=>{const m=o(d)?d:a(d);if(r.has(h)){const e=n();return Promise.reject(e)}try{r.add(h)}catch{}return t(l,()=>l(m))?m.decodeAudioData(h).then(n=>(je(h).catch(()=>{}),t(i,()=>i(n))||u(n),e.add(n),n)):new Promise((t,n)=>{const r=async()=>{try{await je(h)}catch{}},a=e=>{n(e),r()};try{m.decodeAudioData(h,n=>{"function"!==typeof n.copyFromChannel&&(c(n),D(n)),e.add(n),r().then(()=>t(n))},e=>{a(null===e?s():e)})}catch(o){a(o)}})})(zt,vt,()=>new DOMException("","DataCloneError"),()=>new DOMException("","EncodingError"),new WeakSet,St,os,M,De,Ut,Wt),ls=((e,t,n,s,r,a,o,i,l,c,u,d,h,m,f,p,g,x,b,v)=>class extends f{constructor(t,n){super(t,n),this._nativeContext=t,this._audioWorklet=void 0===e?void 0:{addModule:(t,n)=>e(this,t,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new r(this)}createBuffer(e,t,s){return new n({length:t,numberOfChannels:e,sampleRate:s})}createBufferSource(){return new s(this)}createChannelMerger(){return new a(this,{numberOfInputs:arguments.length>0&&void 0!==arguments[0]?arguments[0]:6})}createChannelSplitter(){return new o(this,{numberOfOutputs:arguments.length>0&&void 0!==arguments[0]?arguments[0]:6})}createConstantSource(){return new i(this)}createConvolver(){return new l(this)}createDelay(){return new u(this,{maxDelayTime:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1})}createDynamicsCompressor(){return new d(this)}createGain(){return new h(this)}createIIRFilter(e,t){return new m(this,{feedback:t,feedforward:e})}createOscillator(){return new p(this)}createPanner(){return new g(this)}createPeriodicWave(e,t){return new x(this,{...arguments.length>2&&void 0!==arguments[2]?arguments[2]:{disableNormalization:!1},imag:t,real:e})}createStereoPanner(){return new b(this)}createWaveShaper(){return new v(this)}decodeAudioData(e,t,n){return c(this._nativeContext,e).then(e=>("function"===typeof t&&t(e),e),e=>{throw"function"===typeof n&&n(e),e})}})(as,Vt,Ht,nn,on,hn,fn,bn,wn,is,kn,_n,Tn,Rn,On,qn,Wn,Qn,Zn,es),cs=((e,t,n,s)=>class extends e{constructor(e,r){const a=n(e),o=t(a,r);if(s(a))throw TypeError();super(e,!0,o,null),this._nativeMediaElementAudioSourceNode=o}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(Lt,(e,t)=>e.createMediaElementSource(t.mediaElement),St,Mt),us=((e,t,n,s)=>class extends e{constructor(e,r){const a=n(e);if(s(a))throw new TypeError;const o={...Ee,...r},i=t(a,o);super(e,!1,i,null),this._nativeMediaStreamAudioDestinationNode=i}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(Lt,(e,t)=>{const n=e.createMediaStreamDestination();return Pe(n,t),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},St,Mt),ds=((e,t,n,s)=>class extends e{constructor(e,r){const a=n(e),o=t(a,r);if(s(a))throw new TypeError;super(e,!0,o,null),this._nativeMediaStreamAudioSourceNode=o}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(Lt,(e,t)=>{let{mediaStream:n}=t;const s=n.getAudioTracks();s.sort((e,t)=>e.id<t.id?-1:e.id>t.id?1:0);const r=s.slice(0,1),a=e.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(a,"mediaStream",{value:n}),a},St,Mt),hs=((e,t)=>(n,s)=>{let{mediaStreamTrack:r}=s;if("function"===typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(r);const a=new MediaStream([r]),o=n.createMediaStreamSource(a);if("audio"!==r.kind)throw e();if(t(n))throw new TypeError;return o})(Se,Mt),ms=((e,t,n)=>class extends e{constructor(e,s){const r=n(e);super(e,!0,t(r,s),null)}})(Lt,hs,St),fs=((e,t,n,s,r,a,o,i,l)=>class extends e{constructor(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null===l)throw new Error("Missing the native AudioContext constructor.");try{e=new l(t)}catch(o){if(12===o.code&&"sampleRate is not in range"===o.message)throw n();throw o}if(null===e)throw s();if(!G(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:r}=t,{sampleRate:a}=e;if(this._baseLatency="number"===typeof e.baseLatency?e.baseLatency:"balanced"===r?512/a:"interactive"===r||void 0===r?256/a:"playback"===r?1024/a:128*Math.max(2,Math.min(128,Math.round(r*a/128)))/a,this._nativeAudioContext=e,"webkitAudioContext"===l.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw t()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),z(this)}))}createMediaElementSource(e){return new r(this,{mediaElement:e})}createMediaStreamDestination(){return new a(this)}createMediaStreamSource(e){return new o(this,{mediaStream:e})}createMediaStreamTrackSource(e){return new i(this,{mediaStreamTrack:e})}resume(){return"suspended"===this._state?new Promise((e,t)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?e():this.resume().then(e,t)};this._nativeAudioContext.addEventListener("statechange",n)}):this._nativeAudioContext.resume().catch(e=>{if(void 0===e||15===e.code)throw t();throw e})}suspend(){return this._nativeAudioContext.suspend().catch(e=>{if(void 0===e)throw t();throw e})}})(ls,Se,Xe,st,cs,us,ds,ms,Rt),ps=(e=>t=>{const n=e.get(t);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(Pn),gs=(e=>(t,n)=>{e(t).add(n)})(ps),xs=(e=>function(t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=t[arguments.length>2&&void 0!==arguments[2]?arguments[2]:0];if(void 0===r)throw e();return oe(n)?r.connect(n,0,s):r.connect(n,0)})(E),bs=(e=>(t,n)=>{e(t).delete(n)})(ps),vs=(e=>function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===n?t.forEach(e=>e.disconnect()):"number"===typeof n?Ne(e,t,n).disconnect():oe(n)?void 0===s?t.forEach(e=>e.disconnect(n)):void 0===r?Ne(e,t,s).disconnect(n,0):Ne(e,t,s).disconnect(n,0,r):void 0===s?t.forEach(e=>e.disconnect(n)):Ne(e,t,s).disconnect(n,0)})(E),ys=new WeakMap,ws=((e,t)=>n=>t(e,n))(ys,y),js=((e,t,n,s,r,a,o,i,l,c,u,d,h)=>(m,p,g,x)=>{if(0===x.numberOfInputs&&0===x.numberOfOutputs)throw l();const b=Array.isArray(x.outputChannelCount)?x.outputChannelCount:Array.from(x.outputChannelCount);if(b.some(e=>e<1))throw l();if(b.length!==x.numberOfOutputs)throw t();if("explicit"!==x.channelCountMode)throw l();const v=x.channelCount*x.numberOfInputs,y=b.reduce((e,t)=>e+t,0),w=void 0===g.parameterDescriptors?0:g.parameterDescriptors.length;if(v+w>6||y>6)throw l();const j=new MessageChannel,k=[],N=[];for(let e=0;e<x.numberOfInputs;e+=1)k.push(o(m,{channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation,gain:1})),N.push(r(m,{channelCount:x.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:x.channelCount}));const C=[];if(void 0!==g.parameterDescriptors)for(const{defaultValue:e,maxValue:t,minValue:n,name:s}of g.parameterDescriptors){const r=a(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==x.parameterData[s]?x.parameterData[s]:void 0===e?0:e});Object.defineProperties(r.offset,{defaultValue:{get:()=>void 0===e?0:e},maxValue:{get:()=>void 0===t?P:t},minValue:{get:()=>void 0===n?I:n}}),C.push(r)}const _=s(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+w)}),S=Ve(p,m.sampleRate),T=i(m,S,v+w,Math.max(1,y)),A=r(m,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),M=[];for(let e=0;e<x.numberOfOutputs;e+=1)M.push(s(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:b[e]}));for(let e=0;e<x.numberOfInputs;e+=1){k[e].connect(N[e]);for(let t=0;t<x.channelCount;t+=1)N[e].connect(_,t,e*x.channelCount+t)}const E=new de(void 0===g.parameterDescriptors?[]:g.parameterDescriptors.map((e,t)=>{let{name:n}=e;const s=C[t];return s.connect(_,0,v+t),s.start(0),[n,s.offset]}));_.connect(T);let D=x.channelInterpretation,R=null;const O=0===x.numberOfOutputs?[T]:M,F={get bufferSize(){return S},get channelCount(){return x.channelCount},set channelCount(e){throw n()},get channelCountMode(){return x.channelCountMode},set channelCountMode(e){throw n()},get channelInterpretation(){return D},set channelInterpretation(e){for(const t of k)t.channelInterpretation=e;D=e},get context(){return T.context},get inputs(){return k},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get onprocessorerror(){return R},set onprocessorerror(e){"function"===typeof R&&F.removeEventListener("processorerror",R),R="function"===typeof e?e:null,"function"===typeof R&&F.addEventListener("processorerror",R)},get parameters(){return E},get port(){return j.port2},addEventListener(){return T.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},connect:e.bind(null,O),disconnect:c.bind(null,O),dispatchEvent(){return T.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener(){return T.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},L=new Map;var q,V;j.port1.addEventListener=(q=j.port1.addEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("message"===t[0]){const e="function"===typeof t[1]?t[1]:"object"===typeof t[1]&&null!==t[1]&&"function"===typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=L.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{u(m.currentTime,m.sampleRate,()=>e(t))},L.set(e,t[1]))}}return q.call(j.port1,t[0],t[1],t[2])}),j.port1.removeEventListener=(V=j.port1.removeEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("message"===t[0]){const e=L.get(t[1]);void 0!==e&&(L.delete(t[1]),t[1]=e)}return V.call(j.port1,t[0],t[1],t[2])});let z=null;Object.defineProperty(j.port1,"onmessage",{get:()=>z,set:e=>{"function"===typeof z&&j.port1.removeEventListener("message",z),z="function"===typeof e?e:null,"function"===typeof z&&(j.port1.addEventListener("message",z),j.port1.start())}}),g.prototype.port=j.port1;let G=null;const B=((e,t,n,s)=>{let r=f.get(e);void 0===r&&(r=new WeakMap,f.set(e,r));const a=ze(n,s);return r.set(t,a),a})(m,F,g,x);B.then(e=>G=e);const $=pe(x.numberOfInputs,x.channelCount),U=pe(x.numberOfOutputs,b),W=void 0===g.parameterDescriptors?[]:g.parameterDescriptors.reduce((e,t)=>{let{name:n}=t;return{...e,[n]:new Float32Array(128)}},{});let H=!0;const Q=()=>{x.numberOfOutputs>0&&T.disconnect(A);for(let e=0,t=0;e<x.numberOfOutputs;e+=1){const n=M[e];for(let s=0;s<b[e];s+=1)A.disconnect(n,t+s,s);t+=b[e]}},K=new Map;T.onaudioprocess=e=>{let{inputBuffer:t,outputBuffer:n}=e;if(null!==G){const e=d(F);for(let r=0;r<S;r+=128){for(let e=0;e<x.numberOfInputs;e+=1)for(let n=0;n<x.channelCount;n+=1)me(t,$[e],n,n,r);void 0!==g.parameterDescriptors&&g.parameterDescriptors.forEach((e,n)=>{let{name:s}=e;me(t,W,s,v+n,r)});for(let e=0;e<x.numberOfInputs;e+=1)for(let t=0;t<b[e];t+=1)0===U[e][t].byteLength&&(U[e][t]=new Float32Array(128));try{const t=$.map((t,n)=>{if(e[n].size>0)return K.set(n,S/128),t;const s=K.get(n);return void 0===s?[]:(t.every(e=>e.every(e=>0===e))&&(1===s?K.delete(n):K.set(n,s-1)),t)}),s=u(m.currentTime+r/m.sampleRate,m.sampleRate,()=>G.process(t,U,W));H=s;for(let e=0,a=0;e<x.numberOfOutputs;e+=1){for(let t=0;t<b[e];t+=1)fe(n,U[e],t,a+t,r);a+=b[e]}}catch(s){H=!1,F.dispatchEvent(new ErrorEvent("processorerror",{colno:s.colno,filename:s.filename,lineno:s.lineno,message:s.message}))}if(!H){for(let e=0;e<x.numberOfInputs;e+=1){k[e].disconnect(N[e]);for(let t=0;t<x.channelCount;t+=1)N[r].disconnect(_,t,e*x.channelCount+t)}if(void 0!==g.parameterDescriptors){const e=g.parameterDescriptors.length;for(let t=0;t<e;t+=1){const e=C[t];e.disconnect(_,0,v+t),e.stop()}}_.disconnect(T),T.onaudioprocess=null,Y?Q():J();break}}}};let Y=!1;const X=o(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Z=()=>T.connect(X).connect(m.destination),J=()=>{T.disconnect(X),X.disconnect()};return Z(),h(F,()=>{if(H){J(),x.numberOfOutputs>0&&T.connect(A);for(let e=0,t=0;e<x.numberOfOutputs;e+=1){const n=M[e];for(let s=0;s<b[e];s+=1)A.connect(n,t+s,s);t+=b[e]}}Y=!0},()=>{H&&(Z(),Q()),Y=!1})})(xs,E,Se,un,Be,gn,We,Ye,Xe,vs,ns,ws,ln),ks=((e,t,n,s,r)=>(a,o,i,l,c,u)=>{if(null!==i)try{const t=new i(a,l,u),s=new Map;let o=null;if(Object.defineProperties(t,{channelCount:{get:()=>u.channelCount,set:()=>{throw e()}},channelCountMode:{get:()=>"explicit",set:()=>{throw e()}},onprocessorerror:{get:()=>o,set:e=>{"function"===typeof o&&t.removeEventListener("processorerror",o),o="function"===typeof e?e:null,"function"===typeof o&&t.addEventListener("processorerror",o)}}}),t.addEventListener=(h=t.addEventListener,function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if("processorerror"===n[0]){const e="function"===typeof n[1]?n[1]:"object"===typeof n[1]&&null!==n[1]&&"function"===typeof n[1].handleEvent?n[1].handleEvent:null;if(null!==e){const t=s.get(n[1]);void 0!==t?n[1]=t:(n[1]=t=>{"error"===t.type?(Object.defineProperties(t,{type:{value:"processorerror"}}),e(t)):e(new ErrorEvent(n[0],{...t}))},s.set(e,n[1]))}}return h.call(t,"error",n[1],n[2]),h.call(t,...n)}),t.removeEventListener=(d=t.removeEventListener,function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if("processorerror"===n[0]){const e=s.get(n[1]);void 0!==e&&(s.delete(n[1]),n[1]=e)}return d.call(t,"error",n[1],n[2]),d.call(t,n[0],n[1],n[2])}),0!==u.numberOfOutputs){const e=n(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(e).connect(a.destination);return r(t,()=>e.disconnect(),()=>e.connect(a.destination))}return t}catch(m){if(11===m.code)throw s();throw m}var d,h;if(void 0===c)throw s();return(e=>{const{port1:t}=new MessageChannel;try{t.postMessage(e)}finally{t.close()}})(u),t(a,o,c,u)})(Se,js,We,Xe,ln),Ns=((e,t,n,s,r,a,o,i,l,c,u,d,h,m,f,p)=>(g,x,b)=>{const v=new WeakMap;let y=null;return{render(w,j){i(j,w);const k=v.get(j);return void 0!==k?Promise.resolve(k):(async(i,w)=>{let j=u(i),k=null;const N=A(j,w),C=Array.isArray(x.outputChannelCount)?x.outputChannelCount:Array.from(x.outputChannelCount);if(null===d){const e=C.reduce((e,t)=>e+t,0),n=r(w,{channelCount:Math.max(1,e),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,e)}),a=[];for(let t=0;t<i.numberOfOutputs;t+=1)a.push(s(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:C[t]}));const c=o(w,{channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation,gain:1});c.connect=t.bind(null,a),c.disconnect=l.bind(null,a),k=[n,a,c]}else N||(j=new d(w,g));if(v.set(w,null===k?j:k[2]),null!==k){if(null===y){if(void 0===b)throw new Error("Missing the processor constructor.");if(null===h)throw new Error("Missing the native OfflineAudioContext constructor.");const e=i.channelCount*i.numberOfInputs,t=void 0===b.parameterDescriptors?0:b.parameterDescriptors.length,n=e+t,l=async()=>{const l=new h(n,128*Math.ceil(i.context.length/128),w.sampleRate),c=[],u=[];for(let e=0;e<x.numberOfInputs;e+=1)c.push(o(l,{channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation,gain:1})),u.push(r(l,{channelCount:x.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:x.channelCount}));const d=await Promise.all(Array.from(i.parameters.values()).map(async e=>{const t=a(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:e.value});return await m(l,e,t.offset),t})),g=s(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,e+t)});for(let e=0;e<x.numberOfInputs;e+=1){c[e].connect(u[e]);for(let t=0;t<x.channelCount;t+=1)u[e].connect(g,t,e*x.channelCount+t)}for(const[t,n]of d.entries())n.connect(g,0,e+t),n.start(0);return g.connect(l.destination),await Promise.all(c.map(e=>f(i,l,e))),p(l)};y=ge(i,0===n?null:await l(),w,x,C,b,c)}const e=await y,t=n(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[l,u,d]=k;null!==e&&(t.buffer=e,t.start(0)),t.connect(l);for(let n=0,s=0;n<i.numberOfOutputs;n+=1){const e=u[n];for(let t=0;t<C[n];t+=1)l.connect(e,s+t,t);s+=C[n]}return d}if(N)for(const[t,n]of i.parameters.entries())await e(w,n,j.parameters.get(t));else for(const[e,t]of i.parameters.entries())await m(w,t,j.parameters.get(e));return await f(i,w,j),j})(w,j)}}})(Yt,xs,Xt,un,Be,gn,We,bs,vs,ns,ee,Ft,At,Zt,Ct,Mn),Cs=(e=>t=>e.get(t))(ss),_s=(e=>(t,n)=>{e.set(t,n)})(ys),Ss=ts?((e,t,n,s,r,a,o,i,l,c,u,d,h,f)=>class extends t{constructor(t,f,p){var g;const x=i(t),b=l(x),v=u({...he,...p});h(v);const y=m.get(x),w=null===y||void 0===y?void 0:y.get(f),j=b||"closed"!==x.state?x:null!==(g=o(x))&&void 0!==g?g:x,k=r(j,b?null:t.baseLatency,c,f,w,v);super(t,!0,k,b?s(f,v,w):null);const N=[];k.parameters.forEach((e,t)=>{const s=n(this,b,e);N.push([t,s])}),this._nativeAudioWorkletNode=k,this._onprocessorerror=null,this._parameters=new de(N),b&&e(x,this);const{activeInputs:C}=a(this);d(k,C)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(e){const t="function"===typeof e?f(this,e):null;this._nativeAudioWorkletNode.onprocessorerror=t;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===t?e:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(gs,Lt,en,Ns,ks,L,Cs,St,Mt,Ft,e=>({...e,outputChannelCount:void 0!==e.outputChannelCount?e.outputChannelCount:1===e.numberOfInputs&&1===e.numberOfOutputs?[e.channelCount]:Array.from({length:e.numberOfOutputs},()=>1)}),_s,e=>{const{port1:t,port2:n}=new MessageChannel;try{t.postMessage(e)}finally{t.close(),n.close()}},mt):void 0,Ts=(((e,t,n,s,r)=>{})(Se,Xe,st,On,Rt),((e,t)=>(n,s,r)=>{if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(n,s,r)}catch(a){if("SyntaxError"===a.name)throw e();throw a}})(Xe,At)),As=((e,t,n,s,r,a,o,i)=>(l,c)=>n(l).render(l,c).then(()=>Promise.all(Array.from(s(c)).map(e=>n(e).render(e,c)))).then(()=>r(c)).then(n=>("function"!==typeof n.copyFromChannel?(o(n),D(n)):t(a,()=>a(n))||i(n),e.add(n),n)))(zt,vt,Nt,ps,Mn,M,Ut,Wt),Ms=(((e,t,n,s,r)=>{})(vt,Se,Ts,On,As),((e,t,n,s,r)=>class extends e{constructor(e,n,r){let a;if("number"===typeof e&&void 0!==n&&void 0!==r)a={length:n,numberOfChannels:e,sampleRate:r};else{if("object"!==typeof e)throw new Error("The given parameters are not valid.");a=e}const{length:o,numberOfChannels:i,sampleRate:l}={...Ze,...a},c=s(i,o,l);t(De,()=>De(c))||c.addEventListener("statechange",(()=>{let e=0;const t=n=>{"running"===this._state&&(e>0?(c.removeEventListener("statechange",t),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):e+=1)};return t})()),super(c,i),this._length=o,this._nativeOfflineAudioContext=c,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,z(this)}))}_waitForThePromiseToSettle(e){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout(()=>this._waitForThePromiseToSettle(e))}})(ls,vt,Se,Ts,As)),Es=((e,t)=>n=>{const s=e.get(n);return t(s)||t(n)})(u,It),Ds=((e,t)=>n=>e.has(n)||t(n))(i,Pt),Rs=((e,t)=>n=>e.has(n)||t(n))(c,Ot),Is=((e,t)=>n=>{const s=e.get(n);return t(s)||t(n)})(u,Mt);function Ps(e){return void 0===e}function Os(e){return void 0!==e}function Fs(e){return"number"===typeof e}function Ls(e){return"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object}function qs(e){return"boolean"===typeof e}function Vs(e){return Array.isArray(e)}function zs(e){return"string"===typeof e}function Gs(e){return zs(e)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(e)}function Bs(e,t){if(!e)throw new Error(t)}function $s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;if(!(t<=e&&e<=n))throw new RangeError(`Value must be within [${t}, ${n}], got: ${e}`)}function Us(e){e.isOffline||"running"===e.state||Ys('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let Ws=!1,Hs=!1;function Qs(e){Ws=e}let Ks=console;function Ys(){Ks.warn(...arguments)}const Xs="object"===typeof self?self:null,Zs=Xs&&(Xs.hasOwnProperty("AudioContext")||Xs.hasOwnProperty("webkitAudioContext"));function Js(e,t,n,s){var r,a=arguments.length,o=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(o=(a<3?r(o):a>3?r(t,n,o):r(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}function er(e,t,n,s){return new(n||(n=Promise))(function(r,a){function o(e){try{l(s.next(e))}catch(t){a(t)}}function i(e){try{l(s.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((s=s.apply(e,t||[])).next())})}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;class tr{constructor(e,t,n,s){this._callback=e,this._type=t,this._minimumUpdateInterval=Math.max(128/(s||44100),.001),this.updateInterval=n,this._createClock()}_createWorker(){const e=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(e){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var t;this._updateInterval=Math.max(e,this._minimumUpdateInterval),"worker"===this._type&&(null===(t=this._worker)||void 0===t||t.postMessage(1e3*this._updateInterval))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function nr(e){return Rs(e)}function sr(e){return Ds(e)}function rr(e){return Is(e)}function ar(e){return Es(e)}function or(e,t){return"value"===e||nr(t)||sr(t)||function(e){return e instanceof Ht}(t)}function ir(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];if(!n.length)return e;const r=n.shift();if(Ls(e)&&Ls(r))for(const a in r)or(a,r[a])?e[a]=r[a]:Ls(r[a])?(e[a]||Object.assign(e,{[a]:{}}),ir(e[a],r[a])):Object.assign(e,{[a]:r[a]});return ir(e,...n)}function lr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3?arguments[3]:void 0;const r={},a=Array.from(t);if(Ls(a[0])&&s&&!Reflect.has(a[0],s)){const t=Object.keys(a[0]).some(t=>Reflect.has(e,t));t||(ir(r,{[s]:a[0]}),n.splice(n.indexOf(s),1),a.shift())}if(1===a.length&&Ls(a[0]))ir(r,a[0]);else for(let o=0;o<n.length;o++)Os(a[o])&&(r[n[o]]=a[o]);return ir(e,r)}function cr(e,t){return Ps(e)?t:e}function ur(e,t){return t.forEach(t=>{Reflect.has(e,t)&&delete e[t]}),e}class dr{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(){if(this.debug||Xs&&this.toString()===Xs.TONE_DEBUG_CLASS){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];!function(){Ks.log(...arguments)}(this,...t)}}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}dr.version=s;const hr=1e-6;function mr(e,t){return e>t+hr}function fr(e,t){return mr(e,t)||gr(e,t)}function pr(e,t){return e+hr<t}function gr(e,t){return Math.abs(e-t)<hr}function xr(e,t,n){return Math.max(Math.min(e,n),t)}class br extends dr{constructor(){super(),this.name="Timeline",this._timeline=[];const e=lr(br.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(Bs(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];Bs(fr(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(e){const t=this._timeline.indexOf(e);return-1!==t&&this._timeline.splice(t,1),this}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";const n=this._search(e,t);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";const n=this._search(e,t);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const n=this._search(e);return n-1>=0?this._timeline[n-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(gr(this._timeline[t].time,e)){for(let n=t;n>=0&&gr(this._timeline[n].time,e);n--)t=n;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else 1===this._timeline.length&&fr(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";if(0===this._timeline.length)return-1;let n=0;const s=this._timeline.length;let r=s;if(s>0&&this._timeline[s-1][t]<=e)return s-1;for(;n<r;){let s=Math.floor(n+(r-n)/2);const a=this._timeline[s],o=this._timeline[s+1];if(gr(a[t],e)){for(let n=s;n<this._timeline.length;n++){if(!gr(this._timeline[n][t],e))break;s=n}return s}if(pr(a[t],e)&&mr(o[t],e))return s;mr(a[t],e)?r=s:n=s+1}return-1}_iterate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._timeline.length-1;this._timeline.slice(t,n+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const n=this._search(e);return-1!==n&&this._iterate(t,0,n),this}forEachAfter(e,t){const n=this._search(e);return this._iterate(t,n+1),this}forEachBetween(e,t,n){let s=this._search(e),r=this._search(t);return-1!==s&&-1!==r?(this._timeline[s].time!==e&&(s+=1),this._timeline[r].time===t&&(r-=1),this._iterate(n,s,r)):-1===s&&this._iterate(n,0,r),this}forEachFrom(e,t){let n=this._search(e);for(;n>=0&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this}forEachAtTime(e,t){const n=this._search(e);if(-1!==n&&gr(this._timeline[n].time,e)){let s=n;for(let t=n;t>=0&&gr(this._timeline[t].time,e);t--)s=t;this._iterate(e=>{t(e)},s,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const vr=[];function yr(e){vr.push(e)}const wr=[];function jr(e){wr.push(e)}class kr extends dr{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(e=>{Ps(this._events)&&(this._events={}),this._events.hasOwnProperty(e)||(this._events[e]=[]),this._events[e].push(t)}),this}once(e,t){var n=this;const s=function(){t(...arguments),n.off(e,s)};return this.on(e,s),this}off(e,t){return e.split(/\W+/).forEach(e=>{if(Ps(this._events)&&(this._events={}),this._events.hasOwnProperty(e))if(Ps(t))this._events[e]=[];else{const n=this._events[e];for(let e=n.length-1;e>=0;e--)n[e]===t&&n.splice(e,1)}}),this}emit(e){if(this._events&&this._events.hasOwnProperty(e)){const r=this._events[e].slice(0);for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];for(let e=0,t=r.length;e<t;e++)r[e].apply(this,n)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const n=Object.getOwnPropertyDescriptor(kr.prototype,t);Object.defineProperty(e.prototype,t,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class Nr extends kr{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Cr extends Nr{constructor(){var e,t;super(),this.name="Context",this._constants=new Map,this._timeouts=new br,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const n=lr(Cr.getDefaults(),arguments,["context"]);n.context?(this._context=n.context,this._latencyHint=(null===(e=arguments[0])||void 0===e?void 0:e.latencyHint)||""):(this._context=function(e){return new fs(e)}({latencyHint:n.latencyHint}),this._latencyHint=n.latencyHint),this._ticker=new tr(this.emit.bind(this,"tick"),n.clockSource,n.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[(null===(t=arguments[0])||void 0===t?void 0:t.hasOwnProperty("updateInterval"))?"_lookAhead":"lookAhead"]=n.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var e;return this._initialized||(e=this,vr.forEach(t=>t(e)),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,n){return this._context.createBuffer(e,t,n)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,n){return this._context.createPeriodicWave(e,t,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){Bs(ar(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(e)}createMediaElementSource(e){Bs(ar(this._context),"Not available if OfflineAudioContext");return this._context.createMediaElementSource(e)}createMediaStreamDestination(){Bs(ar(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){Bs(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){Bs(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){Bs(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){Bs(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return function(e,t,n){return Bs(Os(Ss),"AudioWorkletNode only works in a secure context (https or localhost)"),new(e instanceof(null===Xs||void 0===Xs?void 0:Xs.BaseAudioContext)?null===Xs||void 0===Xs?void 0:Xs.AudioWorkletNode:Ss)(e,t,n)}(this.rawContext,e,t)}addAudioWorkletModule(e){return er(this,void 0,void 0,function*(){Bs(Os(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return er(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return ar(this._context)?this._context.resume():Promise.resolve()}close(){return er(this,void 0,void 0,function*(){var e;ar(this._context)&&"closed"!==this.state&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&(e=this,wr.forEach(t=>t(e)))})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),n=t.getChannelData(0);for(let r=0;r<n.length;r++)n[r]=e;const s=this._context.createBufferSource();return s.channelCount=1,s.channelCountMode="explicit",s.buffer=t,s.loop=!0,s.start(0),this._constants.set(e,s),s}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();this._timeouts.forEachBefore(e,e=>{e.callback(),this._timeouts.remove(e)})}setTimeout(e,t){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:n+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const n=++this._timeoutIds,s=()=>{const r=this.now();this._timeouts.add({callback:()=>{e(),s()},id:n,time:r+t})};return s(),n}}function _r(e,t){Vs(t)?t.forEach(t=>_r(e,t)):Object.defineProperty(e,t,{enumerable:!0,writable:!1})}function Sr(e,t){Vs(t)?t.forEach(t=>Sr(e,t)):Object.defineProperty(e,t,{writable:!0})}const Tr=()=>{};class Ar extends dr{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Tr;const e=lr(Ar.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,zs(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:Tr,onload:Tr,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Rr().sampleRate}set(e){return e instanceof Ar?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return er(this,void 0,void 0,function*(){const t=Ar.load(e).then(e=>{this.set(e),this.onload(this)});Ar.downloads.push(t);try{yield t}finally{const e=Ar.downloads.indexOf(t);Ar.downloads.splice(e,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=Vs(e)&&e[0].length>0,n=t?e.length:1,s=t?e[0].length:e.length,r=Rr(),a=r.createBuffer(n,s,r.sampleRate),o=t||1!==n?e:[e];for(let i=0;i<n;i++)a.copyToChannel(o[i],i);return this._buffer=a,this}toMono(e){if(Fs(e))this.fromArray(this.toArray(e));else{let e=new Float32Array(this.length);const t=this.numberOfChannels;for(let n=0;n<t;n++){const t=this.toArray(n);for(let n=0;n<t.length;n++)e[n]+=t[n]}e=e.map(e=>e/t),this.fromArray(e)}return this}toArray(e){if(Fs(e))return this.getChannelData(e);if(1===this.numberOfChannels)return this.toArray(0);{const e=[];for(let t=0;t<this.numberOfChannels;t++)e[t]=this.getChannelData(t);return e}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.duration;Bs(this.loaded,"Buffer is not loaded");const n=Math.floor(e*this.sampleRate),s=Math.floor(t*this.sampleRate);Bs(n<s,"The start time must be less than the end time");const r=s-n,a=Rr().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let o=0;o<this.numberOfChannels;o++)a.copyToChannel(this.getChannelData(o).subarray(n,s),o);return new Ar(a)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return(new Ar).fromArray(e)}static fromUrl(e){return er(this,void 0,void 0,function*(){const t=new Ar;return yield t.load(e)})}static load(e){return er(this,void 0,void 0,function*(){const t=""===Ar.baseUrl||Ar.baseUrl.endsWith("/")?Ar.baseUrl:Ar.baseUrl+"/",n=yield fetch(t+e);if(!n.ok)throw new Error(`could not load url: ${e}`);const s=yield n.arrayBuffer();return yield Rr().decodeAudioData(s)})}static supportsType(e){const t=e.split("."),n=t[t.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return er(this,void 0,void 0,function*(){for(yield Promise.resolve();Ar.downloads.length;)yield Ar.downloads[0]})}}Ar.baseUrl="",Ar.downloads=[];class Mr extends Cr{constructor(){var e,t,n;super({clockSource:"offline",context:rr(arguments[0])?arguments[0]:(e=arguments[0],t=arguments[1]*arguments[2],n=arguments[2],new Ms(e,t,n)),lookAhead:0,updateInterval:rr(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=rr(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return er(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const n=Math.floor(this.sampleRate/128);e&&t%n===0&&(yield new Promise(e=>setTimeout(e,1)))}})}render(){return er(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){yield e.workletsAreReady(),yield e._renderClock(t);const n=yield e._context.startRendering();return new Ar(n)}()})}close(){return Promise.resolve()}}const Er=new class extends Nr{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,n){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return er(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}};let Dr=Er;function Rr(){return Dr===Er&&Zs&&function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&Dr.dispose();Dr=ar(e)?new Cr(e):rr(e)?new Mr(e):e}(new Cr),Dr}if(Xs&&!Xs.TONE_SILENCE_LOGGING){let e="v";0;const t=` * Tone.js ${e}${s} * `;console.log(`%c${t}`,"background: #000; color: #fff")}function Ir(e){return Math.pow(10,e/20)}function Pr(e){return Math.log(e)/Math.LN10*20}function Or(e){return Math.pow(2,e/12)}let Fr=440;function Lr(e){return Math.round(qr(e))}function qr(e){return 69+12*Math.log2(e/Fr)}function Vr(e){return Fr*Math.pow(2,(e-69)/12)}class zr extends dr{constructor(e,t,n){super(),this.defaultUnits="s",this._val=t,this._units=n,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const n=parseInt(e,10),s="."===t?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*s:this._beatsToUnits(4/n)*s},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(3*Math.floor(t)))},regexp:/^(\d+)t$/i},tr:{method:(e,t,n)=>{let s=0;return e&&"0"!==e&&(s+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(s+=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(s+=this._beatsToUnits(parseFloat(n)/4)),s},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof zr&&this.fromType(this._val),Ps(this._val))return this._noArg();if(zs(this._val)&&Ps(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(Ls(this._val)){let e=0;for(const t in this._val)if(Os(this._val[t])){const n=this._val[t];e+=new this.constructor(this.context,t).valueOf()*n}return e}if(Os(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}return zs(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class Gr extends zr{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new Gr(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=new this.constructor(this.context,e).valueOf(),s=this.valueOf();return s+(Math.round(s/n)*n-s)*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let r=1;r<9;r++){const e=Math.pow(2,r);t.push(e+"n."),t.push(e+"n"),t.push(e+"t")}t.push("0");let n=t[0],s=new Gr(this.context,t[0]).toSeconds();return t.forEach(t=>{const r=new Gr(this.context,t).toSeconds();Math.abs(r-e)<Math.abs(s-e)&&(n=t,s=r)}),n}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const n=Math.floor(t/this._getTimeSignature());let s=t%1*4;t=Math.floor(t)%this._getTimeSignature();const r=s.toString();r.length>3&&(s=parseFloat(parseFloat(r).toFixed(3)));return[n,t,s].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return Lr(this.toFrequency())}_now(){return this.context.now()}}class Br extends Gr{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return Fr}static set A4(e){!function(e){Fr=e}(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return"midi"===this.defaultUnits?e:Br.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,t){const n=$r[e.toLowerCase()]+12*(parseInt(t,10)+1);return"midi"===this.defaultUnits?n:Br.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,n){let s=1;return e&&"0"!==e&&(s*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(s*=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(s*=this._beatsToUnits(parseFloat(n)/4)),s}}})}transpose(e){return new Br(this.context,this.valueOf()*Or(e))}harmonize(e){return e.map(e=>this.transpose(e))}toMidi(){return Lr(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/Br.A4);let n=Math.round(12*t)+57;const s=Math.floor(n/12);s<0&&(n+=-12*s);return Ur[n%12]+s.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(60*e/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return Vr(e)}static ftom(e){return Lr(e)}}const $r={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},Ur=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class Wr extends Gr{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Hr extends dr{constructor(){super();const e=lr(Hr.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:Rr()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return function(e){Ps(e)&&Ws&&!Hs&&(Hs=!0,Ys("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}(e),new Gr(this.context,e).toSeconds()}toFrequency(e){return new Br(this.context,e).toFrequency()}toTicks(e){return new Wr(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(n=>{Ps(e[n])&&delete t[n]}),t}get(){const e=this.constructor.getDefaults();return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const n=this[t];Os(n)&&Os(n.value)&&Os(n.setValueAtTime)?e[t]=n.value:n instanceof Hr?e[t]=n._getPartialProperties(e[t]):Vs(n)||Fs(n)||zs(n)||qs(n)?e[t]=n:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&Os(this[t])&&(this[t]&&Os(this[t].value)&&Os(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof Hr?this[t].set(e[t]):this[t]=e[t])}),this}}class Qr extends br{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"stopped";super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return null!==t?t.state:this._initial}setStateAtTime(e,t,n){return $s(t,0),this.add(Object.assign({},n,{state:e,time:t})),this}getLastState(e,t){for(let n=this._search(t);n>=0;n--){const t=this._timeline[n];if(t.state===e)return t}}getNextState(e,t){const n=this._search(t);if(-1!==n)for(let s=n;s<this._timeline.length;s++){const t=this._timeline[s];if(t.state===e)return t}}}class Kr extends Hr{constructor(){const e=lr(Kr.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,Bs(Os(e.param)&&(nr(e.param)||e.param instanceof Kr),"param must be an AudioParam");!nr(e.param);)e.param=e.param._param;this._swappable=!!Os(e.swappable)&&e.swappable,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new br(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,Os(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Hr.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return Os(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return Os(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return Os(this.maxValue)&&Os(this.minValue)&&$s(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?Ir(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&"decibels"===this.units?Pr(e):e}setValueAtTime(e,t){const n=this.toSeconds(t),s=this._fromType(e);return Bs(isFinite(s)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(s),this.log(this.units,"setValueAtTime",e,n),this._events.add({time:n,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,n),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),n=this._events.getAfter(t),s=this._events.get(t);let r=this._initialValue;if(null===s)r=this._initialValue;else if("setTargetAtTime"!==s.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)r=s.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let e=s.value;if("setTargetAtTime"===s.type){const t=this._events.getBefore(s.time);e=null===t?this._initialValue:t.value}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(s.time,e,n.time,n.value,t):this._exponentialInterpolate(s.time,e,n.time,n.value,t)}else r=s.value;else{const e=this._events.getBefore(s.time);let n;n=null===e?this._initialValue:e.value,"setTargetAtTime"===s.type&&(r=this._exponentialApproach(s.time,n,s.value,s.constant,t))}return this._toType(r)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),0===this._fromType(t)&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const n=this._fromType(e),s=this.toSeconds(t);return Bs(isFinite(n)&&isFinite(s),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(n),this._events.add({time:s,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",e,s),this._param.linearRampToValueAtTime(n,s),this}exponentialRampToValueAtTime(e,t){let n=this._fromType(e);n=gr(n,0)?this._minOutput:n,this._assertRange(n);const s=this.toSeconds(t);return Bs(isFinite(n)&&isFinite(s),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:s,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",e,s),this._param.exponentialRampToValueAtTime(n,s),this}exponentialRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this}linearRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this}targetRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(e,n,t),this}exponentialApproachValueAtTime(e,t,n){t=this.toSeconds(t),n=this.toSeconds(n);const s=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(e,t,s),this.cancelAndHoldAtTime(t+.9*n),this.linearRampToValueAtTime(e,t+n),this}setTargetAtTime(e,t,n){const s=this._fromType(e);Bs(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(t);return this._assertRange(s),Bs(isFinite(s)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:s}),this.log(this.units,"setTargetAtTime",e,r,n),this._param.setTargetAtTime(s,r,n),this}setValueCurveAtTime(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;n=this.toSeconds(n),t=this.toSeconds(t);const r=this._fromType(e[0])*s;this.setValueAtTime(this._toType(r),t);const a=n/(e.length-1);for(let o=1;o<e.length;o++){const n=this._fromType(e[o])*s;this.linearRampToValueAtTime(this._toType(n),t+o*a)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return Bs(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),n=this._fromType(this.getValueAtTime(t));Bs(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+n);const s=this._events.get(t),r=this._events.getAfter(t);return s&&gr(s.time,t)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),t):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),t)),this._events.add({time:t,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,t),this}rampTo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2?arguments[2]:void 0;return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(e,t,n):this.linearRampTo(e,t,n),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const n=this._events.get(t);if(n&&"setTargetAtTime"===n.type){const s=this._events.getAfter(n.time),r=s?s.time:t+2,a=(r-t)/10;for(let n=t;n<r;n+=a)e.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,t=>{"cancelScheduledValues"===t.type?e.cancelScheduledValues(t.time):"setTargetAtTime"===t.type?e.setTargetAtTime(t.value,t.time,t.constant):e[t.type](t.value,t.time)}),this}setParam(e){Bs(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,n,s,r){return n+(t-n)*Math.exp(-(r-e)/s)}_linearInterpolate(e,t,n,s,r){return t+(r-e)/(n-e)*(s-t)}_exponentialInterpolate(e,t,n,s,r){return t*Math.pow(s/t,(r-e)/(n-e))}}class Yr extends Hr{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return Os(this.input)?nr(this.input)||this.input instanceof Kr?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Os(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return Os(e)&&(e instanceof Yr||sr(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(t=>{t.channelCount=e.channelCount,t.channelCountMode=e.channelCountMode,t.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();Bs(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e){return Zr(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Ys("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e){return Jr(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}chain(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Xr(this,...t),this}fan(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(e=>this.connect(e)),this}dispose(){return super.dispose(),Os(this.input)&&(this.input instanceof Yr?this.input.dispose():sr(this.input)&&this.input.disconnect()),Os(this.output)&&(this.output instanceof Yr?this.output.dispose():sr(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Xr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=t.shift();t.reduce((e,t)=>(e instanceof Yr?e.connect(t):sr(e)&&Zr(e,t),t),s)}function Zr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(Bs(Os(e),"Cannot connect from undefined node"),Bs(Os(t),"Cannot connect to undefined node"),(t instanceof Yr||sr(t))&&Bs(t.numberOfInputs>0,"Cannot connect to node with no inputs"),Bs(e.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof Yr||t instanceof Kr;)Os(t.input)&&(t=t.input);for(;e instanceof Yr;)Os(e.output)&&(e=e.output);nr(t)?e.connect(t,n):e.connect(t,n,s)}function Jr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(Os(t))for(;t instanceof Yr;)t=t.input;for(;!sr(e);)Os(e.output)&&(e=e.output);nr(t)?e.disconnect(t,n):sr(t)?e.disconnect(t,n,s):e.disconnect()}class ea extends Yr{constructor(){const e=lr(ea.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new Kr({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),_r(this,"gain")}static getDefaults(){return Object.assign(Yr.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class ta extends Yr{constructor(e){super(e),this.onended=Tr,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new ea({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){const t=this.toSeconds(e);return-1!==this._startTime&&t>=this._startTime&&(-1===this._stopTime||t<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(Yr.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Tr})}_startGain(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Bs(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=e+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,e),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(t,e+n):this._gainNode.gain.exponentialApproachValueAtTime(t,e,n)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){Bs(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.now()),t>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const e="exponential"===this._curve?2*t:0;this._stopSource(this.now()+e),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Tr&&(this.onended(this),this.onended=Tr,!this.context.isOffline)){const e=()=>this.dispose();"undefined"!==typeof requestIdleCallback?requestIdleCallback(e):setTimeout(e,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Bs(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Tr,this}}class na extends ta{constructor(){const e=lr(na.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),Zr(this._source,this._gainNode),this.offset=new Kr({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(ta.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class sa extends Yr{constructor(){const e=lr(sa.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new na({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Yr.getDefaults(),{convert:!0,units:"number",value:0})}connect(e){return ra(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,n){return this._param.exponentialRampTo(e,t,n),this}linearRampTo(e,t,n){return this._param.linearRampTo(e,t,n),this}targetRampTo(e,t,n){return this._param.targetRampTo(e,t,n),this}exponentialApproachValueAtTime(e,t,n){return this._param.exponentialApproachValueAtTime(e,t,n),this}setTargetAtTime(e,t,n){return this._param.setTargetAtTime(e,t,n),this}setValueCurveAtTime(e,t,n,s){return this._param.setValueCurveAtTime(e,t,n,s),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,n){return this._param.rampTo(e,t,n),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function ra(e,t,n,s){(t instanceof Kr||nr(t)||t instanceof sa&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof sa&&(t.overridden=!0)),Zr(e,t,n,s)}class aa extends Kr{constructor(){const e=lr(aa.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new br(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Kr.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,n){t=this.toSeconds(t),this.setRampPoint(t);const s=this._fromType(e),r=this._events.get(t),a=Math.round(Math.max(1/n,1));for(let o=0;o<=a;o++){const e=n*o+t,a=this._exponentialApproach(r.time,r.value,s,n,e);this.linearRampToValueAtTime(this._toType(a),e)}return this}setValueAtTime(e,t){const n=this.toSeconds(t);super.setValueAtTime(e,t);const s=this._events.get(n),r=this._events.previousEvent(s),a=this._getTicksUntilEvent(r,n);return s.ticks=Math.max(a,0),this}linearRampToValueAtTime(e,t){const n=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const s=this._events.get(n),r=this._events.previousEvent(s),a=this._getTicksUntilEvent(r,n);return s.ticks=Math.max(a,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const n=this._fromType(e),s=this._events.get(t),r=Math.round(Math.max(10*(t-s.time),1)),a=(t-s.time)/r;for(let o=0;o<=r;o++){const e=a*o+s.time,r=this._exponentialInterpolate(s.time,s.value,t,n,e);this.linearRampToValueAtTime(this._toType(r),e)}return this}_getTicksUntilEvent(e,t){if(null===e)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Ps(e.ticks)){const t=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(t,e.time)}const n=this._fromType(this.getValueAtTime(e.time));let s=this._fromType(this.getValueAtTime(t));const r=this._events.get(t);return r&&r.time===t&&"setValueAtTime"===r.type&&(s=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(n+s)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),n=this._events.get(t);return Math.max(this._getTicksUntilEvent(n,t),0)}getDurationOfTicks(e,t){const n=this.toSeconds(t),s=this.getTicksAtTime(t);return this.getTimeOfTick(s+e)-n}getTimeOfTick(e){const t=this._events.get(e,"ticks"),n=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&n&&"linearRampToValueAtTime"===n.type&&t.value!==n.value){const s=this._fromType(this.getValueAtTime(t.time)),r=(this._fromType(this.getValueAtTime(n.time))-s)/(n.time-t.time),a=Math.sqrt(Math.pow(s,2)-2*r*(t.ticks-e)),o=(-s+a)/r;return(o>0?o:(-s-a)/r)+t.time}return t?0===t.value?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const n=this.toSeconds(t),s=this.toSeconds(e),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+s)-r}_fromType(e){return"bpm"===this.units&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return"bpm"===this.units&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class oa extends sa{constructor(){const e=lr(oa.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new aa({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(sa.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class ia extends Hr{constructor(){const e=lr(ia.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new Qr,this._tickOffset=new br,this._ticksAtTime=new br,this._secondsAtTime=new br,this.frequency=new oa({context:this.context,units:e.units,value:e.frequency}),_r(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Hr.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const n=this.toSeconds(e);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),Os(t)&&this.setTicksAtTime(t,n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n)),this}stop(e){const t=this.toSeconds(e);if("stopped"===this._state.getValueAtTime(t)){const e=this._state.get(t);e&&e.time>0&&(this._tickOffset.cancel(e.time),this._state.cancel(e.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}pause(e){const t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&(this._state.setStateAtTime("paused",t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),n=this._state.getLastState("stopped",t),s=this._ticksAtTime.get(t),r={state:"paused",time:t};this._state.add(r);let a=s||n,o=s?s.ticks:0,i=null;return this._state.forEachBetween(a.time,t+this.sampleTime,e=>{let t=a.time;const n=this._tickOffset.get(e.time);n&&n.time>=a.time&&(o=n.ticks,t=n.time),"started"===a.state&&"started"!==e.state&&(o+=this.frequency.getTicksAtTime(e.time)-this.frequency.getTicksAtTime(t),e.time!==r.time&&(i={state:e.state,time:e.time,ticks:o})),a=e}),this._state.remove(r),i&&this._ticksAtTime.add(i),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),n=this.frequency.timeToTicks(e,t);this.setTicksAtTime(n,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);const s=this._secondsAtTime.get(e);let r=s||t,a=s?s.seconds:0,o=null;return this._state.forEachBetween(r.time,e+this.sampleTime,e=>{let t=r.time;const s=this._tickOffset.get(e.time);s&&s.time>=r.time&&(a=s.seconds,t=s.time),"started"===r.state&&"started"!==e.state&&(a+=e.time-t,e.time!==n.time&&(o={state:e.state,time:e.time,seconds:a})),r=e}),this._state.remove(n),o&&this._secondsAtTime.add(o),a}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now();const n=this._tickOffset.get(t),s=this._state.get(t),r=Math.max(n.time,s.time),a=this.frequency.getTicksAtTime(r)+e-n.ticks;return this.frequency.getTimeOfTick(a)}forEachTickBetween(e,t,n){let s=this._state.get(e);this._state.forEachBetween(e,t,t=>{s&&"started"===s.state&&"started"!==t.state&&this.forEachTickBetween(Math.max(s.time,e),t.time-this.sampleTime,n),s=t});let r=null;if(s&&"started"===s.state){const o=Math.max(s.time,e),i=this.frequency.getTicksAtTime(o),l=i-this.frequency.getTicksAtTime(s.time);let c=Math.ceil(l)-l;c=gr(c,1)?0:c;let u=this.frequency.getTimeOfTick(i+c);for(;u<t;){try{n(u,Math.round(this.getTicksAtTime(u)))}catch(a){r=a;break}u+=this.frequency.getDurationOfTicks(1,u)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class la extends Hr{constructor(){const e=lr(la.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=Tr,this._lastUpdate=0,this._state=new Qr("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new ia({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,_r(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Hr.getDefaults(),{callback:Tr,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){Us(this.context);const n=this.toSeconds(e);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,t),n<this._lastUpdate&&this.emit("start",n,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now();return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const n=this.toSeconds(t),s=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(s+e,n)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,e=>{switch(e.state){case"started":const t=this._tickSource.getTicksAtTime(e.time);this.emit("start",e.time,t);break;case"stopped":0!==e.time&&this.emit("stop",e.time);break;case"paused":this.emit("pause",e.time)}}),this._tickSource.forEachTickBetween(e,t,(e,t)=>{this.callback(e,t)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}kr.mixin(la);class ca extends Yr{constructor(){const e=lr(ca.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new ea({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,_r(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(Yr.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class ua extends Yr{constructor(){const e=lr(ua.getDefaults(),arguments);super(e),this.name="Destination",this.input=new ca({context:this.context}),this.output=new ea({context:this.context}),this.volume=this.input.volume,Xr(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Yr.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(){this.input.disconnect();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift(this.input),t.push(this.output),Xr(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}yr(e=>{e.destination=new ua({context:e})}),jr(e=>{e.destination.dispose()});class da extends Yr{constructor(){super(...arguments),this.name="Listener",this.positionX=new Kr({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Kr({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Kr({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Kr({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Kr({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Kr({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Kr({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Kr({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Kr({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Yr.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}yr(e=>{e.listener=new da({context:e})}),jr(e=>{e.listener.dispose()});class ha extends dr{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=lr(ha.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const n=e.urls[t];this.add(t,n,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Tr,onload:Tr,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return Bs(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,0===this._loadingCount&&e&&e()}get loaded(){return Array.from(this._buffers).every(e=>{let[t,n]=e;return n.loaded})}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tr,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Tr;return zs(t)?(this.baseUrl&&"data:audio/"===t.trim().substring(0,11).toLowerCase()&&(this.baseUrl=""),this._buffers.set(e.toString(),new Ar(this.baseUrl+t,n,s))):this._buffers.set(e.toString(),new Ar(t,n,s)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class ma extends Br{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(e){return Lr(super._frequencyToUnits(e))}_ticksToUnits(e){return Lr(super._ticksToUnits(e))}_beatsToUnits(e){return Lr(super._beatsToUnits(e))}_secondsToUnits(e){return Lr(super._secondsToUnits(e))}toMidi(){return this.valueOf()}toFrequency(){return Vr(this.toMidi())}transpose(e){return new ma(this.context,this.toMidi()+e)}}class fa extends Wr{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class pa extends Hr{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new br,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;this._events.forEachBefore(e+this.anticipation,t=>{e-t.time<=this.expiration&&t.callback(),this._events.remove(t)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}yr(e=>{e.draw=new pa({context:e})}),jr(e=>{e.draw.dispose()});class ga extends dr{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){Bs(Os(e.time),"Events must have a time property"),Bs(Os(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new xa(e.time,e.time+e.duration,e);for(null===this._root?this._root=t:this._root.insert(t),this._length++;null!==t;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(null!==this._root){const t=[];this._root.search(e.time,t);for(const n of t)if(n.event===e){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,e=>this.remove(e)),this}_setRoot(e){this._root=e,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(e,t){null!==e.parent?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(null===e.left&&null===e.right)this._replaceNodeInParent(e,null);else if(null===e.right)this._replaceNodeInParent(e,e.left);else if(null===e.left)this._replaceNodeInParent(e,e.right);else{let t,n=null;if(e.getBalance()>0)if(null===e.left.right)t=e.left,t.right=e.right,n=t;else{for(t=e.left.right;null!==t.right;)t=t.right;t.parent&&(t.parent.right=t.left,n=t.parent,t.left=e.left,t.right=e.right)}else if(null===e.right.left)t=e.right,t.left=e.left,n=t;else{for(t=e.right.left;null!==t.left;)t=t.left;t.parent&&(t.parent.left=t.right,n=t.parent,t.left=e.left,t.right=e.right)}null!==e.parent?e.isLeftChild()?e.parent.left=t:e.parent.right=t:this._setRoot(t),n&&this._rebalance(n)}e.dispose()}_rotateLeft(e){const t=e.parent,n=e.isLeftChild(),s=e.right;s&&(e.right=s.left,s.left=e),null!==t?n?t.left=s:t.right=s:this._setRoot(s)}_rotateRight(e){const t=e.parent,n=e.isLeftChild(),s=e.left;s&&(e.left=s.right,s.right=e),null!==t?n?t.left=s:t.right=s:this._setRoot(s)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(null!==this._root){const t=[];if(this._root.search(e,t),t.length>0){let e=t[0];for(let n=1;n<t.length;n++)t[n].low>e.low&&(e=t[n]);return e.event}}return null}forEach(e){if(null!==this._root){const t=[];this._root.traverse(e=>t.push(e)),t.forEach(t=>{t.event&&e(t.event)})}return this}forEachAtTime(e,t){if(null!==this._root){const n=[];this._root.search(e,n),n.forEach(e=>{e.event&&t(e.event)})}return this}forEachFrom(e,t){if(null!==this._root){const n=[];this._root.searchAfter(e,n),n.forEach(e=>{e.event&&t(e.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class xa{constructor(e,t,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?null===this.left?this.left=e:this.left.insert(e):null===this.right?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(null!==this.left&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),this.low>e||null!==this.right&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),null!==this.left&&this.left.searchAfter(e,t)),null!==this.right&&this.right.searchAfter(e,t)}traverse(e){e(this),null!==this.left&&this.left.traverse(e),null!==this.right&&this.right.traverse(e)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return null!==this.left&&null!==this.right?e=this.left.height-this.right.height:null!==this.left?e=this.left.height+1:null!==this.right&&(e=-(this.right.height+1)),e}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class ba extends dr{constructor(e){super(),this.name="TimelineValue",this._timeline=new br({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class va extends Yr{constructor(){super(lr(va.getDefaults(),arguments,["context"]))}connect(e){return ra(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}}class ya extends va{constructor(){const e=lr(ya.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,Vs(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):"function"===typeof e.mapping&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(sa.getDefaults(),{length:1024})}setMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=new Float32Array(t);for(let s=0,r=t;s<r;s++){const t=s/(r-1)*2-1;n[s]=e(t,s)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){Bs(["none","2x","4x"].some(t=>t.includes(e)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class wa extends va{constructor(){const e=lr(wa.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new ya({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(va.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class ja{constructor(e,t){this.id=ja._eventId++,this._remainderTime=0;const n=Object.assign(ja.getDefaults(),t);this.transport=e,this.callback=n.callback,this._once=n.once,this.time=Math.floor(n.time),this._remainderTime=n.time-this.time}static getDefaults(){return{callback:Tr,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const t=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*t),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}ja._eventId=0;class ka extends ja{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(ka.getDefaults(),t);this.duration=n.duration,this._interval=n.interval,this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},ja.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return pr(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new fa(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){pr(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new fa(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const t=this.transport.getTicksAtTime(e);mr(t,this.time)&&(this._nextTick=this.floatTime+Math.ceil((t-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class Na extends Hr{constructor(){const e=lr(Na.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new ba(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new br,this._repeatedEvents=new ga,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new la({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),_r(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(Hr.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(2*this._swingTicks)!==0){const n=t%(2*this._swingTicks)/(2*this._swingTicks),s=Math.sin(n*Math.PI)*this._swingAmount;e+=new fa(this.context,2*this._swingTicks/3).toSeconds()*s}Qs(!0),this._timeline.forEachAtTime(t,t=>t.invoke(e)),Qs(!1)}schedule(e,t){const n=new ja(this,{callback:e,time:new Wr(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;const r=new ka(this,{callback:e,duration:new Gr(this.context,s).toTicks(),interval:new Gr(this.context,t).toTicks(),time:new Wr(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(e,t){const n=new ja(this,{callback:e,once:!0,time:new Wr(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this.toTicks(e);return this._timeline.forEachFrom(t,e=>this.clear(e.id)),this._repeatedEvents.forEachFrom(t,e=>this.clear(e.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new fa(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){let n;return this.context.resume(),Os(t)&&(n=this.toTicks(t)),this._clock.start(e,n),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),"started"!==this._clock.getStateAtTime(e)?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){Vs(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new Gr(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new Gr(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new fa(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new fa(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),n=this._clock.frequency.timeToTicks(e,t);this.ticks=n}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(t),s=t+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,t);this.emit("stop",s),this._clock.setTicksAtTime(e,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this.emit("ticks",t),this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),"started"!==this.state)return 0;{const t=this.now(),n=e-this.getTicksAtTime(t)%e;return this._clock.nextTickTime(n,t)}}syncSignal(e,t){const n=this.now();let s=this.bpm,r=1/(60/s.getValueAtTime(n)/this.PPQ),a=[];if("time"===e.units){const e=1/64/r,t=new ea(e),n=new wa(-1),o=new ea(e);s.chain(t,n,o),s=o,r=1/r,a=[t,n,o]}t||(t=0!==e.getValueAtTime(n)?e.getValueAtTime(n)/r:0);const o=new ea(t);return s.connect(o),o.connect(e._param),a.push(o),this._syncedSignals.push({initial:e.value,nodes:a,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const n=this._syncedSignals[t];n.signal===e&&(n.nodes.forEach(e=>e.dispose()),n.signal.value=n.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Sr(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}kr.mixin(Na),yr(e=>{e.transport=new Na({context:e})}),jr(e=>{e.transport.dispose()});class Ca extends Yr{constructor(e){super(e),this.input=void 0,this._state=new Qr("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Tr,this._syncedStop=Tr,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new ca({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,_r(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(Yr.getDefaults(),{mute:!1,onstop:Tr,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,n){let s=Ps(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(s=this._clampToCurrentTime(s),this._synced||"started"!==this._state.getValueAtTime(s))if(this.log("start",s),this._state.setStateAtTime("started",s),this._synced){const e=this._state.get(s);e&&(e.offset=this.toSeconds(cr(t,0)),e.duration=n?this.toSeconds(n):void 0);const r=this.context.transport.schedule(e=>{this._start(e,t,n)},s);this._scheduled.push(r),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>s&&this._syncedStart(this.now(),this.context.transport.seconds)}else Us(this.context),this._start(s,t,n);else Bs(mr(s,this._state.get(s).time),"Start time must be strictly greater than previous start time"),this._state.cancel(s),this._state.setStateAtTime("started",s),this.log("restart",s),this.restart(s,t,n);return this}stop(e){let t=Ps(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),"started"===this._state.getValueAtTime(t)||Os(this._state.getNextState("started",t))){if(this.log("stop",t),this._synced){const e=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(e)}else this._stop(t);this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,n){return e=this.toSeconds(e),"started"===this._state.getValueAtTime(e)&&(this._state.cancel(e),this._restart(e,t,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(mr(t,0)){const n=this._state.get(t);if(n&&"started"===n.state&&n.time!==t){const s=t-this.toSeconds(n.time);let r;n.duration&&(r=this.toSeconds(n.duration)-s),this._start(e,this.toSeconds(n.offset)+s,r)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));"started"===this._state.getValueAtTime(t)&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Tr,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class _a extends ta{constructor(){const e=lr(_a.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,Zr(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Kr({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Ar(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(ta.getDefaults(),{url:new Ar,loop:!1,loopEnd:0,loopStart:0,onload:Tr,onerror:Tr,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Bs(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(e);this._startGain(r,s),t=this.loop?cr(t,this.loopStart):cr(t,0);let a=Math.max(this.toSeconds(t),0);if(this.loop){const e=this.toSeconds(this.loopEnd)||this.buffer.duration,t=this.toSeconds(this.loopStart),n=e-t;fr(a,e)&&(a=(a-t)%n+t),gr(a,this.buffer.duration)&&(a=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,pr(a,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,a)),Os(n)){let e=this.toSeconds(n);e=Math.max(e,0),this.stop(r+e)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function Sa(e,t){return er(this,void 0,void 0,function*(){const n=t/e.context.sampleRate,s=new Mr(1,n,e.context.sampleRate);new e.constructor(Object.assign(e.get(),{frequency:2/n,detune:0,context:s})).toDestination().start(0);return(yield s.render()).getChannelData(0)})}class Ta extends ta{constructor(){const e=lr(Ta.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],Zr(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Kr({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Kr({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),_r(this,["frequency","detune"])}static getDefaults(){return Object.assign(ta.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Aa extends Ca{constructor(){const e=lr(Aa.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new sa({context:this.context,units:"frequency",value:e.frequency}),_r(this,"frequency"),this.detune=new sa({context:this.context,units:"cents",value:e.detune}),_r(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&"custom"!==e.type&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Ca.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),n=new Ta({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return Aa._periodicWaveCache.find(e=>{return e.phase===this._phase&&(t=e.partials,n=this._partials,t.length===n.length&&t.every((e,t)=>n[t]===e));var t,n})}{const e=Aa._periodicWaveCache.find(e=>e.type===this._type&&e.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=-1!==["sine","square","sawtooth","triangle"].indexOf(e);if(0===this._phase&&t)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=e);else{const t=this._getCachedPeriodicWave();if(Os(t)){const{partials:e,wave:n}=t;this._wave=n,this._partials=e,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[t,n]=this._getRealImaginary(e,this._phase),s=this.context.createPeriodicWave(t,n);this._wave=s,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),Aa._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:t,type:this._type,wave:this._wave}),Aa._periodicWaveCache.length>100&&Aa._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&"custom"!==this._type&&"custom"!==e?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){$s(e,0);let t=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(t=n[1]),"custom"!==this._type)this.type=0===e?t:t+e.toString();else{const t=new Float32Array(e);this._partials.forEach((e,n)=>t[n]=e),this._partials=Array.from(t),this.type=this._type}}_getRealImaginary(e,t){let n=2048;const s=new Float32Array(n),r=new Float32Array(n);let a=1;if("custom"===e){if(a=this._partials.length+1,this._partialCount=this._partials.length,n=a,0===this._partials.length)return[s,r]}else{const t=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);t?(a=parseInt(t[2],10)+1,this._partialCount=parseInt(t[2],10),e=t[1],a=Math.max(a,2),n=a):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let i;switch(e){case"sine":i=o<=a?1:0,this._partials[o-1]=i;break;case"square":i=1&o?2*n:0,this._partials[o-1]=i;break;case"sawtooth":i=n*(1&o?1:-1),this._partials[o-1]=i;break;case"triangle":i=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=i;break;case"custom":i=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}0!==i?(s[o]=-i*Math.sin(t*o),r[o]=i*Math.cos(t*o)):(s[o]=0,r[o]=0)}return[s,r]}_inverseFFT(e,t,n){let s=0;const r=e.length;for(let a=0;a<r;a++)s+=e[a]*Math.cos(a*n)+t[a]*Math.sin(a*n);return s}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let n=0;const s=2*Math.PI;for(let r=0;r<32;r++)n=Math.max(this._inverseFFT(e,t,r/32*s),n);return xr(-this._inverseFFT(e,t,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return er(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return function*(){return Sa(e,t)}()})}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Aa._periodicWaveCache=[];class Ma extends va{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new ya({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ea extends sa{constructor(){const e=lr(Ea.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new ea({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(sa.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Da extends Ca{constructor(){const e=lr(Da.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new Ma({context:this.context}),this._modulationNode=new ea({context:this.context}),this._carrier=new Aa({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Aa({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Ea({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),_r(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Aa.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return er(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return function*(){return Sa(e,t)}()})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class Ra extends Ca{constructor(){const e=lr(Ra.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new ea({context:this.context,gain:0}),this._carrier=new Aa({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new sa({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Aa({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Ea({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Ea({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),_r(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Aa.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return er(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return function*(){return Sa(e,t)}()})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Ia extends Ca{constructor(){const e=lr(Ia.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new ea({context:this.context,gain:0}),this._thresh=new ya({context:this.context,mapping:e=>e<=0?-1:1}),this.width=new sa({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Aa({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),_r(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Ca.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return er(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return function*(){return Sa(e,t)}()})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Pa extends Ca{constructor(){const e=lr(Pa.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new sa({context:this.context,units:"frequency",value:e.frequency}),this.detune=new sa({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,_r(this,["frequency","detune"])}static getDefaults(){return Object.assign(Aa.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,n=e/(this._oscillators.length-1);this._forEach((e,s)=>e.detune.value=t+n*s)}}get count(){return this._oscillators.length}set count(e){if($s(e,1),this._oscillators.length!==e){this._forEach(e=>e.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const n=new Aa({context:this.context,volume:-6-1.1*e,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:0===t?()=>this.onstop(this):Tr});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[t]=n}this.spread=this._spread,"started"===this.state&&this._forEach(e=>e.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((e,t)=>e.phase=this._phase+t/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(){return er(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return function*(){return Sa(e,t)}()})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class Oa extends Ca{constructor(){const e=lr(Oa.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Ea({context:this.context,value:2}),this._pulse=new Ia({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Aa({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),_r(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Ca.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return er(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return function*(){return Sa(e,t)}()})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const Fa={am:Da,fat:Pa,fm:Ra,oscillator:Aa,pulse:Ia,pwm:Oa};class La extends Ca{constructor(){const e=lr(La.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new sa({context:this.context,units:"frequency",value:e.frequency}),this.detune=new sa({context:this.context,units:"cents",value:e.detune}),_r(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Aa.getDefaults(),Ra.getDefaults(),Da.getDefaults(),Pa.getDefaults(),Ia.getDefaults(),Oa.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(e=>this._sourceType===e)&&(e=this._sourceType),e+this._oscillator.type}set type(e){"fm"===e.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"am"===e.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"fat"===e.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):"pwm"===e?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===e?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=Fa[e],n=this.now();if(this._oscillator){const e=this._oscillator;e.stop(n),this.context.setTimeout(()=>e.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(t=this._oscillator.type),"fm"===e?this.type="fm"+t:"am"===e?this.type="am"+t:"fat"===e?this.type="fat"+t:"oscillator"===e?this.type=t:"pulse"===e?this.type="pulse":"pwm"===e&&(this.type="pwm")}_getOscType(e,t){return e instanceof Fa[t]}get baseType(){return this._oscillator.baseType}set baseType(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===e||"pwm"===e||(this._oscillator.baseType=e)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(e){this._getOscType(this._oscillator,"fat")&&Fs(e)&&(this._oscillator.count=e)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(e){this._getOscType(this._oscillator,"fat")&&Fs(e)&&(this._oscillator.spread=e)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&zs(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(){return er(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return function*(){return Sa(e,t)}()})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function qa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=new WeakMap;return function(s,r){Reflect.defineProperty(s,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){$s(s,e,t),n.set(this,s)}})}}function Va(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=new WeakMap;return function(s,r){Reflect.defineProperty(s,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){$s(this.toSeconds(s),e,t),n.set(this,s)}})}}class za extends Ca{constructor(){const e=lr(za.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new Ar({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Ca.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Tr,onerror:Tr,playbackRate:1,reverse:!1})}load(e){return er(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tr)(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,n){return super.start(e,t,n),this}_start(e,t,n){t=this._loop?cr(t,this._loopStart):cr(t,0);const s=this.toSeconds(t),r=n;n=cr(n,Math.max(this._buffer.duration-s,0));let a=this.toSeconds(n);a/=this._playbackRate,e=this.toSeconds(e);const o=new _a({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(e+a),this._state.setStateAtTime("stopped",e+a,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&Ps(r)?o.start(e,s):o.start(e,s,a-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(e=>e.stop(t))}restart(e,t,n){return super.restart(e,t,n),this}_restart(e,t,n){var s;null===(s=[...this._activeSources].pop())||void 0===s||s.stop(e),this._start(e,t,n)}seek(e,t){const n=this.toSeconds(t);if("started"===this._state.getValueAtTime(n)){const t=this.toSeconds(e);this._stop(n),this._start(n,t)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&$s(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&$s(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),n=this._state.getNextState("stopped",t);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(e=>e.cancelStop())),this._activeSources.forEach(n=>{n.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}Js([Va(0)],za.prototype,"fadeIn",void 0),Js([Va(0)],za.prototype,"fadeOut",void 0);class Ga extends Yr{constructor(){const e=lr(Ga.getDefaults(),arguments,["urls","onload"],"urls");super(e),this.name="Players",this.input=void 0,this._players=new Map,this._volume=this.output=new ca({context:this.context,volume:e.volume}),this.volume=this._volume.volume,_r(this,"volume"),this._buffers=new ha({urls:e.urls,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.mute=e.mute,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Ca.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:Tr,onerror:Tr,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._players.forEach(t=>{t.fadeIn=e})}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._players.forEach(t=>{t.fadeOut=e})}get state(){return Array.from(this._players).some(e=>{let[t,n]=e;return"started"===n.state})?"started":"stopped"}has(e){return this._buffers.has(e)}player(e){if(Bs(this.has(e),`No Player with the name ${e} exists on this object`),!this._players.has(e)){const t=new za({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(e)}).connect(this.output);this._players.set(e,t)}return this._players.get(e)}get loaded(){return this._buffers.loaded}add(e,t,n){return Bs(!this._buffers.has(e),"A buffer with that name already exists on this object"),this._buffers.add(e,t,n),this}stopAll(e){return this._players.forEach(t=>t.stop(e)),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach(e=>e.dispose()),this._buffers.dispose(),this}}class Ba extends Yr{constructor(){const e=lr(Ba.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new sa({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(Yr.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(zs(e))return e;{let n;for(n in $a)if($a[n][t]===e)return n;return e}}_setCurve(e,t,n){if(zs(n)&&Reflect.has($a,n)){const s=$a[n];Ls(s)?"_decayCurve"!==e&&(this[e]=s[t]):this[e]=s}else{if(!Vs(n)||"_decayCurve"===e)throw new Error("Envelope: invalid curve: "+n);this[e]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.log("triggerAttack",e,t),e=this.toSeconds(e);let n=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),r=this.getValueAtTime(e);if(r>0){n=(1-r)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if("linear"===this._attackCurve)this._sig.linearRampTo(t,n,e);else if("exponential"===this._attackCurve)this._sig.targetRampTo(t,n,e);else{this._sig.cancelAndHoldAtTime(e);let s=this._attackCurve;for(let e=1;e<s.length;e++)if(s[e-1]<=r&&r<=s[e]){s=this._attackCurve.slice(e),s[0]=r;break}this._sig.setValueCurveAtTime(s,e,n,t)}if(s&&this.sustain<1){const r=t*this.sustain,a=e+n;this.log("decay",a),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(r,s+a):this._sig.exponentialApproachValueAtTime(r,a,s)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,e):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,e):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,e):(Bs(Vs(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,n,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t=this.toSeconds(t),this.triggerAttack(t,n),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e){return ra(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}asArray(){return er(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return function*(){const n=t/e.context.sampleRate,s=new Mr(1,n,e.context.sampleRate),r=e.toSeconds(e.attack)+e.toSeconds(e.decay),a=r+e.toSeconds(e.release),o=.1*a,i=a+o,l=new e.constructor(Object.assign(e.get(),{attack:n*e.toSeconds(e.attack)/i,decay:n*e.toSeconds(e.decay)/i,release:n*e.toSeconds(e.release)/i,context:s}));l._sig.toDestination(),l.triggerAttackRelease(n*(r+o)/i,0);return(yield s.render()).getChannelData(0)}()})}dispose(){return super.dispose(),this._sig.dispose(),this}}Js([Va(0)],Ba.prototype,"attack",void 0),Js([Va(0)],Ba.prototype,"decay",void 0),Js([qa(0,1)],Ba.prototype,"sustain",void 0),Js([Va(0)],Ba.prototype,"release",void 0);const $a=(()=>{const e=128;let t,n;const s=[];for(t=0;t<e;t++)s[t]=Math.sin(t/127*(Math.PI/2));const r=[];for(t=0;t<127;t++){n=t/127;const e=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;r[t]=e/10+.83*n}r[127]=1;const a=[];for(t=0;t<e;t++)a[t]=Math.ceil(t/127*5)/5;const o=[];for(t=0;t<e;t++)n=t/127,o[t]=.5*(1-Math.cos(Math.PI*n));const i=[];for(t=0;t<e;t++){n=t/127;const e=4*Math.pow(n,3)+.2,s=Math.cos(e*Math.PI*2*n);i[t]=Math.abs(s*(1-n))}function l(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=1-e[n];return t}return{bounce:{In:l(i),Out:i},cosine:{In:s,Out:(c=s,c.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:r,Out:l(r)},sine:{In:o,Out:l(o)},step:{In:a,Out:l(a)}};var c})();class Ua extends Yr{constructor(){const e=lr(Ua.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=e=>this._original_triggerRelease(e),this._volume=this.output=new ca({context:this.context,volume:e.volume}),this.volume=this._volume.volume,_r(this,"volume")}static getDefaults(){return Object.assign(Yr.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){var n=this;const s=this["_original_"+e]=this[e];this[e]=function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];const o=r[t],i=n.context.transport.schedule(e=>{r[t]=e,s.apply(n,r)},o);n._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,t,n,s){const r=this.toSeconds(n),a=this.toSeconds(t);return this.triggerAttack(e,r,s),this.triggerRelease(r+a),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Wa extends Ua{constructor(){const e=lr(Wa.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Ua.getDefaults(),{detune:0,onsilence:Tr,portamento:0})}triggerAttack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.log("triggerAttack",e,t,n);const s=this.toSeconds(t);return this._triggerEnvelopeAttack(s,n),this.setNote(e,s),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const n=this.toSeconds(t),s=e instanceof Br?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const e=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(s,e,n)}else this.frequency.setValueAtTime(s,n);return this}}Js([Va(0)],Wa.prototype,"portamento",void 0);class Ha extends Ba{constructor(){super(lr(Ha.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new ea({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Qa extends Wa{constructor(){const e=lr(Qa.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new La(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Ha(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),_r(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Wa.getDefaults(),{envelope:Object.assign(ur(Ba.getDefaults(),Object.keys(Yr.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(ur(La.getDefaults(),[...Object.keys(Ca.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),0===this.envelope.sustain){const t=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+t+n)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Ka extends Qa{constructor(){const e=lr(Ka.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,_r(this,["oscillator","envelope"])}static getDefaults(){return ir(Wa.getDefaults(),Qa.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const n=this.toSeconds(t),s=this.toFrequency(e instanceof Br?e.toFrequency():e),r=s*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(s,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Js([qa(0)],Ka.prototype,"octaves",void 0),Js([Va(0)],Ka.prototype,"pitchDecay",void 0);const Ya=new Set;function Xa(e){Ya.add(e)}function Za(e,t){const n=`registerProcessor("${e}", ${t})`;Ya.add(n)}Xa('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');Xa("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");Xa("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");const Ja="feedback-comb-filter";Za(Ja,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class eo extends Ua{constructor(){const e=lr(eo.getDefaults(),arguments,["voice","options"]);super(e),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=e=>this.releaseAll(e),Bs(!Fs(e.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const t=e.voice.getDefaults();this.options=Object.assign(t,e.options),this.voice=e.voice,this.maxPolyphony=e.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Ua.getDefaults(),{maxPolyphony:32,options:{},voice:Qa})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(e){this._availableVoices.push(e);const t=this._activeVoices.findIndex(t=>t.voice===e);this._activeVoices.splice(t,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return Bs(e instanceof Wa,"Voice must extend Monophonic class"),e.connect(this.output),this._voices.push(e),e}Ys("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const e=this._availableVoices.shift(),t=this._voices.indexOf(e);this._voices.splice(t,1),this.context.isOffline||e.dispose()}}_triggerAttack(e,t,n){e.forEach(e=>{const s=new ma(this.context,e).toMidi(),r=this._getNextAvailableVoice();r&&(r.triggerAttack(e,t,n),this._activeVoices.push({midi:s,voice:r,released:!1}),this.log("triggerAttack",e,t))})}_triggerRelease(e,t){e.forEach(e=>{const n=new ma(this.context,e).toMidi(),s=this._activeVoices.find(e=>{let{midi:t,released:s}=e;return t===n&&!s});s&&(s.voice.triggerRelease(t),s.released=!0,this.log("triggerRelease",e,t))})}_scheduleEvent(e,t,n,s){Bs(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===e?this._triggerAttack(t,n,s):this._triggerRelease(t,n):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(e,t,n,s)},n-this.now())}triggerAttack(e,t,n){Array.isArray(e)||(e=[e]);const s=this.toSeconds(t);return this._scheduleEvent("attack",e,s,n),this}triggerRelease(e,t){Array.isArray(e)||(e=[e]);const n=this.toSeconds(t);return this._scheduleEvent("release",e,n),this}triggerAttackRelease(e,t,n,s){const r=this.toSeconds(n);if(this.triggerAttack(e,r,s),Vs(t)){Bs(Vs(e),"If the duration is an array, the notes must also be an array");for(let n=0;n<e.length;n++){const s=t[Math.min(n,t.length-1)],a=this.toSeconds(s);Bs(a>0,"The duration must be greater than 0"),this.triggerRelease(e[n],r+a)}}else{const n=this.toSeconds(t);Bs(n>0,"The duration must be greater than 0"),this.triggerRelease(e,r+n)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(e){const t=ur(e,["onsilence","context"]);return this.options=ir(this.options,t),this._voices.forEach(e=>e.set(t)),this._dummyVoice.set(t),this}get(){return this._dummyVoice.get()}releaseAll(e){const t=this.toSeconds(e);return this._activeVoices.forEach(e=>{let{voice:n}=e;n.triggerRelease(t)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(e=>e.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class to extends Ua{constructor(){const e=lr(to.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const t={};Object.keys(e.urls).forEach(n=>{const s=parseInt(n,10);if(Bs(Gs(n)||Fs(s)&&isFinite(s),`url key is neither a note or midi pitch: ${n}`),Gs(n)){const s=new Br(this.context,n).toMidi();t[s]=e.urls[n]}else Fs(s)&&isFinite(s)&&(t[s]=e.urls[s])}),this._buffers=new ha({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Ua.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Tr,onerror:Tr,release:.1,urls:{}})}_findClosest(e){let t=0;for(;t<96;){if(this._buffers.has(e+t))return-t;if(this._buffers.has(e-t))return t;t++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.log("triggerAttack",e,t,n),Array.isArray(e)||(e=[e]),e.forEach(e=>{const s=qr(new Br(this.context,e).toFrequency()),r=Math.round(s),a=s-r,o=this._findClosest(r),i=r-o,l=this._buffers.get(i),c=Or(o+a),u=new _a({url:l,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:c}).connect(this.output);u.start(t,0,l.duration/c,n),Vs(this._activeSources.get(r))||this._activeSources.set(r,[]),this._activeSources.get(r).push(u),u.onended=()=>{if(this._activeSources&&this._activeSources.has(r)){const e=this._activeSources.get(r),t=e.indexOf(u);-1!==t&&e.splice(t,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(e=>{const n=new Br(this.context,e).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const e=this._activeSources.get(n);t=this.toSeconds(t),e.forEach(e=>{e.stop(t)}),this._activeSources.set(n,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(e=>{for(;e.length;){e.shift().stop(t)}}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const r=this.toSeconds(n);return this.triggerAttack(e,r,s),Vs(t)?(Bs(Vs(e),"notes must be an array when duration is array"),e.forEach((e,n)=>{const s=t[Math.min(n,t.length-1)];this.triggerRelease(e,r+this.toSeconds(s))})):this.triggerRelease(e,r+this.toSeconds(t)),this}add(e,t,n){if(Bs(Gs(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Gs(e)){const s=new Br(this.context,e).toMidi();this._buffers.add(s,t,n)}else this._buffers.add(e,t,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(e=>e.dispose())}),this._activeSources.clear(),this}}Js([Va(0)],to.prototype,"attack",void 0),Js([Va(0)],to.prototype,"release",void 0);class no extends Yr{constructor(){const e=lr(no.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new Kr({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",_r(this,"pan")}static getDefaults(){return Object.assign(Yr.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const so="bit-crusher";Za(so,"\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class ro extends Yr{constructor(){const e=lr(ro.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new ea({context:this.context}),ro._allSolos.has(this.context)||ro._allSolos.set(this.context,new Set),ro._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(Yr.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),ro._allSolos.get(this.context).forEach(e=>e._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){ro._soloed.has(this.context)||ro._soloed.set(this.context,new Set),ro._soloed.get(this.context).add(this)}_removeSolo(){ro._soloed.has(this.context)&&ro._soloed.get(this.context).delete(this)}_isSoloed(){return ro._soloed.has(this.context)&&ro._soloed.get(this.context).has(this)}_noSolos(){return!ro._soloed.has(this.context)||ro._soloed.has(this.context)&&0===ro._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),ro._allSolos.get(this.context).delete(this),this._removeSolo(),this}}ro._allSolos=new Map,ro._soloed=new Map;class ao extends Yr{constructor(){const e=lr(ao.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new no({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new ca({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,_r(this,["pan","volume"])}static getDefaults(){return Object.assign(Yr.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class oo extends Yr{constructor(){const e=lr(oo.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new ro({solo:e.solo,context:this.context}),this._panVol=this.output=new ao({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),_r(this,["pan","volume"])}static getDefaults(){return Object.assign(Yr.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return oo.buses.has(e)||oo.buses.set(e,new ea({context:this.context})),oo.buses.get(e)}send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this._getBus(e),s=new ea({context:this.context,units:"decibels",gain:t});return this.connect(s),s.connect(n),s}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}oo.buses=new Map;function io(){return Rr().now()}const lo=Rr().transport;function co(){return Rr().transport}Rr().destination,Rr().destination;Rr().listener;Rr().draw;const uo=Rr();const ho={0:"1",1:"b2",2:"2",3:"b3",4:"3",5:"4",6:"#4/b5",7:"5",8:"b6",9:"6",10:"b7",11:"7"},mo=["C","D","E","F","G","A","B"],fo={C:0,D:2,E:4,F:5,G:7,A:9,B:11},po={C:0,"B#":0,"C#":1,"C\u266f":1,Db:1,"D\u266d":1,D:2,"D#":3,"D\u266f":3,Eb:3,"E\u266d":3,E:4,Fb:4,"F\u266d":4,F:5,"E#":5,"E\u266f":5,"F#":6,"F\u266f":6,Gb:6,"G\u266d":6,G:7,"G#":8,"G\u266f":8,Ab:8,"A\u266d":8,A:9,"A#":10,"A\u266f":10,Bb:10,"B\u266d":10,B:11,Cb:11,"C\u266d":11},go={1:[{name:"C\u266f",weight:1},{name:"D\u266d",weight:4}],3:[{name:"D\u266f",weight:1},{name:"E\u266d",weight:4}],6:[{name:"F\u266f",weight:3},{name:"G\u266d",weight:2}],8:[{name:"G\u266f",weight:2},{name:"A\u266d",weight:3}],10:[{name:"A\u266f",weight:1},{name:"B\u266d",weight:4}]},xo={0:"1",1:"2",2:"2",3:"3",4:"3",5:"4",6:"5",7:"5",8:"6",9:"6",10:"7",11:"7"},bo=e=>e?e.replace("\u266f","#").replace("\u266d","b").replace("\ud834\udd2a","##").replace("\ud834\udd2b","bb"):"",vo=e=>{const t=go[po[e]];if(!t)return e;const n=t.reduce((e,t)=>e+t.weight,0);let s=Math.random()*n;for(const r of t){if(s<r.weight)return r.name;s-=r.weight}return t[0].name},yo=(e,t,n)=>{if("Unison"===n||"Octave"===n)return e.charAt(0).toUpperCase()+e.slice(1).replace(/[0-9]/g,"");if("Tritone"===n){return["C","C\u266f","D","D\u266f","E","F","F\u266f","G","G\u266f","A","A\u266f","B"][t%12]}const s=parseInt(n.replace(/[^0-9]/g,""),10);if(isNaN(s))return null;const r=e.charAt(0),a=mo.indexOf(r);if(-1===a)return null;const o=mo[(a+s-1)%7];let i=t%12-fo[o];i<-6&&(i+=12),i>6&&(i-=12);let l="";return 1===i?l="\u266f":2===i?l="\ud834\udd2a":-1===i?l="\u266d":-2===i&&(l="\ud834\udd2b"),`${o}${l}`},wo=(e,t)=>{const n=Object.keys(So).find(e=>e.toLowerCase()===t.toLowerCase()),s=n?So[n]:null;if(!s)return console.error(`Chord quality '${t}' not found.`),null;const r=Ao[e];if(void 0===r)return console.error(`Root note '${e}' not found.`),null;return s.intervals.map(t=>yo(e,r+t,xo[t])).filter(Boolean)},jo={Major:[0,2,4,5,7,9,11],"Natural Minor":[0,2,3,5,7,8,10],"Harmonic Minor":[0,2,3,5,7,8,11],"Melodic Minor":[0,2,3,5,7,9,11]},ko={Major_Triads:["Major","Minor","Minor","Major","Major","Minor","Diminished"],"Natural Minor_Triads":["Minor","Diminished","Major","Minor","Minor","Major","Major"],"Harmonic Minor_Triads":["Minor","Diminished","Augmented","Minor","Major","Major","Diminished"],"Melodic Minor_Triads":["Minor","Minor","Augmented","Major","Major","Diminished","Diminished"],Major_7ths:["Major 7th","Minor 7th","Minor 7th","Major 7th","Dominant 7th","Minor 7th","Half-Diminished 7th"],"Natural Minor_7ths":["Minor 7th","Half-Diminished 7th","Major 7th","Minor 7th","Minor 7th","Major 7th","Dominant 7th"],"Harmonic Minor_7ths":["Minor-Major 7th","Half-Diminished 7th","Augmented Major 7th","Minor 7th","Dominant 7th","Major 7th","Diminished 7th"],"Melodic Minor_7ths":["Minor-Major 7th","Minor 7th","Augmented Major 7th","Dominant 7th","Dominant 7th","Half-Diminished 7th","Half-Diminished 7th"]},No={Major:"",Minor:"m",Diminished:"dim",Augmented:"aug","Major 7th":"maj7","Minor 7th":"m7","Dominant 7th":"7","Half-Diminished 7th":"m7b5","Diminished 7th":"\xb07","Minor-Major 7th":"m(maj7)","Augmented Major 7th":"+maj7",Sus2:"sus2",Sus4:"sus4"},Co=["I","II","III","IV","V","VI","VII"],_o={Major:{intervals:jo.Major},"Natural Minor":{intervals:jo["Natural Minor"]},"Harmonic Minor":{intervals:jo["Harmonic Minor"]},"Melodic Minor":{intervals:jo["Melodic Minor"]}},So={Major:{intervals:[0,4,7],quality:"Major"},Minor:{intervals:[0,3,7],quality:"Minor"},Diminished:{intervals:[0,3,6],quality:"Diminished"},Augmented:{intervals:[0,4,8],quality:"Augmented"},"Major 7th":{intervals:[0,4,7,11],quality:"Major 7th"},"Minor 7th":{intervals:[0,3,7,10],quality:"Minor 7th"},"Dominant 7th":{intervals:[0,4,7,10],quality:"Dominant 7th"},"Half-Diminished 7th":{intervals:[0,3,6,10],quality:"Half-Diminished 7th"},"Diminished 7th":{intervals:[0,3,6,9],quality:"Diminished 7th"},"Minor-Major 7th":{intervals:[0,3,7,11],quality:"Minor-Major 7th"},"Augmented Major 7th":{intervals:[0,4,8,11],quality:"Augmented Major 7th"},Sus2:{intervals:[0,2,7],quality:"Sus"},Sus4:{intervals:[0,5,7],quality:"Sus"}},To={qualities:{Major:[0,4,7],Minor:[0,3,7],Diminished:[0,3,6],Augmented:[0,4,8],Sus2:[0,2,7],Sus4:[0,5,7]},inversions:{Root:e=>e,"1st":e=>[e[1]-e[0],e[2]-e[0],12],"2nd":e=>[e[2]-e[0],12,e[1]-e[0]+12]}},Ao={C:48,"C#":49,"C\u266f":49,Db:49,"D\u266d":49,D:50,"D#":51,"D\u266f":51,Eb:51,"E\u266d":51,E:52,F:53,"F#":54,"F\u266f":54,Gb:54,"G\u266d":54,G:55,"G#":56,"G\u266f":56,Ab:56,"A\u266d":56,A:57,"A#":58,"A\u266f":58,Bb:58,"B\u266d":58,B:59,Cb:59,"C\u266d":59,"B#":60,"B\u266f":60,"E#":53,"E\u266f":53,Fb:52,"F\u266d":52,Bbb:57,"B\u266d\u266d":57,Abb:55,"A\u266d\u266d":55,"C##":50,"C\ud834\udd2a":50,"D##":52,"D\ud834\udd2a":52,"F##":55,"F\ud834\udd2a":55,"G##":57,"G\ud834\udd2a":57,"A##":59,"A\ud834\udd2a":59},Mo=(e,t)=>{const n=jo[t];if(!n)return[];const s=Ao[e];if(void 0===s)return[];const r=e.charAt(0),a=mo.indexOf(r);return n.map((e,t)=>{const n=mo[(a+t)%7],r=s+e;let o=fo[n]+12*Math.floor(r/12);Math.abs(r-o)>6&&(r>o?o+=12:o-=12),Math.abs(r-(o-12))<Math.abs(r-o)&&(o-=12),Math.abs(r-(o+12))<Math.abs(r-o)&&(o+=12);const i=r-o;let l="";return 1===i?l="#":2===i?l="##":-1===i?l="b":-2===i&&(l="bb"),`${n}${l}`})},Eo=(e,t,n)=>{const s=Mo(e,t),r=ko[`${t}_${n}`];return s.length&&r?s.map((e,t)=>{var n;const s=r[t],a=null!==(n=No[s])&&void 0!==n?n:"";let o=Co[t];return s.includes("Minor")?o=o.toLowerCase():s.includes("Diminished")?o=o.toLowerCase()+"\xb0":s.includes("Augmented")&&(o+="+"),{roman:o,name:`${e}${a}`,root:e,quality:s,type:"diatonic"}}):[]},Do=(()=>{const e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return[{openNote:"E",midi:40},{openNote:"A",midi:45},{openNote:"D",midi:50},{openNote:"G",midi:55},{openNote:"B",midi:59},{openNote:"E",midi:64}].map(t=>{const n=[];for(let s=0;s<=24;s++){const r=t.midi+s,a=e[r%12];n.push({note:a,midi:r})}return n})})(),Ro={0:"1",1:"b2",2:"2",3:"b3",4:"3",5:"4",6:"#4/b5",7:"5",8:"b6",9:"6",10:"b7",11:"7"},Io=(e,t)=>{const n=(t-e)%12;return Ro[n<0?n+12:n]||"?"},Po=function(e,t,n,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Do;const a=To.qualities[t];if(!a)return[];const o=Ao[e];if(void 0===o)return[];const i=o%12,l=new Set(a.map(e=>(i+e)%12)),c=[];for(let u=0;u<=15;u++){const e=[];for(const t of s){let n=null;for(let s=u;s<u+5;s++){if(s>=r[6-t].length)continue;const a=r[6-t][s];if(l.has(a.midi%12)&&!e.some(e=>e.midi%12===a.midi%12)){n={string:t,fret:s,midi:a.midi,label:a.note};break}}n&&e.push(n)}if(3===e.length){const r=e.map(e=>{const t=(e.midi-o)%12,n=t<0?t+12:t,s=Io(o,e.midi);return{...e,isRoot:0===n,degree:s}}),a=Math.max(...s),i=r.find(e=>e.string===a);if(!i)continue;let l=null;if(l="1"===i.degree?"Root":"5"===i.degree?"2nd":"1st",l===n){const e=[...r].sort((e,t)=>t.string-e.string).map(e=>e.degree);if("Sus2"===t&&"Root"===n&&("2"!==e[1]||"5"!==e[2]))continue;if("Sus4"===t&&"2nd"===n&&("1"!==e[1]||"4"!==e[2]))continue;const s=r.map(e=>`${e.string}-${e.fret}`).sort().join(",");c.some(e=>e.signature===s)||c.push({signature:s,notes:r})}}}return c.map(e=>e.notes)},Oo=[{id:"default-01",name:"Default Notes",gameId:"note-generator",gameName:"Note Generator",isDefault:!0,settings:{numNotes:12,noteType:"chromatic",showBarlines:!0,fontSize:2.7,barlineFrequency:4,avoidRepeats:!0}},{id:"default-02",name:"Default Intervals",gameId:"interval-generator",gameName:"Interval Generator",isDefault:!0,settings:{numIntervals:1,selectedQualities:{Perfect:!0,Major:!0,Minor:!0,Augmented:!1,Diminished:!1},useShorthand:!1,displayMode:"stacked"}},{id:"default-03",name:"Default Chord Progressions",gameId:"chord-progression-generator",gameName:"Chord Progression Generator",isDefault:!0,settings:{rootNote:"C",keyType:"Major",numChords:4,numProgressions:1,chordComplexity:"Triads",useCommonPatterns:!0,includeDiminished:!1,qualityFilter:"all",fontSize:3,useAlternateNotation:!1,generationMode:"diatonic",allowedQualities:{major:!0,minor:!0,diminished:!1,augmented:!1},includeSusChords:!1,displayMode:"measure",chordDegreeView:"both",chordsPerBar:1,barsPerLine:4,flowBarlineFrequency:4}},{id:"default-04",name:"Default Interval Quiz",gameId:"intervals-quiz",gameName:"Interval Practice",isDefault:!0,settings:{quizMode:"mixed",rootNoteType:"chromatic",direction:"both",autoAdvance:!0,playAudio:!0,selectedIntervals:{"Perfect Unison":!0,"Minor 2nd":!0,"Major 2nd":!0,"Minor 3rd":!0,"Major 3rd":!0,"Perfect 4th":!0,"Augmented 4th":!0,"Diminished 5th":!0,"Perfect 5th":!0,"Minor 6th":!0,"Major 6th":!0,"Minor 7th":!0,"Major 7th":!0,"Perfect Octave":!0},audioDirection:"above",fretboardVolume:-6}},{id:"default-05",name:"Default Triads Quiz",gameId:"triad-quiz",gameName:"Triad & Tetrads Quiz",isDefault:!0,settings:{quizMode:"mixed",include7ths:!1,includeInversions:!1,autoAdvance:!0,playAudio:!0}},{id:"default-06",name:"Default Chord Trainer",gameId:"chord-trainer",gameName:"Chord Trainer",isDefault:!0,settings:{selectedKeys:["C","G","F"],selectedModes:[1,4],use7thChords:!1,generationMethod:"weighted",majorWeights:[10,6,4,8,10,8,2],degreeToggles:{I:!0,ii:!0,iii:!0,IV:!0,V:!0,vi:!0,"vii\xb0":!0},useAlternateNotation:!1,autoAdvance:!0,hideQuality:!1}},{id:"default-07",name:"Default Fretboard Intervals",gameId:"interval-fretboard-quiz",gameName:"Fretboard Intervals",isDefault:!0,settings:{autoAdvance:!0,playAudio:!0,labelType:"name",fretboardVolume:-6}},{id:"default-08",name:"Default CAGED Quiz",gameId:"caged-system-quiz",gameName:"CAGED System Quiz",isDefault:!0,settings:{includeMajor:!0,includeMinor:!0,shapes:{E:!0,A:!0,G:!0,C:!0,D:!0},showDegrees:!1,quizMode:"mixed"}},{id:"default-11",name:"Default Fretboard Triads",gameId:"fretboard-triads",gameName:"Fretboard Triads",isDefault:!0,settings:{modes:{identify:!0,constructHorizontally:!0,constructVertically:!0},stringSets:{"E A D":!0,"A D G":!0,"D G B":!0,"G B e":!0},qualities:{Major:!0,Minor:!0,Diminished:!1,Augmented:!1,Sus2:!1,Sus4:!1},inversions:{Root:!0,"1st":!0,"2nd":!0},autoAdvance:!0,postAnswerDisplay:"degrees",showRootHint:!1}},{id:"default-09",name:"Default Interval Recognition",gameId:"interval-ear-trainer",gameName:"Interval Recognition",isDefault:!0,settings:{autoAdvance:!0,isTrainingMode:!1,playbackStyle:"Melodic",direction:"Ascending",notePool:"Diatonic",diatonicMode:"Major",answerMode:"Interval Name",rootNoteMode:"Fixed",fixedKey:"C",questionsPerRoot:5,octaveRange:2,useDrone:!0,playRootNote:!0,showKeyChange:!1,replayOnAnswer:!1}},{id:"default-10",name:"Default Melodic Recognition",gameId:"melodic-ear-trainer",gameName:"Melodic Recognition",isDefault:!0,settings:{autoAdvance:!0,answerMode:"Scale Degrees",octaveRange:1,melodyLength:4,startOnRoot:!0,playRootFirst:!1,useDrone:!0,notePool:"Diatonic",diatonicMode:"Major",rootNoteMode:"Roving",fixedKey:"C",questionsPerRoot:5,replayOnAnswer:!1}},{id:"default-12",name:"Default Chord Recognition",gameId:"chord-ear-trainer",gameName:"Chord Recognition",isDefault:!0,settings:{autoAdvance:!0,playbackStyle:"Harmonic",qualities:{Major:!0,Minor:!0,Diminished:!0,Augmented:!1,Sus2:!1,Sus4:!1,"Major 7th":!0,"Minor 7th":!0,"Dominant 7th":!0,"Half-Diminished 7th":!1,"Diminished 7th":!1},keyMode:"Fixed",questionsPerKey:5,fixedKey:"C",useDrone:!0}},{id:"default-13",name:"Default Progression Recognition",gameId:"progression-ear-trainer",gameName:"Progression Recognition",isDefault:!0,settings:{autoAdvance:!0,keyType:"Major",keyMode:"Fixed",fixedKey:"C",chordFilter:"All",excludeDiminished:!0,startOnTonic:!0,questionsPerKey:3,useDrone:!0}},{id:"default-14",name:"Default Circle of 5ths",gameId:"music-circles",gameName:"Music Circles",isDefault:!0,settings:{mode:"Chromatic",circleInterval:7,rootNote:"C",scaleType:"Major",showLabels:!0}}],Fo=(e,t)=>{const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const r of n){const n=e[r],s=t[r],a="object"===typeof n&&null!==n&&"object"===typeof s&&null!==s;if(a&&!Fo(n,s)||!a&&n!==s)return!1}return!0};var Lo=n(960);const qo=(0,e.createContext)(null),Vo=()=>(0,e.useContext)(qo),zo=t=>{let{children:n}=t;const[s,r]=(0,e.useState)(null),[a,o]=(0,e.useState)("welcome"),[i,l]=(0,e.useState)(null),[c,u]=(0,e.useState)(null),[d,h]=(0,e.useState)(null),[m,f]=(0,e.useState)(0),[p,g]=(0,e.useState)(null),[x,b]=(0,e.useState)(null),v=(0,e.useCallback)(async()=>{if("suspended"===uo.state)try{await Dr.resume(),console.log("Audio Context unlocked and running.")}catch(e){console.error("Could not start Audio Context",e)}},[]),y=(0,e.useCallback)(e=>{v(),o(e),l(null)},[v]),w=(0,e.useCallback)(e=>{l(t=>t===e?null:e)},[]),j=(0,e.useCallback)(e=>{r(t=>t===e?null:e)},[]);(0,e.useEffect)(()=>{const e=()=>v();return window.addEventListener("click",e,{once:!0}),()=>window.removeEventListener("click",e)},[v]);const k=(0,e.useCallback)(()=>u(null),[]),N=(()=>{const[t,n]=(0,e.useState)(()=>{try{const e=localStorage.getItem("practiceLog");return e?JSON.parse(e):[]}catch(e){return[]}});(0,e.useEffect)(()=>{localStorage.setItem("practiceLog",JSON.stringify(t))},[t]);const s=(0,e.useCallback)(e=>{n(t=>[...t,e])},[]),r=(0,e.useCallback)(()=>{window.confirm("Are you sure you want to clear the entire practice log? This action cannot be undone.")&&n([])},[]),a=(0,e.useCallback)(e=>{if(!e)return;if(!window.confirm("Are you sure you want to import a new log? This will overwrite your current practice log."))return;const t=new FileReader;t.onload=e=>{try{const t=JSON.parse(e.target.result);if(Array.isArray(t)){if(t.length>0&&(void 0===t[0].game||void 0===t[0].date||void 0===t[0].remarks))return void alert("Import failed: The JSON file has an invalid format.");n(t),alert("Practice log imported successfully!")}else alert("Import failed: The JSON file does not contain a valid log array.")}catch(t){console.error("Failed to parse log file:",t),alert("Import failed: Not a valid JSON file.")}},t.readAsText(e)},[]);return{practiceLog:t,addLogEntry:s,clearLog:r,importLog:a}})(),C=(t=>{const[n,s]=(0,e.useState)(120),[r,a]=(0,e.useState)(!1),[o,i]=(0,e.useState)(-10),[l,c]=(0,e.useState)(!1),[u,d]=(0,e.useState)(4),h=(0,e.useRef)(null),m=(0,e.useRef)([]),f=(0,e.useRef)({id:null,beatCounter:0}),p=(0,e.useRef)(null);(0,e.useEffect)(()=>{let e=!1,t=!1;const n=()=>{e&&t&&c(!0)};h.current=new za({url:"/musical-tools-app/sounds/click.wav",fadeOut:.1,onload:()=>{e=!0,n()}}).toDestination();let s=0;const r=["1.wav","2.wav","3.wav","4.wav","5.wav","6.wav","7.wav"],a=r.length;return m.current=r.map(e=>new za({url:`/musical-tools-app/sounds/${e}`,onload:()=>{s++,s===a&&(t=!0,n())}}).toDestination()),()=>{var e;null===(e=h.current)||void 0===e||e.dispose(),m.current.forEach(e=>e.dispose()),"started"===co().state&&(co().stop(),co().cancel())}},[]),(0,e.useEffect)(()=>{l&&(h.current.volume.value=o,m.current.forEach(e=>{e.volume.value=o}))},[o,l]);const g=(0,e.useCallback)(()=>{if(!l)return;const e=co();e.bpm.value=n,f.current.id&&e.clear(f.current.id),"stopped"===e.state&&(f.current.beatCounter=0),f.current.id=e.scheduleRepeat(e=>{const t=p.current;if(!t||!t.callback||t.interval<=0)return void(h.current&&h.current.loaded&&h.current.start(e));const n=t.interval,s=u>0?u:0,r=n+s,a=f.current.beatCounter%r;if(0===a&&t.callback(),a<s){const t=a,n=m.current[t];n&&n.loaded?n.start(e):h.current&&h.current.loaded&&h.current.start(e)}else h.current&&h.current.loaded&&h.current.start(e);f.current.beatCounter++},"4n"),"started"!==e.state&&e.start(io()+.1),a(!0)},[n,l,u]),x=(0,e.useCallback)(()=>{const e=co();e.stop(),e.cancel(),e.position=0,f.current.id=null,f.current.beatCounter=0,a(!1)},[]),b=(0,e.useCallback)(e=>{const t="started"===co().state;t&&x(),p.current=e,t&&setTimeout(()=>{g()},50)},[g,x]),v=(0,e.useCallback)(async()=>{await t(),r?x():g()},[r,x,g,t]);return(0,e.useEffect)(()=>{r&&(co().bpm.value=n)},[n,r]),{bpm:n,setBpm:s,isMetronomePlaying:r,toggleMetronome:v,metronomeVolume:o,setMetronomeVolume:i,isMetronomeReady:l,setMetronomeSchedule:b,countdownClicks:u,setCountdownClicks:d}})(v),_=(t=>{const[n,s]=(0,e.useState)("C"),[r,a]=(0,e.useState)(!1),[o,i]=(0,e.useState)(-10),[l,c]=(0,e.useState)(!1),u=(0,e.useRef)({});(0,e.useEffect)(()=>{const e={},t=["c","cs","d","ds","e","f","fs","g","gs","a","as","b"];let n=0;return t.forEach(s=>{e[s.toUpperCase().replace("S","#")]=new za({url:`/musical-tools-app/sounds/${s}_drone.mp3`,loop:!0,fadeOut:3,fadeIn:3,onload:()=>{n++,n===t.length&&c(!0)}}).toDestination()}),u.current=e,()=>{Object.values(u.current).forEach(e=>e.dispose())}},[]),(0,e.useEffect)(()=>{l&&Object.values(u.current).forEach(e=>e.volume.value=o)},[o,l]);const d=(0,e.useCallback)(async()=>{await t(),l&&a(e=>!e)},[l,t]),h=(0,e.useCallback)(()=>{const e=Object.keys(u.current);if(0===e.length)return;let t;do{t=e[Math.floor(Math.random()*e.length)]}while(t===n&&e.length>1);s(t)},[n]);return(0,e.useEffect)(()=>{const e=u.current[n];if(r){if(!e||!e.loaded)return;Object.values(u.current).forEach(t=>{t!==e&&"started"===t.state&&t.stop()}),"started"!==e.state&&e.start()}else Object.values(u.current).forEach(e=>{"started"===e.state&&e.stop()})},[n,r,l]),{droneNote:n,setDroneNote:s,isDronePlaying:r,toggleDrone:d,droneVolume:o,setDroneVolume:i,areDronesReady:l,randomizeDroneNote:h}})(v),S=(t=>{const[n,s]=(0,e.useState)(600),[r,a]=(0,e.useState)(n),[o,i]=(0,e.useState)(!1),l=(0,e.useRef)(null),c=(0,e.useRef)(new Audio("/musical-tools-app/sounds/ding.wav"));(0,e.useEffect)(()=>(o?l.current=setInterval(()=>{a(e=>e<=1?(clearInterval(l.current),i(!1),c.current.play(),0):e-1)},1e3):clearInterval(l.current),()=>clearInterval(l.current)),[o]);const u=(0,e.useCallback)(async()=>{await t(),r>0&&i(e=>!e)},[r,t]),d=(0,e.useCallback)(e=>{const t=60*(e||n/60);i(!1),s(t),a(t)},[n]);return{timeLeft:r,isTimerRunning:o,toggleTimer:u,resetTimer:d,timerDuration:n,setTimerDuration:s}})(v),T=(()=>{const[t,n]=(0,e.useState)(0),[s,r]=(0,e.useState)(!1),[a,o]=(0,e.useState)([]),i=(0,e.useRef)(),l=(0,e.useRef)();(0,e.useEffect)(()=>{if(s){const e=t=>{if(null!=l.current){const e=t-l.current;n(t=>t+e)}l.current=t,i.current=requestAnimationFrame(e)};l.current=performance.now(),i.current=requestAnimationFrame(e)}else cancelAnimationFrame(i.current);return()=>cancelAnimationFrame(i.current)},[s]);const c=(0,e.useCallback)(()=>{r(e=>!e)},[]),u=(0,e.useCallback)(()=>{r(!1),n(0),o([])},[]),d=(0,e.useCallback)(()=>{s&&o(e=>[...e,t])},[s,t]);return(0,e.useMemo)(()=>({stopwatchTime:t,isStopwatchRunning:s,laps:a,toggleStopwatch:c,resetStopwatch:u,addLap:d}),[t,s,a,c,u,d])})(),A=(t=>{const n=(0,e.useRef)(null),s=(0,e.useRef)(null),[r,a]=(0,e.useState)(!1),[o,i]=(0,e.useState)(-6),[l,c]=(0,e.useState)(0);(0,e.useEffect)(()=>{n.current=new eo(Qa,{oscillator:{type:"sine"},envelope:{attack:.02,decay:.1,sustain:.3,release:1}}).toDestination();const e={};for(let t=1;t<=6;t++)for(let n=0;n<=12;n++)e[`${t}-${n}`]=`/musical-tools-app/sounds/fretboard/${t}-${n}.mp3`;return s.current=new Ga(e,{onload:()=>{a(!0),console.log("Fretboard sounds loaded.")},fadeIn:.1,fadeOut:.1}).toDestination(),()=>{var e,t;null===(e=n.current)||void 0===e||e.dispose(),null===(t=s.current)||void 0===t||t.dispose()}},[]),(0,e.useEffect)(()=>{r&&s.current&&(s.current.volume.value=o)},[o,r]),(0,e.useEffect)(()=>{n.current&&(n.current.volume.value=l)},[l]);const u=(0,e.useCallback)(async e=>{if(!e||e.length<2||!n.current)return;await t(),n.current.releaseAll();const s=io();n.current.triggerAttackRelease(e[0],.4,s),n.current.triggerAttackRelease(e[1],.4,s+.5),n.current.triggerAttackRelease(e,.8,s+1.2)},[t]),d=(0,e.useCallback)(async e=>{if(!r||!e||e.length<2)return;await t();const n=`${e[0].string}-${e[0].fret}`,a=`${e[1].string}-${e[1].fret}`;if(!s.current.has(n)||!s.current.has(a))return void console.error("Audio for notes not found:",n,a);const o=io(),i=s.current.player(n),l=s.current.player(a);"started"===i.state&&i.stop(0),"started"===l.state&&l.stop(0),i.start(o),l.start(o+.5),i.start(o+1.2),l.start(o+1.2)},[r,t]);return{playInterval:u,playChord:(0,e.useCallback)(async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Harmonic",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;if(!r||!e||0===e.length)return;await t();let o=52;const i=[];for(const t of e){const e=Ao[t]%12;let n=null;for(let t=o+1;t<80;t++){if(t%12===e)for(let e=1;e<=6;e++){for(let s=0;s<=12;s++)if(Do[6-e][s].midi===t){n={string:e,fret:s,midi:t};break}if(n)break}if(n)break}n&&(i.push(n),o=n.midi)}if(i.length!==e.length)return void console.error("Could not build a full ascending voicing for:",e.join(", "));const l=io(),c=(e,t)=>{const n=`${e.string}-${e.fret}`;s.current.has(n)&&s.current.player(n).start(t)};if("Melodic"===n)i.forEach((e,t)=>c(e,l+t*a));else if("Harmonic"===n)i.forEach(e=>c(e,l));else if("Both"===n){const e=.5;i.forEach((t,n)=>{c(t,l+n*e)});const t=l+(i.length-1)*e+.7;i.forEach(e=>{c(e,t)})}},[r,t]),playFretboardNotes:d,areFretboardSoundsReady:r,fretboardVolume:o,setFretboardVolume:i,intervalSynthVolume:l,setIntervalSynthVolume:c,fretboardPlayers:s}})(v,C.bpm),M=(()=>{const[t,n]=(0,e.useState)(()=>{try{const e=localStorage.getItem("routineScores");return e?JSON.parse(e):[]}catch(e){return console.error("Error reading scores from localStorage",e),[]}});(0,e.useEffect)(()=>{localStorage.setItem("routineScores",JSON.stringify(t))},[t]);const s=(0,e.useCallback)(e=>{n(t=>[e,...t])},[]),r=(0,e.useCallback)(()=>{window.confirm("Are you sure you want to clear the entire scoreboard? This is irreversible.")&&n([])},[]),a=(0,e.useCallback)(e=>{window.confirm("Are you sure you want to delete this result?")&&n(t=>t.filter(t=>t.id!==e))},[]);return{scores:t,saveRoutineResult:s,clearScoreboard:r,deleteScore:a}})(),E=(()=>{const[t,n]=(0,e.useState)(()=>{try{const e=localStorage.getItem("routines");return(e?JSON.parse(e):[]).map(e=>(e.folderId&&!e.folderIds?(e.folderIds=[e.folderId],delete e.folderId):e.folderIds||(e.folderIds=[]),e))}catch(e){return[]}}),[s,r]=(0,e.useState)(()=>{try{const e=localStorage.getItem("routineFolders");return e?JSON.parse(e):[]}catch(e){return[]}});(0,e.useEffect)(()=>{localStorage.setItem("routines",JSON.stringify(t))},[t]),(0,e.useEffect)(()=>{localStorage.setItem("routineFolders",JSON.stringify(s))},[s]);const a=(0,e.useCallback)(e=>{n(t=>{const n=t.findIndex(t=>t.id===e.id);if(n>-1){const s=[...t];return s[n]={...e,createdAt:t[n].createdAt,folderIds:t[n].folderIds||[],lastPlayed:t[n].lastPlayed},s}{const n={...e,createdAt:(new Date).toISOString(),folderIds:[]};return[...t,n]}})},[]),o=(0,e.useCallback)(e=>{window.confirm("Are you sure you want to delete this routine?")&&n(t=>t.filter(t=>t.id!==e))},[]),i=(0,e.useCallback)(e=>{if(!e||""===e.trim())return;const t={id:`folder_${Date.now()}`,name:e.trim()};r(e=>[...e,t])},[]),l=(0,e.useCallback)((e,t)=>{t&&""!==t.trim()&&r(n=>n.map(n=>n.id===e?{...n,name:t.trim()}:n))},[]),c=(0,e.useCallback)(e=>{window.confirm("Are you sure you want to delete this folder? This will not delete the routines inside it.")&&(r(t=>t.filter(t=>t.id!==e)),n(t=>t.map(t=>({...t,folderIds:t.folderIds.filter(t=>t!==e)}))))},[]),u=(0,e.useCallback)((e,t)=>{n(n=>n.map(n=>{if(n.id===e){const e=n.folderIds.includes(t)?n.folderIds.filter(e=>e!==t):[...n.folderIds,t];return{...n,folderIds:e}}return n}))},[]),d=(0,e.useCallback)(e=>{n(t=>t.map(t=>t.id===e?{...t,lastPlayed:(new Date).toISOString()}:t))},[]),h=(0,e.useCallback)((e,t)=>{if(!e)return alert("Could not find the routine to export.");const n=new Set(e.steps.map(e=>e.presetId)),s={type:"MusicToolsRoutineBundle",routine:e,requiredPresets:t.filter(e=>n.has(e.id))},r=JSON.stringify(s,null,2),a=new Blob([r],{type:"application/json"}),o=URL.createObjectURL(a),i=document.createElement("a"),l=e.name.replace(/[^a-z0-9]/gi,"_").toLowerCase();i.download=`routine_${l}.routine.json`,i.href=o,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)},[]),m=(0,e.useCallback)((e,n,r)=>{let a,o;if(Array.isArray(e))a=t.filter(t=>e.includes(t.id)),o=r||"custom_selection";else{const n=s.find(t=>t.id===e);if(!n)return alert("Folder not found.");a=t.filter(t=>t.folderIds&&t.folderIds.includes(e)),o=n.name}if(0===a.length)return alert("There are no routines to export in this selection.");const i=new Set(a.flatMap(e=>e.steps.map(e=>e.presetId))),l={type:"MusicToolsRoutineFolderBundle",folderName:o,routines:a,requiredPresets:n.filter(e=>i.has(e.id))},c=JSON.stringify(l,null,2),u=new Blob([c],{type:"application/json"}),d=URL.createObjectURL(u),h=document.createElement("a"),m=(r||o).replace(/[^a-z0-9]/gi,"_").toLowerCase();h.download=`routine_folder_${m}.routine.json`,h.href=d,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(d)},[t,s]),f=(0,e.useCallback)((e,t)=>{if(!e||!t)return;const n=new FileReader;n.onload=e=>{try{const n=JSON.parse(e.target.result);if("MusicToolsRoutineFolderBundle"===n.type){if(!n.folderName||!n.routines||!n.requiredPresets)return alert("Import failed: Invalid folder bundle file.");if(!window.confirm(`Import the "${n.folderName}" folder and its ${n.routines.length} routines?`))return;n.requiredPresets.forEach(t);let e=s.find(e=>e.name.toLowerCase()===n.folderName.toLowerCase());e||(e={id:`folder_${Date.now()}`,name:n.folderName},r(t=>[...t,e])),n.routines.map(t=>({...t,folderIds:[e.id]})).forEach(a),alert(`Folder "${n.folderName}" imported successfully!`)}else"MusicToolsRoutineBundle"===n.type?(n.requiredPresets.forEach(t),a(n.routine),alert(`Routine "${n.routine.name}" imported successfully!`)):alert("Import failed: This does not appear to be a valid Routine file.")}catch(n){alert("Import failed: The selected file is not a valid JSON file.")}},n.readAsText(e)},[a,s]);return{routines:t,saveRoutine:a,deleteRoutine:o,exportRoutine:h,importRoutines:f,folders:s,addFolder:i,renameFolder:l,deleteFolder:c,toggleRoutineInFolder:u,exportFolder:m,updateRoutineLastPlayed:d}})(),{presets:D,updatePreset:R,...I}=(t=>{const[n,s]=(0,e.useState)(()=>{try{const e=localStorage.getItem("toolPresets"),t=e?JSON.parse(e):[];return[...Oo,...t]}catch(e){return console.error("Error reading presets from localStorage",e),[...Oo]}});(0,e.useEffect)(()=>{const e=n.filter(e=>!e.isDefault);localStorage.setItem("toolPresets",JSON.stringify(e))},[n]);const r=(0,e.useCallback)(e=>{const t={...e,isDefault:!1};s(e=>[...e,t])},[]),a=(0,e.useCallback)(e=>{const t=e.map(e=>({...e,isDefault:!1}));return s(e=>{const n=new Set(e.map(e=>e.id)),s=t.filter(e=>!n.has(e.id));return s.length<t.length&&alert(`Note: ${t.length-s.length} preset(s) were ignored because their IDs already exist.`),[...e,...s]}),t.length},[]),o=(0,e.useCallback)((e,t)=>{s(n=>n.map(n=>n.id===e?{...n,...t}:n))},[]),i=(0,e.useCallback)(e=>{const t=n.find(t=>t.id===e);t&&t.isDefault?alert("Default presets cannot be deleted."):window.confirm("Are you sure you want to delete this preset?")&&s(t=>t.filter(t=>t.id!==e))},[n]),l=(0,e.useCallback)(e=>{if(!e||0===e.length)return alert("No presets selected to delete.");const t=n.filter(t=>e.includes(t.id)).filter(e=>!e.isDefault);if(0===t.length)return alert("No custom presets were selected. Default presets cannot be deleted.");window.confirm(`Are you sure you want to delete ${t.length} selected preset(s)? This action cannot be undone.`)&&(s(e=>e.filter(e=>!t.some(t=>t.id===e.id))),alert(`${t.length} presets have been deleted.`))},[n]),c=(0,e.useCallback)(e=>{const r=n.filter(e=>!e.isDefault);let a=new Set,o="";switch(e.type){case"byGame":o=`Are you sure you want to remove all custom presets for "${e.value}"?`,r.forEach(t=>{t.gameName===e.value&&a.add(t.id)});break;case"unusedSince":const n=new Date,s=new Date(n.setDate(n.getDate()-e.value));o=`Are you sure you want to remove all presets not used in the last ${e.value} days?`,r.forEach(e=>{(!e.lastUsed||new Date(e.lastUsed)<s)&&a.add(e.id)});break;case"notInRoutine":o="Are you sure you want to remove all presets that aren't used in any routine?";const i=new Set(t.flatMap(e=>e.steps.map(e=>e.presetId)));r.forEach(e=>{i.has(e.id)||a.add(e.id)});break;case"duplicates":o="Are you sure you want to remove all duplicate presets? (Keeps the most recent)";const l=[];for(let e=r.length-1;e>=0;e--){const t=r[e];l.some(e=>t.gameName===e.gameName&&Fo(t.settings,e.settings))?a.add(t.id):l.push(t)}break;default:return}if(0===a.size)return alert("No presets matched the criteria to be removed.");window.confirm(`${o} This will remove ${a.size} preset(s). This action cannot be undone.`)&&(s(e=>e.filter(e=>!a.has(e.id))),alert(`${a.size} presets have been removed.`))},[n,t]),u=(0,e.useCallback)(e=>{if(!e||0===e.length)return alert("No presets selected to export. Please check the boxes next to the presets you want to export.");const t=n.filter(t=>e.includes(t.id)&&!t.isDefault);if(0===t.length)return alert("Only custom presets can be exported. None of the selected presets are eligible.");const s=JSON.stringify(t,null,2),r=new Blob([s],{type:"application/json"}),a=URL.createObjectURL(r),o=document.createElement("a");o.href=a,o.download=`musical_tools_presets_${(new Date).toISOString().split("T")[0]}.preset.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},[n]);return{presets:n,savePreset:r,saveMultiplePresets:a,deletePreset:i,deleteSelectedPresets:l,exportSelectedPresets:u,updatePreset:o,removePresets:c}})(E.routines);(0,e.useEffect)(()=>{C.setMetronomeSchedule&&C.setMetronomeSchedule(null)},[a]);const P=(0,e.useCallback)(e=>{R(e.id,{...e,lastUsed:(new Date).toISOString()}),u(e)},[R]),O=(0,e.useCallback)(async e=>{await v();let t={...e};"random"===e.executionOrder&&(t.steps=(e=>{let t,n=e.length;for(;0!==n;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e})([...e.steps])),E.updateRoutineLastPlayed(e.id),h(t),f(0),g({totalScore:0,totalAsked:0,streak:0,stepResults:t.steps.map(()=>({score:0,asked:0}))})},[v,E]),F=(0,e.useCallback)(()=>f(e=>e+1),[]),L=(0,e.useCallback)(()=>{T.isStopwatchRunning&&T.toggleStopwatch(),h(null),f(0),g(null)},[T]),q=(0,e.useCallback)((e,t,n)=>{var s;if(null===n||void 0===n||null===(s=n.stepResults)||void 0===s||!s[e])return n;const r=[...n.stepResults];r[e]={score:t.score,asked:t.totalAsked};const a=r.reduce((e,t)=>e+t.score,0),o=r.reduce((e,t)=>e+t.asked,0),i={...n,stepResults:r,totalScore:a,totalAsked:o,streak:t.wasCorrect?(n.streak||0)+1:0};return g(i),i},[]),V=(0,e.useCallback)(e=>{if(!d||!e)return;const t={id:`res_${Date.now()}`,routineId:d.id,routineName:d.name,routineType:d.type,completionTime:(new Date).toISOString(),steps:d.steps,stepResults:e.stepResults,totalScore:e.totalScore,totalAsked:e.totalAsked,streak:e.streak,finalTime:"Gauntlet"===d.type?T.stopwatchTime:null};"Streak"===t.routineType&&(t.totalScore=t.streak,t.totalAsked=t.streak),M.saveRoutineResult(t),b(t.id),L()},[d,L,T,M]),z=(0,e.useMemo)(()=>({unlockAudio:v,activeTool:s,toggleActiveTool:j,activeTab:a,navigate:y,openCategory:i,handleCategoryClick:w,...N,...C,..._,...S,...T,...A,presets:D,updatePreset:R,...I,...E,exportRoutine:e=>E.exportRoutine(e,D),exportFolder:(e,t)=>E.exportFolder(e,D,t),importRoutines:e=>E.importRoutines(e,I.savePreset),...M,presetToLoad:c,loadPreset:P,clearPresetToLoad:k,activeRoutine:d,routineStepIndex:m,routineProgress:p,setRoutineProgress:g,startRoutine:O,nextRoutineStep:F,endRoutine:L,updateRoutineProgress:q,finishRoutine:V,lastRoutineResultId:x,setLastRoutineResultId:b}),[v,s,j,a,y,i,w,N,C,_,S,T,A,D,R,I,E,M,c,d,m,p,x,P,O,F,L,q,V,g,b,k]);return(0,Lo.jsx)(qo.Provider,{value:z,children:n})},Go=e=>{let{title:t}=e;return(0,Lo.jsx)("h2",{className:"text-2xl font-bold text-teal-300 mb-4 p-2 bg-slate-700 rounded-lg shadow-sm text-center",children:t})},Bo=()=>(0,Lo.jsxs)("div",{className:"flex flex-col items-center text-center max-w-4xl mx-auto",children:[(0,Lo.jsx)("h2",{className:"text-4xl font-extrabold text-teal-400 mb-4",children:"Welcome to Your Personal Music Gym"}),(0,Lo.jsx)("p",{className:"text-xl text-gray-300 mb-12",children:"A complete suite of tools designed to structure your practice, sharpen your skills, and track your progress."}),(0,Lo.jsxs)("div",{className:"w-full text-left space-y-16",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)(Go,{title:"How to Get Started"}),(0,Lo.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mt-6 text-center",children:[(0,Lo.jsxs)("div",{className:"bg-slate-800/70 p-4 rounded-lg border border-slate-700",children:[(0,Lo.jsx)("h4",{className:"font-bold text-2xl text-indigo-300 mb-3",children:"1. Explore a Module"}),(0,Lo.jsx)("p",{className:"text-gray-300",children:"Use the navigation bar above to select a practice tool. Each module is a focused quiz or generator for a specific skill."})]}),(0,Lo.jsxs)("div",{className:"bg-slate-800/70 p-4 rounded-lg border border-slate-700",children:[(0,Lo.jsx)("h4",{className:"font-bold text-2xl text-indigo-300 mb-3",children:"2. Create Presets"}),(0,Lo.jsx)("p",{className:"text-gray-300",children:'In each module, click "Controls" to adjust the settings. Save any configuration as a preset from the **Preset Manager** page.'})]}),(0,Lo.jsxs)("div",{className:"bg-slate-800/70 p-4 rounded-lg border border-slate-700",children:[(0,Lo.jsx)("h4",{className:"font-bold text-2xl text-indigo-300 mb-3",children:"3. Build a Routine"})," ",(0,Lo.jsx)("p",{className:"text-gray-300",children:"Go to the **Routine Hub** to combine your saved presets into a structured, multi-step workout routine. "})]})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)(Go,{title:"Explore the Practice Modules"}),(0,Lo.jsx)("p",{className:"text-center text-lg text-gray-300 mt-4 mb-8",children:"The practice modules are divided into four distinct categories to target every aspect of your musicianship."}),(0,Lo.jsxs)("div",{className:"space-y-6",children:[(0,Lo.jsxs)("div",{className:"p-4 rounded-lg bg-slate-700/50",children:[(0,Lo.jsx)("h4",{className:"font-bold text-xl text-indigo-300 mb-2",children:"Generators"}),(0,Lo.jsx)("p",{className:"text-gray-300",children:"Spark creativity and create targeted exercises. These tools provide random content on demand, including notes, intervals, chord progressions, and fretboard diagrams."})]}),(0,Lo.jsxs)("div",{className:"p-4 rounded-lg bg-slate-700/50",children:[(0,Lo.jsx)("h4",{className:"font-bold text-xl text-indigo-300 mb-2",children:"Music Theory"}),(0,Lo.jsx)("p",{className:"text-gray-300",children:"Sharpen your foundational knowledge with quizzes on intervals, triads, 7th chords, and diatonic harmony."})]}),(0,Lo.jsxs)("div",{className:"p-4 rounded-lg bg-slate-700/50",children:[(0,Lo.jsx)("h4",{className:"font-bold text-xl text-indigo-300 mb-2",children:"Fretboard"}),(0,Lo.jsx)("p",{className:"text-gray-300",children:"Apply theory directly to the guitar. These modules are focused on visualizing patterns and intervals on the fretboard with the Fretboard Intervals and CAGED System quizzes."})]}),(0,Lo.jsxs)("div",{className:"p-4 rounded-lg bg-slate-700/50",children:[(0,Lo.jsx)("h4",{className:"font-bold text-xl text-indigo-300 mb-2",children:"Ear Training"}),(0,Lo.jsx)("p",{className:"text-gray-300",children:"Develop your aural skills. Listen to and identify individual intervals or entire melodic phrases to connect your ears to your theoretical knowledge."})]})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)(Go,{title:"Master Your Workflow"}),(0,Lo.jsxs)("div",{className:"bg-slate-700/50 p-6 rounded-lg mt-6 space-y-6",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-xl text-amber-300 mb-2",children:"The Global Toolkit: Your Practice Companion"}),(0,Lo.jsx)("p",{className:"text-lg text-gray-300",children:"The floating toolbar on the side of the screen is your command center, accessible at any time. Use it to accompany any practice session with essential utilities like the Metronome, a pitch Drone, a Timer, or a Stopwatch. It also provides quick access to your Practice Log and saved Presets."})]}),(0,Lo.jsxs)("div",{className:"border-t border-slate-600 pt-6",children:[(0,Lo.jsx)("h4",{className:"font-bold text-xl text-amber-300 mb-2",children:"Unleash Your Potential with Presets & Routines"})," ",(0,Lo.jsx)("p",{className:"text-lg text-gray-300",children:"The **Preset Manager** is where you build your personal library of exercises. After configuring a module, you can save its settings as a named preset. Then, visit the **Routine Hub** to combine these presets into powerful, multi-step workout routines, complete with custom goals and scoring. "})]}),(0,Lo.jsxs)("div",{className:"border-t border-slate-600 pt-6",children:[(0,Lo.jsx)("h4",{className:"font-bold text-xl text-amber-300 mb-2",children:"Track Everything in the Scoreboard & Log"}),(0,Lo.jsx)("p",{className:"text-lg text-gray-300",children:"Every completed routine is automatically saved to the **Scoreboard**, giving you a detailed breakdown of your performance. For other practice sessions, you can manually save notes to your **Practice Log** using the Global Toolkit. "})]})]})]}),(0,Lo.jsxs)("div",{className:"bg-slate-800/70 p-4 rounded-lg border border-slate-600 mt-16",children:[(0,Lo.jsx)("p",{className:"text-lg font-bold text-amber-300",children:"A Note for iPhone & iPad Users:"}),(0,Lo.jsx)("p",{className:"text-md text-gray-300 mt-1",children:"To hear audio from the Metronome or Ear Training modules, please ensure your device's physical Ring/Silent switch is not in silent mode (the switch should not be showing orange)."})]})]})]}),$o=e=>{let{isOpen:t,onClose:n,title:s,children:r,verticalAlign:a="center"}=e;if(!t)return null;const o="top"===a?"items-start pt-12 md:pt-24":"items-center";return(0,Lo.jsx)("div",{className:`fixed inset-0 bg-black/60 flex justify-center p-4 z-50 transition-opacity duration-300 ${o}`,onClick:n,children:(0,Lo.jsxs)("div",{className:"bg-slate-900 border border-slate-700 rounded-2xl max-w-lg w-full shadow-2xl animate-pulse-once grid grid-rows-[auto_1fr_auto] max-h-[90vh]",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsx)("h3",{className:"text-2xl font-bold text-indigo-300 p-6",children:s}),(0,Lo.jsx)("div",{className:"text-left text-gray-300 space-y-3 px-6 min-h-0 overflow-y-auto",children:r}),(0,Lo.jsx)("div",{className:"p-6",children:(0,Lo.jsx)("button",{onClick:n,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg",children:"Got it!"})})]})})},Uo=e=>{let{onClick:t}=e;return(0,Lo.jsx)("button",{onClick:t,className:"p-1 rounded-full text-gray-400 hover:bg-slate-700 transition-colors","aria-label":"Show help",children:(0,Lo.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Lo.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})},Wo=e=>{let{title:t,score:n,totalAsked:s,history:r,isReviewing:a,onStartReview:o,topControls:i,children:l,footerContent:c,onLogProgress:u,onToggleControls:d,onShowInfo:h}=e;return(0,Lo.jsxs)("div",{className:"w-full flex-1 bg-slate-800 p-4 rounded-lg",children:[(0,Lo.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("h1",{className:"text-2xl font-bold text-indigo-300",children:t}),(0,Lo.jsx)(Uo,{onClick:h})]}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("button",{onClick:u,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-1 px-3 rounded-lg text-sm",children:"Log"}),(0,Lo.jsx)("button",{onClick:d,className:"p-2 rounded-md bg-slate-700 hover:bg-slate-600 text-sm font-semibold",children:"Controls"})]})]}),(0,Lo.jsxs)("div",{className:"w-full flex justify-between items-center mb-4 text-lg",children:[(0,Lo.jsxs)("span",{className:"font-semibold",children:["Score: ",n," / ",s]}),(0,Lo.jsxs)("div",{className:"flex items-center gap-4",children:[r.length>0&&(0,Lo.jsx)("button",{onClick:o,disabled:a,className:"bg-gray-600 hover:bg-gray-500 text-sm py-1 px-3 rounded-lg",children:"Review"}),i]})]}),(0,Lo.jsx)("div",{className:"max-w-2xl mx-auto",children:l}),(0,Lo.jsx)("div",{className:"mt-4 min-h-[52px] flex justify-center items-center gap-4",children:c})]})},Ho=["C","D","E","F","G","A","B"],Qo=[{id:"bb",display:"\u266d\u266d"},{id:"b",display:"\u266d"},{id:"natural",display:""},{id:"#",display:"\u266f"},{id:"##",display:"\u266f\u266f"}],Ko={C:0,D:2,E:4,F:5,G:7,A:9,B:11},Yo=["C","G","D","A","E","B","F#","F","Bb","Eb","Ab","Db","Gb"],Xo=[{name:"Perfect Unison",semitones:0,quality:"Perfect",number:"Unison"},{name:"Minor 2nd",semitones:1,quality:"Minor",number:"2nd"},{name:"Major 2nd",semitones:2,quality:"Major",number:"2nd"},{name:"Minor 3rd",semitones:3,quality:"Minor",number:"3rd"},{name:"Major 3rd",semitones:4,quality:"Major",number:"3rd"},{name:"Perfect 4th",semitones:5,quality:"Perfect",number:"4th"},{name:"Augmented 4th",semitones:6,quality:"Augmented",number:"4th"},{name:"Diminished 5th",semitones:6,quality:"Diminished",number:"5th"},{name:"Perfect 5th",semitones:7,quality:"Perfect",number:"5th"},{name:"Minor 6th",semitones:8,quality:"Minor",number:"6th"},{name:"Major 6th",semitones:9,quality:"Major",number:"6th"},{name:"Minor 7th",semitones:10,quality:"Minor",number:"7th"},{name:"Major 7th",semitones:11,quality:"Major",number:"7th"},{name:"Perfect Octave",semitones:12,quality:"Perfect",number:"Octave"}],Zo=e=>{let{title:t,isOpen:n,onToggle:s,children:r}=e;return(0,Lo.jsxs)("div",{className:"border-t border-slate-600/80 pt-3 mt-3",children:[(0,Lo.jsxs)("button",{onClick:s,className:"w-full flex justify-between items-center text-left text-lg font-bold text-teal-300 hover:text-teal-200",children:[(0,Lo.jsx)("span",{children:t}),(0,Lo.jsx)("span",{className:"text-xl",children:n?"\u2212":"+"})]}),n&&(0,Lo.jsx)("div",{className:"pt-4 space-y-4",children:r})]})},Jo=t=>{let{settings:n,onSettingChange:s,audioDirection:r,onAudioDirectionChange:a,localVolume:o,onLocalVolumeChange:i,onVolumeSet:l,onIntervalSelectionChange:c,onQuickSelect:u,onSelectAll:d,onSavePreset:h,openControlSections:m,onToggleSection:f}=t;const p=e.useMemo(()=>Xo.reduce((e,t)=>{const n=t.number.includes("Unison")||t.number.includes("Octave")?"Unison/Octave":`${t.number}s`;return e[n]||(e[n]=[]),e[n].push(t),e},{}),[]);return(0,Lo.jsxs)("div",{className:"space-y-6",children:[(0,Lo.jsx)(Zo,{title:"Quiz Options",isOpen:m.quiz,onToggle:()=>f("quiz"),children:(0,Lo.jsxs)("div",{className:"space-y-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Quiz Mode"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>s("quizMode","nameTheInterval"),className:"flex-1 rounded-md text-sm py-1 "+("nameTheInterval"===n.quizMode?"bg-blue-600 text-white":""),children:"Name Interval"}),(0,Lo.jsx)("button",{onClick:()=>s("quizMode","nameTheNote"),className:"flex-1 rounded-md text-sm py-1 "+("nameTheNote"===n.quizMode?"bg-blue-600 text-white":""),children:"Name Note"}),(0,Lo.jsx)("button",{onClick:()=>s("quizMode","mixed"),className:"flex-1 rounded-md text-sm py-1 "+("mixed"===n.quizMode?"bg-blue-600 text-white":""),children:"Mixed"})]})]}),("nameTheNote"===n.quizMode||"mixed"===n.quizMode)&&(0,Lo.jsxs)("div",{className:"p-3 bg-slate-900/50 rounded-lg space-y-3",children:[(0,Lo.jsx)("h5",{className:"font-bold text-base text-teal-300 border-b border-slate-600 pb-1",children:'"Name the Note" Settings'}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold",children:"Root Notes"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1 mt-1",children:[(0,Lo.jsxs)("label",{className:"flex-1 rounded-md text-sm py-1 text-center cursor-pointer "+("natural"===n.rootNoteType?"bg-blue-600 text-white":"text-gray-300"),children:[(0,Lo.jsx)("input",{type:"radio",name:"rootType",value:"natural",checked:"natural"===n.rootNoteType,onChange:()=>s("rootNoteType","natural"),className:"sr-only"}),"Natural"]}),(0,Lo.jsxs)("label",{className:"flex-1 rounded-md text-sm py-1 text-center cursor-pointer "+("chromatic"===n.rootNoteType?"bg-blue-600 text-white":"text-gray-300"),children:[(0,Lo.jsx)("input",{type:"radio",name:"rootType",value:"chromatic",checked:"chromatic"===n.rootNoteType,onChange:()=>s("rootNoteType","chromatic"),className:"sr-only"}),"Chromatic"]})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold",children:"Question Direction"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1 mt-1",children:[(0,Lo.jsx)("button",{onClick:()=>s("direction","above"),className:"flex-1 rounded-md text-sm py-1 "+("above"===n.direction?"bg-blue-600 text-white":"text-gray-300"),children:"Ascending"}),(0,Lo.jsx)("button",{onClick:()=>s("direction","below"),className:"flex-1 rounded-md text-sm py-1 "+("below"===n.direction?"bg-blue-600 text-white":"text-gray-300"),children:"Descending"}),(0,Lo.jsx)("button",{onClick:()=>s("direction","both"),className:"flex-1 rounded-md text-sm py-1 "+("both"===n.direction?"bg-blue-600 text-white":"text-gray-300"),children:"Both"})]})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{htmlFor:"interval-audio-volume",className:"font-semibold text-lg text-teal-300 mb-2 block",children:"Audio Volume"}),(0,Lo.jsx)("input",{type:"range",id:"interval-audio-volume",min:"-30",max:"0",value:o,onChange:e=>i(Number(e.target.value)),onMouseUp:()=>l(),onKeyUp:()=>l(),className:"w-full h-3 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]})]})}),(0,Lo.jsxs)(Zo,{title:"Interval Selection",isOpen:m.selection,onToggle:()=>f("selection"),children:[(0,Lo.jsxs)("div",{className:"flex flex-wrap justify-start gap-2 mb-4",children:[(0,Lo.jsx)("h4",{className:"text-lg font-semibold text-blue-200 w-full",children:"Quick Select"}),(0,Lo.jsx)("button",{onClick:()=>u("Major"),className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-1 px-3 text-sm rounded-lg",children:"Toggle Major"}),(0,Lo.jsx)("button",{onClick:()=>u("Minor"),className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-1 px-3 text-sm rounded-lg",children:"Toggle Minor"}),(0,Lo.jsx)("button",{onClick:()=>u("Perfect"),className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-1 px-3 text-sm rounded-lg",children:"Toggle Perfect"}),(0,Lo.jsx)("button",{onClick:()=>d(!0),className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-1 px-3 text-sm rounded-lg",children:"Select All"}),(0,Lo.jsx)("button",{onClick:()=>d(!1),className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-1 px-3 text-sm rounded-lg",children:"Deselect All"})]}),(0,Lo.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full",children:Object.entries(p).map(e=>{let[t,s]=e;return(0,Lo.jsxs)("div",{className:"break-inside-avoid",children:[(0,Lo.jsx)("h5",{className:"font-bold text-base text-teal-300 mb-2 border-b border-slate-600 pb-1",children:t}),(0,Lo.jsx)("div",{className:"flex flex-col gap-3",children:s.map(e=>(0,Lo.jsxs)("label",{className:"flex items-center justify-between text-gray-200 cursor-pointer",children:[(0,Lo.jsx)("span",{className:"text-sm",children:e.name}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:!!n.selectedIntervals[e.name],onChange:()=>c(e.name),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},e.name))})]},t)})})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:h,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},ei=e=>{let{value:t,type:n,selectedValue:s,onClick:r,isDisabled:a,children:o}=e;const i=s===t;return(0,Lo.jsx)("button",{onClick:()=>r(n,t),disabled:a,className:"p-3 rounded-lg font-semibold transition-colors disabled:opacity-50 "+(i?"bg-indigo-600 text-white":"bg-teal-600 hover:bg-teal-500"),children:o||t})},ti=t=>{let{onProgressUpdate:n}=t;const{addLogEntry:s,fretboardVolume:r,setFretboardVolume:a,savePreset:o,presetToLoad:i,clearPresetToLoad:l}=Vo(),c=(0,e.useMemo)(()=>Xo.map(e=>e.name),[]),[u,d]=(0,e.useState)({quizMode:"mixed",rootNoteType:"chromatic",direction:"both",autoAdvance:!0,playAudio:!0,selectedIntervals:c.reduce((e,t)=>({...e,[t]:!0}),{})}),[h,m]=(0,e.useState)(!1),[f,p]=(0,e.useState)(!1),[g,x]=(0,e.useState)({quiz:!0,selection:!0}),[b,v]=(0,e.useState)(r);(0,e.useEffect)(()=>{if(i&&"intervals-quiz"===i.gameId){const{fretboardVolume:e,audioDirection:t,...n}=i.settings;d(n),void 0!==e&&(a(e),v(e)),l()}},[i,l,a]),(0,e.useEffect)(()=>{v(r)},[r]);const{feedback:y,score:w,answerChecked:j,currentQuestion:k,userAnswer:N,setUserAnswer:C,history:_,reviewIndex:S,setReviewIndex:T,handleReviewNav:A,startReview:M,checkAnswer:E,generateNewQuestion:D,replayAudioForHistoryItem:R}=((t,n,s)=>{const{playFretboardNotes:r}=Vo(),{quizMode:a,rootNoteType:o,direction:i,autoAdvance:l,selectedIntervals:c}=t,[u,d]=(0,e.useState)({message:"",type:""}),[h,m]=(0,e.useState)(0),[f,p]=(0,e.useState)(!1),[g,x]=(0,e.useState)(null),[b,v]=(0,e.useState)({}),y=(0,e.useRef)(null),[w,j]=(0,e.useState)([]),[k,N]=(0,e.useState)(null),C=(0,e.useCallback)(()=>{clearTimeout(y.current),N(null);const e="mixed"===a?Math.random()<.5?"nameTheNote":"nameTheInterval":a;let t=Xo.filter(e=>c[e.name]);if(0===t.length)return void x({type:"error",text:"Please select intervals in the controls."});let n={},s="both"===i?Math.random()<.5?"above":"below":i;"below"===s&&(t=t.filter(e=>"Perfect Unison"!==e.name));const r=t[Math.floor(Math.random()*t.length)];if("Perfect Unison"===r.name&&(s=""),"nameTheNote"===e){var l;const t="natural"===o?Ho:Yo,a=t[Math.floor(Math.random()*t.length)],i=a.charAt(0),c=a.substring(1);let u=c.includes("#")?c.length:-c.length;""===c&&(u=0);const d=parseInt((null===(l=r.name.match(/\d+/))||void 0===l?void 0:l[0])||(r.name.includes("Unison")?1:8),10),h=Ho.indexOf(i),m=Ko[i]+u;let f="above"===s||""===s?(h+d-1)%7:(h-(d-1)+7)%7,p="above"===s||""===s?m+r.semitones:m-r.semitones;const g=Ho[f];let x=Ko[g];"above"!==s&&""!==s||!(f<h||8===d)?"below"===s&&(f>h||8===d)&&(x-=12):x+=12;const b=p-x;let v="";1===b?v="#":2===b?v="##":-1===b?v="b":-2===b&&(v="bb"),n={mode:e,rootNote:a,intervalName:r.name,direction:s,correctAnswer:{note:g+v}}}else{var u;const t=Ho[Math.floor(7*Math.random())],s=Math.floor(3*Math.random())-1,a=t+(1===s?"#":-1===s?"b":""),o=Ho[(Ho.indexOf(t)+(parseInt((null===(u=r.name.match(/\d+/))||void 0===u?void 0:u[0])||1,10)-1))%7],i=Ko[t]+s;let l=Ko[o];(Ho.indexOf(o)<Ho.indexOf(t)||"Octave"===r.number)&&(l+=12);const c=i+r.semitones-l;let d="";1===c?d="#":2===c?d="##":-1===c?d="b":-2===c&&(d="bb"),n={mode:e,note1:a,note2:o+d,correctAnswer:{quality:r.quality,number:r.number}}}x(n),p(!1),d({message:"",type:""}),v({})},[a,o,i,c]),_=(0,e.useCallback)((e,t)=>{const n=((e,t)=>{const n=t-e;for(let s=6;s>=1;s--)for(let t=0;t<=7;t++){const r=Do[6-s][t];if(r.midi%12===e%12){const e={string:s,fret:t,midi:r.midi},a=e.midi+n;for(let t=6;t>=1;t--)for(let n=0;n<=12;n++)if(Do[6-t][n].midi===a)return[e,{string:t,fret:n}]}}return null})(e,t);n?r(n):console.error("Could not find a playable fretboard position for MIDI notes:",e,t)},[r]),S=(0,e.useCallback)(()=>{if(f||!g)return;let e=!1,t="";if("nameTheNote"===g.mode){var r;const n=`${b.noteLetter||""}${null!==(r=b.accidental)&&void 0!==r?r:""}`,s=g.correctAnswer.note;e=n===s,t=s}else{const{quality:n,number:s}=g.correctAnswer;e="Unison / Octave"===b.number?"Perfect"===b.quality&&("Unison"===s||"Octave"===s):b.quality===n&&b.number===s,t=`${n} ${s}`}const a=e?h+1:h,o=w.length+1;if(e?(m(a),d({message:"Correct!",type:"correct"})):d({message:`Incorrect! The answer was ${t}.`,type:"incorrect"}),j(t=>[...t,{question:g,userAnswer:b,wasCorrect:e}]),s&&s({wasCorrect:e,score:a,totalAsked:o}),p(!0),n){let e,t,n;if("nameTheNote"===g.mode?(e=g.rootNote,t=Xo.find(e=>e.name===g.intervalName),n=g.direction):(e=g.note1,t=Xo.find(e=>e.quality===g.correctAnswer.quality&&e.number===g.correctAnswer.number),n="above"),t&&Ao[e]){const s=Ao[e]%12+60;let r;r="below"===n?s-t.semitones:s+t.semitones,_(s,r)}}l&&e&&(y.current=setTimeout(C,2e3))},[f,b,g,l,C,n,_,h,w.length,s]);return(0,e.useEffect)(()=>{m(0),j([]),C()},[C]),(0,e.useEffect)(()=>{l&&("nameTheNote"===(null===g||void 0===g?void 0:g.mode)&&b.noteLetter&&"undefined"!==typeof b.accidental||"nameTheInterval"===(null===g||void 0===g?void 0:g.mode)&&b.quality&&b.number)&&S()},[b,l,S,g]),{feedback:u,score:h,answerChecked:f,currentQuestion:g,userAnswer:b,setUserAnswer:v,history:w,reviewIndex:k,setReviewIndex:N,handleReviewNav:e=>{N(t=>{const n=t+e;return n>=0&&n<w.length?n:t})},startReview:()=>w.length>0&&N(w.length-1),checkAnswer:S,generateNewQuestion:C,replayAudioForHistoryItem:e=>{const t=w[e];if(!t||!n)return;const{question:s}=t;let r,a,o;if("nameTheNote"===s.mode?(r=s.rootNote,a=Xo.find(e=>e.name===s.intervalName),o=s.direction):"nameTheInterval"===s.mode&&(r=s.note1,a=Xo.find(e=>e.quality===s.correctAnswer.quality&&e.number===s.correctAnswer.number),o="above"),a&&Ao[r]){const e=Ao[r]%12+60;let t;t="below"===o?e-a.semitones:e+a.semitones,_(e,t)}}}})(u,u.playAudio,n),I=null!==S,P=(e,t)=>d(n=>({...n,[e]:t})),O=(e,t)=>!j&&!I&&C(n=>({...n,[e]:t}));(0,e.useEffect)(()=>{const e=e=>{const t=e.target.tagName.toLowerCase();"input"!==t&&"textarea"!==t&&"select"!==t&&(I||"Enter"!==e.key||j||(e.preventDefault(),E()))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[j,E,I]),(0,e.useEffect)(()=>{const e=e=>{const t=e.target.tagName.toLowerCase();if("input"===t||"textarea"===t||"select"===t)return;const n=!(_.length>0)||_[_.length-1].wasCorrect;"Enter"!==e.key||!j||u.autoAdvance&&n||(e.preventDefault(),D())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[j,u.autoAdvance,_,D]);const F=()=>{const e=prompt("Enter a name for your preset:",`Intervals - ${u.quizMode}`);e&&""!==e.trim()&&(o({id:Date.now().toString(),name:e.trim(),gameId:"intervals-quiz",gameName:"Interval Practice",settings:{...u,fretboardVolume:r}}),alert(`Preset "${e.trim()}" saved!`))},L=e=>P("selectedIntervals",{...u.selectedIntervals,[e]:!u.selectedIntervals[e]}),q=e=>{const t={...u.selectedIntervals};Xo.forEach(n=>{n.quality===e&&(t[n.name]=!t[n.name])}),P("selectedIntervals",t)},V=e=>{const t={};c.forEach(n=>{t[n]=e}),P("selectedIntervals",t)},z=I?_[S]:{question:k,userAnswer:N},G=(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Play Audio"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:u.playAudio,onChange:()=>P("playAudio",!u.playAudio),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Auto-Advance"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:u.autoAdvance,onChange:()=>P("autoAdvance",!u.autoAdvance),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),B=!(_.length>0)||_[_.length-1].wasCorrect,$=I?(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-4 w-full",children:[(0,Lo.jsx)("button",{onClick:()=>A(-1),disabled:0===S,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Prev"}),(0,Lo.jsxs)("div",{className:"flex flex-col gap-2 flex-grow max-w-xs",children:[(0,Lo.jsx)("button",{onClick:()=>T(null),className:"bg-purple-600 hover:bg-purple-500 font-bold p-3 rounded-lg text-xl",children:"Return to Quiz"}),(0,Lo.jsx)("button",{onClick:()=>R(S),className:"bg-sky-600 hover:bg-sky-500 text-sm p-2 rounded-lg font-semibold",children:"Replay Audio"})]}),(0,Lo.jsx)("button",{onClick:()=>A(1),disabled:S===_.length-1,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Next"})]}):!j||u.autoAdvance&&B?j?null:(0,Lo.jsx)("button",{onClick:E,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg",children:"Submit"}):(0,Lo.jsx)("button",{onClick:D,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg animate-pulse",children:"Next Question"});return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsxs)($o,{isOpen:f,onClose:()=>p(!1),title:"Interval Practice Quiz Guide",children:[(0,Lo.jsx)("p",{children:"This module tests your knowledge of intervals in two ways: identifying an interval from two notes, or identifying a note from a root and an interval."}),(0,Lo.jsxs)("p",{className:"mt-2",children:["Enable the ",(0,Lo.jsx)("b",{children:"Play Audio"})," toggle to hear the interval played using natural guitar sounds after you answer."]}),(0,Lo.jsx)("p",{children:'Use the "Controls" panel to select the quiz mode and other options. The audio for "Name The Interval" mode will always be ascending.'})]}),(0,Lo.jsxs)(Wo,{title:"Interval Practice",score:w,totalAsked:_.length,history:_,isReviewing:I,onStartReview:M,topControls:G,footerContent:$,onLogProgress:()=>{const e=prompt("Enter any remarks for this session:",`Score: ${w}/${_.length}`);null!==e&&(s({game:"Interval Practice Quiz",date:(new Date).toLocaleDateString(),remarks:e}),alert("Session logged!"))},onToggleControls:()=>m(e=>!e),onShowInfo:()=>p(!0),children:[(0,Lo.jsx)("div",{className:"text-center w-full max-w-2xl mx-auto my-6 min-h-[120px] flex flex-col items-center justify-center",children:(()=>{const e=null===z||void 0===z?void 0:z.question;return e?"error"===e.type?(0,Lo.jsx)("div",{className:"text-2xl font-semibold text-red-400",children:e.text}):"nameTheNote"===e.mode?(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)("div",{className:"text-5xl font-bold text-teal-300 mb-4",children:e.rootNote}),(0,Lo.jsxs)("div",{className:"text-2xl font-semibold text-gray-400",children:["What is the ",e.intervalName,e.direction&&` ${e.direction}`,"?"]})]}):"nameTheInterval"===e.mode?(0,Lo.jsxs)("div",{className:"flex justify-center items-center gap-5",children:[(0,Lo.jsx)("div",{className:"text-6xl font-bold text-teal-300 p-4 bg-slate-700 rounded-lg w-36",children:e.note1}),(0,Lo.jsx)("div",{className:"text-6xl font-bold text-teal-300 p-4 bg-slate-700 rounded-lg w-36",children:e.note2})]}):void 0:(0,Lo.jsx)("div",{className:"text-2xl font-semibold text-gray-400",children:"Loading..."})})()}),(0,Lo.jsx)("div",{className:"my-4 min-h-[60px] flex flex-col justify-center",children:I?(()=>{if(!I)return null;const{question:e,userAnswer:t,wasCorrect:n}=z;let s,r;var a;"nameTheNote"===e.mode?(s=`${t.noteLetter||"?"}${null!==(a=t.accidental)&&void 0!==a?a:""}`,r=e.correctAnswer.note):(s=`${t.quality||"?"} ${t.number||"?"}`,r=`${e.correctAnswer.quality} ${e.correctAnswer.number}`);return(0,Lo.jsxs)("div",{className:"text-center p-3 rounded-lg "+(n?"bg-green-900/50":"bg-red-900/50"),children:[(0,Lo.jsxs)("p",{className:"font-bold text-gray-200",children:["Correct Answer: ",(0,Lo.jsx)("span",{className:"text-teal-300 font-semibold",children:r})]}),!n&&(0,Lo.jsxs)("p",{className:"mt-1",children:[(0,Lo.jsx)("span",{className:"font-bold text-gray-300",children:"Your Answer:"})," ",(0,Lo.jsx)("span",{className:"text-red-400 font-semibold",children:s})]})]})})():(0,Lo.jsx)("p",{className:"text-lg font-bold text-center "+("correct"===y.type?"text-green-400":"text-red-400"),children:y.message||(0,Lo.jsx)(Lo.Fragment,{children:"\xa0"})})}),(0,Lo.jsx)("div",{className:"w-full max-w-lg mx-auto space-y-4",children:(()=>{const e=null===z||void 0===z?void 0:z.question,t=null===z||void 0===z?void 0:z.userAnswer;if(!e||"error"===e.type)return null;const n=j||I;if("nameTheNote"===e.mode)return(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:"Note"}),(0,Lo.jsx)("div",{className:"grid grid-cols-7 gap-1",children:Ho.map(e=>(0,Lo.jsx)(ei,{value:e,type:"noteLetter",selectedValue:t.noteLetter,onClick:O,isDisabled:n},e))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:"Accidental"}),(0,Lo.jsx)("div",{className:"grid grid-cols-5 gap-1",children:Qo.map(e=>(0,Lo.jsx)(ei,{value:"natural"===e.id?"":e.id,type:"accidental",selectedValue:t.accidental,onClick:O,isDisabled:n,children:e.display},e.id))})]})]});if("nameTheInterval"===e.mode){const e=["Diminished","Minor","Perfect","Major","Augmented"],s=["Unison / Octave","2nd","3rd","4th","5th","6th","7th"];return(0,Lo.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-lg font-semibold text-gray-400 mb-3",children:"Quality"}),(0,Lo.jsx)("div",{className:"flex flex-col gap-2",children:e.map(e=>(0,Lo.jsx)(ei,{value:e,type:"quality",selectedValue:t.quality,onClick:O,isDisabled:n},e))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-lg font-semibold text-gray-400 mb-3",children:"Number"}),(0,Lo.jsx)("div",{className:"grid grid-cols-2 gap-2",children:s.map(e=>(0,Lo.jsx)(ei,{value:e,type:"number",selectedValue:t.number,onClick:O,isDisabled:n},e))})]})]})}})()})]}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out "+(h?"w-96 p-4":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!h&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(Jo,{settings:u,onSettingChange:P,localVolume:b,onLocalVolumeChange:v,onVolumeSet:()=>a(b),onIntervalSelectionChange:L,onQuickSelect:q,onSelectAll:V,onSavePreset:F,openControlSections:g,onToggleSection:e=>x(t=>({...t,[e]:!t[e]}))})]})}),h&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>m(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(Jo,{settings:u,onSettingChange:P,localVolume:b,onLocalVolumeChange:v,onVolumeSet:()=>a(b),onIntervalSelectionChange:L,onQuickSelect:q,onSelectAll:V,onSavePreset:F,openControlSections:g,onToggleSection:e=>x(t=>({...t,[e]:!t[e]}))})})]})})]})},ni=()=>{const{bpm:t,addLogEntry:n,setMetronomeSchedule:s,countdownClicks:r,setCountdownClicks:a,presetToLoad:o,clearPresetToLoad:i,setDroneNote:l}=Vo(),[c,u]=(0,e.useState)({numNotes:12,noteType:"chromatic",fontSize:2.7,avoidRepeats:!0,displayMode:"flow",barlineFrequency:4,notesPerBar:1,barsPerLine:4}),[d,h]=(0,e.useState)([]),[m,f]=(0,e.useState)(!1),[p,g]=(0,e.useState)(c.numNotes),[x,b]=(0,e.useState)(!1),[v,y]=(0,e.useState)(!1);(0,e.useEffect)(()=>{if(o&&"note-generator"===o.gameId){const e={...o.settings};!0!==e.showBarlines||e.displayMode?!1!==e.showBarlines||e.displayMode||(e.displayMode="flow",e.barlineFrequency=0):e.displayMode="measure",u(t=>({...t,...e})),o.automation&&(f(o.automation.isAutoGenerateOn),g(o.automation.autoGenerateInterval),a(o.automation.countdownClicks)),i()}},[o,i,a]);const w=(0,e.useCallback)(()=>{const e=["C","D","E","F","G","A","B"],t=["C",{sharp:"C#",flat:"Db"},"D",{sharp:"D#",flat:"Eb"},"E","F",{sharp:"F#",flat:"Gb"},"G",{sharp:"G#",flat:"Ab"},"A",{sharp:"A#",flat:"Bb"},"B"];let n=[];if(c.avoidRepeats&&"chromatic"===c.noteType){const e=(e=>{let t,n=e.length;for(;0!==n;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e})(t.map(e=>"object"===typeof e?Math.random()<.5?e.sharp:e.flat:e));if(c.numNotes<=12)n=e.slice(0,c.numNotes);else{n=[...e];for(let e=12;e<c.numNotes;e++){let e;do{let n=t[Math.floor(Math.random()*t.length)];"object"===typeof n&&(n=Math.random()<.5?n.sharp:n.flat),e=n}while(e===n[n.length-1]);n.push(e)}}}else{const s="natural"===c.noteType?e:t;let r=null;for(let e=0;e<c.numNotes;e++){let e;do{let t=s[Math.floor(Math.random()*s.length)];"object"===typeof t&&(t=Math.random()<.5?t.sharp:t.flat),e=t}while(c.avoidRepeats&&e===r&&s.length>1);n.push(e),r=e}}if(h(n),n.length>0){const e=n[0];l({Db:"C#",Eb:"D#",Gb:"F#",Ab:"G#",Bb:"A#"}[e]||e)}},[c.numNotes,c.noteType,c.avoidRepeats,l]),j=(0,e.useCallback)(()=>{setTimeout(w,0)},[w]);(0,e.useEffect)(()=>{w()},[w]),(0,e.useEffect)(()=>(s(m?{callback:j,interval:p}:null),()=>s(null)),[m,p,j,s]),(0,e.useEffect)(()=>{const e=e=>{const t=e.target.tagName.toLowerCase();"input"!==t&&"textarea"!==t&&"select"!==t&&("Enter"!==e.key&&" "!==e.key||(e.preventDefault(),w()))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[w]);return{settings:c,setSettings:u,generatedNotes:d,isAutoGenerateOn:m,setIsAutoGenerateOn:f,autoGenerateInterval:p,setAutoGenerateInterval:g,isControlsOpen:x,setIsControlsOpen:b,isInfoModalOpen:v,setIsInfoModalOpen:y,countdownClicks:r,setCountdownClicks:a,handleLogProgress:()=>{const e=prompt("Enter any remarks for this session:",`Practiced ${c.noteType} notes.`);if(null!==e){const s={game:"Note Generator",bpm:t||"N/A",date:(new Date).toLocaleDateString(),remarks:e||"No remarks."};n(s),alert("Session logged!")}},generateNotes:w}},si=e=>{let{settings:t,onSettingChange:n,isAutoGenerateOn:s,onAutoGenerateToggle:r,autoGenerateInterval:a,onIntervalChange:o,countdownClicks:i,onCountdownChange:l,onSavePreset:c}=e;return(0,Lo.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,Lo.jsx)("div",{children:(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"num-notes",className:"font-semibold text-lg",children:"Number of Notes:"}),(0,Lo.jsx)("input",{type:"number",id:"num-notes",value:t.numNotes,onChange:e=>n("numNotes",Math.max(1,parseInt(e.target.value,10)||1)),className:"w-24 p-2 rounded-md bg-slate-600 text-white text-center",min:"1"})]})}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold text-lg",children:"Note Type:"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1 mt-1",children:[(0,Lo.jsxs)("label",{className:"flex-1 rounded-md py-1 text-center cursor-pointer "+("natural"===t.noteType?"bg-blue-600 text-white":"text-gray-300"),children:[(0,Lo.jsx)("input",{type:"radio",name:"noteType",value:"natural",checked:"natural"===t.noteType,onChange:()=>n("noteType","natural"),className:"sr-only"}),"Natural"]}),(0,Lo.jsxs)("label",{className:"flex-1 rounded-md py-1 text-center cursor-pointer "+("chromatic"===t.noteType?"bg-blue-600 text-white":"text-gray-300"),children:[(0,Lo.jsx)("input",{type:"radio",name:"noteType",value:"chromatic",checked:"chromatic"===t.noteType,onChange:()=>n("noteType","chromatic"),className:"sr-only"}),"Chromatic"]})]})]}),(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 bg-slate-600 rounded-md",children:[(0,Lo.jsx)("span",{className:"font-semibold text-lg",children:"Avoid Repeats"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:t.avoidRepeats,onChange:()=>n("avoidRepeats",!t.avoidRepeats),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,Lo.jsxs)("div",{className:"pt-4 border-t border-slate-600 space-y-2",children:[(0,Lo.jsx)("h4",{className:"font-semibold text-lg",children:"Display Mode"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("displayMode","flow"),className:"flex-1 rounded-md text-sm py-1 "+("flow"===t.displayMode?"bg-blue-600 text-white":"text-gray-300"),children:"Flow"}),(0,Lo.jsx)("button",{onClick:()=>n("displayMode","measure"),className:"flex-1 rounded-md text-sm py-1 "+("measure"===t.displayMode?"bg-blue-600 text-white":"text-gray-300"),children:"Measures"})]}),"measure"===t.displayMode&&(0,Lo.jsxs)("div",{className:"pl-2 pt-2 space-y-2 animate-fade-in-down border-l-2 border-slate-600",children:[(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"notes-per-bar",className:"font-semibold text-md",children:"Notes per Bar:"}),(0,Lo.jsx)("input",{type:"number",id:"notes-per-bar",value:t.notesPerBar,onChange:e=>n("notesPerBar",Math.max(1,parseInt(e.target.value,10)||1)),className:"w-20 p-1 rounded-md bg-slate-800 text-white text-center",min:"1"})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"bars-per-line",className:"font-semibold text-md",children:"Bars per Line:"}),(0,Lo.jsx)("input",{type:"number",id:"bars-per-line",value:t.barsPerLine,onChange:e=>n("barsPerLine",Math.max(1,parseInt(e.target.value,10)||1)),className:"w-20 p-1 rounded-md bg-slate-800 text-white text-center",min:"1"})]})]}),"flow"===t.displayMode&&(0,Lo.jsxs)("div",{className:"pl-2 pt-2 space-y-2 animate-fade-in-down border-l-2 border-slate-600",children:[(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"barline-freq",className:"font-semibold text-md",children:"Barline Every:"}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("input",{type:"number",id:"barline-freq",value:t.barlineFrequency,onChange:e=>n("barlineFrequency",Math.max(0,parseInt(e.target.value,10))||0),className:"w-20 p-1 rounded-md bg-slate-800 text-white text-center",min:"0"}),(0,Lo.jsx)("span",{className:"font-semibold text-md",children:"notes"})]})]}),(0,Lo.jsx)("p",{className:"text-xs text-gray-400 italic",children:"Set to 0 to disable barlines."})]})]}),(0,Lo.jsxs)("div",{className:"pt-4 border-t border-slate-600 space-y-4",children:[(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"auto-generate",className:"font-semibold text-lg text-teal-300",children:"Auto-Generate:"}),(0,Lo.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",id:"auto-generate",checked:s,onChange:r,className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-teal-600"})]})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"auto-generate-interval",className:`font-semibold text-lg ${!s&&"opacity-50"}`,children:"Every:"}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("input",{type:"number",id:"auto-generate-interval",value:a,onChange:e=>o(Math.max(1,parseInt(e.target.value,10))||1),className:`w-24 p-2 rounded-md bg-slate-600 text-white text-center ${!s&&"opacity-50"}`,min:"1",disabled:!s}),(0,Lo.jsx)("span",{className:`font-semibold text-lg ${!s&&"opacity-50"}`,children:"clicks"})]})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"countdown-clicks",className:`font-semibold text-lg ${!s&&"opacity-50"}`,children:"Countdown:"}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("input",{type:"number",id:"countdown-clicks",value:i,onChange:e=>l(Math.max(0,parseInt(e.target.value,10))||0),className:`w-24 p-2 rounded-md bg-slate-600 text-white text-center ${!s&&"opacity-50"}`,min:"0",max:"7",disabled:!s}),(0,Lo.jsx)("span",{className:`font-semibold text-lg ${!s&&"opacity-50"}`,children:"clicks"})]})]})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:c,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},ri=(e,t)=>{const n=[];if(t<=0)return[e];for(let s=0;s<e.length;s+=t)n.push(e.slice(s,s+t));return n},ai=()=>{const{savePreset:t}=Vo(),{settings:n,setSettings:s,generatedNotes:r,isAutoGenerateOn:a,setIsAutoGenerateOn:o,autoGenerateInterval:i,setAutoGenerateInterval:l,isControlsOpen:c,setIsControlsOpen:u,isInfoModalOpen:d,setIsInfoModalOpen:h,countdownClicks:m,setCountdownClicks:f,handleLogProgress:p,generateNotes:g}=ni(),x=(0,e.useCallback)((e,t)=>{s(n=>({...n,[e]:t}))},[s]),b=()=>{const e=prompt("Enter a name for your preset:",`Notes - ${n.numNotes} ${n.noteType}`);if(e&&""!==e.trim()){const s={id:Date.now().toString(),name:e.trim(),gameId:"note-generator",gameName:"Note Generator",settings:n,automation:{isAutoGenerateOn:a,autoGenerateInterval:i,countdownClicks:m}};t(s),alert(`Preset "${e.trim()}" saved!`)}},v=(e,t)=>{const n=e.charAt(0),s=e.substring(1).replace(/#/g,"\u266f").replace(/b/g,"\u266d");return(0,Lo.jsxs)("span",{className:"font-bold text-teal-300 whitespace-nowrap transition-all duration-150",children:[n,(0,Lo.jsx)("sup",{style:{fontSize:"0.6em",verticalAlign:"super",marginLeft:"0.1em"},children:s})]},t)};return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsx)($o,{isOpen:d,onClose:()=>h(!1),title:"Random Note Generator Guide",children:(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsx)("p",{children:"The Note Generator lets you generate a sequence of random notes. Use the controls to customize the output for your practice needs."}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-2",children:"Controls Explained"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside space-y-2",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Number of Notes"}),": Sets the total number of notes in the generated sequence."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Note Type"}),': Choose "Natural" to only generate notes from A to G, or "Chromatic" to include all sharp and flat notes.']}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Avoid Repeats"}),": When enabled, this prevents the same note from appearing twice in a row, which is useful for creating more varied sequences."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Display Mode"}),":",(0,Lo.jsxs)("ul",{className:"list-['-_'] list-inside pl-4 mt-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Flow"}),': Displays notes in a simple, wrapping line. You can set a bar line to appear every "X" notes.']}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Measures"}),': Arranges notes in a grid that mimics sheet music. You can set both the "Notes per Bar" and "Bars per Line".']})]})]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Auto-Generate"}),': Links the generator to the global Metronome. A new sequence will be generated automatically based on the "Every X clicks" and "Countdown" settings.']})]})]})]})}),(0,Lo.jsxs)("div",{className:"w-full flex-1 bg-slate-800 p-4 rounded-lg",children:[(0,Lo.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 gap-2",children:[(0,Lo.jsx)("div",{className:"flex-1"}),(0,Lo.jsxs)("div",{className:"flex-1 flex justify-center items-center gap-2",children:[(0,Lo.jsx)("h1",{className:"text-xl md:text-2xl text-center font-bold text-indigo-300",children:"Random Note Generator"}),(0,Lo.jsx)(Uo,{onClick:()=>h(!0)})]}),(0,Lo.jsxs)("div",{className:"flex-1 flex justify-end items-center gap-2",children:[(0,Lo.jsx)("button",{onClick:p,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-1 px-3 rounded-lg text-sm",children:"Log Session"}),(0,Lo.jsx)("button",{onClick:()=>u(e=>!e),className:"p-2 rounded-md bg-slate-700 hover:bg-slate-600 text-sm font-semibold",children:"Controls"})]})]}),(0,Lo.jsx)("div",{className:"w-full rounded-lg text-center min-h-[160px] flex justify-center items-center",style:{padding:"1.5rem",fontSize:`${n.fontSize}rem`,lineHeight:1},children:"measure"===n.displayMode?(0,Lo.jsx)("div",{className:"w-full flex flex-col items-center gap-y-6",children:ri(ri(r,n.notesPerBar),n.barsPerLine).map((t,n)=>(0,Lo.jsx)("div",{className:"w-full flex justify-center items-center",children:t.map((t,n)=>(0,Lo.jsxs)(e.Fragment,{children:[n>0&&(0,Lo.jsx)("div",{className:"w-px h-16 bg-slate-500 self-center"}),(0,Lo.jsx)("div",{className:"flex-1 flex justify-around items-center p-2",children:t.map(v)})]},n))},n))}):(0,Lo.jsx)("div",{className:"flex justify-center items-center flex-wrap",style:{columnGap:"0.6em",rowGap:"0.3em"},children:r.map((t,s)=>(0,Lo.jsxs)(e.Fragment,{children:[v(t,s),n.barlineFrequency>0&&(s+1)%n.barlineFrequency===0&&s<r.length-1&&(0,Lo.jsx)("div",{style:{width:"0.10em",height:"1.2em",backgroundColor:"rgb(71 85 105)",borderRadius:"9999px",marginLeft:"0.4em",marginRight:"0.4em"}})]},s))})}),(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-2 md:gap-4 mt-6 mb-8",children:[(0,Lo.jsx)("label",{htmlFor:"font-size-main",className:"font-semibold text-lg",children:"Font Size:"}),(0,Lo.jsx)("input",{type:"range",id:"font-size-main",min:"2",max:"8",step:"0.1",value:n.fontSize,onChange:e=>{x("fontSize",e.target.value)},className:"w-1/2 max-w-xs"})]}),(0,Lo.jsx)("div",{className:"w-full flex justify-center",children:(0,Lo.jsx)("button",{onClick:g,className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg text-xl",children:"Generate (Enter/Space)"})})]}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out sticky top-6 max-h-[calc(100vh-3rem)] "+(c?"w-80 p-4 overflow-y-auto":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!c&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(si,{settings:n,onSettingChange:x,isAutoGenerateOn:a,onAutoGenerateToggle:()=>o(e=>!e),autoGenerateInterval:i,onIntervalChange:l,countdownClicks:m,onCountdownChange:f,onSavePreset:b})]})}),c&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>u(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(si,{settings:n,onSettingChange:x,isAutoGenerateOn:a,onAutoGenerateToggle:()=>o(e=>!e),autoGenerateInterval:i,onIntervalChange:l,countdownClicks:m,onCountdownChange:f,onSavePreset:b})})]})})]})},oi={C:{triads:{chords:["C","Dm","Em","F","G","Am","Bdim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Cmaj7","Dm7","Em7","Fmaj7","G7","Am7","Bm7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},G:{triads:{chords:["G","Am","Bm","C","D","Em","F#dim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Gmaj7","Am7","Bm7","Cmaj7","D7","Em7","F#m7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},D:{triads:{chords:["D","Em","F#m","G","A","Bm","C#dim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Dmaj7","Em7","F#m7","Gmaj7","A7","Bm7","C#m7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},A:{triads:{chords:["A","Bm","C#m","D","E","F#m","G#dim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Amaj7","Bm7","C#m7","Dmaj7","E7","F#m7","G#m7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},E:{triads:{chords:["E","F#m","G#m","A","B","C#m","D#dim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Emaj7","F#m7","G#m7","Amaj7","B7","C#m7","D#m7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},B:{triads:{chords:["B","C#m","D#m","E","F#","G#m","A#dim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Bmaj7","C#m7","D#m7","Emaj7","F#7","G#m7","A#m7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},"F#":{triads:{chords:["F#","G#m","A#m","B","C#","D#m","E#dim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["F#maj7","G#m7","A#m7","Bmaj7","C#7","D#m7","E#m7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},Gb:{triads:{chords:["Gb","Abm","Bbm","Cb","Db","Ebm","Fdim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Gbmaj7","Abm7","Bbm7","Cbmaj7","Db7","Ebm7","Fm7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},Db:{triads:{chords:["Db","Ebm","Fm","Gb","Ab","Bbm","Cdim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Dbmaj7","Ebm7","Fm7","Gbmaj7","Ab7","Bbm7","Cm7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},Ab:{triads:{chords:["Ab","Bbm","Cm","Db","Eb","Fm","Gdim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Abmaj7","Bbm7","Cm7","Dbmaj7","Eb7","Fm7","Gm7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},Eb:{triads:{chords:["Eb","Fm","Gm","Ab","Bb","Cm","Ddim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Ebmaj7","Fm7","Gm7","Abmaj7","Bb7","Cm7","Dm7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},Bb:{triads:{chords:["Bb","Cm","Dm","Eb","F","Gm","Adim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Bbmaj7","Cm7","Dm7","Ebmaj7","F7","Gm7","Am7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}},F:{triads:{chords:["F","Gm","Am","Bb","C","Dm","Edim"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]},sevenths:{chords:["Fmaj7","Gm7","Am7","Bbmaj7","C7","Dm7","Em7b5"],numerals:["I","ii","iii","IV","V","vi","vii\xb0"]}}},ii=[["I","V","vi","IV"],["I","IV","V","IV"],["vi","IV","I","V"],["I","vi","ii","V"],["I","iii","vi","IV"],["ii","V","I","vi"],["I","V","ii","IV"],["vi","ii","V","I"],["I","IV","vi","V"],["iii","vi","IV","V"]],li=e=>"string"!==typeof e?"":e.toLowerCase().replace(/min/g,"m").replace(/[,\s-]+/g," ").trim(),ci=[["C","Am"],["G","Em"],["D","Bm"],["A","F#m"],["E","C#m"],["B","G#m"],["F#","D#m"],["Db","Bbm"],["Ab","Fm"],["Eb","Cm"],["Bb","Gm"],["F","Dm"]],ui=["Gb"],di=[10,6,4,8,10,8,2],hi={triads:["I","ii","iii","IV","V","vi","vii\xb0"],sevenths:["Imaj7","ii7","iii7","IVmaj7","V7","vi7","viim7b5"]},mi=[{id:1,label:"Name Chord"},{id:4,label:"Name Numeral"},{id:2,label:"Progression"},{id:3,label:"Transpose"}],fi=e=>{let{weights:t,onWeightChange:n,use7thChords:s}=e;const r=s?hi.sevenths:hi.triads;return(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Chord Weights"}),t.map((e,s)=>(0,Lo.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,Lo.jsx)("label",{className:"w-8 font-mono text-right text-sm",children:r[s]}),(0,Lo.jsx)("input",{type:"range",min:"0",max:"10",value:e,onChange:e=>{const r=t.map((t,n)=>n===s?Number(e.target.value):t);n(r)},className:"flex-1 h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"}),(0,Lo.jsx)("span",{className:"w-4 text-left text-sm",children:e})]},s))]})},pi=t=>{let{onStart:n}=t;const[s,r]=(0,e.useState)({selectedKeys:["C","G","F"],selectedModes:[1,4],use7thChords:!1,generationMethod:"weighted",majorWeights:di}),[a,o]=(0,e.useState)(!1),[i,l]=(0,e.useState)(!1),c=e=>{const t=s.selectedKeys.includes(e)?s.selectedKeys.filter(t=>t!==e):[...s.selectedKeys,e];r(e=>({...e,selectedKeys:t}))};return(0,Lo.jsxs)("div",{className:"w-full",children:[(0,Lo.jsx)($o,{isOpen:i,onClose:()=>l(!1),title:"Chord Trainer Setup Guide",children:(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsx)("p",{children:'Use this screen to configure your Chord Trainer session. Select the keys and game modes you want to practice, then press "Start Practice" to begin.'}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Game Modes Explained"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Name Chord:"})," Given a key and a Roman numeral (e.g., V), provide the correct chord name (e.g., G)."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Name Numeral:"})," Given a key and a chord (e.g., Am), provide the correct Roman numeral (e.g., vi)."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Progression:"})," Given a key and a sequence of numerals (e.g., I-V-vi-IV), provide the full chord progression."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Transpose:"})," Given a chord progression in a starting key, transpose it to a new key."]})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Advanced Settings"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Generation Method:"}),' Choose "Weighted" to have chords appear based on their commonality (using the sliders below), or "Random" for equal probability.']}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Chord Weights:"}),' In "Weighted" mode, these sliders control how frequently each scale degree will appear. Higher numbers mean more frequent appearances.']})]})]})]})}),(0,Lo.jsxs)("div",{className:"flex justify-center items-center gap-2 mb-6",children:[(0,Lo.jsx)("h2",{className:"text-3xl font-extrabold text-indigo-300 text-center",children:"Chord Trainer Setup"}),(0,Lo.jsx)(Uo,{onClick:()=>l(!0)})]}),(0,Lo.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,Lo.jsxs)("div",{className:"bg-slate-700 p-4 rounded-lg flex flex-col items-center",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4 text-center",children:"Select Keys"}),(0,Lo.jsx)("div",{className:"relative w-80 h-80 sm:w-[350px] sm:h-[350px] mx-auto mb-4",children:ci.map((t,n)=>{let[r]=t;const a=30*n-90;return(0,Lo.jsxs)(e.Fragment,{children:[(0,Lo.jsx)("div",{style:{transform:`translate(-50%, -50%) rotate(${a}deg) translate(130px) rotate(${-a}deg)`},className:"absolute top-1/2 left-1/2 sm:hidden",children:(0,Lo.jsx)("button",{onClick:()=>c(r),className:"p-2 rounded-md min-w-[50px] text-sm "+(s.selectedKeys.includes(r)?"bg-blue-600 text-white":"bg-slate-600 hover:bg-slate-500"),children:r})}),(0,Lo.jsx)("div",{style:{transform:`translate(-50%, -50%) rotate(${a}deg) translate(150px) rotate(${-a}deg)`},className:"absolute top-1/2 left-1/2 hidden sm:block",children:(0,Lo.jsx)("button",{onClick:()=>c(r),className:"p-2 rounded-md min-w-[50px] "+(s.selectedKeys.includes(r)?"bg-blue-600 text-white":"bg-slate-600 hover:bg-slate-500"),children:r})})]},r)})}),(0,Lo.jsxs)("div",{className:"border-t border-slate-600 pt-3 text-center mt-2",children:[(0,Lo.jsx)("h4",{className:"font-semibold text-lg text-gray-400 mb-2",children:"Enharmonic Keys"}),(0,Lo.jsx)("div",{className:"flex justify-center gap-4",children:ui.map(e=>(0,Lo.jsx)("button",{onClick:()=>c(e),className:"p-2 rounded-md min-w-[50px] "+(s.selectedKeys.includes(e)?"bg-blue-600 text-white":"bg-slate-600 hover:bg-slate-500"),children:e},e))})]})]}),(0,Lo.jsxs)("div",{className:"bg-slate-700 p-4 rounded-lg flex flex-col",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Game Modes"}),(0,Lo.jsx)("div",{className:"space-y-2",children:mi.map(e=>(0,Lo.jsx)("button",{onClick:()=>(e=>{const t=s.selectedModes.includes(e)?s.selectedModes.filter(t=>t!==e):[...s.selectedModes,e];r(e=>({...e,selectedModes:t}))})(e.id),className:"w-full text-left p-3 rounded-md "+(s.selectedModes.includes(e.id)?"bg-blue-600 text-white":"bg-slate-600 hover:bg-slate-500"),children:e.label},e.id))}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 my-4"}),(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-2",children:"Chord Type"}),(0,Lo.jsxs)("label",{className:"flex items-center justify-between p-3 rounded-md bg-slate-600 cursor-pointer",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Use 7th Chords"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:s.use7thChords,onChange:e=>r(t=>({...t,use7thChords:e.target.checked})),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 my-4"}),(0,Lo.jsxs)("button",{onClick:()=>o(e=>!e),className:"text-left text-teal-300 font-bold text-lg hover:text-teal-200 w-full",children:[a?"\u25bc":"\u25ba"," Advanced Settings"]}),a&&(0,Lo.jsxs)("div",{className:"mt-2 p-3 bg-slate-800/50 rounded-lg space-y-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold",children:"Generation Method"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1 mt-1",children:[(0,Lo.jsx)("button",{onClick:()=>r(e=>({...e,generationMethod:"weighted"})),className:"flex-1 text-sm rounded-md py-1 "+("weighted"===s.generationMethod?"bg-blue-600 text-white":"text-gray-300"),children:"Weighted"}),(0,Lo.jsx)("button",{onClick:()=>r(e=>({...e,generationMethod:"random"})),className:"flex-1 text-sm rounded-md py-1 "+("random"===s.generationMethod?"bg-blue-600 text-white":"text-gray-300"),children:"Random"})]})]}),(0,Lo.jsx)(fi,{weights:s.majorWeights,onWeightChange:e=>r(t=>({...t,majorWeights:e})),use7thChords:s.use7thChords})]}),(0,Lo.jsx)("div",{className:"mt-auto pt-4",children:(0,Lo.jsx)("button",{onClick:()=>{0!==s.selectedKeys.length&&0!==s.selectedModes.length?n(s):alert("Please select at least one key and one game mode.")},className:"w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3 px-8 rounded-lg text-xl",children:"Start Practice"})})]})]})]})},gi=["C","G","D","A","E","B","F#"],xi=["F","Bb","Eb","Ab","Db","Gb"],bi=[{id:1,label:"Name Chord"},{id:4,label:"Name Numeral"},{id:2,label:"Progression"},{id:3,label:"Transpose"}],vi={triads:["I","ii","iii","IV","V","vi","vii\xb0"],sevenths:["Imaj7","ii7","iii7","IVmaj7","V7","vi7","viim7b5"]},yi=e=>{let{weights:t,onWeightChange:n,use7thChords:s}=e;const r=s?vi.sevenths:vi.triads;return(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Chord Weights"}),t.map((e,t)=>(0,Lo.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,Lo.jsx)("label",{className:"w-8 font-mono text-right text-sm",children:r[t]}),(0,Lo.jsx)("input",{type:"range",min:"0",max:"10",value:e,onChange:e=>n(t,Number(e.target.value)),className:"flex-1 h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"}),(0,Lo.jsx)("span",{className:"w-4 text-left text-sm",children:e})]},t))]})},wi=e=>{let{settings:t,onSettingChange:n,onSavePreset:s}=e;const r=e=>{const s=t.selectedKeys.includes(e)?t.selectedKeys.filter(t=>t!==e):[...t.selectedKeys,e];n("selectedKeys",s)};return(0,Lo.jsxs)("div",{className:"space-y-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Keys"}),(0,Lo.jsxs)("div",{className:"space-y-2",children:[(0,Lo.jsx)("div",{children:gi.map(e=>(0,Lo.jsx)("button",{onClick:()=>r(e),className:"px-3 py-1 mr-1 mb-1 text-sm rounded-full font-semibold "+(t.selectedKeys.includes(e)?"bg-blue-600 text-white":"bg-slate-600"),children:e},e))}),(0,Lo.jsx)("div",{children:xi.map(e=>(0,Lo.jsx)("button",{onClick:()=>r(e),className:"px-3 py-1 mr-1 mb-1 text-sm rounded-full font-semibold "+(t.selectedKeys.includes(e)?"bg-blue-600 text-white":"bg-slate-600"),children:e},e))})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Game Modes"}),(0,Lo.jsx)("div",{className:"grid grid-cols-2 gap-2",children:bi.map(e=>(0,Lo.jsx)("button",{onClick:()=>(e=>{const s=t.selectedModes.includes(e)?t.selectedModes.filter(t=>t!==e):[...t.selectedModes,e];n("selectedModes",s)})(e.id),className:"p-2 text-sm rounded-md font-semibold "+(t.selectedModes.includes(e.id)?"bg-blue-600 text-white":"bg-slate-600"),children:e.label},e.id))})]}),(0,Lo.jsxs)("label",{className:"flex items-center justify-between p-2 rounded-md bg-slate-600 cursor-pointer",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Use 7th Chords"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:t.use7thChords,onChange:e=>n("use7thChords",e.target.checked),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 peer-checked:bg-blue-600"})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Scale Degrees"}),(0,Lo.jsx)("div",{className:"grid grid-cols-4 gap-2",children:Object.keys(t.degreeToggles).map((e,s)=>(0,Lo.jsx)("button",{onClick:()=>(e=>{n("degreeToggles",{...t.degreeToggles,[e]:!t.degreeToggles[e]})})(e),className:"p-2 text-sm rounded-md font-mono "+(t.degreeToggles[e]?"bg-blue-600 text-white":"bg-slate-600"),children:t.use7thChords?vi.sevenths[s]:vi.triads[s]},e))})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsxs)("details",{children:[(0,Lo.jsx)("summary",{className:"text-lg font-bold text-teal-300 cursor-pointer hover:text-teal-200",children:"Advanced Options"}),(0,Lo.jsxs)("div",{className:"mt-2 p-3 bg-slate-800/50 rounded-lg space-y-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Generation Method"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1 mt-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("generationMethod","weighted"),className:"flex-1 text-sm rounded-md py-1 "+("weighted"===t.generationMethod?"bg-blue-600 text-white":"text-gray-300"),children:"Weighted"}),(0,Lo.jsx)("button",{onClick:()=>n("generationMethod","random"),className:"flex-1 text-sm rounded-md py-1 "+("random"===t.generationMethod?"bg-blue-600 text-white":"text-gray-300"),children:"Random"})]})]}),(0,Lo.jsx)(yi,{weights:t.majorWeights,onWeightChange:(e,s)=>{const r=t.majorWeights.map((t,n)=>n===e?s:t);n("majorWeights",r)},use7thChords:t.use7thChords}),(0,Lo.jsxs)("label",{className:"flex items-center justify-between p-2 rounded-md bg-slate-600 cursor-pointer",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Alternate Notation"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:t.useAlternateNotation,onChange:e=>n("useAlternateNotation",e.target.checked),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,Lo.jsxs)("label",{className:"flex items-center justify-between p-2 rounded-md bg-slate-600 cursor-pointer",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Hide Quality (Challenge)"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:t.hideQuality,onChange:e=>n("hideQuality",e.target.checked),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]})}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:s,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},ji={m:"-",maj7:"\u25b37",m7:"-7",dim:"\xb0",m7b5:"\xf87",7:"7"},ki=e=>{let{chord:t,useAlternateNotation:n=!1}=e;if(!t)return null;let s=t;if(n){const e=Object.keys(ji).sort((e,t)=>t.length-e.length);for(const t of e)if(s.endsWith(t)){s=s.slice(0,-t.length)+ji[t];break}}const r=s.match(/^([A-G])([#b]?)(.*)/);if(!r)return(0,Lo.jsx)("span",{children:s});let[,a,o,i]=r;return"#"===o&&(o="\u266f"),"b"===o&&(o="\u266d"),(0,Lo.jsxs)("span",{className:"whitespace-nowrap inline-flex items-baseline",children:[(0,Lo.jsx)("span",{children:a}),(0,Lo.jsxs)("span",{className:"relative",style:{marginLeft:"0.1em",display:"inline-block"},children:[(0,Lo.jsx)("span",{style:{fontSize:"70%",marginLeft:o?"0.25em":"0"},children:i||(0,Lo.jsx)("span",{className:"opacity-0",children:"\xa0"})}),(0,Lo.jsx)("span",{className:"absolute left-0",style:{fontSize:"60%",bottom:"45%"},children:o})]})]})},Ni=t=>{let{initialSettings:n,onLogSession:s,onGoToSetup:r,onProgressUpdate:a,isChallengeMode:o}=t;const[i,l]=(0,e.useState)(n),{currentQuestion:c,userAnswer:u,setUserAnswer:d,feedback:h,score:m,history:f,reviewIndex:p,setReviewIndex:g,checkAnswer:x,generateNewQuestion:b,startReview:v,handleReviewNav:y}=((t,n)=>{const[s,r]=(0,e.useState)(null),[a,o]=(0,e.useState)(""),[i,l]=(0,e.useState)(""),[c,u]=(0,e.useState)(0),[d,h]=(0,e.useState)([]),[m,f]=(0,e.useState)(null),p=(0,e.useRef)(null),g=(0,e.useCallback)(()=>{if(clearTimeout(p.current),f(null),!t)return;const{selectedKeys:e,selectedModes:n,majorWeights:s,degreeToggles:a,use7thChords:i,generationMethod:c,hideQuality:u,useAlternateNotation:d}=t;if(0===e.length||0===n.length)return void r({type:"error",prompt:{text:"Please select keys and game modes to begin."}});const h=e[Math.floor(Math.random()*e.length)],m=n[Math.floor(Math.random()*n.length)],x=i?oi[h].sevenths:oi[h].triads,b=Object.keys(a).map((e,t)=>a[e]?t:-1).filter(e=>-1!==e);if(0===b.length)return void r({type:"error",prompt:{text:"Please enable at least one scale degree in Controls."}});let v=[];if("random"===c?v=b:b.forEach(e=>{for(let t=0;t<s[e];t++)v.push(e)}),0===v.length)return void r({type:"error",prompt:{text:"No chords available with current settings."}});let y={},w="",j=null;const k=v[Math.floor(Math.random()*v.length)],N=e=>e.toUpperCase().replace("\xb0","");if(1===m){let e=x.numerals[k];u&&(e=N(e)),y={text:"In {key}, what is the chord for:",keys:[h],content:e},w=x.chords[k]}else if(4===m)y={text:"In {key}, what is the numeral for:",keys:[h],content:x.chords[k]},w=x.numerals[k];else{const t=ii,n=t[Math.floor(Math.random()*t.length)].map(e=>x.numerals.findIndex(t=>t.toLowerCase().replace("\xb0","")===e.toLowerCase().replace("\xb0","")));let s=n.map(e=>x.numerals[e]);if(2===m){let e=u?s.map(N):s;y={text:"In {key}, what are the chords for:",keys:[h],content:e.join(" ")},w=n.map(e=>x.chords[e]).join(" ")}else{const t=e.filter(e=>e!==h);if(0===t.length)return void g();const r=t[Math.floor(Math.random()*t.length)],a=i?oi[r].sevenths:oi[r].triads;y={text:"Transpose from {key} to {key}:",keys:[h,r],content:n.map(e=>x.chords[e]).join(" ")},w=s.map(e=>{const t=x.numerals.indexOf(e);return a.chords[t]}).join(" ")}}let C="";switch(m){case 1:case 2:case 3:C=i?"Tetrad mode is active. Correct answers look like this: Cmaj7 G#7 Bbm7b5":"Correct answers look like this: C G#m Bbdim";break;case 4:C=i?"Provide the Roman numeral (e.g., I ii vii\xb0). The '7' is implied and should not be written.":"Provide the Roman numeral (e.g., I ii vii\xb0). Case and the \xb0 symbol are important!"}if(d&&C){const e=C,t="Note: Type answers using standard notation (m, maj7, etc.), not symbols.";j=(0,Lo.jsxs)(Lo.Fragment,{children:[e,(0,Lo.jsx)("br",{}),t]})}else j=C;r({prompt:y,answer:w,key:h,mode:m,reminder:j}),o(""),l("")},[t]);(0,e.useEffect)(()=>{t&&t.selectedKeys.length>0&&g()},[t,g]);const x=(0,e.useCallback)((e,t)=>{if(i||!s||"error"===s.type)return;const r=li(e)===li(s.answer),a=r?c+1:c,o=d.length+1;r?(u(a),l("Correct!")):l(`Incorrect. The answer was: ${s.answer}`),h(t=>[...t,{question:s,userAnswer:e,wasCorrect:r}]),n&&n({wasCorrect:r,score:a,totalAsked:o}),t&&r&&(p.current=setTimeout(g,1500))},[i,s,g,c,d.length,n]);return{currentQuestion:s,userAnswer:a,setUserAnswer:o,feedback:i,score:c,history:d,reviewIndex:m,setReviewIndex:f,checkAnswer:x,generateNewQuestion:g,startReview:()=>d.length>0&&f(d.length-1),handleReviewNav:e=>f(t=>{const n=t+e;return n>=0&&n<d.length?n:t})}})(i,a),[w,j]=(0,e.useState)(!1),[k,N]=(0,e.useState)(!1),{savePreset:C}=Vo(),_=(0,e.useRef)(null),S=null!==p,T=!(f.length>0)||f[f.length-1].wasCorrect;(0,e.useEffect)(()=>{h||S||!_.current||_.current.focus()},[c,h,S]),(0,e.useEffect)(()=>{const e=e=>{"Enter"!==e.key||!h||i.autoAdvance&&T||(e.preventDefault(),b())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[h,i.autoAdvance,T,b]);const A=(e,t)=>l(n=>({...n,[e]:t})),M=()=>{const e=prompt("Enter a name for your preset:",`CT - ${i.selectedKeys.join(",")}`);e&&""!==e.trim()&&(C({id:Date.now().toString(),name:e.trim(),gameId:"chord-trainer",gameName:"Chord Trainer",settings:i}),alert(`Preset "${e.trim()}" saved!`))},E=S?f[p]:{question:c,userAnswer:u};return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsx)($o,{isOpen:k,onClose:()=>N(!1),title:"Chord Trainer Guide",children:(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Game Modes"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Name Chord:"})," Given a key and a Roman numeral, name the chord."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Name Numeral:"})," Given a key and a chord, name the Roman numeral."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Progression:"})," Given a key and a numeral progression, name all the chords."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Transpose:"})," Given a chord progression in a starting key, transpose it to a new key, keeping the scale degrees (roman numerals) the same."]})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-2 mb-1",children:"Chord Complexity"}),(0,Lo.jsx)("p",{children:'Use the "Use 7th Chords" toggle to switch between triads (3-note chords) and tetrads (4-note chords). When active, you must provide the full 7th chord name (e.g., Cmaj7, Dm7).'})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-2 mb-1",children:"Roman Numerals"}),(0,Lo.jsx)("p",{children:'Roman numerals represent scale degrees. Their case indicates quality (e.g., I is major, ii is minor, vii\xb0 is diminished). They do not include the "7" for tetrads; you are expected to know the correct 7th chord quality for that degree.'})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-2",children:"Advanced Options"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Alternate Notation:"})," Displays chords with professional symbols (e.g., C-, F\u25b37, B\xf87). Even when active, you should type your answers in standard notation (e.g., Cm7, Fmaj7)."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Hide Quality:"})," For a harder challenge, this makes all Roman numerals uppercase (e.g., ii becomes II), forcing you to recall the quality from theory."]})]})]})]})}),(0,Lo.jsxs)("div",{className:"w-full flex-1 bg-slate-800 p-4 rounded-lg",children:[(0,Lo.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("h1",{className:"text-2xl font-bold text-indigo-300",children:"Chord Trainer"}),(0,Lo.jsx)(Uo,{onClick:()=>N(!0)})]}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("button",{onClick:()=>s(m,f),className:"bg-green-600 hover:bg-green-500 text-white font-bold py-1 px-3 rounded-lg text-sm",children:"Log"}),(0,Lo.jsx)("button",{onClick:()=>j(e=>!e),className:"p-2 rounded-md bg-slate-700 hover:bg-slate-600 text-sm font-semibold",children:"Controls"})]})]}),(0,Lo.jsxs)("div",{className:"grid grid-cols-3 items-center mb-4 text-lg",children:[(0,Lo.jsxs)("span",{className:"font-semibold justify-self-start",children:["Score: ",m," / ",f.length]}),(0,Lo.jsx)("div",{className:"justify-self-center",children:f.length>0&&(0,Lo.jsx)("button",{onClick:v,disabled:S,className:"bg-gray-600 hover:bg-gray-500 text-sm py-1 px-3 rounded-lg",children:"Review"})}),(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold justify-self-end",children:[(0,Lo.jsx)("span",{children:"Auto-Advance"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:i.autoAdvance,onChange:e=>A("autoAdvance",e.target.checked),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),(0,Lo.jsxs)("div",{className:"w-full max-w-3xl mx-auto flex flex-col items-center",children:[(0,Lo.jsx)("div",{className:"w-full bg-slate-900/50 p-4 rounded-lg text-center min-h-[120px] flex justify-center items-center flex-wrap gap-x-2 mb-2",children:(()=>{const t=E.question;if(!t||!t.prompt)return null;if("error"===t.type)return(0,Lo.jsx)("span",{className:"text-red-400",children:t.prompt.text});let n=0;const s=t.prompt.text.split("{key}").map((s,r)=>r<t.prompt.keys.length?(0,Lo.jsxs)(e.Fragment,{children:[s,(0,Lo.jsx)("span",{className:"text-highlight font-bold",children:t.prompt.keys[n++]})]},r):s),r=t.prompt.content.split(" ");return(0,Lo.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,Lo.jsx)("div",{className:"text-3xl mb-4",children:s}),(0,Lo.jsx)("div",{className:"inline-flex flex-wrap justify-center items-center gap-2",children:r.map((e,t)=>(0,Lo.jsx)("strong",{className:"text-4xl font-bold text-teal-300 bg-slate-700/50 px-3 py-1 rounded-md",children:(0,Lo.jsx)(ki,{chord:e,useAlternateNotation:i.useAlternateNotation})},t))})]})})()}),c&&c.reminder&&!h&&(0,Lo.jsx)("div",{className:"text-sm italic text-highlight bg-yellow-900/30 p-2 rounded-md my-2 w-full text-center",children:c.reminder}),(0,Lo.jsx)("div",{className:"text-xl my-4 min-h-[28px] "+(h.startsWith("Correct")?"text-green-400":"text-red-400"),children:h}),(0,Lo.jsxs)("form",{onSubmit:e=>{e.preventDefault(),x(u,i.autoAdvance)},className:"w-full max-w-sm flex flex-col items-center",children:[(0,Lo.jsx)("input",{ref:_,type:"text",value:S?"":u,onChange:e=>d(e.target.value),className:"w-full text-center text-xl p-3 rounded-lg bg-slate-700",disabled:!!h||S,autoFocus:!0}),(0,Lo.jsx)("div",{className:"h-20 mt-3 flex justify-center items-center gap-4",children:S?(0,Lo.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Lo.jsx)("button",{type:"button",onClick:()=>y(-1),disabled:0===p,className:"p-3 rounded-lg bg-slate-600",children:"Prev"}),(0,Lo.jsx)("button",{type:"button",onClick:()=>g(null),className:"bg-purple-600 p-3 rounded-lg font-bold",children:"Return"}),(0,Lo.jsx)("button",{type:"button",onClick:()=>y(1),disabled:p===f.length-1,className:"p-3 rounded-lg bg-slate-600",children:"Next"})]}):(0,Lo.jsxs)(Lo.Fragment,{children:[!a&&(0,Lo.jsx)("button",{type:"button",onClick:r,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg",children:"Menu"}),!h&&(0,Lo.jsx)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg",children:"Submit"}),h&&(!i.autoAdvance||!T)&&(0,Lo.jsx)("button",{type:"button",onClick:b,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg animate-pulse",children:"Next Question"})]})})]})]})]}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 "+(w?"w-96 p-4":"w-0 overflow-hidden"),children:w&&(0,Lo.jsx)(wi,{settings:i,onSettingChange:A,onSavePreset:M})}),w&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>j(!1),children:(0,Lo.jsx)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(wi,{settings:i,onSettingChange:A,onSavePreset:M})})})})]})},Ci=t=>{let{onProgressUpdate:n,challengeSettings:s}=t;const{addLogEntry:r,clearPresetToLoad:a,presetToLoad:o}=Vo(),[i,l]=(0,e.useState)("setup"),[c,u]=(0,e.useState)(null);(0,e.useEffect)(()=>{s?(u(s),l("quiz")):o&&"chord-trainer"===o.gameId&&(u(o.settings),l("quiz"),a())},[s,o,a]);const d=e=>{u({...e,degreeToggles:{I:!0,ii:!0,iii:!0,IV:!0,V:!0,vi:!0,"vii\xb0":!0},useAlternateNotation:!1,autoAdvance:!0,hideQuality:!1}),l("quiz")},h=()=>{window.confirm("Are you sure you want to return to the menu? Your session will be lost.")&&(l("setup"),u(null))},m=(e,t)=>{const n=prompt("Enter any remarks for this session:",`Score: ${e}/${t.length}`);null!==n&&(r({game:"Chord Trainer",date:(new Date).toLocaleDateString(),remarks:n}),alert("Session logged!"))};return"setup"===i?(0,Lo.jsx)(pi,{onStart:d}):"quiz"===i&&c?(0,Lo.jsx)(Ni,{initialSettings:c,onLogSession:m,onGoToSetup:h,onProgressUpdate:n,isChallengeMode:!!s},JSON.stringify(c)):null},_i=()=>{const[t,n]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{const e=/iPhone|iPad|iPod/.test(navigator.userAgent);n(e)},[]),t?(0,Lo.jsxs)("div",{className:"bg-indigo-900/50 border border-indigo-700 text-indigo-200 text-sm rounded-lg p-3 my-3 text-center",children:[(0,Lo.jsx)("p",{className:"font-bold",children:"No Sound on iPhone / iPad?"}),(0,Lo.jsx)("p",{children:"If you don't hear audio, please ensure your device's Ring/Silent switch is turned ON (not showing orange)."})]}):null},Si=()=>{const{bpm:e,setBpm:t,isMetronomePlaying:n,toggleMetronome:s,metronomeVolume:r,setMetronomeVolume:a,isMetronomeReady:o}=Vo();return(0,Lo.jsxs)("div",{className:"bg-slate-700 p-4 rounded-b-lg w-full",children:[(0,Lo.jsx)(_i,{}),(0,Lo.jsxs)("div",{className:"mb-4",children:[(0,Lo.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Lo.jsx)("label",{htmlFor:"bpm-input",className:"text-gray-200 text-lg font-semibold",children:"BPM:"}),(0,Lo.jsx)("input",{type:"number",id:"bpm-input",value:e,onChange:e=>{t(e.target.value)},onBlur:()=>{let n=parseInt(e,10);isNaN(n)||n<40?t(40):t(n>240?240:n)},className:"w-20 p-1 rounded-md bg-slate-600 text-white text-center",min:"40",max:"240"})]}),(0,Lo.jsx)("input",{type:"range",id:"bpm-slider",min:"40",max:"240",value:e,onChange:e=>t(Number(e.target.value)),className:"w-full h-3 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]}),(0,Lo.jsxs)("div",{className:"mb-4",children:[(0,Lo.jsx)("label",{htmlFor:"volume-slider",className:"block text-gray-200 text-lg font-semibold mb-2",children:"Volume"}),(0,Lo.jsx)("input",{type:"range",id:"volume-slider",min:"-40",max:"0",step:"1",value:r,onChange:e=>a(Number(e.target.value)),className:"w-full h-3 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]}),(0,Lo.jsx)("button",{onClick:s,disabled:!o,className:"w-full py-3 rounded-lg text-lg font-bold text-white transition-colors disabled:bg-gray-500 disabled:cursor-not-allowed "+(n?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"),children:o?n?"Stop":"Start":"Loading..."})]})},Ti=()=>{var e;const{droneNote:t,setDroneNote:n,isDronePlaying:s,toggleDrone:r,droneVolume:a,setDroneVolume:o,areDronesReady:i,randomizeDroneNote:l}=Vo(),c=[{value:"A",display:"A"},{value:"A#",display:"A# / Bb"},{value:"B",display:"B"},{value:"C",display:"C"},{value:"C#",display:"C# / Db"},{value:"D",display:"D"},{value:"D#",display:"D# / Eb"},{value:"E",display:"E"},{value:"F",display:"F"},{value:"F#",display:"F# / Gb"},{value:"G",display:"G"},{value:"G#",display:"G# / Ab"}],u=(null===(e=c.find(e=>e.value===t))||void 0===e?void 0:e.display)||t;return(0,Lo.jsxs)("div",{className:"bg-slate-700 p-4 rounded-b-lg w-full",children:[(0,Lo.jsx)(_i,{}),(0,Lo.jsxs)("div",{className:"mb-4",children:[(0,Lo.jsxs)("label",{htmlFor:"drone-note",className:"block text-gray-200 text-lg font-semibold mb-2",children:["Note: ",u]}),(0,Lo.jsxs)("div",{className:"grid grid-cols-[1fr_auto] items-center gap-2",children:[(0,Lo.jsx)("select",{id:"drone-note",value:t,onChange:e=>n(e.target.value),className:"p-2 rounded-lg bg-slate-600 text-white w-full",children:c.map(e=>(0,Lo.jsx)("option",{value:e.value,children:e.display},e.value))}),(0,Lo.jsx)("button",{onClick:l,className:"px-2 py-2 rounded-lg font-semibold bg-blue-600 hover:bg-blue-500 text-white",children:"Random"})]})]}),(0,Lo.jsxs)("div",{className:"mb-4",children:[(0,Lo.jsx)("label",{htmlFor:"drone-volume-slider",className:"block text-gray-200 text-lg font-semibold mb-2",children:"Volume"}),(0,Lo.jsx)("input",{type:"range",id:"drone-volume-slider",min:"-40",max:"0",step:"1",value:a,onChange:e=>o(Number(e.target.value)),className:"w-full h-3 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]}),(0,Lo.jsx)("button",{onClick:r,disabled:!i,className:"w-full py-3 rounded-lg text-lg font-bold text-white disabled:bg-gray-500 disabled:cursor-not-allowed "+(s?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"),children:i?s?"Stop Drone":"Play Drone":"Loading..."})]})},Ai=()=>{const{timeLeft:t,isTimerRunning:n,toggleTimer:s,resetTimer:r,timerDuration:a}=Vo(),[o,i]=(0,e.useState)(a/60);(0,e.useEffect)(()=>{i(a/60)},[a]);const l=0===t&&!n;return(0,Lo.jsxs)("div",{className:"bg-slate-700 p-4 rounded-b-lg w-full",children:[(0,Lo.jsx)("div",{className:"text-5xl font-mono text-center mb-4 "+(l?"text-red-500 animate-pulse":"text-white"),children:l?"Time's Up!":(e=>{const t=Math.floor(e/60),n=e%60;return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`})(t)}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,Lo.jsx)("input",{type:"number",value:o,onChange:e=>i(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white text-center",min:"1",disabled:n}),(0,Lo.jsx)("button",{onClick:()=>{const e=parseInt(o,10);!isNaN(e)&&e>0&&r(e)},disabled:n,className:"px-4 py-2 rounded-lg font-semibold bg-blue-600 hover:bg-blue-500 text-white disabled:bg-gray-500",children:"Set"})]}),(0,Lo.jsxs)("div",{className:"flex gap-4",children:[(0,Lo.jsx)("button",{onClick:s,disabled:0===t,className:"w-full py-3 rounded-lg text-lg font-bold text-white disabled:bg-gray-500 "+(n?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"),children:n?"Pause":"Start"}),(0,Lo.jsx)("button",{onClick:()=>r(o),className:"w-full py-3 rounded-lg text-lg font-bold bg-gray-600 hover:bg-gray-500 text-white",children:"Reset"})]})]})},Mi=e=>{let{isLocked:t=!1}=e;const{stopwatchTime:n,isStopwatchRunning:s,laps:r,toggleStopwatch:a,resetStopwatch:o,addLap:i}=Vo(),l=e=>{const t=Math.floor(e/6e4),n=Math.floor(e%6e4/1e3),s=Math.floor(e%1e3/10);return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}.${String(s).padStart(2,"0")}`};return(0,Lo.jsxs)("div",{className:"bg-slate-700 p-4 rounded-b-lg w-full",children:[(0,Lo.jsx)("div",{className:"text-4xl font-mono text-center text-white mb-4",children:l(n)}),(0,Lo.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,Lo.jsx)("button",{onClick:a,disabled:t,className:`w-full py-2 rounded-lg text-lg font-bold text-white ${s?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"} disabled:bg-gray-500 disabled:cursor-not-allowed`,children:s?"Pause":"Start"}),(0,Lo.jsx)("button",{onClick:i,disabled:t||!s,className:"w-full py-2 rounded-lg text-lg font-bold bg-blue-600 hover:bg-blue-500 text-white disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Lap"})]}),(0,Lo.jsx)("button",{onClick:o,disabled:t,className:"w-full py-2 rounded-lg text-lg font-bold bg-gray-600 hover:bg-gray-500 text-white disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Reset"}),r.length>0&&(0,Lo.jsx)("div",{className:"mt-4 border-t border-slate-600 pt-2 max-h-24 overflow-y-auto",children:(0,Lo.jsx)("ul",{className:"text-gray-300 text-center",children:r.map((e,t)=>(0,Lo.jsxs)("li",{className:"flex justify-between px-2",children:[(0,Lo.jsxs)("span",{children:["Lap ",t+1]}),(0,Lo.jsx)("span",{children:l(e)})]},t)).reverse()})})]})},Ei=()=>{const{practiceLog:t,clearLog:n,addLogEntry:s,importLog:r}=Vo(),[a,o]=(0,e.useState)("All"),[i,l]=(0,e.useState)("date-desc"),[c,u]=(0,e.useState)(""),[d,h]=(0,e.useState)(!1),m=(0,e.useRef)(null),f=(0,e.useMemo)(()=>{const e=new Set(t.map(e=>e.game));return["All",...Array.from(e)]},[t]),p=(0,e.useMemo)(()=>{let e="All"===a?[...t]:t.filter(e=>e.game===a);switch(i){case"name-asc":e.sort((e,t)=>e.game.localeCompare(t.game));break;case"name-desc":e.sort((e,t)=>t.game.localeCompare(e.game));break;case"date-asc":return e;default:return e.slice().reverse()}return e},[t,a,i]);return(0,Lo.jsxs)("div",{className:"bg-slate-700 p-4 rounded-b-lg w-full flex flex-col h-full",children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0",children:[(0,Lo.jsxs)("div",{className:"mb-4",children:[(0,Lo.jsxs)("button",{onClick:()=>h(e=>!e),className:"w-full flex justify-between items-center p-3 bg-slate-800/50 rounded-lg text-left font-bold text-lg text-white hover:bg-slate-800 transition-colors",children:[(0,Lo.jsx)("span",{children:"Add a Custom Log"}),(0,Lo.jsx)("span",{className:"transform transition-transform duration-200 "+(d?"rotate-90":""),children:"\u25b6"})]}),d&&(0,Lo.jsxs)("div",{className:"mt-2 p-3 bg-slate-800/50 rounded-lg animate-fade-in-down",children:[(0,Lo.jsx)("textarea",{value:c,onChange:e=>u(e.target.value),placeholder:"Practiced scales for 20 minutes...",className:"w-full p-2 rounded-md bg-slate-600 text-white text-sm h-20 resize-none",autoFocus:!0}),(0,Lo.jsx)("button",{onClick:()=>{if(""===c.trim())return void alert("Please enter some remarks for your custom log.");const e={game:"Custom Log",bpm:"N/A",date:(new Date).toLocaleDateString(),remarks:c.trim()};s(e),u(""),h(!1)},className:"w-full mt-2 py-2 rounded-lg text-md font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Custom Log"})]})]}),(0,Lo.jsxs)("div",{className:"flex justify-between items-center mb-3 pt-4 border-t border-slate-600 gap-2",children:[(0,Lo.jsx)("h4",{className:"font-bold text-lg text-white",children:"History"}),(0,Lo.jsx)("select",{value:a,onChange:e=>o(e.target.value),className:"bg-slate-600 text-white rounded-md p-1 border border-slate-500 w-full",title:"Filter by tool",children:f.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))}),(0,Lo.jsxs)("select",{value:i,onChange:e=>l(e.target.value),className:"bg-slate-600 text-white rounded-md p-1 border border-slate-500 w-full",title:"Sort logs",children:[(0,Lo.jsx)("option",{value:"date-desc",children:"Newest First"}),(0,Lo.jsx)("option",{value:"date-asc",children:"Oldest First"}),(0,Lo.jsx)("option",{value:"name-asc",children:"Name (A-Z)"}),(0,Lo.jsx)("option",{value:"name-desc",children:"Name (Z-A)"})]})]})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:p.length>0?(0,Lo.jsx)("ul",{className:"space-y-3",children:p.map((e,t)=>(0,Lo.jsxs)("li",{className:"bg-slate-600 p-3 rounded-lg text-sm",children:[(0,Lo.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,Lo.jsxs)("div",{className:"flex flex-col",children:[(0,Lo.jsx)("span",{className:"font-bold text-teal-300",children:e.game}),(0,Lo.jsxs)("span",{className:"text-gray-300",children:[e.bpm," BPM"]})]}),(0,Lo.jsx)("span",{className:"text-gray-400 font-mono flex-shrink-0 ml-4",children:e.date})]}),(0,Lo.jsx)("p",{className:"text-gray-200 break-words pt-1 border-t border-slate-500/50 mt-2",children:e.remarks})]},t))}):(0,Lo.jsx)("p",{className:"text-center text-gray-400 py-4",children:"No practice sessions logged."})}),(0,Lo.jsx)("div",{className:"flex-shrink-0 mt-4 pt-4 border-t border-slate-600",children:(0,Lo.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,Lo.jsx)("button",{onClick:()=>{m.current.click()},className:"w-full py-2 rounded-lg font-bold bg-blue-700 hover:bg-blue-600 text-white",children:"Import"}),(0,Lo.jsx)("button",{onClick:()=>{if(0===t.length)return void alert("Your practice log is empty. Nothing to export.");const e=JSON.stringify(t,null,2),n=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=`practice_log_${(new Date).toISOString().split("T")[0]}.log.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)},className:"w-full py-2 rounded-lg font-bold bg-blue-700 hover:bg-blue-600 text-white",children:"Export"}),(0,Lo.jsx)("button",{onClick:n,className:"w-full py-2 rounded-lg font-bold bg-red-700 hover:bg-red-600 text-white col-span-2",children:"Clear All Logs"})]})}),(0,Lo.jsx)("input",{type:"file",ref:m,onChange:e=>{const t=e.target.files[0];t&&r(t),e.target.value=null},accept:".json",style:{display:"none"}})]})},Di=()=>{const{presets:t,deletePreset:n,loadPreset:s,navigate:r}=Vo(),[a,o]=(0,e.useState)("All"),[i,l]=(0,e.useState)("date-desc"),[c,u]=(0,e.useState)(""),[d,h]=(0,e.useState)("Custom"),m=(0,e.useMemo)(()=>{const e=new Set(t.map(e=>e.gameName));return["All",...Array.from(e).sort()]},[t]),f=(0,e.useMemo)(()=>{let e=[...t];return""!==c.trim()&&(e=e.filter(e=>e.name.toLowerCase().includes(c.toLowerCase()))),"All"!==a&&(e=e.filter(e=>e.gameName===a)),"Default"===d?e=e.filter(e=>e.isDefault):"Custom"===d&&(e=e.filter(e=>!e.isDefault)),e.sort((e,t)=>{switch(i){case"name-asc":return e.name.localeCompare(t.name);case"name-desc":return t.name.localeCompare(e.name);case"date-asc":return e.id.toString().localeCompare(t.id.toString());default:return t.id.toString().localeCompare(e.id.toString())}}),e},[t,a,i,c,d]);return(0,Lo.jsxs)("div",{className:"bg-slate-700 p-4 rounded-b-lg w-full flex flex-col h-full",children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0",children:[(0,Lo.jsx)("div",{className:"mb-3",children:(0,Lo.jsx)("input",{type:"text",placeholder:"Search by name...",value:c,onChange:e=>u(e.target.value),className:"w-full p-2 bg-slate-800 text-white rounded-md border border-slate-600"})}),(0,Lo.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,Lo.jsx)("select",{value:a,onChange:e=>o(e.target.value),className:"bg-slate-600 text-white text-sm rounded-md p-1 border border-slate-500 w-full",children:m.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))}),(0,Lo.jsxs)("select",{value:d,onChange:e=>h(e.target.value),className:"bg-slate-600 text-white text-sm rounded-md p-1 border border-slate-500 w-full",children:[(0,Lo.jsx)("option",{value:"All",children:"All Presets"}),(0,Lo.jsx)("option",{value:"Custom",children:"My Presets"}),(0,Lo.jsx)("option",{value:"Default",children:"Defaults"})]}),(0,Lo.jsxs)("select",{value:i,onChange:e=>l(e.target.value),className:"bg-slate-600 text-white text-sm rounded-md p-1 border border-slate-500 w-full col-span-2",children:[(0,Lo.jsx)("option",{value:"date-desc",children:"Newest First"}),(0,Lo.jsx)("option",{value:"date-asc",children:"Oldest First"}),(0,Lo.jsx)("option",{value:"name-asc",children:"Name (A-Z)"}),(0,Lo.jsx)("option",{value:"name-desc",children:"Name (Z-A)"})]})]})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:f.length>0?(0,Lo.jsx)("ul",{className:"space-y-3",children:f.map(e=>(0,Lo.jsxs)("li",{className:"p-3 rounded-lg text-sm "+(e.isDefault?"bg-slate-800":"bg-slate-600"),children:[(0,Lo.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,Lo.jsxs)("div",{className:"flex flex-col",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("span",{className:"font-bold text-teal-300",children:e.name}),e.isDefault&&(0,Lo.jsx)("span",{className:"text-xs bg-indigo-500 text-white font-semibold px-2 py-0.5 rounded-full",children:"Default"})]}),(0,Lo.jsx)("span",{className:"text-gray-400 text-xs",children:e.gameName})]}),!e.isDefault&&(0,Lo.jsx)("button",{onClick:()=>n(e.id),className:"text-red-400 hover:text-red-300 font-bold text-lg flex-shrink-0 ml-2",children:"\xd7"})]}),(0,Lo.jsx)("button",{onClick:()=>s(e),className:"w-full py-2 rounded-lg font-bold bg-blue-600 hover:bg-blue-500 text-white",children:"Load Preset"})]},e.id))}):(0,Lo.jsx)("p",{className:"text-center text-gray-400 py-4",children:"No presets match your filters."})}),(0,Lo.jsx)("div",{className:"flex-shrink-0 mt-4 pt-4 border-t border-slate-600",children:(0,Lo.jsx)("button",{onClick:()=>{r&&r("presets-manager")},className:"w-full py-2 rounded-lg font-bold bg-indigo-700 hover:bg-indigo-600 text-white",children:"Go to Preset Manager"})})]})},Ri=()=>{const{unlockAudio:e,activeTool:t,toggleActiveTool:n,isMetronomePlaying:s,toggleMetronome:r,isDronePlaying:a,toggleDrone:o,isTimerRunning:i,toggleTimer:l,isStopwatchRunning:c,toggleStopwatch:u,activeRoutine:d}=Vo(),h=()=>(0,Lo.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Lo.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"})}),m=()=>(0,Lo.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Lo.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6"})}),f="Gauntlet"===(null===d||void 0===d?void 0:d.type),p=[{name:"log",label:"Practice Log",Component:Ei,hidePlayPause:!0},{name:"presets",label:"Presets",Component:Di,hidePlayPause:!0},{name:"metronome",label:"Metronome",Component:Si,isPlaying:s},{name:"drone",label:"Drone",Component:Ti,isPlaying:a},{name:"timer",label:"Timer",Component:Ai,isPlaying:i},{name:"stopwatch",label:"Stopwatch",Component:Mi,isPlaying:c}],g=p.find(e=>e.name===t),x=null===g||void 0===g?void 0:g.Component;return(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center transition-opacity duration-300 "+(t?"bg-black/60 opacity-100":"bg-transparent opacity-0 pointer-events-none"),onClick:()=>n(null),children:(0,Lo.jsx)("div",{className:"w-11/12 max-w-sm bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:x&&(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:g.label}),(0,Lo.jsx)("button",{onClick:()=>n(null),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto -mr-2 pr-2",children:"stopwatch"===t?(0,Lo.jsx)(x,{isLocked:f}):(0,Lo.jsx)(x,{})})]})})}),(0,Lo.jsx)("div",{className:"fixed z-30 bg-slate-900/80 backdrop-blur-sm\n                         bottom-0 left-0 right-0 p-2 flex flex-row items-center justify-start gap-2 border-t border-slate-700 overflow-x-auto\n                         md:top-1/4 md:left-5 md:right-auto md:bottom-5 md:flex-col md:items-stretch md:p-3 md:gap-2 md:border-t-0 md:rounded-lg md:border\n                         transition-all duration-300 "+("log"===t||"presets"===t?"md:w-96":"md:w-64"),children:p.map(s=>{const a=s.Component;return(0,Lo.jsxs)("div",{className:"bg-slate-800 rounded-lg shadow-lg border border-slate-700 flex-shrink-0 md:flex md:flex-col",children:[(0,Lo.jsxs)("div",{className:"flex items-center flex-shrink-0",children:[(0,Lo.jsx)("button",{onClick:()=>{return t=s.name,e(),void n(t);var t},className:"flex-grow text-left font-bold py-2 px-3 md:py-3 md:px-4 text-white hover:bg-indigo-700 rounded-l-lg text-sm md:text-base",children:s.label}),!s.hidePlayPause&&(0,Lo.jsx)("button",{onClick:t=>(async(t,n)=>{if(t.stopPropagation(),"stopwatch"!==n||!f)switch(await e(),n){case"metronome":r();break;case"drone":o();break;case"timer":l();break;case"stopwatch":u()}})(t,s.name),disabled:"stopwatch"===s.name&&f,className:"p-2 md:p-3 text-white hover:bg-indigo-700 rounded-r-lg disabled:text-gray-500",children:s.isPlaying?(0,Lo.jsx)(m,{}):(0,Lo.jsx)(h,{})})]}),(0,Lo.jsx)("div",{className:"hidden md:block md:flex-grow md:overflow-y-auto",children:t===s.name&&(0,Lo.jsx)("div",{className:"border-t border-slate-700 h-full",children:"stopwatch"===s.name?(0,Lo.jsx)(a,{isLocked:f}):(0,Lo.jsx)(a,{})})})]},s.name)})})]})},Ii=e=>{let{fretCount:t=15,startFret:n=0,stringCount:s=6,notesToDisplay:r=[],showLabels:a=!1,labelType:o="name",colorMap:i={},onBoardClick:l,onNoteMouseDown:c,onBoardMouseMove:u,onBoardMouseUp:d,draggingNote:h}=e;const m=800,f=240,p=f/s,g=0===n?10:0,x=(m-g)/t,b=[3,5,7,9,15,17,19,21],v=[12,24],y=()=>(0,Lo.jsx)("g",{className:"frets",children:Array.from({length:t+1}).map((e,t)=>{const s=0===n&&0===t,r=t*x+g;return(0,Lo.jsx)("line",{x1:r,y1:0,x2:r,y2:f,stroke:s?"hsl(0, 0%, 80%)":"hsl(0, 0%, 50%)",strokeWidth:s?g:4},`fret-${t}`)})}),w=()=>(0,Lo.jsx)("g",{className:"strings",children:Array.from({length:s}).map((e,t)=>(0,Lo.jsx)("line",{x1:0,y1:t*p+p/2,x2:m,y2:t*p+p/2,stroke:"hsl(45, 50%, 60%)",strokeWidth:1+.3*t},`string-${t}`))}),j=()=>{const e=[];for(let s=0;s<t;s++){const t=n+s+1,r=s*x+x/2+g;b.includes(t)&&e.push((0,Lo.jsx)("circle",{cx:r,cy:120,r:"8",fill:"rgba(255, 255, 255, 0.15)"},`inlay-${s}`)),v.includes(t)&&(e.push((0,Lo.jsx)("circle",{cx:r,cy:1.5*p,r:"8",fill:"rgba(255, 255, 255, 0.15)"},`inlay-${s}-1`)),e.push((0,Lo.jsx)("circle",{cx:r,cy:f-1.5*p,r:"8",fill:"rgba(255, 255, 255, 0.15)"},`inlay-${s}-2`)))}return(0,Lo.jsx)("g",{className:"inlays",children:e})},k=()=>(0,Lo.jsx)("g",{className:"notes",children:r.map(e=>{if(e.fret<n||e.fret>n+t)return null;let s,r;const u=void 0!==e.movedFret?e.movedFret:e.fret,d=void 0!==e.movedString?e.movedString:e.string;if(u>0){s=(u-n-.5)*x+g}else{if(0!==n)return null;s=g/2}r=(d-1)*p+p/2;const m=e.isRoot?"hsl(170, 100%, 35%)":"hsl(220, 80%, 55%)",f=i[e.degree],b=e.overrideColor||(f&&f.active?f.color:m),v=e.isRoot?"hsl(170, 100%, 75%)":"hsl(220, 80%, 85%)",y="degree"===o?e.degree:e.label,w=a?e.overrideLabel||y:e.isRoot?"R":"",j=h&&h.string===e.string&&h.fret===e.fret;return(0,Lo.jsxs)("g",{transform:`translate(${s}, ${r})`,onMouseDown:t=>{t.stopPropagation(),c&&c(e,t)},onClick:t=>{t.stopPropagation(),l&&l(e.string,e.fret)},className:j?"opacity-70 scale-110":"",style:{transition:j?"none":"all 0.3s ease",cursor:c?"grab":l?"pointer":"default"},children:[(0,Lo.jsx)("circle",{r:"16",fill:b,stroke:v,strokeWidth:"2"}),(0,Lo.jsx)("text",{textAnchor:"middle",dy:".3em",fill:"white",fontSize:"1.1rem",fontWeight:"bold",style:{pointerEvents:"none"},children:w})]},`note-${e.string}-${e.fret}`)})});return(0,Lo.jsxs)("div",{className:"flex flex-col items-center w-full",children:[n>0&&(0,Lo.jsxs)("div",{className:"text-gray-400 text-sm font-bold mb-1",children:["Fret: ",n]}),(0,Lo.jsxs)("svg",{id:"fretboard-diagram-svg",className:"w-full max-w-4xl bg-slate-800 rounded-lg shadow-lg border border-slate-700",viewBox:"0 0 800 240",preserveAspectRatio:"xMidYMid meet",onClick:e=>{if(l){if(e.target.closest(".notes g"))return;const r=e.currentTarget,a=r.createSVGPoint();a.x=e.clientX,a.y=e.clientY;const o=a.matrixTransform(r.getScreenCTM().inverse()),i=Math.floor(o.y/p)+1;if(0===n&&o.x>0&&o.x<g)return void l(i,0);const c=Math.floor((o.x-g)/x);let u;u=0===n?c+1:c+n,i>=1&&i<=s&&u>=n&&u<=n+t&&l(i,u)}},onMouseMove:u,onMouseUp:d,onMouseLeave:d,style:{cursor:l?"copy":h?"grabbing":"default"},children:[(0,Lo.jsx)("rect",{width:m,height:f,fill:"transparent"}),(0,Lo.jsx)(j,{}),(0,Lo.jsx)(w,{}),(0,Lo.jsx)(y,{}),(0,Lo.jsx)(k,{})]})]})},Pi=e=>{let{settings:t,onSettingChange:n,volume:s,onVolumeChange:r,onSavePreset:a}=e;return(0,Lo.jsxs)("div",{className:"space-y-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Note Display"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("labelType","name"),className:"flex-1 rounded-md text-sm py-1 "+("name"===t.labelType?"bg-blue-600 text-white":"text-gray-300"),children:"Note Name"}),(0,Lo.jsx)("button",{onClick:()=>n("labelType","degree"),className:"flex-1 rounded-md text-sm py-1 "+("degree"===t.labelType?"bg-blue-600 text-white":"text-gray-300"),children:"Scale Degree"})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{htmlFor:"fretboard-audio-volume",className:"font-semibold text-lg text-teal-300 mb-2 block",children:"Audio Volume"}),(0,Lo.jsx)("input",{type:"range",id:"fretboard-audio-volume",min:"-30",max:"0",step:"1",value:s,onChange:e=>r(Number(e.target.value)),className:"w-full h-3 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:a,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},Oi={qualities:["Diminished","Minor","Perfect","Major","Augmented"],numericButtons:["Uni/Oct","2nd","3rd","4th","Tritone","5th","6th","7th"],intervalsToTest:[{name:{quality:"Perfect",number:"Unison"},semitones:0},{name:{quality:"Minor",number:"2nd"},semitones:1},{name:{quality:"Major",number:"2nd"},semitones:2},{name:{quality:"Minor",number:"3rd"},semitones:3},{name:{quality:"Major",number:"3rd"},semitones:4},{name:{quality:"Perfect",number:"4th"},semitones:5},{name:{quality:"Tritone",number:"Tritone"},semitones:6},{name:{quality:"Perfect",number:"5th"},semitones:7},{name:{quality:"Minor",number:"6th"},semitones:8},{name:{quality:"Major",number:"6th"},semitones:9},{name:{quality:"Minor",number:"7th"},semitones:10},{name:{quality:"Major",number:"7th"},semitones:11},{name:{quality:"Perfect",number:"Octave"},semitones:12}]},Fi=t=>{let{onProgressUpdate:n}=t;const{addLogEntry:s,fretboardVolume:r,setFretboardVolume:a,savePreset:o,presetToLoad:i,clearPresetToLoad:l}=Vo(),[c,u]=(0,e.useState)({autoAdvance:!0,playAudio:!0,labelType:"name"}),[d,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)(!1);(0,e.useEffect)(()=>{if(i&&"interval-fretboard-quiz"===i.gameId){const{fretboardVolume:e,...t}=i.settings;u(t),void 0!==e&&a(e),l()}},[i,l,a]);const{score:p,currentQuestion:g,feedback:x,isAnswered:b,selected:v,setSelected:y,history:w,reviewIndex:j,setReviewIndex:k,startNewRound:N,handleReviewNav:C,startReview:_,replayAudioForHistoryItem:S}=((t,n,s)=>{const{playFretboardNotes:r}=Vo(),[a,o]=(0,e.useState)(0),[i,l]=(0,e.useState)(null),[c,u]=(0,e.useState)({message:"",type:""}),[d,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)({quality:null,number:null}),[p,g]=(0,e.useState)([]),[x,b]=(0,e.useState)(null),v=(0,e.useRef)(null),y=(0,e.useCallback)(()=>{clearTimeout(v.current),b(null);let e=null,t=0;for(;null===e&&t<50;){t++;const n=Math.floor(6*Math.random()),s=Math.floor(8*Math.random()),r=Do[n][s],a=Oi.intervalsToTest[Math.floor(Math.random()*Oi.intervalsToTest.length)],o=r.midi+a.semitones,i=[];if([-2,-1,0,1,2].forEach(e=>{const t=n+e;t>=0&&t<6&&Do[t].forEach((e,r)=>{const a=Math.abs(r-s)<=4;e.midi===o&&r<12&&a&&(t!==n||r!==s)&&i.push({string:6-t,fret:r,label:e.note,midi:e.midi})})}),i.length>0){const t=i[Math.floor(Math.random()*i.length)],o=vo(r.note),l=yo(o,t.midi,a.name.number);e={notes:[{string:6-n,fret:s,label:o,isRoot:!0,midi:r.midi,degree:"1"},{...t,label:l,degree:Io(r.midi,t.midi)}],answer:a.name}}}l(e),u({message:"",type:""}),f({quality:null,number:null}),h(!1)},[]);(0,e.useEffect)(()=>(y(),()=>clearTimeout(v.current)),[y]);const w=(0,e.useCallback)(()=>{if(d||!i)return;const e=i.answer;let l=!1;l="Tritone"===m.number?"Tritone"===e.number:"Uni/Oct"===m.number?"Perfect"===m.quality&&("Unison"===e.number||"Octave"===e.number):m.quality===e.quality&&m.number===e.number;const c=l?a+1:a,f=p.length+1;if(l)o(c),u({message:"Correct!",type:"correct"});else{const t="Tritone"===e.number?"a Tritone":`a ${e.quality} ${e.number}`;u({message:`Incorrect! It was ${t}.`,type:"incorrect"})}g(e=>[...e,{question:i,userAnswer:m,wasCorrect:l}]),s&&s({wasCorrect:l,score:c,totalAsked:f}),h(!0),n&&r(i.notes),t&&l&&(v.current=setTimeout(y,2e3))},[d,m,i,t,y,n,r,p.length,s,a]);return(0,e.useEffect)(()=>{m.quality&&m.number&&!d&&w()},[m,w,d]),{score:a,currentQuestion:i,feedback:c,isAnswered:d,selected:m,setSelected:f,history:p,reviewIndex:x,setReviewIndex:b,checkAnswer:w,startNewRound:y,handleReviewNav:e=>{b(t=>{const n=t+e;return n>=0&&n<p.length?n:t})},startReview:()=>{p.length>0&&(clearTimeout(v.current),b(p.length-1))},replayAudioForHistoryItem:e=>{const t=p[e];t&&t.question.notes&&r(t.question.notes)}}})(c.autoAdvance,c.playAudio,n);(0,e.useEffect)(()=>{const e=e=>{const t=!(w.length>0)||w[w.length-1].wasCorrect;"Enter"!==e.key||!b||c.autoAdvance&&t||(e.preventDefault(),N())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[b,c.autoAdvance,w,N]);const T=null!==j,A=()=>{const e=prompt("Enter a name for your preset:",`Fretboard Ints - ${c.labelType}`);if(e&&""!==e.trim()){const t={id:Date.now().toString(),name:e.trim(),gameId:"interval-fretboard-quiz",gameName:"Fretboard Intervals",settings:{...c,fretboardVolume:r}};o(t),alert(`Preset "${e.trim()}" saved!`)}},M=(e,t)=>{b||T||y("Tritone"===t?{quality:"Tritone",number:"Tritone"}:n=>({...n,[e]:t}))},E=(e,t)=>{u(n=>({...n,[e]:t}))},D=T?w[j]:{question:g};if(!D.question)return(0,Lo.jsx)("div",{children:"Loading..."});const R=(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Play Audio"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:c.playAudio,onChange:()=>E("playAudio",!c.playAudio),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Auto-Advance"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:c.autoAdvance,onChange:()=>E("autoAdvance",!c.autoAdvance),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),I=!(w.length>0)||w[w.length-1].wasCorrect,P=T?(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-4 w-full",children:[(0,Lo.jsx)("button",{onClick:()=>C(-1),disabled:0===j,className:"bg-slate-600 p-3 rounded-lg",children:"Prev"}),(0,Lo.jsxs)("div",{className:"flex flex-col gap-2 flex-grow max-w-xs",children:[(0,Lo.jsx)("button",{onClick:()=>k(null),className:"bg-purple-600 p-3 rounded-lg text-xl",children:"Return to Quiz"}),(0,Lo.jsx)("button",{onClick:()=>S(j),className:"bg-sky-600 text-sm p-2 rounded-lg",children:"Replay Audio"})]}),(0,Lo.jsx)("button",{onClick:()=>C(1),disabled:j===w.length-1,className:"bg-slate-600 p-3 rounded-lg",children:"Next"})]}):!b||c.autoAdvance&&I?null:(0,Lo.jsx)("button",{onClick:N,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg animate-pulse",children:"Next Question"});return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsxs)($o,{isOpen:d,onClose:()=>h(!1),title:"How to Play: Intervals on Fretboard",children:[(0,Lo.jsx)("p",{children:"A diagram of a guitar fretboard will be displayed with two notes."}),(0,Lo.jsx)("p",{children:"The green note marked 'R' is the **root note**."}),(0,Lo.jsx)("p",{children:"Your goal is to identify the interval between the root note and the second note by its shape."}),(0,Lo.jsxs)("p",{className:"mt-2",children:["Enable the ",(0,Lo.jsx)("b",{children:"Play Audio"})," toggle to hear the interval after you answer, reinforcing your ear training."]}),(0,Lo.jsxs)("p",{className:"mt-2",children:["Use the ",(0,Lo.jsx)("b",{children:"Controls"})," button to change the audio volume and switch the label display between Note Names and Scale Degrees."]})]}),(0,Lo.jsxs)(Wo,{title:"Fretboard Intervals",score:p,totalAsked:w.length,history:w,isReviewing:T,onStartReview:_,topControls:R,footerContent:P,onLogProgress:()=>{const e=prompt("Enter any remarks for this session:",`Score: ${p}/${w.length}`);null!==e&&(s({game:"Interval Fretboard Quiz",date:(new Date).toLocaleDateString(),remarks:e}),alert("Session logged!"))},onToggleControls:()=>f(e=>!e),onShowInfo:()=>h(!0),children:[(0,Lo.jsx)(Ii,{notesToDisplay:D.question.notes,showLabels:T||b,startFret:0,fretCount:12,labelType:c.labelType}),(0,Lo.jsx)("div",{className:"text-lg font-bold my-4 min-h-[28px] "+("correct"===x.type?"text-green-400":"text-red-400"),children:T?`The correct answer was ${"Tritone"===D.question.answer.number?"a Tritone":`a ${D.question.answer.quality} ${D.question.answer.number}`}.`:x.message||(0,Lo.jsx)(Lo.Fragment,{children:"\xa0"})}),(0,Lo.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-lg font-semibold text-gray-400 mb-3",children:"Quality"}),(0,Lo.jsx)("div",{className:"flex flex-col gap-2",children:Oi.qualities.map(e=>{const t=b||T||"Augmented"===e||"Diminished"===e;return(0,Lo.jsx)("button",{onClick:()=>M("quality",e),disabled:t,className:"p-3 rounded-lg font-semibold transition-colors disabled:opacity-50 "+(v.quality!==e||T?"bg-teal-600 hover:bg-teal-500":"bg-indigo-600 ring-2"),children:e},e)})})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-lg font-semibold text-gray-400 mb-3",children:"Number"}),(0,Lo.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Oi.numericButtons.map(e=>{const t=v.number!==e||T?"bg-teal-600 hover:bg-teal-500":"bg-indigo-600 ring-2";return(0,Lo.jsx)("button",{onClick:()=>M("number",e),disabled:b||T,className:`p-3 rounded-lg font-semibold transition-colors disabled:opacity-50 ${t}`,children:e},e)})})]})]})]}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out "+(m?"w-80 p-4":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!m&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(Pi,{settings:c,onSettingChange:E,volume:r,onVolumeChange:a,onSavePreset:A})]})}),m&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>f(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>f(!1),className:"text-gray-400 text-2xl",children:"\xd7"})]}),(0,Lo.jsx)(Pi,{settings:c,onSettingChange:E,volume:r,onVolumeChange:a,onSavePreset:A})]})})]})},Li=()=>{const[t,n]=(0,e.useState)("C"),[s,r]=(0,e.useState)("Scale"),[a,o]=(0,e.useState)("Major"),[i,l]=(0,e.useState)([]),[c,u]=(0,e.useState)(0),[d,h]=(0,e.useState)(15),[m,f]=(0,e.useState)("degree"),[p,g]=(0,e.useState)({1:{color:"#ef4444",active:!0},b2:{color:"#f97316",active:!1},2:{color:"#a3e635",active:!1},b3:{color:"#ec4899",active:!1},3:{color:"#22c55e",active:!1},4:{color:"#14b8a6",active:!1},"#4/b5":{color:"#6b7280",active:!1},5:{color:"#eab308",active:!1},b6:{color:"#8b5cf6",active:!1},6:{color:"#a855f7",active:!1},b7:{color:"#3b82f6",active:!1},7:{color:"#7dd3fc",active:!1}}),[x,b]=(0,e.useState)(!0),[v,y]=(0,e.useState)(null),[w,j]=(0,e.useState)(""),[k,N]=(0,e.useState)("#ffffff"),[C,_]=(0,e.useState)(!1),[S,T]=(0,e.useState)(!1),[A,M]=(0,e.useState)(null),E=(0,e.useRef)({clickTimeout:null,lastClickTimestamp:0,clickedNote:null}),D=(0,e.useRef)(!1);return(0,e.useEffect)(()=>{o("Scale"===s?Object.keys(_o)[0]:Object.keys(So)[0])},[s]),(0,e.useEffect)(()=>{const e=Ao[t];if(void 0!==e)if(x)l(t=>t.map(t=>{const n=(t.midi-e)%12,s=n<0?n+12:n;return{...t,degree:ho[s]||"?",isRoot:t.midi%12===e%12,label:Do[6-t.string][t.fret].note}}));else{var n;const r=null===(n=("Scale"===s?_o:So)[a])||void 0===n?void 0:n.intervals;if(r){const n="Scale"===s?Mo(t,a):wo(t,a),o={};n&&n.length>0&&n.forEach((t,n)=>{const s=(e+r[n])%12;o[s]=t});const i=((e,t,n)=>{const s=Ao[e];if(void 0===s)return console.error("Invalid root note name"),[];const r=new Set,a=[-2,-1,0,1,2,3];t.forEach(e=>{a.forEach(t=>{r.add(s+e+12*t)})});const o=[];return n.forEach((e,t)=>{e.forEach((e,n)=>{if(r.has(e.midi)){const r=(e.midi-s)%12,a=ho[r<0?r+12:r];o.push({string:6-t,fret:n,label:e.note,midi:e.midi,isRoot:e.midi%12===s%12,degree:a})}})}),o})(t,r,Do),c=i.map(e=>({...e,label:o[e.midi%12]||e.label,overrideColor:null,overrideLabel:null}));l(c)}}},[t,s,a,x]),(0,e.useEffect)(()=>{const e=()=>{D.current=!1};window.addEventListener("mouseup",e);const t=E.current;return()=>{window.removeEventListener("mouseup",e),clearTimeout(t.clickTimeout)}},[]),{selectedRoot:t,setSelectedRoot:n,selectedType:s,setSelectedType:r,selectedName:a,setSelectedName:o,displayedNotes:i,startFret:c,setStartFret:u,fretCount:d,setFretCount:h,labelType:m,setLabelType:f,colorMap:p,handleColorToggle:e=>g(t=>({...t,[e]:{...t[e],active:!t[e].active}})),handleColorChange:(e,t)=>g(n=>({...n,[e]:{...n[e],color:t}})),handleHighlightAll:e=>{const t={...p};Object.keys(t).forEach(n=>{t[n].active=e}),g(t)},isManualMode:x,setIsManualMode:b,editingNote:v,setEditingNote:y,handleSaveNoteEdit:()=>{v&&(l(e=>e.map(e=>e.string===v.string&&e.fret===v.fret?{...e,overrideLabel:w,overrideColor:k}:e)),y(null))},editLabel:w,setEditLabel:j,editColor:k,setEditColor:N,isInfoModalOpen:C,setIsInfoModalOpen:_,useWhiteBackground:S,setUseWhiteBackground:T,draggingNote:A,handleExportAsPng:()=>{const e=document.getElementById("fretboard-diagram-svg");if(!e)return;let t=(new XMLSerializer).serializeToString(e);S&&(t=t.replace(/fill="white"/g,'fill="#111827"'));const n=document.createElement("canvas"),s=n.getContext("2d"),{width:r,height:a}=e.viewBox.baseVal;n.width=2*r,n.height=2*a,s.fillStyle=S?"#ffffff":"#1e293b",s.fillRect(0,0,n.width,n.height);const o=new Image,i=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),l=URL.createObjectURL(i);o.onload=()=>{s.scale(2,2),s.drawImage(o,0,0,r,a);const e=n.toDataURL("image/png"),t=document.createElement("a");t.href=e,t.download="fretboard-diagram.png",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(l)},o.src=l},handleNoteMouseDown:(e,t)=>{var n,s;if(!x||v)return;t.preventDefault();const r=Date.now();if(r-E.current.lastClickTimestamp<300&&e.string===(null===(n=E.current.clickedNote)||void 0===n?void 0:n.string)&&e.fret===(null===(s=E.current.clickedNote)||void 0===s?void 0:s.fret))return clearTimeout(E.current.clickTimeout),E.current.lastClickTimestamp=0,E.current.clickedNote=null,void(e=>{y(e),j(e.overrideLabel||("name"===m?e.label:e.degree));const t=p[e.degree],n=e.isRoot?"#ef4444":"#3b82f6",s=t&&t.active?t.color:n;N(e.overrideColor||s)})(e);E.current.lastClickTimestamp=r,E.current.clickedNote=e,M({note:e,initialX:t.clientX,initialY:t.clientY,moved:!1})},handleBoardMouseMove:e=>{if(!A)return;e.preventDefault();const t=e.clientX-A.initialX,n=e.clientY-A.initialY;if(!A.moved&&(Math.abs(t)>5||Math.abs(n)>5)&&M(e=>({...e,moved:!0})),A.moved){const e=(800-(0===c?10:0))/d,s=Math.round(t/e),r=Math.max(0,Math.min(24,A.note.fret+s)),a=40,o=Math.round(n/a),i=Math.max(1,Math.min(6,A.note.string+o));l(e=>e.map(e=>e.string===A.note.string&&e.fret===A.note.fret?{...e,movedFret:r,movedString:i}:e))}},handleBoardMouseUp:()=>{if(A){if(A.moved){const e=i.find(e=>e.string===A.note.string&&e.fret===A.note.fret);if(e&&void 0!==e.movedFret&&void 0!==e.movedString){const{movedFret:t,movedString:n}=e;if(i.some(e=>e.string===n&&e.fret===t&&!(e.string===A.note.string&&e.fret===A.note.fret)))l(e=>e.map(e=>({...e,movedFret:void 0,movedString:void 0})));else{const s=Do[6-n][t];l(r=>r.map(r=>r.string===e.string&&r.fret===e.fret?{...r,...s,string:n,fret:t,movedFret:void 0,movedString:void 0}:r))}}}else E.current.clickTimeout=setTimeout(()=>{return e=A.note,l(t=>t.filter(t=>!(t.string===e.string&&t.fret===e.fret)));var e},250);M(null)}},handleBoardClick:(e,n)=>{var s;if(!x||i.some(t=>t.string===e&&t.fret===n))return;const r=null===(s=Do[6-e])||void 0===s?void 0:s[n];if(r){const s=Ao[t],a=(r.midi-s)%12,o=ho[a<0?a+12:a]||"?",i={string:e,fret:n,label:r.note,midi:r.midi,isRoot:r.midi%12===s%12,degree:o,overrideColor:null,overrideLabel:null};l(e=>[...e,i])}},handleClearBoard:()=>{l([]),b(!0)},isModalInteraction:D}},qi=()=>{const{selectedRoot:e,setSelectedRoot:t,selectedType:n,setSelectedType:s,selectedName:r,setSelectedName:a,displayedNotes:o,startFret:i,setStartFret:l,fretCount:c,setFretCount:u,labelType:d,setLabelType:h,colorMap:m,handleColorToggle:f,handleColorChange:p,handleHighlightAll:g,isManualMode:x,setIsManualMode:b,editingNote:v,setEditingNote:y,handleSaveNoteEdit:w,editLabel:j,setEditLabel:k,editColor:N,setEditColor:C,isInfoModalOpen:_,setIsInfoModalOpen:S,useWhiteBackground:T,setUseWhiteBackground:A,draggingNote:M,handleExportAsPng:E,handleNoteMouseDown:D,handleBoardMouseMove:R,handleBoardMouseUp:I,handleBoardClick:P,handleClearBoard:O,isModalInteraction:F}=Li(),L="Scale"===n?Object.keys(_o):Object.keys(So),q="none"===d?o.map(e=>({...e,isRoot:!1,degree:null})):o;return(0,Lo.jsxs)("div",{className:"flex flex-col items-center w-full",children:[(0,Lo.jsx)($o,{isOpen:_,onClose:()=>S(!1),title:"Fretboard Diagram Maker Guide",children:(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Generator Mode"}),(0,Lo.jsx)("p",{children:"Use the dropdowns to automatically generate a diagram for any scale or chord. The diagram will update as you change the root note, type, or name."})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Customize Mode"}),(0,Lo.jsx)("p",{children:'Click the "Customize Diagram" button to start with a blank canvas or lock the current diagram for editing. In this mode:'}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside ml-4 mt-1 space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Add Note:"})," Click any empty spot on the fretboard. The new note's degree will be automatically calculated relative to the selected root note."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Delete Note:"})," Single-click an existing note."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Edit Note:"})," Double-click an existing note to change its color or label."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Move Note:"})," Click and drag a note to any other fret or string. Note that this won't change the name or scale degree written inside that note!"]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Change Root Note:"})," The Root Note dropdown is always active! Change it at any time to see the scale degrees update instantly for your custom diagram."]})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Display & Export"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside ml-4 mt-1 space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Sliders:"}),' Use the "Start Fret" and "Fret Count" sliders to focus on a specific area of the fretboard.']}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Advanced Options:"})," Expand this section to highlight specific degrees or choose a white background for your PNG export (great for printing)."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Export/Print:"})," Use the buttons in the header to export your diagram as a high-resolution PNG image or to print it directly."]})]})]})]})}),v&&(0,Lo.jsx)($o,{isOpen:!!v,onClose:()=>{F.current||y(null)},title:`Edit Note (${v.label})`,children:(0,Lo.jsxs)("div",{onMouseDown:()=>F.current=!0,children:[(0,Lo.jsxs)("div",{className:"space-y-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{htmlFor:"note-label",className:"block text-sm font-medium text-gray-300",children:"Custom Label"}),(0,Lo.jsx)("input",{type:"text",id:"note-label",value:j,onChange:e=>k(e.target.value),className:"mt-1 w-full p-2 rounded-md bg-slate-600 text-white"})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{htmlFor:"note-color",className:"block text-sm font-medium text-gray-300",children:"Custom Color"}),(0,Lo.jsx)("input",{type:"color",id:"note-color",value:N,onChange:e=>C(e.target.value),className:"mt-1 w-full h-10 p-1 border-none rounded-md cursor-pointer"})]})]}),(0,Lo.jsxs)("div",{className:"flex justify-end gap-4 mt-6",children:[(0,Lo.jsx)("button",{onClick:()=>y(null),className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg",children:"Cancel"}),(0,Lo.jsx)("button",{onClick:w,className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg",children:"Save Changes"})]})]})}),(0,Lo.jsxs)("div",{className:"w-full flex flex-col sm:flex-row justify-between items-center gap-4 mb-6",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("h2",{className:"text-3xl font-extrabold text-indigo-300",children:"Fretboard Diagram Maker"}),(0,Lo.jsx)(Uo,{onClick:()=>S(!0)})]}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("button",{onClick:E,className:"bg-blue-700 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg text-sm",children:"Export as PNG"}),(0,Lo.jsx)("button",{onClick:()=>window.print(),className:"bg-gray-500 hover:bg-gray-400 text-white font-bold py-2 px-4 rounded-lg text-sm",children:"Print Diagram"})]})]}),(0,Lo.jsx)("div",{className:"w-full mb-8",id:"printable-diagram",children:(0,Lo.jsx)(Ii,{notesToDisplay:q,startFret:i,fretCount:c,showLabels:"none"!==d,labelType:d,colorMap:m,onNoteMouseDown:x?D:null,onBoardMouseMove:M&&!v?R:null,onBoardMouseUp:M&&!v?I:null,onBoardClick:x?P:null,draggingNote:null===M||void 0===M?void 0:M.note})}),(0,Lo.jsxs)("div",{id:"controls-panel",className:"w-full max-w-2xl bg-slate-700 p-4 rounded-lg flex flex-col items-center gap-4",children:[(0,Lo.jsxs)("div",{className:"w-full flex flex-col md:flex-row items-center gap-4",children:[(0,Lo.jsxs)("div",{className:"flex-1 w-full",children:[(0,Lo.jsx)("label",{htmlFor:"root-note",className:"block text-sm font-medium text-gray-300 mb-1",children:"Root Note"}),(0,Lo.jsx)("select",{id:"root-note",value:e,onChange:e=>t(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",children:[{name:"C",value:"C"},{name:"F",value:"F"},{name:"Bb",value:"Bb"},{name:"Eb",value:"Eb"},{name:"Ab",value:"Ab"},{name:"Db",value:"Db"},{name:"F#",value:"F#"},{name:"B",value:"B"},{name:"E",value:"E"},{name:"A",value:"A"},{name:"D",value:"D"},{name:"G",value:"G"}].map(e=>(0,Lo.jsx)("option",{value:e.value,children:e.name},e.value))})]}),(0,Lo.jsxs)("div",{className:"flex-1 w-full",children:[(0,Lo.jsx)("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-300 mb-1",children:"Type"}),(0,Lo.jsxs)("select",{id:"type",value:n,onChange:e=>s(e.target.value),disabled:x,className:"w-full p-2 rounded-md bg-slate-600 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,Lo.jsx)("option",{value:"Scale",children:"Scale"}),(0,Lo.jsx)("option",{value:"Chord",children:"Chord"})]})]}),(0,Lo.jsxs)("div",{className:"flex-1 w-full",children:[(0,Lo.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300 mb-1",children:[n," Name"]}),(0,Lo.jsx)("select",{id:"name",value:r,onChange:e=>a(e.target.value),disabled:x,className:"w-full p-2 rounded-md bg-slate-600 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:L.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))})]})]}),(0,Lo.jsxs)("div",{className:"w-full pt-4 border-t border-slate-600 mt-4 flex gap-2",children:[(0,Lo.jsx)("button",{onClick:O,className:"flex-1 bg-red-700 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg",children:"Clear Board"}),x?(0,Lo.jsx)("button",{onClick:()=>b(!1),className:"flex-1 bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-4 rounded-lg",children:"Generate Scale / Chord"}):(0,Lo.jsx)("button",{onClick:()=>b(!0),className:"flex-1 bg-purple-600 hover:bg-purple-500 text-white font-bold py-2 px-4 rounded-lg",children:"Customize Diagram"})]}),x&&(0,Lo.jsx)("p",{className:"text-xs text-center text-gray-400",children:"In Customize Mode: Click an empty spot to add, single-click to delete, double-click to edit, or drag to move."}),(0,Lo.jsxs)("div",{className:"w-full pt-4 border-t border-slate-600 mt-4",children:[(0,Lo.jsxs)("div",{className:"flex justify-between items-center gap-4 w-full",children:[(0,Lo.jsxs)("div",{className:"flex-1",children:[(0,Lo.jsxs)("label",{htmlFor:"start-fret",className:"block text-sm font-medium text-gray-300 mb-1",children:["Start Fret: ",(0,Lo.jsx)("span",{className:"font-bold text-teal-300",children:i})]}),(0,Lo.jsx)("input",{id:"start-fret",type:"range",min:"0",max:"12",value:i,onChange:e=>l(Number(e.target.value)),className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"})]}),(0,Lo.jsxs)("div",{className:"flex-1",children:[(0,Lo.jsxs)("label",{htmlFor:"fret-count",className:"block text-sm font-medium text-gray-300 mb-1",children:["Fret Count: ",(0,Lo.jsx)("span",{className:"font-bold text-teal-300",children:c})]}),(0,Lo.jsx)("input",{id:"fret-count",type:"range",min:"3",max:"22",value:c,onChange:e=>u(Number(e.target.value)),className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"})]})]}),(0,Lo.jsxs)("div",{className:"mt-4",children:[(0,Lo.jsx)("label",{className:"block text-sm text-center font-medium text-gray-300 mb-1",children:"Label Display"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>h("degree"),className:"flex-1 rounded-md text-sm py-1 "+("degree"===d?"bg-blue-600 text-white":"text-gray-300"),children:"Degree"}),(0,Lo.jsx)("button",{onClick:()=>h("name"),className:"flex-1 rounded-md text-sm py-1 "+("name"===d?"bg-blue-600 text-white":"text-gray-300"),children:"Name"}),(0,Lo.jsx)("button",{onClick:()=>h("none"),className:"flex-1 rounded-md text-sm py-1 "+("none"===d?"bg-blue-600 text-white":"text-gray-300"),children:"None"})]})]})]}),(0,Lo.jsxs)("details",{className:"w-full",open:!1,children:[(0,Lo.jsx)("summary",{className:"text-lg font-semibold text-teal-300 cursor-pointer hover:text-teal-200 transition-colors py-2 border-t border-slate-600 mt-4",children:"Advanced Display Options"}),(0,Lo.jsxs)("div",{className:"w-full pt-4",children:[(0,Lo.jsxs)("div",{className:"flex justify-between items-center gap-4 mb-2",children:[(0,Lo.jsx)("h3",{className:"text-sm font-medium text-gray-300",children:"Highlight Degrees"}),(0,Lo.jsxs)("div",{className:"flex-1 flex justify-end gap-2",children:[(0,Lo.jsx)("button",{onClick:()=>g(!0),className:"text-sm bg-slate-600 hover:bg-slate-500 py-1 px-3 rounded-md",children:"All"}),(0,Lo.jsx)("button",{onClick:()=>g(!1),className:"text-sm bg-slate-600 hover:bg-slate-500 py-1 px-3 rounded-md",children:"None"})]})]}),(0,Lo.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-x-4 gap-y-2 bg-slate-800/50 p-2 rounded-md",children:Object.entries(m).map(e=>{let[t,{color:n,active:s}]=e;return(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("input",{type:"checkbox",id:`toggle-${t}`,checked:s,onChange:()=>f(t),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,Lo.jsx)("input",{type:"color",value:n,onChange:e=>p(t,e.target.value),className:"w-6 h-6 p-0 border-none rounded-md cursor-pointer bg-transparent"}),(0,Lo.jsx)("label",{htmlFor:`toggle-${t}`,className:"text-sm font-bold text-gray-300 w-12 text-left",children:t})]},t)})}),(0,Lo.jsx)("div",{className:"mt-4 pt-4 border-t border-slate-700",children:(0,Lo.jsxs)("label",{htmlFor:"png-bg",className:"flex items-center gap-2 cursor-pointer",children:[(0,Lo.jsx)("input",{id:"png-bg",type:"checkbox",checked:T,onChange:e=>A(e.target.checked),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,Lo.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Use white background for PNG export"})]})})]})]})]})]})},Vi=["C","F","Bb","Eb","Ab","Db","F#","B","E","A","D","G"],zi={Major:[["I","V","vi","IV"],["I","IV","V","IV"],["vi","IV","I","V"],["I","vi","ii","V"],["I","iii","vi","IV"],["ii","V","I","vi"],["I","V","ii","IV"],["vi","ii","V","I"],["I","IV","vi","V"],["iii","vi","IV","V"],["I","V","IV","I"],["IV","I","V","I"],["I","vi","IV","V"],["ii","V","I","IV"],["I","IV","V","I"],["iii","vi","ii","V"],["vi","I","V","IV"]],Minor:[["i","VI","III","VII"],["i","iv","v","iv"],["i","iv","VII","III"],["ii\xb0","v","i","VI"],["i","VII","VI","V"],["i","iv","V","i"],["iv","i","VII","III"],["i","VI","iv","V"],["v","VI","III","VII"],["i","III","VII","iv"],["i","iv","i","V"],["i","VI","III","iv"],["iv","VII","i","V"],["i","VII","i","iv"],["ii\xb0","V","i","VII"],["i","iv","VI","VII"],["i","v","VI","III"]]},Gi=e=>{let{title:t,isOpen:n,onToggle:s,children:r}=e;return(0,Lo.jsxs)("div",{className:"border-t border-slate-600/80 pt-3 mt-3",children:[(0,Lo.jsxs)("button",{onClick:s,className:"w-full flex justify-between items-center text-left text-lg font-bold text-teal-300 hover:text-teal-200",children:[(0,Lo.jsx)("span",{children:t}),(0,Lo.jsx)("span",{className:"text-xl",children:n?"\u2212":"+"})]}),n&&(0,Lo.jsx)("div",{className:"pt-3 space-y-4",children:r})]})},Bi=["C","F","Bb","Eb","Ab","Db","F#","B","E","A","D","G"],$i=["Major","Natural Minor","Harmonic Minor","Melodic Minor"],Ui=e=>{let{settings:t,onSettingChange:n,onQualityFilterChange:s,onRandomRootNote:r,isAutoGenerateOn:a,onAutoGenerateToggle:o,autoGenerateInterval:i,onIntervalChange:l,countdownClicks:c,onCountdownChange:u,openSections:d,onToggleSection:h,onSavePreset:m}=e;const f="diatonic"===t.generationMode,p=e=>{n("allowedQualities",{...t.allowedQualities,[e]:!t.allowedQualities[e]})},g=e=>{let{label:t,isChecked:n,onChange:s}=e;return(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer pt-1",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:t}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:n,onChange:s,className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})};return(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)(Gi,{title:"General Settings",isOpen:d.general,onToggle:()=>h("general"),children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Generation Mode"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("generationMode","diatonic"),className:"flex-1 rounded-md text-sm py-1 "+(f?"bg-blue-600":"text-gray-300"),children:"Diatonic"}),(0,Lo.jsx)("button",{onClick:()=>n("generationMode","random"),className:"flex-1 rounded-md text-sm py-1 "+(f?"text-gray-300":"bg-blue-600"),children:"Random"})]})]}),(0,Lo.jsxs)("div",{className:`${!f&&"opacity-50 pointer-events-none"}`,children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Root Note"}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("select",{value:t.rootNote,onChange:e=>n("rootNote",e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",disabled:!f,children:Bi.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))}),(0,Lo.jsx)("button",{onClick:r,className:"px-4 py-2 rounded-lg font-semibold bg-blue-600 hover:bg-blue-500 text-white",disabled:!f,children:"Random"})]})]}),(0,Lo.jsxs)("div",{className:`${!f&&"opacity-50 pointer-events-none"}`,children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Key / Scale"}),(0,Lo.jsx)("select",{value:t.keyType,onChange:e=>n("keyType",e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",disabled:!f,children:$i.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))})]}),(0,Lo.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Chords/Line"}),(0,Lo.jsx)("input",{type:"number",value:t.numChords,onChange:e=>n("numChords",Math.max(1,parseInt(e.target.value,10))||1),className:"w-full p-2 rounded-md bg-slate-600 text-white"})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Lines"}),(0,Lo.jsx)("input",{type:"number",value:t.numProgressions,onChange:e=>n("numProgressions",Math.max(1,parseInt(e.target.value,10))||1),className:"w-full p-2 rounded-md bg-slate-600 text-white"})]})]}),(0,Lo.jsxs)("div",{className:`${!f&&"opacity-50 pointer-events-none"}`,children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Progression Pattern"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("useCommonPatterns",!0),className:`flex-1 rounded-md text-sm py-1 ${t.useCommonPatterns?"bg-blue-600":"text-gray-300"} disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed`,disabled:!f||"all"!==t.qualityFilter,title:f?"all"!==t.qualityFilter?"Not available with quality filters":"":"Only available in Diatonic mode",children:"Common"}),(0,Lo.jsx)("button",{onClick:()=>n("useCommonPatterns",!1),className:"flex-1 rounded-md text-sm py-1 "+(t.useCommonPatterns?"text-gray-300":"bg-blue-600"),disabled:!f,children:"Random"})]})]})]}),(0,Lo.jsx)(Gi,{title:"Chord Options",isOpen:d.options,onToggle:()=>h("options"),children:f?(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Chord Complexity"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("chordComplexity","Triads"),className:"flex-1 rounded-md text-sm py-1 "+("Triads"===t.chordComplexity?"bg-blue-600":"text-gray-300"),children:"Triads"}),(0,Lo.jsx)("button",{onClick:()=>n("chordComplexity","Tetrads"),className:"flex-1 rounded-md text-sm py-1 "+("Tetrads"===t.chordComplexity?"bg-blue-600":"text-gray-300"),children:"Tetrads"})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Chord Quality"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>s("all"),className:"flex-1 rounded-md text-sm py-1 "+("all"===t.qualityFilter?"bg-blue-600":"text-gray-300"),children:"All"}),(0,Lo.jsx)("button",{onClick:()=>s("major"),className:"flex-1 rounded-md text-sm py-1 "+("major"===t.qualityFilter?"bg-blue-600":"text-gray-300"),children:"Major"}),(0,Lo.jsx)("button",{onClick:()=>s("minor"),className:"flex-1 rounded-md text-sm py-1 "+("minor"===t.qualityFilter?"bg-blue-600":"text-gray-300"),children:"Minor"})]})]}),(0,Lo.jsx)(g,{label:"Include Diminished",isChecked:t.includeDiminished,onChange:()=>n("includeDiminished",!t.includeDiminished)}),(0,Lo.jsx)(g,{label:"Include Sus Chords",isChecked:t.includeSusChords,onChange:()=>n("includeSusChords",!t.includeSusChords)})]}):(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Allowed Qualities"}),(0,Lo.jsxs)("div",{className:"space-y-1 mt-2",children:[(0,Lo.jsx)(g,{label:"Major",isChecked:t.allowedQualities.major,onChange:()=>p("major")}),(0,Lo.jsx)(g,{label:"Minor",isChecked:t.allowedQualities.minor,onChange:()=>p("minor")}),(0,Lo.jsx)(g,{label:"Diminished",isChecked:t.allowedQualities.diminished,onChange:()=>p("diminished")}),(0,Lo.jsx)(g,{label:"Augmented",isChecked:t.allowedQualities.augmented,onChange:()=>p("augmented")}),(0,Lo.jsx)("div",{className:"border-t border-slate-600/50 pt-2 mt-2",children:(0,Lo.jsx)(g,{label:"Include Sus Chords",isChecked:t.includeSusChords,onChange:()=>n("includeSusChords",!t.includeSusChords)})})]})]})}),(0,Lo.jsxs)(Gi,{title:"Display Settings",isOpen:d.display,onToggle:()=>h("display"),children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Layout Mode"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("displayMode","flow"),className:"flex-1 rounded-md text-sm py-1 "+("flow"===t.displayMode?"bg-blue-600":"text-gray-300"),children:"Flow"}),(0,Lo.jsx)("button",{onClick:()=>n("displayMode","measure"),className:"flex-1 rounded-md text-sm py-1 "+("measure"===t.displayMode?"bg-blue-600":"text-gray-300"),children:"Measures"})]})]}),"measure"===t.displayMode&&(0,Lo.jsxs)("div",{className:"pl-2 pt-2 space-y-2 animate-fade-in-down border-l-2 border-slate-600",children:[(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{className:"font-semibold",children:"Chords per Bar"}),(0,Lo.jsx)("input",{type:"number",value:t.chordsPerBar,onChange:e=>n("chordsPerBar",Math.max(1,parseInt(e.target.value,10))||1),className:"w-20 p-2 rounded-md bg-slate-800 text-white text-center"})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{className:"font-semibold",children:"Bars per Line"}),(0,Lo.jsx)("input",{type:"number",value:t.barsPerLine,onChange:e=>n("barsPerLine",Math.max(1,parseInt(e.target.value,10))||1),className:"w-20 p-2 rounded-md bg-slate-800 text-white text-center"})]})]}),"flow"===t.displayMode&&(0,Lo.jsx)("div",{className:"pl-2 pt-2 space-y-2 animate-fade-in-down border-l-2 border-slate-600",children:(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{className:"font-semibold",children:"Barline Every"}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("input",{type:"number",value:t.flowBarlineFrequency,onChange:e=>n("flowBarlineFrequency",Math.max(0,parseInt(e.target.value,10))||0),className:"w-20 p-2 rounded-md bg-slate-800 text-white text-center"}),(0,Lo.jsx)("span",{children:"chords"})]})]})}),(0,Lo.jsxs)("div",{className:`mt-4 pt-4 border-t border-slate-700 ${!f&&"opacity-50 pointer-events-none"}`,children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-1",children:"Chord/Degree View"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("chordDegreeView","chords"),className:"flex-1 rounded-md text-sm py-1 "+("chords"===t.chordDegreeView?"bg-blue-600":"text-gray-300"),disabled:!f,children:"Chords"}),(0,Lo.jsx)("button",{onClick:()=>n("chordDegreeView","degrees"),className:"flex-1 rounded-md text-sm py-1 "+("degrees"===t.chordDegreeView?"bg-blue-600":"text-gray-300"),disabled:!f,children:"Degrees"}),(0,Lo.jsx)("button",{onClick:()=>n("chordDegreeView","both"),className:"flex-1 rounded-md text-sm py-1 "+("both"===t.chordDegreeView?"bg-blue-600":"text-gray-300"),disabled:!f,children:"Both"})]})]}),(0,Lo.jsx)(g,{label:"Alternate Notation",isChecked:t.useAlternateNotation,onChange:()=>n("useAlternateNotation",!t.useAlternateNotation)})]}),(0,Lo.jsxs)(Gi,{title:"Automation",isOpen:d.automation,onToggle:()=>h("automation"),children:[(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"auto-generate-prog",className:"font-semibold text-lg text-teal-300",children:"Auto-Generate:"}),(0,Lo.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",id:"auto-generate-prog",checked:a,onChange:o,className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-teal-600"})]})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"auto-generate-interval-prog",className:`font-semibold ${!a&&"opacity-50"}`,children:"Every:"}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("input",{type:"number",id:"auto-generate-interval-prog",value:i,onChange:e=>l(Math.max(1,parseInt(e.target.value,10))||1),className:`w-20 p-2 rounded-md bg-slate-600 text-white text-center ${!a&&"opacity-50"}`,min:"1",disabled:!a}),(0,Lo.jsx)("span",{className:`font-semibold ${!a&&"opacity-50"}`,children:"clicks"})]})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"countdown-clicks-prog",className:`font-semibold ${!a&&"opacity-50"}`,children:"Countdown:"}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("input",{type:"number",id:"countdown-clicks-prog",value:c,onChange:e=>u(Math.max(0,parseInt(e.target.value,10))||0),className:`w-20 p-2 rounded-md bg-slate-600 text-white text-center ${!a&&"opacity-50"}`,min:"0",max:"7",disabled:!a}),(0,Lo.jsx)("span",{className:`font-semibold ${!a&&"opacity-50"}`,children:"clicks"})]})]})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:m,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},Wi=["C","F","Bb","Eb","Ab","Db","F#","B","E","A","D","G"],Hi={m:"-",maj7:"\u25b37",m7:"-7",dim:"\xb0",aug:"+",m7b5:"\xf87",7:"7"},Qi=(e,t)=>{const n=[];if(t<=0)return[e];for(let s=0;s<e.length;s+=t)n.push(e.slice(s,s+t));return n},Ki=e=>{let{name:t,fontSize:n,useAlternateNotation:s}=e;const r=t.match(/^([A-G])([#b]?)(sus[24]|m\(maj7\)|m7b5|maj7|m7|dim|aug|m|7|\+|\xb07)?/);if(!r)return(0,Lo.jsx)("div",{style:{fontSize:`${n}rem`},className:"font-bold text-teal-300 whitespace-nowrap",children:t});let[,a,o,i]=r;return i=i||"","#"===o&&(o="\u266f"),"b"===o&&(o="\u266d"),s&&Hi[i]&&(i=Hi[i]),(0,Lo.jsxs)("span",{style:{fontSize:`${n}rem`},className:"font-bold text-teal-300 whitespace-nowrap inline-flex items-baseline",children:[(0,Lo.jsx)("span",{children:a}),(0,Lo.jsxs)("span",{className:"relative",style:{marginLeft:"0.1em",display:"inline-block"},children:[(0,Lo.jsx)("span",{style:{fontSize:.7*n+"rem",marginLeft:o?.25*n+"rem":"0"},children:i||(0,Lo.jsx)("span",{className:"opacity-0",children:"\xa0"})}),(0,Lo.jsx)("span",{className:"absolute left-0",style:{fontSize:.6*n+"rem",bottom:.45*n+"rem"},children:o})]})]})},Yi=()=>{const{savePreset:t}=Vo(),{settings:n,setSettings:s,isAutoGenerateOn:r,setIsAutoGenerateOn:a,autoGenerateInterval:o,setAutoGenerateInterval:i,isControlsOpen:l,setIsControlsOpen:c,isInfoModalOpen:u,setIsInfoModalOpen:d,progressions:h,openSections:m,toggleSection:f,countdownClicks:p,setCountdownClicks:g,handleGenerate:x,handleLogSession:b}=(()=>{const{setMetronomeSchedule:t,addLogEntry:n,bpm:s,countdownClicks:r,setCountdownClicks:a,presetToLoad:o,clearPresetToLoad:i}=Vo(),[l,c]=(0,e.useState)({rootNote:"C",keyType:"Major",numChords:4,numProgressions:1,chordComplexity:"Triads",useCommonPatterns:!0,includeDiminished:!1,qualityFilter:"all",fontSize:3,useAlternateNotation:!1,generationMode:"diatonic",allowedQualities:{major:!0,minor:!0,diminished:!1,augmented:!1},includeSusChords:!1,displayMode:"measure",chordDegreeView:"both",chordsPerBar:1,barsPerLine:4,flowBarlineFrequency:4}),[u,d]=(0,e.useState)(!1),[h,m]=(0,e.useState)(l.numChords),[f,p]=(0,e.useState)(!1),[g,x]=(0,e.useState)(!1),[b,v]=(0,e.useState)([]),[y,w]=(0,e.useState)({general:!0,options:!1,display:!1,automation:!1});(0,e.useEffect)(()=>{if(o&&"chord-progression-generator"===o.gameId){const e={...o.settings},t={displayMode:"measure",chordDegreeView:"both",chordsPerBar:1,barsPerLine:4,flowBarlineFrequency:4};void 0===e.displayMode&&void 0!==e.showBarLines&&(e.displayMode=e.showBarLines?"measure":"flow");for(const n in t)void 0===e[n]&&(e[n]=t[n]);delete e.showBarLines,c(t=>({...t,...e})),o.automation&&(d(o.automation.isAutoGenerateOn),m(o.automation.autoGenerateInterval),a(o.automation.countdownClicks)),i()}},[o,i,a]);const j=(0,e.useCallback)(()=>{const e=[];if("random"===l.generationMode){let t=Object.entries(l.allowedQualities).filter(e=>{let[,t]=e;return t}).map(e=>{let[t]=e;return t});if(l.includeSusChords&&t.push("sus2","sus4"),0===t.length)return void v([]);for(let n=0;n<l.numProgressions;n++){const n=[];for(let e=0;e<l.numChords;e++){const e=Vi[Math.floor(Math.random()*Vi.length)],s=t[Math.floor(Math.random()*t.length)];let r="";"major"===s?r="":"minor"===s?r="m":"diminished"===s?r="dim":"augmented"===s?r="aug":"sus2"===s?r="sus2":"sus4"===s&&(r="sus4");const a=`${e}${r}`;n.push({name:a,tetradName:a,roman:"N/A"})}e.push(n)}}else{const n=Eo(l.rootNote,l.keyType,"Triads"),s=Eo(l.rootNote,l.keyType,"7ths");let r=[...n];l.includeDiminished||(r=r.filter(e=>!e.quality.includes("Diminished"))),"major"===l.qualityFilter?r=r.filter(e=>e.quality.includes("Major")||e.quality.includes("Dominant")||e.quality.includes("Augmented")):"minor"===l.qualityFilter&&(r=r.filter(e=>e.quality.includes("Minor")));const a=l.useCommonPatterns&&"all"===l.qualityFilter;for(let o=0;o<l.numProgressions;o++){const o=[];if(a&&r.length>0){const e=l.keyType.includes("Minor"),t=zi[e?"Minor":"Major"],r=t[Math.floor(Math.random()*t.length)],a=Array.from({length:l.numChords},(e,t)=>r[t%r.length]);for(const i of a){const e=Co.indexOf(i.replace(/\xb0|\+/g,"").toUpperCase());if(-1!==e){let t={...n[e]},r={...s[e]};if(l.includeSusChords&&("Major"===t.quality||"Minor"===t.quality)&&Math.random()<.2){const e=Math.random()<.5?"sus2":"sus4";t.name=`${t.root}${e}`,r.name=`${r.root}${e}`,t.roman=`${t.roman} ${e}`}o.push({roman:t.roman,name:t.name,tetradName:r.name})}}}else if(r.length>0){let e=null;for(let n=0;n<l.numChords;n++){let n;do{var t;n={...r[Math.floor(Math.random()*r.length)]}}while(n.name===(null===(t=e)||void 0===t?void 0:t.name)&&r.length>1);if(l.includeSusChords&&("Major"===n.quality||"Minor"===n.quality)&&Math.random()<.2){const e=Math.random()<.5?"sus2":"sus4";n.name=`${n.root}${e}`,n.roman=`${n.roman} ${e}`}const a=s[Co.indexOf(n.roman.replace(/\xb0|\+|sus[24]/g,"").toUpperCase())];o.push({...n,tetradName:a?a.name:n.name}),e=n}}e.push(o)}}e.every(e=>0===e.length)||v(e)},[l.rootNote,l.keyType,l.numChords,l.numProgressions,l.useCommonPatterns,l.includeDiminished,l.qualityFilter,l.generationMode,l.allowedQualities,l.includeSusChords]),k=(0,e.useCallback)(()=>{setTimeout(j,0)},[j]);return(0,e.useEffect)(()=>{j()},[j]),(0,e.useEffect)(()=>(t(u?{callback:k,interval:h}:null),()=>t(null)),[u,h,k,t]),(0,e.useEffect)(()=>{const e=e=>{"Enter"===e.key&&(e.preventDefault(),j())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[j]),{settings:l,setSettings:c,isAutoGenerateOn:u,setIsAutoGenerateOn:d,autoGenerateInterval:h,setAutoGenerateInterval:m,isControlsOpen:f,setIsControlsOpen:p,isInfoModalOpen:g,setIsInfoModalOpen:x,progressions:b,openSections:y,toggleSection:e=>{w(t=>({...t,[e]:!t[e]}))},countdownClicks:r,setCountdownClicks:a,handleGenerate:j,handleLogSession:()=>{const e=prompt("Enter any remarks for this session:",`Practiced chord progressions in ${l.rootNote} ${l.keyType}.`);null!==e&&(n({game:"Chord Progression Generator",bpm:s||"N/A",date:(new Date).toLocaleDateString(),remarks:e||"No remarks."}),alert("Session logged!"))}}})(),v=()=>{const e=prompt("Enter a name for your preset:",`CPG - ${n.rootNote} ${n.keyType}`);if(e&&""!==e.trim()){const s={id:Date.now().toString(),name:e.trim(),gameId:"chord-progression-generator",gameName:"Chord Progression Generator",settings:n,automation:{isAutoGenerateOn:r,autoGenerateInterval:o,countdownClicks:p}};t(s),alert(`Preset "${e.trim()}" saved!`)}},y=(e,t)=>{s(n=>({...n,[e]:t}))},w=e=>{s(t=>({...t,qualityFilter:e,useCommonPatterns:"all"===e&&t.useCommonPatterns}))},j=()=>{let e;do{e=Wi[Math.floor(Math.random()*Wi.length)]}while(e===n.rootNote&&Wi.length>1);y("rootNote",e)},k=(e,t)=>{const s="Tetrads"===n.chordComplexity?e.tetradName:e.name,r=("degrees"===n.chordDegreeView||"both"===n.chordDegreeView)&&"diatonic"===n.generationMode,a="chords"===n.chordDegreeView||"both"===n.chordDegreeView||"random"===n.generationMode;return(0,Lo.jsxs)("div",{className:"text-center flex-shrink-0 p-2 min-w-[6rem]",children:[a&&(0,Lo.jsx)(Ki,{name:s,fontSize:n.fontSize,useAlternateNotation:n.useAlternateNotation}),r&&(0,Lo.jsx)("div",{style:{fontSize:`${"both"===n.chordDegreeView?.6*n.fontSize:n.fontSize}rem`},className:"whitespace-nowrap "+("both"===n.chordDegreeView?"text-gray-200 mt-2":"font-bold text-teal-300"),children:e.roman})]},t)};return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsx)($o,{isOpen:u,onClose:()=>d(!1),title:"Chord Progression Generator Guide",children:(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsx)("p",{children:"This tool generates chord progressions based on your selected key, scale, and other options."}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"How It Works"}),(0,Lo.jsx)("p",{children:'Use the collapsible "Settings & Controls" panel to customize your progression. You can choose a root note and key, how many chords to generate, and filter the types of chords used.'})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Features"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside ml-2 mt-1 space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Layout Mode:"}),' Choose "Flow" for a simple wrapping list, or "Measures" to arrange chords in a grid with aligned barlines.']}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Complexity:"})," Switch between basic 3-note triads and richer 4-note tetrads."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Filtering:"})," You can choose to include or exclude diminished chords, or even limit the generator to only use major or minor chords."]})]})]})]})}),(0,Lo.jsxs)("div",{className:"w-full flex-1 flex flex-col",children:[(0,Lo.jsxs)("div",{className:"bg-slate-800 p-4 rounded-lg",children:[(0,Lo.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[(0,Lo.jsx)("div",{className:"flex-1"}),(0,Lo.jsxs)("div",{className:"flex-1 flex justify-center items-center gap-2",children:[(0,Lo.jsx)("h2",{className:"text-2xl text-center font-bold text-indigo-300",children:"Chord Progression Generator"}),(0,Lo.jsx)(Uo,{onClick:()=>d(!0)})]}),(0,Lo.jsxs)("div",{className:"flex-1 flex justify-end items-center gap-2",children:[(0,Lo.jsx)("button",{onClick:b,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-1 px-3 rounded-lg text-sm",children:"Log Session"}),(0,Lo.jsx)("button",{onClick:()=>c(e=>!e),className:"p-2 rounded-md bg-slate-700 hover:bg-slate-600 text-sm font-semibold",title:"Toggle Controls",children:"Controls"})]})]}),(0,Lo.jsx)("div",{className:"w-full flex flex-col items-center space-y-4 p-4 rounded-lg min-h-[10rem]",children:h.map((t,s)=>"measure"===n.displayMode?(0,Lo.jsx)("div",{className:"w-full flex flex-col items-center gap-y-6",children:Qi(Qi(t,n.chordsPerBar),n.barsPerLine).map((t,n)=>(0,Lo.jsx)("div",{className:"w-full flex justify-center items-center flex-wrap gap-y-4",children:t.map((t,n)=>(0,Lo.jsxs)(e.Fragment,{children:[n>0&&(0,Lo.jsx)("div",{className:"w-px h-16 bg-slate-500 self-center"}),(0,Lo.jsx)("div",{className:"flex-1 flex justify-around items-center p-2",children:t.map((e,t)=>k(e,`${n}-${t}`))})]},n))},n))},s):(0,Lo.jsx)("div",{className:"w-full flex flex-wrap justify-center items-center gap-x-2 gap-y-6",children:t.map((t,s)=>(0,Lo.jsxs)(e.Fragment,{children:[n.flowBarlineFrequency>0&&s>0&&s%n.flowBarlineFrequency===0&&(0,Lo.jsx)("div",{className:"w-px h-16 bg-slate-500 mx-3 self-center"}),k(t,s)]},s))},s))})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-4 my-6",children:[(0,Lo.jsx)("label",{htmlFor:"font-size",className:"font-semibold text-lg",children:"Font Size:"}),(0,Lo.jsx)("input",{type:"range",id:"font-size",min:"1.5",max:"5",step:"0.1",value:n.fontSize,onChange:e=>y("fontSize",parseFloat(e.target.value)),className:"w-1/2 max-w-xs"})]}),(0,Lo.jsx)("div",{className:"w-full flex justify-center my-6",children:(0,Lo.jsx)("button",{onClick:x,className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg text-xl",children:"Generate New Progression (Enter)"})})]}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out sticky top-6 max-h-[calc(100vh-3rem)] "+(l?"w-80 p-4 overflow-y-auto":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!l&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(Ui,{settings:n,onSettingChange:y,onQualityFilterChange:w,onRandomRootNote:j,isAutoGenerateOn:r,onAutoGenerateToggle:()=>a(e=>!e),autoGenerateInterval:o,onIntervalChange:i,countdownClicks:p,onCountdownChange:g,openSections:m,onToggleSection:f,onSavePreset:v})]})}),l&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>c(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(Ui,{settings:n,onSettingChange:y,onQualityFilterChange:w,onRandomRootNote:j,isAutoGenerateOn:r,onAutoGenerateToggle:()=>a(e=>!e),autoGenerateInterval:o,onIntervalChange:i,countdownClicks:p,onCountdownChange:g,openSections:m,onToggleSection:f,onSavePreset:v})})]})})]})},Xi=e=>{let{settings:t,onSettingChange:n,isAutoGenerateOn:s,onAutoGenerateToggle:r,autoGenerateInterval:a,onIntervalChange:o,countdownClicks:i,onCountdownChange:l,onSavePreset:c}=e;return(0,Lo.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"num-intervals",className:"font-semibold text-lg",children:"Number of Intervals:"}),(0,Lo.jsx)("input",{type:"number",id:"num-intervals",value:t.numIntervals,onChange:e=>n("numIntervals",Math.max(1,parseInt(e.target.value,10)||1)),className:"w-24 p-2 rounded-md bg-slate-600 text-white text-center",min:"1"})]}),(0,Lo.jsxs)("div",{className:"pt-4 border-t border-slate-600",children:[(0,Lo.jsx)("span",{className:"font-semibold text-lg",children:"Include Qualities:"}),(0,Lo.jsx)("div",{className:"flex flex-col gap-3 mt-2",children:Object.keys(t.selectedQualities).map(e=>(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 bg-slate-600 rounded-md",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:e}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:t.selectedQualities[e],onChange:()=>{const s={...t.selectedQualities,[e]:!t.selectedQualities[e]};n("selectedQualities",s)},className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},e))})]}),(0,Lo.jsxs)("div",{className:"pt-4 border-t border-slate-600 space-y-4",children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300",children:"Display Options"}),(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 bg-slate-600 rounded-md",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Use Shorthand (P4, m3)"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:t.useShorthand,onChange:()=>n("useShorthand",!t.useShorthand),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),t.useShorthand&&(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"font-semibold block mb-2 text-md",children:"Display Mode:"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("displayMode","stacked"),className:"flex-1 rounded-md text-sm py-1 "+("stacked"===t.displayMode?"bg-blue-600 text-white":"text-gray-300"),children:"Stacked"}),(0,Lo.jsx)("button",{onClick:()=>n("displayMode","single-line"),className:"flex-1 rounded-md text-sm py-1 "+("single-line"===t.displayMode?"bg-blue-600 text-white":"text-gray-300"),children:"Single Line"})]})]})]}),(0,Lo.jsxs)("div",{className:"pt-4 border-t border-slate-600 space-y-4",children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300",children:"Automation"}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"auto-generate-int",className:"font-semibold",children:"Auto-Generate:"}),(0,Lo.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",id:"auto-generate-int",checked:s,onChange:r,className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-teal-600"})]})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"auto-generate-interval-int",className:`font-semibold ${!s&&"opacity-50"}`,children:"Generate every:"}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("input",{type:"number",id:"auto-generate-interval-int",value:a,onChange:e=>o(Math.max(1,parseInt(e.target.value,10)||1)),className:`w-24 p-2 rounded-md bg-slate-600 text-white text-center ${!s&&"opacity-50"}`,min:"1",disabled:!s}),(0,Lo.jsx)("span",{className:`font-semibold ${!s&&"opacity-50"}`,children:"clicks"})]})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsx)("label",{htmlFor:"countdown-clicks-int",className:`font-semibold ${!s&&"opacity-50"}`,children:"Countdown:"}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("input",{type:"number",id:"countdown-clicks-int",value:i,onChange:e=>l(Math.max(0,parseInt(e.target.value,10))||0),className:`w-24 p-2 rounded-md bg-slate-600 text-white text-center ${!s&&"opacity-50"}`,min:"0",max:"7",disabled:!s}),(0,Lo.jsx)("span",{className:`font-semibold ${!s&&"opacity-50"}`,children:"clicks"})]})]})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:c,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},Zi={"Perfect Unison":"P1","Minor 2nd":"m2","Major 2nd":"M2","Minor 3rd":"m3","Major 3rd":"M3","Perfect 4th":"P4","Augmented 4th":"A4","Diminished 5th":"d5","Perfect 5th":"P5","Minor 6th":"m6","Major 6th":"M6","Minor 7th":"m7","Major 7th":"M7","Perfect Octave":"P8"},Ji=()=>{const{savePreset:t}=Vo(),{settings:n,setSettings:s,generatedIntervals:r,fontSize:a,setFontSize:o,isAutoGenerateOn:i,setIsAutoGenerateOn:l,autoGenerateInterval:c,setAutoGenerateInterval:u,isControlsOpen:d,setIsControlsOpen:h,isInfoModalOpen:m,setIsInfoModalOpen:f,countdownClicks:p,setCountdownClicks:g,countdownMode:x,setCountdownMode:b,generateIntervals:v,handleLogSession:y}=(()=>{const{addLogEntry:t,setMetronomeSchedule:n,countdownClicks:s,setCountdownClicks:r,presetToLoad:a,clearPresetToLoad:o}=Vo(),[i,l]=(0,e.useState)({numIntervals:1,selectedQualities:{Perfect:!0,Major:!0,Minor:!0,Augmented:!1,Diminished:!1},useShorthand:!1,displayMode:"stacked"}),[c,u]=(0,e.useState)([]),[d,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)(1),[p,g]=(0,e.useState)(!1),[x,b]=(0,e.useState)(!1),[v,y]=(0,e.useState)(4);(0,e.useEffect)(()=>{a&&"interval-generator"===a.gameId&&(l(a.settings),a.automation&&(h(a.automation.isAutoGenerateOn),f(a.automation.autoGenerateInterval),r(a.automation.countdownClicks)),a.display&&y(a.display.fontSize),o())},[a,o,r]);const w=(0,e.useMemo)(()=>({"Unison/Octave":[{name:"Perfect Unison",quality:"Perfect"},{name:"Perfect Octave",quality:"Perfect"}],"2nd":[{name:"Minor 2nd",quality:"Minor"},{name:"Major 2nd",quality:"Major"}],"3rd":[{name:"Minor 3rd",quality:"Minor"},{name:"Major 3rd",quality:"Major"}],"4th":[{name:"Perfect 4th",quality:"Perfect"},{name:"Augmented 4th",quality:"Augmented"}],"5th":[{name:"Diminished 5th",quality:"Diminished"},{name:"Perfect 5th",quality:"Perfect"}],"6th":[{name:"Minor 6th",quality:"Minor"},{name:"Major 6th",quality:"Major"}],"7th":[{name:"Minor 7th",quality:"Minor"},{name:"Major 7th",quality:"Major"}]}),[]),j=(0,e.useMemo)(()=>Object.values(w).flat(),[w]),k=(0,e.useCallback)(()=>{const e=j.filter(e=>i.selectedQualities[e.quality]);if(0===e.length)return void u(["Select a quality"]);let t=[],n=null;for(let s=0;s<i.numIntervals;s++){let s,r=0;do{s=e[Math.floor(Math.random()*e.length)],r++}while(s.name===n&&e.length>1&&r<20);t.push(s.name),n=s.name}u(t)},[i.numIntervals,i.selectedQualities,j]),N=(0,e.useCallback)(()=>{setTimeout(k,0)},[k]);return(0,e.useEffect)(()=>{k()},[k]),(0,e.useEffect)(()=>(n(d?{callback:N,interval:m}:null),()=>n(null)),[d,m,N,n]),(0,e.useEffect)(()=>{const e=e=>{const t=e.target.tagName.toLowerCase();"input"!==t&&"textarea"!==t&&"select"!==t&&("Enter"!==e.key&&" "!==e.key||(e.preventDefault(),k()))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[k]),{settings:i,setSettings:l,generatedIntervals:c,fontSize:v,setFontSize:y,isAutoGenerateOn:d,setIsAutoGenerateOn:h,autoGenerateInterval:m,setAutoGenerateInterval:f,isControlsOpen:p,setIsControlsOpen:g,isInfoModalOpen:x,setIsInfoModalOpen:b,countdownClicks:s,setCountdownClicks:r,generateIntervals:k,handleLogSession:()=>{const e=prompt("Enter any remarks for this session:","Practiced random intervals.");null!==e&&(t({game:"Interval Generator",bpm:"N/A",date:(new Date).toLocaleDateString(),remarks:e||"No remarks."}),alert("Session logged!"))}}})(),w=()=>{const e=Object.keys(n.selectedQualities).filter(e=>n.selectedQualities[e]).join("/"),s=prompt("Enter a name for your preset:",`Intervals - ${e}`);if(s&&""!==s.trim()){const e={id:Date.now().toString(),name:s.trim(),gameId:"interval-generator",gameName:"Interval Generator",settings:n,automation:{isAutoGenerateOn:i,autoGenerateInterval:c,countdownClicks:p,countdownMode:x},display:{fontSize:a}};t(e),alert(`Preset "${s.trim()}" saved!`)}},j=(e,t)=>{s(n=>({...n,[e]:t}))};return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsx)($o,{isOpen:m,onClose:()=>f(!1),title:"Random Interval Generator Guide",children:(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsx)("p",{children:"This tool generates random musical intervals to help train your ear and theoretical knowledge."}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"How It Works"}),(0,Lo.jsx)("p",{children:'Use the "Generate" button or press the Enter/Space key to get a new interval. You can select which interval qualities (Major, Minor, etc.) you want to include in the randomization from the controls panel.'})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Features"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside ml-2 mt-1 space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Multiple Intervals:"})," Choose to generate more than one interval at a time for a longer practice sequence."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Display Options:"})," Use the controls to switch between full names and shorthand (e.g., P4, M3), and display them stacked or in a single line."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{className:"text-teal-300",children:"Auto-Generate:"})," For continuous practice, enable this feature to get a new interval automatically in time with the metronome."]})]})]})]})}),(0,Lo.jsxs)("div",{className:"w-full flex-1 bg-slate-800 p-4 rounded-lg",children:[(0,Lo.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 gap-2",children:[(0,Lo.jsx)("div",{className:"flex-1"}),(0,Lo.jsxs)("div",{className:"flex-1 flex justify-center items-center gap-2",children:[(0,Lo.jsx)("h1",{className:"text-xl md:text-2xl text-center font-bold text-indigo-300",children:"Random Interval Generator"}),(0,Lo.jsx)(Uo,{onClick:()=>f(!0)})]}),(0,Lo.jsxs)("div",{className:"flex-1 flex justify-end items-center gap-2",children:[(0,Lo.jsx)("button",{onClick:y,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-1 px-3 rounded-lg text-sm",children:"Log Session"}),(0,Lo.jsx)("button",{onClick:()=>h(e=>!e),className:"p-2 rounded-md bg-slate-700 hover:bg-slate-600 text-sm font-semibold",children:"Controls"})]})]}),(0,Lo.jsx)("div",{className:"w-full p-6 rounded-lg text-center min-h-[150px] flex justify-center items-center gap-y-4 "+(n.useShorthand&&"single-line"===n.displayMode?"flex-row flex-wrap gap-x-8":"flex-col"),children:r.map((e,t)=>(0,Lo.jsx)("span",{className:"font-bold text-teal-300",style:{fontSize:`${a}rem`,lineHeight:"1.2"},children:n.useShorthand&&Zi[e]||e},t))}),(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-4 mt-6 mb-8",children:[(0,Lo.jsx)("label",{htmlFor:"font-size",className:"font-semibold text-lg",children:"Font Size:"}),(0,Lo.jsx)("input",{type:"range",id:"font-size",min:"1.5",max:"8",step:"0.1",value:a,onChange:e=>o(parseFloat(e.target.value)),className:"w-1/2 max-w-xs"})]}),(0,Lo.jsx)("div",{className:"w-full flex justify-center",children:(0,Lo.jsx)("button",{onClick:v,className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg text-xl",children:"Generate (Enter/Space)"})})]}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out sticky top-6 max-h-[calc(100vh-3rem)] "+(d?"w-80 p-4 overflow-y-auto":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!d&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(Xi,{settings:n,onSettingChange:j,isAutoGenerateOn:i,onAutoGenerateToggle:()=>l(e=>!e),autoGenerateInterval:c,onIntervalChange:u,countdownClicks:p,onCountdownChange:g,countdownMode:x,onCountdownModeChange:b,onSavePreset:w})]})}),d&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>h(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(Xi,{settings:n,onSettingChange:j,isAutoGenerateOn:i,onAutoGenerateToggle:()=>l(e=>!e),autoGenerateInterval:c,onIntervalChange:u,countdownClicks:p,onCountdownChange:g,countdownMode:x,onCountdownModeChange:b,onSavePreset:w})})]})})]})},el=["C","C#","Db","D","D#","Eb","E","F","F#","Gb","G","G#","Ab","A","A#","Bb","B"],tl=["C","C#","Db","D","D#","Eb","E","F","F#","Gb","G","G#","Ab","A","A#","Bb","B"],nl=["C","D","E","F","G","A","B"],sl=[{id:"b",display:"\u266d"},{id:"natural",display:""},{id:"#",display:"\u266f"}],rl={C:0,D:2,E:4,F:5,G:7,A:9,B:11},al={Major:[0,4,7],Minor:[0,3,7],Diminished:[0,3,6],Augmented:[0,4,8]},ol={"Major 7":[0,4,7,11],"Minor 7":[0,3,7,10],"Dominant 7":[0,4,7,10],"Half-Diminished 7":[0,3,6,10],"Diminished 7":[0,3,6,9]},il=(e,t)=>{const n=(e=>{const t=e.charAt(0).toUpperCase(),n=e.substring(1);let s=rl[t];return n.includes("#")&&(s+=n.length),n.includes("b")&&(s-=n.length),s})(e),s=e.charAt(0),r=nl.indexOf(s),a=[0,2,4,6];return t.map((e,t)=>{const s=nl[(r+a[t])%7];let o=(n+e)%12-rl[s]%12;o>6&&(o-=12),o<-6&&(o+=12);let i="";return 1===o?i="#":2===o?i="##":-1===o?i="b":-2===o&&(i="bb"),`${s}${i}`})},ll=e=>{let{settings:t,onSettingChange:n,onSavePreset:s}=e;return(0,Lo.jsxs)("div",{className:"space-y-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Quiz Mode"}),(0,Lo.jsxs)("div",{className:"space-y-2",children:[(0,Lo.jsxs)("label",{className:"block p-3 rounded-md cursor-pointer "+("nameTheTriad"===t.quizMode?"bg-blue-600 text-white":"bg-slate-600 hover:bg-slate-500"),children:[(0,Lo.jsx)("input",{type:"radio",name:"quizMode",value:"nameTheTriad",checked:"nameTheTriad"===t.quizMode,onChange:e=>n("quizMode",e.target.value),className:"sr-only"}),"Name the Chord"]}),(0,Lo.jsxs)("label",{className:"block p-3 rounded-md cursor-pointer "+("nameTheNotes"===t.quizMode?"bg-blue-600 text-white":"bg-slate-600 hover:bg-slate-500"),children:[(0,Lo.jsx)("input",{type:"radio",name:"quizMode",value:"nameTheNotes",checked:"nameTheNotes"===t.quizMode,onChange:e=>n("quizMode",e.target.value),className:"sr-only"}),"Name the Notes"]}),(0,Lo.jsxs)("label",{className:"block p-3 rounded-md cursor-pointer "+("mixed"===t.quizMode?"bg-blue-600 text-white":"bg-slate-600 hover:bg-slate-500"),children:[(0,Lo.jsx)("input",{type:"radio",name:"quizMode",value:"mixed",checked:"mixed"===t.quizMode,onChange:e=>n("quizMode",e.target.value),className:"sr-only"}),"Mixed Quiz"]})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Options"}),(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 bg-slate-600 rounded-md",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Include 7th Chords"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:t.include7ths,onChange:()=>n("include7ths",!t.include7ths),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 peer-checked:bg-blue-600"})]})]}),(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 bg-slate-600 rounded-md mt-2",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Include Inversions"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:t.includeInversions,onChange:()=>n("includeInversions",!t.includeInversions),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 peer-checked:bg-blue-600"})]})]})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:s,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},cl=t=>{let{onProgressUpdate:n}=t;const{addLogEntry:s,savePreset:r,presetToLoad:a,clearPresetToLoad:o}=Vo(),[i,l]=(0,e.useState)({quizMode:"mixed",include7ths:!1,includeInversions:!1,autoAdvance:!0,playAudio:!0}),[c,u]=(0,e.useState)(!1),[d,h]=(0,e.useState)(!1);(0,e.useEffect)(()=>{a&&"triad-quiz"===a.gameId&&(l(a.settings),o())},[a,o]);const{score:m,totalAsked:f,feedback:p,isAnswered:g,currentQuestion:x,userAnswer:b,setUserAnswer:v,history:y,reviewIndex:w,setReviewIndex:j,questionTypes:k,checkAnswer:N,generateNewQuestion:C,handleReviewNav:_,startReview:S,replayAudioForHistoryItem:T,playUserAnswerForHistoryItem:A}=((t,n)=>{const{quizMode:s,include7ths:r,includeInversions:a,autoAdvance:o,playAudio:i}=t,{playChord:l}=Vo(),[c,u]=(0,e.useState)(null),[d,h]=(0,e.useState)({}),[m,f]=(0,e.useState)({message:"",type:""}),[p,g]=(0,e.useState)(!1),[x,b]=(0,e.useState)(0),[v,y]=(0,e.useState)(0),[w,j]=(0,e.useState)([]),[k,N]=(0,e.useState)(null),C=(0,e.useMemo)(()=>r?{...al,...ol}:al,[r]),_=(0,e.useCallback)(()=>{N(null);let e=null,t=0;do{const n=el[Math.floor(Math.random()*el.length)],r=Object.keys(C),o=r[Math.floor(Math.random()*r.length)],i=C[o],l=il(n,i);if(l.every(e=>tl.includes(e))){let t=[...l];if(a&&Math.random()>.3){const e=Math.floor(Math.random()*t.length);e>0&&(t=[...t.slice(e),...t.slice(0,e)])}const r="mixed"===s?Math.random()<.5?"nameTheTriad":"nameTheNotes":s;e={root:n,quality:o,notes:t,rootPositionNotes:l,sortedNotes:[...l].sort(),mode:r}}t++}while(!e&&t<100);e?(u(e),g(!1),f({message:"",type:""}),h({accidental:""})):console.error("Could not generate an answerable question.")},[s,C,a]),S=(0,e.useCallback)(()=>{if(p||!c)return;let e=!1,s="";if("nameTheTriad"===c.mode){const t=`${d.noteLetter||""}${d.accidental||""}`;e=t===c.root&&d.quality===c.quality,s=`${c.root} ${c.quality}`}else{var r;const t=(null===(r=d.notes)||void 0===r?void 0:r.sort())||[];s=c.rootPositionNotes.join(", "),t.length===c.sortedNotes.length&&(e=t.every((e,t)=>e===c.sortedNotes[t]))}const a=e?x+1:x,u=v+1;if(e?(b(a),f({message:"Correct!",type:"correct"})):f({message:`Incorrect! The answer was ${s}.`,type:"incorrect"}),y(u),j(n=>[...n,{question:c,userAnswer:d,wasCorrect:e,settings:{...t}}]),g(!0),n&&n({wasCorrect:e,score:a,totalAsked:u}),i){const e=t.includeInversions&&"nameTheTriad"===c.mode?c.notes:c.rootPositionNotes;l(e,"Both")}o&&e&&setTimeout(_,2e3)},[p,d,c,o,_,x,v,n,i,l,t]);(0,e.useEffect)(()=>{b(0),y(0),j([]),N(null),C&&Object.keys(C).length>0&&_()},[_,C]);const T=(0,e.useCallback)(e=>{const n=w[e];if(!n||!i)return;const s=n.question,r=(n.settings||t).includeInversions&&"nameTheTriad"===s.mode?s.notes:s.rootPositionNotes;l(r,"Both")},[w,i,l,t]),A=(0,e.useCallback)(e=>{const t=w[e];if(!t||t.wasCorrect||!i)return;let n=[];if("nameTheTriad"===t.question.mode){const{noteLetter:e,accidental:s,quality:r}=t.userAnswer;if(e&&r){const t=`${e}${s||""}`,a=C[r];a&&(n=il(t,a))}}else n=t.userAnswer.notes||[];n.length>0&&l(n,"Both")},[w,i,l,C]);return{score:x,totalAsked:v,feedback:m,isAnswered:p,currentQuestion:c,userAnswer:d,setUserAnswer:h,history:w,reviewIndex:k,setReviewIndex:N,questionTypes:C,checkAnswer:S,generateNewQuestion:_,handleReviewNav:e=>{N(t=>{const n=t+e;return n>=0&&n<w.length?n:t})},startReview:()=>{w.length>0&&N(w.length-1)},replayAudioForHistoryItem:T,playUserAnswerForHistoryItem:A}})(i,n),M=null!==w,E=(e,t)=>{l(n=>({...n,[e]:t}))};(0,e.useEffect)(()=>{const e=e=>{const t=e.target.tagName.toLowerCase();if("input"===t||"textarea"===t||"select"===t)return;if("Enter"!==e.key||M)return;e.preventDefault();const n=!(y.length>0)||y[y.length-1].wasCorrect;!g||i.autoAdvance&&n?g||N():C()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[g,i.autoAdvance,y,M,N,C]),(0,e.useEffect)(()=>{var e;i.autoAdvance&&"nameTheNotes"===(null===x||void 0===x?void 0:x.mode)&&(null===(e=b.notes)||void 0===e?void 0:e.length)===x.notes.length&&!g&&N()},[b,x,i.autoAdvance,g,N]),(0,e.useEffect)(()=>{i.autoAdvance&&"nameTheTriad"===(null===x||void 0===x?void 0:x.mode)&&b.noteLetter&&void 0!==b.accidental&&b.quality&&!g&&N()},[b,x,i.autoAdvance,g,N]);const D=()=>{const e=prompt("Enter a name for your preset:","Triads Quiz Setting");if(e&&""!==e.trim()){const t={id:Date.now().toString(),name:e.trim(),gameId:"triad-quiz",gameName:"Triad & Tetrads Quiz",settings:i};r(t),alert(`Preset "${e.trim()}" saved!`)}};if(!x&&null===w)return(0,Lo.jsx)("div",{children:"Loading..."});const R=M?y[w]:{question:x,userAnswer:b},I=R.question,P=R.userAnswer,O=Object.keys(k),F=I.notes.length,L="bg-teal-600 hover:bg-teal-500",q="bg-indigo-600 text-white",V=(e,t)=>{g||M||v(n=>({...n,[e]:t}))},z=(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Play Audio"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:i.playAudio,onChange:()=>E("playAudio",!i.playAudio),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Auto-Advance"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:i.autoAdvance,onChange:()=>E("autoAdvance",!i.autoAdvance),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),G=!(y.length>0)||y[y.length-1].wasCorrect,B=M?(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-4 w-full",children:[(0,Lo.jsx)("button",{onClick:()=>_(-1),disabled:0===w,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Prev"}),(0,Lo.jsxs)("div",{className:"flex flex-col gap-2 flex-grow max-w-xs",children:[(0,Lo.jsx)("button",{onClick:()=>j(null),className:"bg-purple-600 hover:bg-purple-500 font-bold p-3 rounded-lg text-xl",children:"Return to Quiz"}),(0,Lo.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[(0,Lo.jsx)("button",{onClick:()=>T(w),className:"bg-sky-600 hover:bg-sky-500 text-sm p-2 rounded-lg font-semibold",children:"Replay Correct"}),!y[w].wasCorrect&&(0,Lo.jsx)("button",{onClick:()=>A(w),className:"bg-orange-600 hover:bg-orange-500 text-sm p-2 rounded-lg font-semibold",children:"Replay Your Answer"})]})]}),(0,Lo.jsx)("button",{onClick:()=>_(1),disabled:w===y.length-1,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Next"})]}):g?!g||i.autoAdvance&&G?null:(0,Lo.jsx)("button",{onClick:C,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg animate-pulse",children:"Next Question"}):(0,Lo.jsx)("button",{onClick:N,className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg",children:"Submit"});return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsx)($o,{isOpen:c,onClose:()=>u(!1),title:"How to Play: Triad & Tetrads Quiz",children:(0,Lo.jsxs)("div",{className:"space-y-3",children:[(0,Lo.jsx)("p",{children:"This quiz tests your ability to identify chords by their notes, and vice-versa."}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300",children:"How It Works"}),(0,Lo.jsx)("p",{className:"text-sm",children:'A question will appear in the main display. Use the green buttons below to construct your answer, then press "Submit" or the Enter key.'})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300",children:"Game Modes & Options"}),(0,Lo.jsx)("p",{className:"text-sm",children:'Click the "Controls" button to change game settings at any time. You can choose between different quiz modes, and add 7th chords or inversions to make the quiz more challenging. Changing a setting will restart the quiz with a new question.'})]})]})}),(0,Lo.jsxs)(Wo,{title:"Triad & Tetrads Quiz",score:m,totalAsked:f,history:y,isReviewing:M,onStartReview:S,topControls:z,footerContent:B,onLogProgress:()=>{const e=prompt("Enter any remarks for this session:",`Score: ${m} / ${f}`);null!==e&&(s({game:"Triad & Tetrads Quiz",date:(new Date).toLocaleDateString(),remarks:e}),alert("Session logged!"))},onToggleControls:()=>h(e=>!e),onShowInfo:()=>u(!0),children:[(0,Lo.jsx)("div",{className:"min-h-[6rem] p-4 bg-slate-900/50 rounded-lg flex justify-center items-center mb-2 md:mb-4",children:x&&("nameTheTriad"===I.mode?(0,Lo.jsx)("p",{className:"text-4xl font-bold text-teal-300 tracking-widest",children:I.notes.join(" - ")}):(0,Lo.jsxs)("p",{className:"text-4xl font-bold text-teal-300",children:[I.root," ",I.quality]}))}),(0,Lo.jsx)("div",{className:"my-2 md:my-4 min-h-[52px] flex flex-col justify-center "+(M?"":"correct"===p.type?"text-green-400":"text-red-400"),children:M?(()=>{const{question:e,userAnswer:t,wasCorrect:n}=R;let s,r;return"nameTheTriad"===e.mode?(s=`${t.noteLetter||"?"}${t.accidental||""} ${t.quality||"?"}`.trim(),r=`${e.root} ${e.quality}`):(s=t.notes&&t.notes.length>0?t.notes.sort().join(", "):"No answer",r=e.rootPositionNotes.join(", ")),(0,Lo.jsxs)("div",{className:"text-center p-3 rounded-lg "+(n?"bg-green-900/50":"bg-red-900/50"),children:[(0,Lo.jsxs)("p",{className:"font-bold text-gray-200",children:["Correct Answer: ",(0,Lo.jsx)("span",{className:"text-teal-300 font-semibold",children:r})]}),!n&&(0,Lo.jsxs)("p",{className:"mt-1",children:[(0,Lo.jsx)("span",{className:"font-bold text-gray-300",children:"Your Answer:"})," ",(0,Lo.jsx)("span",{className:"text-red-400 font-semibold",children:s})]})]})})():(0,Lo.jsx)("p",{className:"text-lg font-bold text-center",children:p.message||(0,Lo.jsx)(Lo.Fragment,{children:"\xa0"})})}),(0,Lo.jsx)("div",{className:"space-y-4",children:x&&(()=>{if(M)return null;if("nameTheTriad"===I.mode){const e=["A","B","C","D","E","F","G"];return(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:"Root Note"}),(0,Lo.jsx)("div",{className:"grid grid-cols-7 gap-1",children:e.map(e=>(0,Lo.jsx)("button",{onClick:()=>V("noteLetter",e),disabled:g,className:`py-3 rounded font-semibold text-lg ${P.noteLetter===e?q:L}`,children:e},e))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:"Accidental"}),(0,Lo.jsx)("div",{className:"grid grid-cols-3 gap-1",children:sl.map(e=>(0,Lo.jsx)("button",{onClick:()=>V("accidental","natural"===e.id?"":e.id),disabled:g,className:`py-3 rounded font-semibold text-2xl ${P.accidental===("natural"===e.id?"":e.id)?q:L}`,children:e.display||"\u266e"},e.id))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:"Quality"}),(0,Lo.jsx)("div",{className:"grid grid-cols-4 gap-1",children:O.map(e=>(0,Lo.jsx)("button",{onClick:()=>V("quality",e),disabled:g,className:`py-3 px-1 rounded font-semibold ${P.quality===e?q:L}`,children:e},e))})]})]})}return(0,Lo.jsxs)("div",{children:[(0,Lo.jsxs)("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:["Select ",F," Notes"]}),(0,Lo.jsx)("div",{className:"flex gap-x-1 md:gap-x-2",children:[{letter:"A",notes:["A#","A","Ab"]},{letter:"B",notes:[null,"B","Bb"]},{letter:"C",notes:["C#","C",null]},{letter:"D",notes:["D#","D","Db"]},{letter:"E",notes:[null,"E","Eb"]},{letter:"F",notes:["F#","F",null]},{letter:"G",notes:["G#","G","Gb"]}].map(e=>(0,Lo.jsx)("div",{className:"flex flex-1 flex-col gap-y-1",children:e.notes.map((e,t)=>{var n;return null===e?(0,Lo.jsx)("div",{className:"h-14 w-full"},t):(0,Lo.jsx)("button",{onClick:()=>(e=>{if(g||M)return;const t=b.notes||[],n=t.includes(e)?t.filter(t=>t!==e):[...t,e].slice(0,F);v({notes:n})})(e),disabled:g,className:`h-14 w-full flex items-center justify-center rounded font-semibold text-lg transition-colors ${null!==(n=P.notes)&&void 0!==n&&n.includes(e)?q:L}`,children:e},e)})},e.letter))})]})})()})]}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out "+(d?"w-80 p-4":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!d&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(ll,{settings:i,onSettingChange:E,onSavePreset:D})]})}),d&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>h(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(ll,{settings:i,onSettingChange:E,onSavePreset:D})})]})})]})},ul={major:{E:{muted:[],notes:[{s:6,f:0,d:"R",degree:"1"},{s:5,f:2,degree:"5"},{s:4,f:2,d:"R",degree:"1"},{s:3,f:1,degree:"3"},{s:2,f:0,degree:"5"},{s:1,f:0,d:"R",degree:"1"}]},A:{muted:[6],notes:[{s:5,f:0,d:"R",degree:"1"},{s:4,f:2,degree:"5"},{s:3,f:2,d:"R",degree:"1"},{s:2,f:2,degree:"3"},{s:1,f:0,degree:"5"}]},G:{muted:[],notes:[{s:6,f:0,d:"R",degree:"1"},{s:5,f:-1,degree:"3"},{s:4,f:-3,degree:"5"},{s:3,f:-3,d:"R",degree:"1"},{s:2,f:-3,degree:"3"},{s:1,f:0,d:"R",degree:"1"}]},C:{muted:[6],notes:[{s:5,f:0,d:"R",degree:"1"},{s:4,f:-1,degree:"3"},{s:3,f:-3,degree:"5"},{s:2,f:-2,d:"R",degree:"1"},{s:1,f:-3,degree:"3"}]},D:{muted:[6,5],notes:[{s:4,f:0,d:"R",degree:"1"},{s:3,f:2,degree:"5"},{s:2,f:3,d:"R",degree:"3"},{s:1,f:2,degree:"5"}]}},minor:{E:{muted:[],notes:[{s:6,f:0,d:"R",degree:"1"},{s:5,f:2,degree:"5"},{s:4,f:2,d:"R",degree:"1"},{s:3,f:0,degree:"b3"},{s:2,f:0,degree:"5"},{s:1,f:0,d:"R",degree:"1"}]},A:{muted:[6],notes:[{s:5,f:0,d:"R",degree:"1"},{s:4,f:2,degree:"5"},{s:3,f:2,d:"R",degree:"1"},{s:2,f:1,degree:"b3"},{s:1,f:0,degree:"5"}]},G:{muted:[],notes:[{s:6,f:0,d:"R",degree:"1"},{s:5,f:-2,degree:"b3"},{s:4,f:-3,degree:"5"},{s:3,f:-3,d:"R",degree:"1"},{s:2,f:-4,degree:"5"},{s:1,f:0,d:"R",degree:"1"}]},C:{muted:[6],notes:[{s:5,f:0,d:"R",degree:"1"},{s:4,f:-2,degree:"b3"},{s:3,f:-3,degree:"5"},{s:2,f:-2,d:"R",degree:"1"},{s:1,f:-4,degree:"b3"}]},D:{muted:[6,5],notes:[{s:4,f:0,d:"R",degree:"1"},{s:3,f:2,degree:"5"},{s:2,f:3,d:"R",degree:"1"},{s:1,f:1,degree:"b3"}]}}},dl=[{display:"A",value:"A"},{display:"A#/Bb",value:"Bb",altValue:"A#"},{display:"B",value:"B"},{display:"C",value:"C"},{display:"C#/Db",value:"Db",altValue:"C#"},{display:"D",value:"D"},{display:"D#/Eb",value:"Eb",altValue:"D#"},{display:"E",value:"E"},{display:"F",value:"F"},{display:"F#/Gb",value:"F#",altValue:"Gb"},{display:"G",value:"G"},{display:"G#/Ab",value:"Ab",altValue:"G#"}],hl=["C","A","G","E","D"],ml=e=>{let{quizMode:t,onQuizModeChange:n,settings:s,onSettingToggle:r,onSavePreset:a}=e;return(0,Lo.jsxs)("div",{className:"space-y-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Game Mode"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("identify"),className:"flex-1 rounded-md text-sm py-1 "+("identify"===t?"bg-blue-600 text-white":"text-gray-300"),children:"Identify"}),(0,Lo.jsx)("button",{onClick:()=>n("construct"),className:"flex-1 rounded-md text-sm py-1 "+("construct"===t?"bg-blue-600 text-white":"text-gray-300"),children:"Construct"}),(0,Lo.jsx)("button",{onClick:()=>n("mixed"),className:"flex-1 rounded-md text-sm py-1 "+("mixed"===t?"bg-blue-600 text-white":"text-gray-300"),children:"Mixed"})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Chord Qualities"}),(0,Lo.jsxs)("div",{className:"space-y-2",children:[(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 bg-slate-600 rounded-md",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Major"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:s.includeMajor,onChange:()=>r("quality","includeMajor"),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 bg-slate-600 rounded-md",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Minor"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:s.includeMinor,onChange:()=>r("quality","includeMinor"),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Shapes to Practice"}),(0,Lo.jsx)("div",{className:"grid grid-cols-3 gap-2",children:hl.map(e=>(0,Lo.jsxs)("label",{className:"flex items-center justify-center gap-2 cursor-pointer p-2 bg-slate-600 rounded-md",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:e}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:s.shapes[e],onChange:()=>r("shapes",e),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-9 h-5 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"})]})]},e))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Display Options"}),(0,Lo.jsxs)("div",{className:"space-y-2",children:[(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 bg-slate-600 rounded-md",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Show Root Hint"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:s.showRootHint,onChange:()=>r("display","showRootHint"),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 bg-slate-600 rounded-md",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:"Show Scale Degrees"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:s.showDegrees,onChange:()=>r("display","showDegrees"),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:a,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},fl=e=>{let{isChecked:t,onChange:n}=e;return(0,Lo.jsxs)("label",{className:"flex items-center justify-center gap-2 cursor-pointer p-2 bg-slate-700 rounded-md",children:[(0,Lo.jsx)("span",{className:"font-semibold text-gray-300 text-sm",children:"Show Scale Degrees"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:t,onChange:n,className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-9 h-5 bg-gray-500 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"})]})]})},pl=t=>{var n,s,r,a;let{onProgressUpdate:o}=t;const{addLogEntry:i,savePreset:l,presetToLoad:c,clearPresetToLoad:u}=Vo(),[d,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)(!1),[p,g]=(0,e.useState)("mixed"),[x,b]=(0,e.useState)({includeMajor:!0,includeMinor:!0,shapes:{E:!0,A:!0,G:!0,C:!0,D:!0},showDegrees:!1,showRootHint:!1}),[v,y]=(0,e.useState)(!0);(0,e.useEffect)(()=>{if(c&&"caged-system-quiz"===c.gameId){const{quizMode:e,...t}=c.settings,n={showRootHint:!1,...t};b(n),e&&g(e),u()}},[c,u]);const w=()=>{const e=Object.keys(x.shapes).filter(e=>x.shapes[e]).join(","),t=prompt("Enter a name for your preset:",`CAGED - ${e}`);t&&""!==t.trim()&&(l({id:Date.now().toString(),name:t.trim(),gameId:"caged-system-quiz",gameName:"CAGED System Quiz",settings:{...x,quizMode:p}}),alert(`Preset "${t.trim()}" saved!`))},j=(0,e.useCallback)((e,t)=>{b(n=>{const s={...n};return"shapes"===e?s.shapes={...n.shapes,[t]:!n.shapes[t]}:s[t]=!n[t],s})},[]),k=(0,e.useMemo)(()=>{const e=[];return x.includeMajor&&Object.keys(x.shapes).forEach(t=>{x.shapes[t]&&e.push({quality:"major",shape:t})}),x.includeMinor&&Object.keys(x.shapes).forEach(t=>{x.shapes[t]&&e.push({quality:"minor",shape:t})}),e},[x.includeMajor,x.includeMinor,x.shapes]),N=((t,n,s)=>{const[r,a]=(0,e.useState)(0),[o,i]=(0,e.useState)(0),[l,c]=(0,e.useState)({message:"",type:""}),[u,d]=(0,e.useState)(!1),[h,m]=(0,e.useState)(null),[f,p]=(0,e.useState)({}),[g,x]=(0,e.useState)([]),[b,v]=(0,e.useState)(null),y=(0,e.useRef)(null),w=null!==b,j=(0,e.useCallback)(()=>{if(clearTimeout(y.current),v(null),0===n.length)return void m({notes:[],answer:null,prompt:"Please select shapes/qualities in Controls to begin.",mode:t});const e="mixed"===t?Math.random()<.5?"identify":"construct":t;let s=null,r=0;for(;!s&&r<50;){r++;const{quality:t,shape:a}=n[Math.floor(Math.random()*n.length)],o=ul[t][a],i=o.notes.find(e=>"R"===e.d),l=Math.floor(10*Math.random()),c=Do[6-i.s][l].note,u=vo(c),d=l-i.f,h=wo(u,t),m={};h&&h.forEach(e=>{const t=po[e];void 0!==t&&(m[t]=e)});const f=o.notes.map(e=>{const t=e.f+d;if(t<0||t>15)return null;const n=Do[6-e.s][t],s=m[n.midi%12]||n.note;return{...e,string:e.s,fret:t,isRoot:"R"===e.d,label:s,midi:n.midi}}).filter(Boolean);if(f.length!==o.notes.length)continue;const p=o.muted.map(e=>({string:e,fret:-1,label:"X"}));s={notes:[...f,...p],answer:{root:u,quality:t,shape:a,notes:f},prompt:`Construct ${u} ${t} (${a} shape)`,mode:e}}m(s),d(!1),c({message:"",type:""}),p("identify"===e?{root:null,quality:null,shape:null}:{notes:[]})},[n,t]);(0,e.useEffect)(()=>{a(0),i(0),x([]),j()},[t,n]);const k=(0,e.useCallback)(e=>{if(u||!h)return;const t=h.answer;let n=!1;const l=`${t.root} ${t.quality} (${t.shape} shape)`;if("identify"===h.mode){const e=f.root||"",s=bo(t.root),r=dl.find(e=>e.value===s||e.altValue===s),a=r&&(e===r.value||r.altValue&&e===r.altValue);n=a&&f.quality===t.quality&&f.shape===t.shape}else{const e=t.notes,s=f.notes||[],r=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};if(e.length!==s.length)n=!1;else{const t=new Set(s.map(e=>`${e.string}-${e.fret}`)),a=r(t,new Set(e.map(e=>`${e.string}-${e.fret}`))),o=r(t,new Set(e.map(e=>`${e.string}-${e.fret+12}`)));n=a||o}}const m=n?r+1:r,p=o+1;n?(a(m),c({message:"Correct!",type:"correct"})):c({message:`Incorrect! It was ${l}.`,type:"incorrect"}),i(p),s&&s({wasCorrect:n,score:m,totalAsked:p}),x(e=>[...e,{question:h,userAnswer:f,wasCorrect:n}]),d(!0),e&&n&&(y.current=setTimeout(j,2e3))},[u,f,h,j,s,r,o]),N=(0,e.useMemo)(()=>w?g[b]:{question:h,userAnswer:f},[w,g,b,h,f]);return{score:r,totalAsked:o,feedback:l,isAnswered:u,currentQuestion:h,userAnswer:f,setUserAnswer:p,history:g,reviewIndex:b,setReviewIndex:v,isReviewing:w,itemToDisplay:N,generateNewQuestion:j,checkAnswer:k,handleAnswerSelect:(e,t)=>{u||w||p(n=>({...n,[e]:t}))},handleFretClick:(e,t)=>{if(u||w||"construct"!==(null===h||void 0===h?void 0:h.mode))return;const n=`${e}-${t}`,s=f.notes||[];let r;if(s.some(e=>`${e.string}-${e.fret}`===n))r=s.filter(e=>`${e.string}-${e.fret}`!==n);else{const n=Do[6-e][t],a=Ao[h.answer.root],o=(n.midi-a)%12,i=ho[o<0?o+12:o],l={string:e,fret:t,label:n.note,midi:n.midi,isRoot:n.midi%12===a%12,degree:i};r=[...s,l]}p({notes:r})},handleReviewNav:e=>v(t=>{const n=t+e;return n>=0&&n<g.length?n:t}),handleEnterReview:()=>{g.length>0&&(clearTimeout(y.current),v(g.length-1))}}})(p,k,o),{score:C,totalAsked:_,feedback:S,isAnswered:T,history:A,reviewIndex:M,setReviewIndex:E,isReviewing:D,itemToDisplay:R,handleAnswerSelect:I,handleFretClick:P,checkAnswer:O,generateNewQuestion:F,userAnswer:L,setUserAnswer:q}=N;(0,e.useEffect)(()=>{var e;v&&"identify"===(null===(e=R.question)||void 0===e?void 0:e.mode)&&L.root&&L.quality&&L.shape&&O(v)},[L,v,O,R.question]),(0,e.useEffect)(()=>{const e=e=>{const t=e.target.tagName.toLowerCase();if("input"===t||"textarea"===t||"select"===t)return;const n=!(A.length>0)||A[A.length-1].wasCorrect;"Enter"!==e.key||!T||v&&n||(e.preventDefault(),F())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[T,v,A,F]);const V=(0,e.useMemo)(()=>{if(null===R||void 0===R||!R.question)return[];const{question:e,userAnswer:t}=R,n=e=>e?x.showDegrees?e.degree:e.label:"";if(!T&&!D){if("identify"===e.mode)return e.notes.map(e=>({...e,label:e.isRoot&&x.showRootHint?"R":"",isRoot:e.isRoot&&x.showRootHint}));if("construct"===e.mode){const t=(L.notes||[]).map(e=>({...e,isRoot:!1,overrideColor:"#3b82f6",label:"",degree:""}));return[...e.notes.filter(e=>-1===e.fret),...t]}}if(T||D){const s=D?R.wasCorrect:A.length>0&&A[A.length-1].wasCorrect,r=t.notes||[],a=e.answer.notes,o=e.notes.filter(e=>-1===e.fret);if(s){return[...a.map(e=>({...e,overrideLabel:n(e),overrideColor:e.isRoot?"#166534":"#22c55e"})),...o]}{const e=new Set(a.map(e=>`${e.string}-${e.fret}`));return[...a.map(e=>({...e,overrideLabel:n(e),overrideColor:e.isRoot?"#166534":"#22c55e"})),...r.filter(t=>!e.has(`${t.string}-${t.fret}`)).map(e=>({...e,overrideLabel:n(e),overrideColor:"#ef4444"})),...o]}}return[]},[R,T,D,x.showDegrees,x.showRootHint,L.notes,A]),z=(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Auto-Advance"}),(0,Lo.jsxs)("div",{className:"relative",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:v,onChange:()=>y(e=>!e),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-2 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),G=!(A.length>0)||A[A.length-1].wasCorrect,B=D?(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-4 w-full",children:[(0,Lo.jsx)("button",{onClick:()=>N.handleReviewNav(-1),disabled:0===M,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Prev"}),(0,Lo.jsxs)("div",{className:"flex-grow max-w-xs flex flex-col items-center gap-2",children:[(0,Lo.jsx)("button",{onClick:()=>E(null),className:"bg-purple-600 hover:bg-purple-500 font-bold p-3 rounded-lg text-xl w-full",children:"Return to Quiz"}),(0,Lo.jsx)(fl,{isChecked:x.showDegrees,onChange:()=>j("display","showDegrees")})]}),(0,Lo.jsx)("button",{onClick:()=>N.handleReviewNav(1),disabled:M===A.length-1,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Next"})]}):!T||v&&G?null:(0,Lo.jsx)("button",{onClick:F,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg animate-pulse",children:"Next Question"});return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsx)($o,{isOpen:d,onClose:()=>h(!1),title:"CAGED System Quiz Guide",children:(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsx)("p",{children:"This quiz tests your knowledge of the CAGED system on the guitar fretboard."}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Identify Mode"}),(0,Lo.jsx)("p",{children:"A chord shape will be shown on the fretboard with blank notes. Identify its Root Note, Quality, and base CAGED Shape."})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Construct Mode"}),(0,Lo.jsx)("p",{children:'You will be given a chord and a shape name (e.g., "G Major - E Shape"). Click the correct frets on the empty fretboard to build the shape.'})]}),(0,Lo.jsx)("p",{children:"Use the **Controls** panel to select which shapes and qualities to include in the quiz."})]})}),(0,Lo.jsxs)(Wo,{title:"CAGED System Quiz",score:C,totalAsked:_,history:A,isReviewing:D,onStartReview:N.handleEnterReview,topControls:z,footerContent:B,onLogProgress:()=>{const e=prompt("Enter any remarks for this session:",`Score: ${C} / ${_}`);null!==e&&(i({game:"CAGED Fretboard Quiz",date:(new Date).toLocaleDateString(),remarks:e}),alert("Session logged!"))},onToggleControls:()=>f(e=>!e),onShowInfo:()=>h(!0),children:["construct"===(null===(n=R.question)||void 0===n?void 0:n.mode)&&!D&&(0,Lo.jsx)("div",{className:"text-center text-2xl font-semibold text-gray-400 my-4",children:null===(s=R.question)||void 0===s?void 0:s.prompt}),(0,Lo.jsx)("div",{className:"my-4",children:(0,Lo.jsx)(Ii,{notesToDisplay:V,onBoardClick:P,showLabels:x.showDegrees||T||D})}),(0,Lo.jsx)("div",{className:"my-4 min-h-[60px] flex flex-col justify-center",children:D?(()=>{if(!D)return null;const{question:e,userAnswer:t,wasCorrect:n}=R,s=bo(e.answer.root),r=`${dl.find(e=>e.value===s||e.altValue===s).display} ${e.answer.quality} (${e.answer.shape} shape)`;let a;return a="identify"===e.mode?`${t.root||"?"} ${t.quality||"?"} (${t.shape||"?"})`:t.notes&&t.notes.length>0?t.notes.map(e=>e.label).join(", "):"No answer",(0,Lo.jsxs)("div",{className:"text-center p-3 rounded-lg "+(n?"bg-green-900/50":"bg-red-900/50"),children:[(0,Lo.jsxs)("p",{className:"font-bold text-gray-200",children:["Correct Answer: ",(0,Lo.jsx)("span",{className:"text-teal-300 font-semibold",children:r})]}),!n&&(0,Lo.jsxs)("p",{className:"mt-1",children:[(0,Lo.jsx)("span",{className:"font-bold text-gray-300",children:"Your Answer:"})," ",(0,Lo.jsx)("span",{className:"text-red-400 font-semibold",children:a})]})]})})():(0,Lo.jsx)("p",{className:"text-lg font-bold text-center "+("correct"===S.type?"text-green-400":"text-red-400"),children:S.message||(0,Lo.jsx)(Lo.Fragment,{children:"\xa0"})})}),!D&&"identify"===(null===(r=R.question)||void 0===r?void 0:r.mode)&&(0,Lo.jsxs)("div",{className:"space-y-4 max-w-2xl mx-auto",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-base font-semibold text-gray-400 mb-2",children:"Root Note"}),(0,Lo.jsx)("div",{className:"grid grid-cols-6 md:grid-cols-12 gap-1",children:dl.map(e=>(0,Lo.jsx)("button",{onClick:()=>I("root",e.value),disabled:T,className:"py-3 px-1 rounded font-semibold text-xs md:text-sm "+(L.root===e.value||L.root===e.altValue?"bg-indigo-600 text-white":"bg-teal-600 hover:bg-teal-500"),children:e.display},e.value))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-base font-semibold text-gray-400 mb-2",children:"Quality"}),(0,Lo.jsx)("div",{className:"grid grid-cols-2 gap-2",children:["major","minor"].map(e=>(0,Lo.jsx)("button",{onClick:()=>I("quality",e),disabled:T,className:"py-3 font-semibold capitalize text-base "+(L.quality===e?"bg-indigo-600 text-white":"bg-teal-600 hover:bg-teal-500"),children:e},e))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-base font-semibold text-gray-400 mb-2",children:"Shape"}),(0,Lo.jsx)("div",{className:"grid grid-cols-5 gap-2",children:hl.map(e=>(0,Lo.jsx)("button",{onClick:()=>I("shape",e),disabled:T,className:"py-3 font-semibold text-base "+(L.shape===e?"bg-indigo-600 text-white":"bg-teal-600 hover:bg-teal-500"),children:e},e))})]})]}),!D&&"construct"===(null===(a=R.question)||void 0===a?void 0:a.mode)&&!T&&(0,Lo.jsxs)("div",{className:"flex justify-center gap-4 max-w-lg mx-auto",children:[(0,Lo.jsx)("button",{onClick:()=>q({notes:[]}),className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg",children:"Clear"}),(0,Lo.jsx)("button",{onClick:()=>O(v),disabled:!L.notes||0===L.notes.length,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg disabled:bg-gray-500",children:"Submit"})]})]}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out "+(m?"w-80 p-4":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!m&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(ml,{quizMode:p,onQuizModeChange:g,settings:x,onSettingToggle:j,onSavePreset:w})]})}),m&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>f(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(ml,{quizMode:p,onQuizModeChange:g,settings:x,onSettingToggle:j,onSavePreset:w})})]})})]})},gl=["Major","Minor","Diminished","Augmented","Sus2","Sus4"],xl=["Root","1st","2nd"],bl={"E A D":[6,5,4],"A D G":[5,4,3],"D G B":[4,3,2],"G B e":[3,2,1]},vl=[{value:"A",display:"A"},{value:"A#",display:"A\u266f/B\u266d"},{value:"B",display:"B"},{value:"C",display:"C"},{value:"C#",display:"C\u266f/D\u266d"},{value:"D",display:"D"},{value:"D#",display:"D\u266f/E\u266d"},{value:"E",display:"E"},{value:"F",display:"F"},{value:"F#",display:"F\u266f/G\u266d"},{value:"G",display:"G"},{value:"G#",display:"G\u266f/A\u266d"}],yl=e=>{let{title:t,children:n}=e;return(0,Lo.jsxs)("details",{className:"border-t border-slate-600/80 pt-3 mt-3",open:!0,children:[(0,Lo.jsxs)("summary",{className:"w-full flex justify-between items-center text-left text-lg font-bold text-teal-300 hover:text-teal-200 cursor-pointer list-none",children:[(0,Lo.jsx)("span",{children:t}),(0,Lo.jsx)("span",{className:"text-xl transition-transform transform duration-200 group-open:rotate-90",children:"\u25b6"})]}),(0,Lo.jsx)("div",{className:"pt-3 space-y-3",children:n})]})},wl=e=>{let{label:t,isChecked:n,onChange:s}=e;return(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 bg-slate-600 rounded-md",children:[(0,Lo.jsx)("span",{className:"capitalize font-medium text-sm",children:t.replace("construct","Construct ").replace(/([A-Z])/g," $1")}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:n,onChange:s,className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})},jl=e=>{let{settings:t,onSettingChange:n,onSavePreset:s}=e;const r=(e,s)=>{n(e,{...t[e],[s]:!t[e][s]})},a=t.modes.constructVertically;return(0,Lo.jsxs)("div",{className:"space-y-4",children:[(0,Lo.jsxs)(yl,{title:"Game Settings",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Modes"}),(0,Lo.jsx)("div",{className:"flex flex-col gap-2",children:Object.keys(t.modes).map(e=>(0,Lo.jsx)(wl,{label:e,isChecked:t.modes[e],onChange:()=>r("modes",e)},e))})]}),(0,Lo.jsxs)("div",{className:a?"opacity-50":"",children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"String Sets"}),(0,Lo.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(t.stringSets).map(e=>(0,Lo.jsx)("button",{onClick:()=>!a&&r("stringSets",e),className:"p-2 rounded-md font-semibold text-sm "+(t.stringSets[e]?"bg-blue-600 text-white":"bg-slate-600"),children:e},e))}),a&&(0,Lo.jsx)("p",{className:"text-xs text-amber-300 mt-1",children:"String sets are not applicable for this mode."})]})]}),(0,Lo.jsxs)(yl,{title:"Triad Options",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Qualities"}),(0,Lo.jsx)("div",{className:"grid grid-cols-3 gap-2",children:Object.keys(t.qualities).map(e=>(0,Lo.jsx)("button",{onClick:()=>r("qualities",e),className:"p-2 rounded-md font-semibold text-xs "+(t.qualities[e]?"bg-blue-600 text-white":"bg-slate-600"),children:e},e))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Inversions"}),(0,Lo.jsx)("div",{className:"grid grid-cols-3 gap-2",children:Object.keys(t.inversions).map(e=>(0,Lo.jsx)("button",{onClick:()=>r("inversions",e),className:"p-2 rounded-md font-semibold text-xs "+(t.inversions[e]?"bg-blue-600 text-white":"bg-slate-600"),children:e},e))})]})]}),(0,Lo.jsxs)(yl,{title:"Display Options",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"font-semibold text-lg text-teal-300 mb-2",children:"Post-Answer Display"}),(0,Lo.jsxs)("div",{className:"flex bg-slate-600 rounded-md p-1",children:[(0,Lo.jsx)("button",{onClick:()=>n("postAnswerDisplay","degrees"),className:"flex-1 rounded-md text-sm py-1 "+("degrees"===t.postAnswerDisplay?"bg-blue-600 text-white":"text-gray-300"),children:"Degrees"}),(0,Lo.jsx)("button",{onClick:()=>n("postAnswerDisplay","names"),className:"flex-1 rounded-md text-sm py-1 "+("names"===t.postAnswerDisplay?"bg-blue-600 text-white":"text-gray-300"),children:"Note Names"})]})]}),(0,Lo.jsx)("div",{className:"pt-2",children:(0,Lo.jsx)(wl,{label:"Show Root Hint (Identify Mode)",isChecked:t.showRootHint,onChange:()=>n("showRootHint",!t.showRootHint)})})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:s,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},kl=t=>{var n;let{onProgressUpdate:s}=t;const{addLogEntry:r,savePreset:a,presetToLoad:o,clearPresetToLoad:i}=Vo(),[l,c]=(0,e.useState)(!1),[u,d]=(0,e.useState)(!1),[h,m]=(0,e.useState)({modes:{identify:!0,constructHorizontally:!0,constructVertically:!0},stringSets:{"E A D":!0,"A D G":!0,"D G B":!0,"G B e":!0},qualities:{Major:!0,Minor:!0,Diminished:!1,Augmented:!1,Sus2:!1,Sus4:!1},inversions:{Root:!0,"1st":!0,"2nd":!0},autoAdvance:!0,postAnswerDisplay:"degrees",showRootHint:!1});(0,e.useEffect)(()=>{o&&"fretboard-triads"===o.gameId&&(m(e=>({...e,...o.settings,modes:{...e.modes,...o.settings.modes},stringSets:{...e.stringSets,...o.settings.stringSets},qualities:{...e.qualities,...o.settings.qualities},inversions:{...e.inversions,...o.settings.inversions}})),i())},[o,i]);const f=((t,n)=>{const[s,r]=(0,e.useState)(0),[a,o]=(0,e.useState)(0),[i,l]=(0,e.useState)({message:"",type:""}),[c,u]=(0,e.useState)(!1),[d,h]=(0,e.useState)(null),[m,f]=(0,e.useState)({}),[p,g]=(0,e.useState)([]),[x,b]=(0,e.useState)(null),v=(0,e.useRef)(null),y=null!==x,w=(0,e.useRef)(d);(0,e.useEffect)(()=>{w.current=d},[d]);const j=(0,e.useCallback)(()=>{clearTimeout(v.current),b(null);const{modes:e,qualities:n,stringSets:s,inversions:r}=t,a=Object.keys(e).filter(t=>e[t]),o=Object.keys(n).filter(e=>n[e]),i=Object.keys(s).filter(e=>s[e]),c=Object.keys(r).filter(e=>r[e]);if(0===a.length||0===o.length||0===c.length||0===i.length&&a.some(e=>"constructVertically"!==e))return void h({prompt:{text1:"Please select options in Controls to begin."}});const d=a[Math.floor(Math.random()*a.length)];let m=null,p=0;for(;!m&&p<50;){p++;const e=o[Math.floor(Math.random()*o.length)],t=vl[Math.floor(Math.random()*vl.length)].value,n=vo(t),s=c[Math.floor(Math.random()*c.length)],r=w.current;if("identify"===d){const t=i[Math.floor(Math.random()*i.length)];if(null!==r&&void 0!==r&&r.answer&&"identify"===r.mode){const t=r.answer;if(t.root===n&&t.quality===e&&t.inversion===s)continue}const a=Po(n,e,s,bl[t]).filter(e=>e.every(e=>e.fret<=15));a.length>0&&(m={notes:a[Math.floor(Math.random()*a.length)],answer:{root:n,quality:e,inversion:s},prompt:{text1:"Identify the triad:"},mode:"identify"})}else if("constructHorizontally"===d){const t=i[Math.floor(Math.random()*i.length)];if(null!==r&&void 0!==r&&r.answer&&"constructHorizontally"===r.mode){const s=r.answer;if(s.root===n&&s.quality===e&&s.stringSetName===t)continue}let s=[];c.forEach(r=>{const a=Po(n,e,r,bl[t]);a.length>0&&s.push(...a[0])}),s.length===3*c.length&&(m={answer:{notes:s,root:n,quality:e,inversions:c,stringSetName:t},prompt:{text1:"Construct all ",highlight1:`${n} ${e}`,text2:" triads on the ",highlight2:`${t} strings`},mode:"constructHorizontally"})}else if("constructVertically"===d){if(null!==r&&void 0!==r&&r.answer&&"constructVertically"===r.mode){const t=r.answer;if(t.root===n&&t.quality===e&&t.inversion===s)continue}let t=[];Object.values(bl).forEach(r=>{const a=Po(n,e,s,r);a.length>0&&t.push(...a[0])}),t.length>0&&(m={answer:{notes:t,root:n,quality:e,inversion:s},prompt:{text1:"Construct all ",highlight1:`${n} ${e}`,text2:" triads in ",highlight2:`${s} inversion`},mode:"constructVertically"})}}h(m),u(!1),l({message:"",type:""}),f("identify"===d?{}:{notes:[]})},[t]);(0,e.useEffect)(()=>{j()},[j]);const k=(0,e.useCallback)(e=>{if(c||!d||!d.answer)return;let t=!1;if("identify"===d.mode){const{root:e,quality:n,inversion:s}=d.answer,r=po[m.root];t=r===po[e]&&m.quality===n&&m.inversion===s}else{const e=m.notes||[],n=d.answer.notes,s=new Set(n.map(e=>`${e.string}-${e.fret}`));t=e.length===n.length&&e.every(e=>s.has(`${e.string}-${e.fret}`))}const i=t?s+1:s,h=a+1;if(t)r(i),l({message:"Correct!",type:"correct"});else if("identify"===d.mode){const{root:e,quality:t,inversion:n}=d.answer;l({message:`Incorrect. The answer was ${e} ${t} (${n}).`,type:"incorrect"})}else l({message:"Incorrect. The correct answer is shown.",type:"incorrect"});o(h),n&&n({wasCorrect:t,score:i,totalAsked:h}),g(e=>[...e,{question:d,userAnswer:m,wasCorrect:t}]),u(!0),e&&t&&(v.current=setTimeout(j,2e3))},[c,m,d,j,n,s,a]),N=y?p[x]:{question:d,userAnswer:m};return{score:s,totalAsked:a,feedback:i,isAnswered:c,history:p,reviewIndex:x,setReviewIndex:b,isReviewing:y,itemToDisplay:N,generateNewQuestion:j,checkAnswer:k,handleAnswerSelect:(e,t)=>{c||y||f(n=>({...n,[e]:t}))},handleFretClick:(e,t)=>{if(c||y||"identify"===(null===d||void 0===d?void 0:d.mode))return;const n=`${e}-${t}`,s=m.notes||[];let r;if(s.some(e=>`${e.string}-${e.fret}`===n))r=s.filter(e=>`${e.string}-${e.fret}`!==n);else{const n=Do[6-e][t];r=[...s,{string:e,fret:t,label:n.note,midi:n.midi}]}f({notes:r})},userAnswer:m,setUserAnswer:f,handleReviewNav:e=>b(t=>{const n=t+e;return n>=0&&n<p.length?n:t}),handleEnterReview:()=>{p.length>0&&(clearTimeout(v.current),b(p.length-1))}}})((0,e.useMemo)(()=>({modes:h.modes,stringSets:h.stringSets,qualities:h.qualities,inversions:h.inversions}),[h.modes,h.stringSets,h.qualities,h.inversions]),s),{itemToDisplay:p,isAnswered:g,isReviewing:x,history:b,userAnswer:v}=f;(0,e.useEffect)(()=>{var e;h.autoAdvance&&!g&&!x&&"identify"===(null===(e=p.question)||void 0===e?void 0:e.mode)&&v.root&&v.quality&&v.inversion&&f.checkAnswer(!0)},[v,h.autoAdvance,g,x,p.question,f]);const y=(e,t)=>{m(n=>({...n,[e]:t}))},w=()=>{const e=prompt("Enter a name for your preset:","Fretboard Triads Custom");e&&""!==e.trim()&&(a({id:`ft-${Date.now()}`,name:e.trim(),gameId:"fretboard-triads",gameName:"Fretboard Triads",settings:h}),alert(`Preset "${e.trim()}" saved!`))},j=(0,e.useMemo)(()=>{var e;if(null===p||void 0===p||!p.question||!p.question.notes&&(null===(e=p.question.answer)||void 0===e||!e.notes))return[];const{question:t}=p;if(g||x){var n;const{root:e,quality:s}=t.answer,r={},a=wo(e,s),o=null===(n=So[s])||void 0===n?void 0:n.intervals,i=po[e];a&&o&&void 0!==i&&o.forEach((e,t)=>{const n=(i+e)%12;a[t]&&(r[n]=a[t])});const l=e=>{if("degrees"===h.postAnswerDisplay)return e.degree;const t=e.midi%12;return r[t]||e.label},c=x?p.wasCorrect:b.length>0&&b[b.length-1].wasCorrect,u=t.answer.notes||t.notes,d=u.map(e=>({...e,overrideLabel:l(e),overrideColor:e.isRoot?"#22c55e":"#3b82f6"}));if(c)return d;const m=p.userAnswer.notes||[],f=new Set(u.map(e=>`${e.string}-${e.fret}`)),g=m.filter(e=>!f.has(`${e.string}-${e.fret}`)).map(e=>({...e,label:l(e),overrideColor:"#f97316"}));return[...d,...g]}return"identify"===t.mode?h.showRootHint?t.notes.map(e=>({...e,label:"",overrideColor:e.isRoot?"#22c55e":void 0})):t.notes.map(e=>({...e,isRoot:!1,label:""})):(v.notes||[]).map(e=>({...e,overrideColor:"#3b82f6"}))},[p,g,x,v.notes,b,h.postAnswerDisplay,h.showRootHint]),k=(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Auto-Advance"}),(0,Lo.jsxs)("div",{className:"relative",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:h.autoAdvance,onChange:()=>y("autoAdvance",!h.autoAdvance),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer peer-focus:ring-2 peer-focus:ring-blue-300 peer-checked:after:translate-x-full after:content[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),N=!(b.length>0)||b[b.length-1].wasCorrect,C=x?(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-4 w-full",children:[(0,Lo.jsx)("button",{onClick:()=>f.handleReviewNav(-1),disabled:0===f.reviewIndex,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Prev"}),(0,Lo.jsx)("button",{onClick:()=>f.setReviewIndex(null),className:"bg-purple-600 hover:bg-purple-500 font-bold p-3 rounded-lg text-xl",children:"Return to Quiz"}),(0,Lo.jsx)("button",{onClick:()=>f.handleReviewNav(1),disabled:f.reviewIndex===b.length-1,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Next"})]}):!g||h.autoAdvance&&N?g||"identify"!==(null===(n=p.question)||void 0===n?void 0:n.mode)||h.autoAdvance?null:(0,Lo.jsx)("button",{onClick:()=>f.checkAnswer(h.autoAdvance),className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg",children:"Submit"}):(0,Lo.jsx)("button",{onClick:f.generateNewQuestion,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg animate-pulse",children:"Next Question"});return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsxs)($o,{isOpen:l,onClose:()=>c(!1),title:"Fretboard Triads Guide",children:[(0,Lo.jsx)("p",{children:"Test your knowledge of triad shapes and inversions across the fretboard."}),(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-4",children:"Game Modes"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside text-sm space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Identify:"})," A triad shape is shown. You must identify its root, quality, and inversion."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Construct Horizontally:"})," You're given a triad and a string set. Find all three inversions on those strings."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Construct Vertically:"})," You're given a triad and an inversion. Find that specific shape on all possible string sets."]})]}),(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-4",children:"Display Options"}),(0,Lo.jsx)("ul",{className:"list-disc list-inside text-sm space-y-1",children:(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Show Root Hint:"})," In 'Identify' mode, the root note of the triad will be colored green to help you find your bearings. This is off by default."]})})]}),(0,Lo.jsxs)(Wo,{title:"Fretboard Triads",score:f.score,totalAsked:f.totalAsked,history:b,isReviewing:x,onStartReview:f.handleEnterReview,topControls:k,footerContent:C,onLogProgress:()=>{const e=prompt("Enter any remarks for this session:",`Score: ${f.score}/${f.totalAsked}`);null!==e&&(r({game:"Fretboard Triads",date:(new Date).toLocaleDateString(),remarks:e}),alert("Session logged!"))},onToggleControls:()=>d(e=>!e),onShowInfo:()=>c(!0),children:[(0,Lo.jsx)("div",{className:"text-center text-xl sm:text-2xl font-semibold text-gray-300 my-4",children:(()=>{var e;const t=null===(e=p.question)||void 0===e?void 0:e.prompt;return t?(0,Lo.jsxs)("span",{children:[t.text1,t.highlight1&&(0,Lo.jsx)("strong",{className:"text-teal-300",children:t.highlight1}),t.text2,t.highlight2&&(0,Lo.jsx)("strong",{className:"text-teal-300",children:t.highlight2})]}):null})()}),(0,Lo.jsx)("div",{className:"my-4",children:(0,Lo.jsx)(Ii,{notesToDisplay:j,onBoardClick:f.handleFretClick,showLabels:g||x})}),(0,Lo.jsx)("div",{className:"my-4 min-h-[60px] flex flex-col justify-center",children:(0,Lo.jsx)("p",{className:"text-lg font-bold text-center "+("correct"===f.feedback.type?"text-green-400":"text-red-400"),children:f.feedback.message||(0,Lo.jsx)(Lo.Fragment,{children:"\xa0"})})}),!p.question||x?null:"identify"===p.question.mode?(0,Lo.jsxs)("div",{className:"space-y-4 max-w-2xl mx-auto",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-base font-semibold text-gray-400 mb-2",children:"Root Note"}),(0,Lo.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-1",children:vl.map(e=>(0,Lo.jsx)("button",{onClick:()=>f.handleAnswerSelect("root",e.value),className:"py-3 px-1 rounded font-semibold text-xs md:text-sm "+(v.root===e.value?"bg-indigo-600 text-white":"bg-teal-600 hover:bg-teal-500"),children:e.display},e.value))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-base font-semibold text-gray-400 mb-2",children:"Quality"}),(0,Lo.jsx)("div",{className:"grid grid-cols-3 gap-2",children:gl.map(e=>(0,Lo.jsx)("button",{onClick:()=>f.handleAnswerSelect("quality",e),disabled:!h.qualities[e],className:`py-3 font-semibold capitalize text-base ${v.quality===e?"bg-indigo-600 text-white":"bg-teal-600 hover:bg-teal-500"} disabled:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed`,children:e},e))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h3",{className:"text-base font-semibold text-gray-400 mb-2",children:"Inversion"}),(0,Lo.jsx)("div",{className:"grid grid-cols-3 gap-2",children:xl.map(e=>(0,Lo.jsx)("button",{onClick:()=>f.handleAnswerSelect("inversion",e),className:"py-3 font-semibold text-base "+(v.inversion===e?"bg-indigo-600 text-white":"bg-teal-600 hover:bg-teal-500"),children:e},e))})]})]}):g?null:(0,Lo.jsxs)("div",{className:"flex justify-center gap-4 max-w-lg mx-auto",children:[(0,Lo.jsx)("button",{onClick:()=>f.setUserAnswer({notes:[]}),className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg",children:"Clear"}),(0,Lo.jsx)("button",{onClick:()=>f.checkAnswer(h.autoAdvance),disabled:!v.notes||0===v.notes.length,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg disabled:bg-gray-500",children:"Submit"})]})]}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out "+(u?"w-80 p-4":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!u&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(jl,{settings:h,onSettingChange:y,onSavePreset:w})]})}),u&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>d(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(jl,{settings:h,onSettingChange:y,onSavePreset:w})})]})})]})},Nl=[{name:"Minor 2nd",semitones:1},{name:"Major 2nd",semitones:2},{name:"Minor 3rd",semitones:3},{name:"Major 3rd",semitones:4},{name:"Perfect 4th",semitones:5},{name:"Tritone",semitones:6},{name:"Perfect 5th",semitones:7},{name:"Minor 6th",semitones:8},{name:"Major 6th",semitones:9},{name:"Minor 7th",semitones:10},{name:"Major 7th",semitones:11},{name:"Octave",semitones:12}],Cl=Object.fromEntries(Object.entries(ho).map(e=>{let[t,n]=e;return[n,parseInt(t,10)]})),_l=e=>{for(let t=Do.length-1;t>=0;t--)for(let n=0;n<=12;n++)if(Do[t][n].midi===e)return`${6-t}-${n}`;return null},Sl=()=>{const e={};return Nl.forEach(t=>{e[t.name]={correct:0,incorrect:0,weight:10}}),e},Tl=(e,t,n)=>{const s=Mo(t,n),r=e%12;for(const a of s)if(Ao[a]%12===r)return a;return{0:"C",1:"C#",2:"D",3:"Eb",4:"E",5:"F",6:"F#",7:"G",8:"Ab",9:"A",10:"Bb",11:"B"}[r]||""},Al=(t,n)=>{const{fretboardPlayers:s,areFretboardSoundsReady:r,unlockAudio:a,setDroneNote:o}=Vo(),[i,l]=(0,e.useState)(0),[c,u]=(0,e.useState)(0),[d,h]=(0,e.useState)(null),[m,f]=(0,e.useState)({message:"",type:""}),[p,g]=(0,e.useState)(!1),[x,b]=(0,e.useState)([]),[v,y]=(0,e.useState)(null),[w,j]=(0,e.useState)(()=>Sl()),[k,N]=(0,e.useState)({intervals:[],degrees:[]}),[C,_]=(0,e.useState)(null),S=(0,e.useRef)("C"),T=(0,e.useRef)(0),A=(0,e.useRef)(null);(0,e.useEffect)(()=>{j(Sl())},[t.isTrainingMode]);const M=(0,e.useCallback)(()=>{clearTimeout(A.current),y(null);let e=!1;if("Roving"===t.rootNoteMode&&T.current>0&&T.current%t.questionsPerRoot===0){const t=["C","G","D","A","E","F","Bb"];let n=S.current;for(;n===S.current;)n=t[Math.floor(Math.random()*t.length)];S.current=n,e=!0}else"Fixed"===t.rootNoteMode&&(S.current!==t.fixedKey&&(e=!0),S.current=t.fixedKey);if(t.useDrone&&o(S.current),e&&t.showKeyChange){const e="Diatonic"===t.notePool?t.diatonicMode:"";_(`New Key: ${S.current} ${e}`.trim()),setTimeout(()=>_(null),2500)}let n=null,s=0;for(;null===n&&s<100;){s++;const e=Ao[S.current];let r;const a="Minor"===t.diatonicMode?"Natural Minor":"Major";let o,i=Nl;if("Diatonic"===t.notePool){const e=Mo(S.current,a),t=Ao[S.current]%12,n=e.map(e=>Ao[e]%12),s=Nl.filter(e=>n.includes((t+e.semitones)%12)),r=s.map(e=>ho[e.semitones%12]);N({intervals:s.map(e=>e.name),degrees:[...new Set(r)]}),i=s}else N({intervals:[],degrees:[]});if("Note Names"===t.answerMode&&(i=i.filter(e=>"Octave"!==e.name)),r=e+12*Math.floor(Math.random()*t.octaveRange),t.isTrainingMode&&i.length>0){const e=i.map(e=>{var t;return(null===(t=w[e.name])||void 0===t?void 0:t.weight)||1}),t=e.reduce((e,t)=>e+t,0);let n=Math.random()*t;for(let s=0;s<i.length;s++)if(n-=e[s],n<=0){o=i[s];break}}else i.length>0&&(o=i[Math.floor(Math.random()*i.length)]);if(!o)continue;const l="Both"===t.direction?Math.random()<.5?1:-1:"Ascending"===t.direction?1:-1,c=r+o.semitones*l;_l(r)&&_l(c)&&(n={rootMidi:r,targetMidi:c,answer:{intervalName:o.name,scaleDegree:ho[(c-r+60)%12],noteName:Tl(c,S.current,a)}})}n?h(n):console.error("Failed to generate a valid, playable question. Please check settings."),g(!1),f({message:"",type:""})},[t,w,o]);(0,e.useEffect)(()=>{T.current=0,M()},[JSON.stringify(t)]);const E=(0,e.useCallback)(async e=>{const n=e||d;if(!n||!r||!s.current)return;await a();const o=_l(n.rootMidi),i=_l(n.targetMidi);if(!o||!i)return;const l=io(),c=(e,t)=>{s.current.has(e)&&s.current.player(e).start(t)};"Harmonic"===t.playbackStyle?(t.useDrone&&!t.playRootNote||c(o,l),c(i,l)):t.useDrone&&!t.playRootNote?c(i,l):(c(o,l),c(i,l+.7))},[d,r,a,s,t]),D=(0,e.useCallback)(e=>{if(p||!d||null===e)return;const s=d.answer;let r=!1,a="";"Interval Name"===t.answerMode?(r=e===s.intervalName,a=s.intervalName):"Scale Degree"===t.answerMode?(r=e===s.scaleDegree,a=s.scaleDegree):"Note Names"===t.answerMode&&(r=e===s.noteName,a=s.noteName);const o=r?i+1:i,h=c+1;r?(l(o),f({message:"Correct!",type:"correct"})):f({message:`Incorrect! The answer was ${a}.`,type:"incorrect"}),j(e=>{const t=s.intervalName;if(!e[t])return e;const n={...e[t]};return r?n.correct+=1:n.incorrect+=1,n.weight=Math.max(1,10+20*n.incorrect-2*n.correct),{...e,[t]:n}}),T.current+=1,u(h),b(n=>[...n,{question:d,userAnswer:Array.isArray(e)?e.join(", "):e,wasCorrect:r,answerMode:t.answerMode}]),g(!0),t.replayOnAnswer&&setTimeout(()=>E(d),500),n&&n({wasCorrect:r,score:o,totalAsked:h}),r&&t.autoAdvance&&(A.current=setTimeout(M,2500))},[p,d,t,M,i,c,n,E]),R=(0,e.useCallback)(async e=>{if(!e||!r)return;await a();const{question:t,userAnswer:n,answerMode:s}=e,o=t.rootMidi;let i=null;const l=t.targetMidi>o?1:-1;if("Interval Name"===s){const e=Nl.find(e=>e.name===n);e&&(i=o+e.semitones*l)}else if("Scale Degree"===s){const e=Cl[n];void 0!==e&&(i=o+e*l)}else if("Note Names"===s){const e=Ao[n];if(void 0!==e){const n=Math.abs(t.targetMidi-o);let s=e;[-24,-12,0,12,24].forEach(t=>{const r=e+t;Math.abs(r-o-n)<Math.abs(s-o-n)&&(s=r)}),i=s}}null!==o&&null!==i&&E({rootMidi:o,targetMidi:i})},[r,a,E]);return{score:i,totalAsked:c,feedback:m,isAnswered:p,currentQuestion:d,history:x,reviewIndex:v,setReviewIndex:y,generateNewQuestion:M,checkAnswer:D,handleReviewNav:e=>y(t=>{const n=t+e;return n>=0&&n<x.length?n:t}),startReview:()=>x.length>0&&y(x.length-1),playQuestionAudio:E,ALL_INTERVALS:Nl,diatonicOptions:k,newKeyNotification:C,currentKey:S.current,playUserAnswer:R}},Ml=["C","G","D","A","E","B","F#","F","Bb","Eb","Ab","Db"],El=e=>{let{title:t,isOpen:n,onToggle:s,children:r}=e;return(0,Lo.jsxs)("div",{className:"border-t border-slate-600/80 pt-3 mt-3",children:[(0,Lo.jsxs)("button",{onClick:s,className:"w-full flex justify-between items-center text-left text-lg font-bold text-teal-300 hover:text-teal-200",children:[(0,Lo.jsx)("span",{children:t}),(0,Lo.jsx)("span",{className:"text-xl",children:n?"\u2212":"+"})]}),n&&(0,Lo.jsx)("div",{className:"pt-3 space-y-3",children:r})]})},Dl=e=>{let{label:t,settingKey:n,settings:s,onSettingChange:r,highlight:a=!1,disabled:o=!1}=e;return(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 rounded-md "+(o?"bg-slate-800":"bg-slate-700"),children:[(0,Lo.jsx)("span",{className:`font-semibold ${a?"text-green-300":""} ${o?"text-gray-500":""}`,children:t}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:s[n],onChange:e=>r(n,e.target.checked),className:"sr-only peer",disabled:o}),(0,Lo.jsx)("div",{className:`w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all ${o?"cursor-not-allowed":"peer-focus:ring-4 peer-focus:ring-blue-300"} ${a?"peer-checked:bg-green-600":"peer-checked:bg-blue-600"}`})]})]})},Rl=e=>{let{label:t,settingKey:n,options:s,settings:r,onSettingChange:a}=e;return(0,Lo.jsxs)("div",{children:[t&&(0,Lo.jsx)("h4",{className:"font-semibold text-gray-300 mb-1",children:t}),(0,Lo.jsx)("div",{className:"flex bg-slate-600 rounded-md p-1",children:s.map(e=>(0,Lo.jsx)("button",{onClick:()=>a(n,e.value),className:"flex-1 rounded-md py-1 text-sm font-semibold "+(r[n]===e.value?"bg-blue-600 text-white":"text-gray-300"),children:e.label},e.value))})]})},Il=t=>{let{settings:n,onSettingChange:s,onSavePreset:r}=t;const[a,o]=(0,e.useState)({general:!0,playback:!1,question:!1}),i=e=>{o(t=>({...t,[e]:!t[e]}))};return(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsxs)(El,{title:"General Settings",isOpen:a.general,onToggle:()=>i("general"),children:[(0,Lo.jsx)(Dl,{label:"Training Mode",settingKey:"isTrainingMode",settings:n,onSettingChange:s,highlight:!0}),(0,Lo.jsx)(Dl,{label:"Replay on Answer",settingKey:"replayOnAnswer",settings:n,onSettingChange:s}),(0,Lo.jsx)(Rl,{label:"Answer Mode",settingKey:"answerMode",settings:n,onSettingChange:s,options:[{value:"Interval Name",label:"Interval Name"},{value:"Scale Degree",label:"Scale Degree"},{value:"Note Names",label:"Note Names"}]})]}),(0,Lo.jsxs)(El,{title:"Playback Options",isOpen:a.playback,onToggle:()=>i("playback"),children:[(0,Lo.jsx)(Rl,{label:"Playback Style",settingKey:"playbackStyle",settings:n,onSettingChange:s,options:[{value:"Melodic",label:"Melodic"},{value:"Harmonic",label:"Harmonic"}]}),(0,Lo.jsx)(Rl,{label:"Direction",settingKey:"direction",settings:n,onSettingChange:s,options:[{value:"Ascending",label:"Ascending"},{value:"Descending",label:"Descending"},{value:"Both",label:"Both"}]}),(0,Lo.jsx)(Dl,{label:"Use Drone",settingKey:"useDrone",settings:n,onSettingChange:s}),(0,Lo.jsx)(Dl,{label:"Play First Note",settingKey:"playRootNote",settings:n,onSettingChange:s,disabled:"Melodic"!==n.playbackStyle||!n.useDrone})]}),(0,Lo.jsxs)(El,{title:"Question Options",isOpen:a.question,onToggle:()=>i("question"),children:[(0,Lo.jsx)(Rl,{label:"Note Pool",settingKey:"notePool",settings:n,onSettingChange:s,options:[{value:"Chromatic",label:"Chromatic"},{value:"Diatonic",label:"Diatonic"}]}),"Diatonic"===n.notePool&&(0,Lo.jsx)(Rl,{label:"Diatonic Mode",settingKey:"diatonicMode",settings:n,onSettingChange:s,options:[{value:"Major",label:"Major"},{value:"Minor",label:"Minor"}]}),(0,Lo.jsx)(Rl,{label:"Key/Root Mode",settingKey:"rootNoteMode",settings:n,onSettingChange:s,options:[{value:"Fixed",label:"Fixed"},{value:"Roving",label:"Roving"}]}),"Fixed"===n.rootNoteMode&&(0,Lo.jsx)("select",{value:n.fixedKey,onChange:e=>s("fixedKey",e.target.value),className:"w-full p-2 mt-2 bg-slate-600 rounded-md",children:Ml.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))}),"Roving"===n.rootNoteMode&&(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)("div",{className:"flex items-center justify-between p-2 bg-slate-700 rounded-md",children:[(0,Lo.jsx)("label",{htmlFor:"qpr",className:"font-semibold",children:"Questions per Key:"}),(0,Lo.jsx)("input",{type:"number",id:"qpr",min:"1",max:"20",value:n.questionsPerRoot,onChange:e=>s("questionsPerRoot",Number(e.target.value)),className:"w-16 p-1 bg-slate-600 rounded-md text-center"})]}),(0,Lo.jsx)(Dl,{label:"Show Key Change Alert",settingKey:"showKeyChange",settings:n,onSettingChange:s})]}),(0,Lo.jsxs)("div",{className:"mt-2",children:[(0,Lo.jsxs)("label",{htmlFor:"octave-range",className:"font-semibold",children:["Octave Range: ",n.octaveRange]}),(0,Lo.jsx)("input",{type:"range",id:"octave-range",min:"1",max:"3",step:"1",value:n.octaveRange,onChange:e=>s("octaveRange",Number(e.target.value)),className:"w-full h-2 mt-1 bg-slate-600 rounded-lg appearance-none cursor-pointer"})]})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:r,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Current Settings as Preset"})})]})},Pl=t=>{let{onProgressUpdate:n}=t;const{addLogEntry:s,savePreset:r,presetToLoad:a,clearPresetToLoad:o}=Vo(),[i,l]=(0,e.useState)({autoAdvance:!0,isTrainingMode:!1,playbackStyle:"Melodic",direction:"Ascending",notePool:"Diatonic",diatonicMode:"Major",answerMode:"Interval Name",rootNoteMode:"Fixed",fixedKey:"C",questionsPerRoot:5,octaveRange:2,useDrone:!0,playRootNote:!0,showKeyChange:!1,replayOnAnswer:!1}),[c,u]=(0,e.useState)(!1),[d,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)(null),{score:p,totalAsked:g,feedback:x,isAnswered:b,currentQuestion:v,history:y,reviewIndex:w,setReviewIndex:j,generateNewQuestion:k,checkAnswer:N,handleReviewNav:C,startReview:_,playQuestionAudio:S,ALL_INTERVALS:T,diatonicOptions:A,newKeyNotification:M,currentKey:E,playUserAnswer:D}=Al(i,n);(0,e.useEffect)(()=>{a&&"interval-ear-trainer"===a.gameId&&(l(a.settings),o())},[a,o]);const R=null!==w;(0,e.useEffect)(()=>{if(v&&f(null),v&&!b&&!R){const e=M&&"Roving"===i.rootNoteMode?3e3:500,t=setTimeout(()=>S(),e);return()=>clearTimeout(t)}},[v,b,R,S,M,i.rootNoteMode]),(0,e.useEffect)(()=>{"Note Names"===i.answerMode&&i.autoAdvance&&null!==m&&!b&&N(m)},[m,i.autoAdvance,i.answerMode,b,N]);const I=(e,t)=>{l(n=>({...n,[e]:t}))},P=()=>{const e=(e=>{const t=[];return t.push("Diatonic"===e.notePool?`${e.diatonicMode}`:"Chromatic"),t.push("Fixed"===e.rootNoteMode?`${e.fixedKey}`:"Roving"),t.push(e.playbackStyle),"Melodic"===e.playbackStyle&&t.push(e.direction.slice(0,4)),t.join(" ")})(i),t=prompt("Enter a name for your preset:",e);t&&""!==t.trim()&&(r({id:Date.now().toString(),name:t.trim(),gameId:"interval-ear-trainer",gameName:"Interval Recognition",settings:i}),alert(`Preset "${t.trim()}" saved!`))},O=R?y[w]:null,F=R?null===O||void 0===O?void 0:O.question:v,L=b||R,q=()=>{const e="Diatonic"===i.notePool;if("Scale Degree"===i.answerMode){const t=Object.values(ho);return(0,Lo.jsx)("div",{className:"w-full grid grid-cols-4 md:grid-cols-6 gap-2",children:t.map(t=>{const n=L||e&&!A.degrees.includes(t);return(0,Lo.jsx)("button",{onClick:()=>N(t),disabled:n,className:"py-3 rounded-lg font-mono text-lg transition-colors disabled:opacity-30 bg-teal-600 hover:bg-teal-500",children:t},t)})})}if("Note Names"===i.answerMode){const e=(e=>["G","D","A","E","B","F#","C"].includes(e)?["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"]:["A","Bb","B","C","Db","D","Eb","E","F","Gb","G","Ab"])(E),t=e.indexOf(E),n=-1!==t?[...e.slice(t),...e.slice(0,t)]:e;return(0,Lo.jsxs)("div",{className:"w-full flex flex-col items-center gap-2",children:[(0,Lo.jsx)("p",{className:"text-sm text-gray-400",children:"The blue button is the given tonic. Select the second note you heard."}),(0,Lo.jsx)("div",{className:"grid grid-cols-6 gap-1 w-full",children:n.map(e=>{const t=e===E,n=m===e;return(0,Lo.jsx)("button",{onClick:()=>!t&&f(e),disabled:L||t,className:"py-3 rounded-md font-semibold disabled:opacity-80 \n                                        "+(t?"bg-blue-600 text-white cursor-default":n?"bg-indigo-600 text-white":"bg-teal-600 hover:bg-teal-500"),children:e.replace("b","\u266d").replace("#","\u266f")},e)})}),!i.autoAdvance&&(0,Lo.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,Lo.jsx)("button",{onClick:()=>f(null),disabled:L,className:"py-2 px-4 rounded-md bg-gray-600 hover:bg-gray-500",children:"Clear"}),(0,Lo.jsx)("button",{onClick:()=>N(m),disabled:L||!m,className:"py-2 px-4 rounded-md bg-blue-600 hover:bg-blue-500 disabled:bg-gray-500",children:"Submit"})]})]})}return(0,Lo.jsx)("div",{className:"w-full grid grid-cols-2 md:grid-cols-4 gap-2",children:T.map(t=>(0,Lo.jsx)("button",{onClick:()=>N(t.name),disabled:L||e&&!A.intervals.includes(t.name),className:"py-4 rounded-lg font-semibold text-lg transition-colors disabled:opacity-30 bg-teal-600 hover:bg-teal-500",children:t.name},t.name))})},V=e=>{if(!e||!e.question)return"";switch(e.answerMode){case"Note Names":return e.question.answer.noteName;case"Scale Degree":return e.question.answer.scaleDegree;default:return e.question.answer.intervalName}},z=(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Auto-Advance"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:i.autoAdvance,onChange:e=>I("autoAdvance",e.target.checked),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),G=R?(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("button",{type:"button",onClick:()=>C(-1),disabled:0===w,className:"p-3 rounded-lg bg-slate-600 hover:bg-slate-500",children:"Prev"}),(0,Lo.jsxs)("div",{className:"flex-grow flex flex-col gap-2",children:[(0,Lo.jsx)("button",{type:"button",onClick:()=>j(null),className:"bg-purple-600 p-3 rounded-lg font-bold",children:"Return to Quiz"}),!O.wasCorrect&&(0,Lo.jsx)("button",{onClick:()=>D(O),className:"text-sm py-1 px-2 rounded-md bg-orange-600 hover:bg-orange-500",children:"Replay Your Answer"})]}),(0,Lo.jsx)("button",{type:"button",onClick:()=>C(1),disabled:w===y.length-1,className:"p-3 rounded-lg bg-slate-600 hover:bg-slate-500",children:"Next"})]}):b?(0,Lo.jsxs)("div",{className:"flex items-center justify-center flex-wrap gap-2",children:["incorrect"===x.type&&(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)("button",{onClick:()=>S(v),className:"py-2 px-4 rounded-md bg-sky-600 hover:bg-sky-500",children:"Replay Question"}),(0,Lo.jsx)("button",{onClick:()=>D({question:v,userAnswer:y[y.length-1].userAnswer,answerMode:i.answerMode}),className:"py-2 px-4 rounded-md bg-orange-600 hover:bg-orange-500",children:"Replay Your Answer"})]}),(!i.autoAdvance||"incorrect"===x.type)&&(0,Lo.jsx)("button",{onClick:k,className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg",children:"Next Question"})]}):null;return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsx)($o,{isOpen:c,onClose:()=>u(!1),title:"Interval Recognition Guide",children:(0,Lo.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,Lo.jsx)("p",{children:"Listen to the interval and select the correct answer. Use the controls panel to customize your practice session."}),(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-2",children:"Core Features"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Training Mode:"})," Focuses on intervals you get wrong more often."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Playback:"})," Hear notes together (Harmonic) or one after another (Melodic), and in different directions."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Note Pool:"})," Practice with all notes (Chromatic) or within a Major/Minor key (Diatonic)."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Key/Root:"})," Keep the starting key fixed, or have it rove to a new key after a set number of questions."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Drone Assist:"})," Use the drone to establish a key center. You can even turn off the first note of the interval to rely solely on the drone for your reference."]})]})]})}),(0,Lo.jsx)(Wo,{title:"Interval Recognition",score:p,totalAsked:g,history:y,isReviewing:R,onStartReview:_,topControls:z,footerContent:G,onLogProgress:()=>{const e=prompt("Enter any remarks for this session:",`Score: ${p}/${g}`);null!==e&&(s({game:"Interval Ear Trainer",date:(new Date).toLocaleDateString(),remarks:e}),alert("Session logged!"))},onToggleControls:()=>h(e=>!e),onShowInfo:()=>u(!0),children:(0,Lo.jsxs)("div",{className:"w-full max-w-2xl mx-auto flex flex-col items-center relative",children:[M&&(0,Lo.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-black/80 text-white text-2xl font-bold p-6 rounded-lg z-20 animate-pulse-once",children:M}),(0,Lo.jsx)("div",{className:"w-full bg-slate-900/50 p-4 rounded-lg text-center min-h-[80px] flex justify-center items-center flex-wrap gap-x-2 mb-4",children:(0,Lo.jsx)("button",{onClick:()=>S(F),className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg text-xl",children:"Replay Sound"})}),(0,Lo.jsx)("div",{className:"text-xl my-4 min-h-[28px]",children:R?O.wasCorrect?(0,Lo.jsxs)("span",{className:"text-green-400 font-semibold",children:["Correct: ",V(O)]}):(0,Lo.jsxs)("span",{className:"text-gray-300",children:["Your Answer: ",(0,Lo.jsx)("span",{className:"text-red-400",children:O.userAnswer})," | Correct: ",(0,Lo.jsx)("span",{className:"text-teal-300",children:V(O)})]}):(0,Lo.jsx)("span",{className:"correct"===x.type?"text-green-400":"text-red-400",children:x.message||(0,Lo.jsx)(Lo.Fragment,{children:"\xa0"})})}),(0,Lo.jsx)(q,{})]})}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 "+(d?"w-80 p-4":"w-0 overflow-hidden"),children:d&&(0,Lo.jsx)(Il,{settings:i,onSettingChange:I,onSavePreset:P})}),d&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>h(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4 flex-shrink-0",children:"Settings & Controls"}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(Il,{settings:i,onSettingChange:I,onSavePreset:P})})]})})]})},Ol=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Fl=40,Ll=76,ql={Db:"C#",Eb:"D#",Gb:"F#",Ab:"G#",Bb:"A#"},Vl={1:0,b2:1,2:2,b3:3,3:4,4:5,"#4":6,b5:6,5:7,b6:8,6:9,b7:10,7:11},zl=e=>{for(let t=Do.length-1;t>=0;t--)for(let n=0;n<=12;n++)if(Do[t][n].midi===e)return`${6-t}-${n}`;return null},Gl=["C","G","D","A","E","B","F#","F","Bb","Eb","Ab","Db"],Bl=e=>{let{title:t,isOpen:n,onToggle:s,children:r}=e;return(0,Lo.jsxs)("div",{className:"border-t border-slate-600/80 pt-3 mt-3",children:[(0,Lo.jsxs)("button",{onClick:s,className:"w-full flex justify-between items-center text-left text-lg font-bold text-teal-300 hover:text-teal-200",children:[(0,Lo.jsx)("span",{children:t}),(0,Lo.jsx)("span",{className:"text-xl",children:n?"\u2212":"+"})]}),n&&(0,Lo.jsx)("div",{className:"pt-3 space-y-3",children:r})]})},$l=e=>{let{label:t,settingKey:n,settings:s,onSettingChange:r,disabled:a=!1}=e;return(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 rounded-md "+(a?"bg-slate-800":"bg-slate-700"),children:[(0,Lo.jsx)("span",{className:"font-semibold "+(a?"text-gray-500":""),children:t}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:s[n],onChange:e=>r(n,e.target.checked),className:"sr-only peer",disabled:a}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all "+(a?"cursor-not-allowed":"peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:bg-blue-600")})]})]})},Ul=e=>{let{label:t,settingKey:n,options:s,settings:r,onSettingChange:a}=e;return(0,Lo.jsxs)("div",{children:[t&&(0,Lo.jsx)("h4",{className:"font-semibold text-gray-300 mb-1",children:t}),(0,Lo.jsx)("div",{className:"flex bg-slate-600 rounded-md p-1",children:s.map(e=>(0,Lo.jsx)("button",{onClick:()=>a(n,e.value),className:"flex-1 rounded-md py-1 text-sm font-semibold "+(r[n]===e.value?"bg-blue-600 text-white":"text-gray-300"),children:e.label},e.value))})]})},Wl=t=>{let{settings:n,onSettingChange:s,onRandomKey:r,onSavePreset:a,volume:o,onVolumeChange:i,onApplySettings:l}=t;const[c,u]=(0,e.useState)({general:!0,melody:!1,reference:!1,key:!1}),d=e=>{u(t=>({...t,[e]:!t[e]}))};return(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsxs)(Bl,{title:"General Settings",isOpen:c.general,onToggle:()=>d("general"),children:[(0,Lo.jsx)(Ul,{label:"Answer Mode",settingKey:"answerMode",settings:n,onSettingChange:s,options:[{value:"Scale Degrees",label:"Scale Degrees"},{value:"Note Names",label:"Note Names"}]}),(0,Lo.jsx)($l,{label:"Replay on Answer",settingKey:"replayOnAnswer",settings:n,onSettingChange:s})]}),(0,Lo.jsxs)(Bl,{title:"Melody Options",isOpen:c.melody,onToggle:()=>d("melody"),children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{htmlFor:"melody-volume",className:"font-semibold text-gray-300 mb-1 block",children:"Melody Volume"}),(0,Lo.jsx)("input",{type:"range",id:"melody-volume",min:"-30",max:"0",step:"1",value:o,onChange:e=>i(Number(e.target.value)),className:"w-full h-3 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsxs)("label",{htmlFor:"melodyLength",children:["Notes in Melody: ",(0,Lo.jsx)("span",{className:"font-bold",children:n.melodyLength})]}),(0,Lo.jsx)("input",{type:"range",id:"melodyLength",min:"3",max:"8",value:n.melodyLength,onChange:e=>s("melodyLength",Number(e.target.value)),className:"w-1/2"})]}),(0,Lo.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Lo.jsxs)("label",{htmlFor:"octaveRange",children:["Octave Range: ",(0,Lo.jsx)("span",{className:"font-bold",children:n.octaveRange})]}),(0,Lo.jsx)("input",{type:"range",id:"octaveRange",min:"1",max:"3",value:n.octaveRange,onChange:e=>s("octaveRange",Number(e.target.value)),className:"w-1/2"})]}),(0,Lo.jsx)($l,{label:"Always Start on Root",settingKey:"startOnRoot",settings:n,onSettingChange:s})]}),(0,Lo.jsxs)(Bl,{title:"Reference Note Options",isOpen:c.reference,onToggle:()=>d("reference"),children:[(0,Lo.jsx)($l,{label:"Play Root Note First",settingKey:"playRootFirst",settings:n,onSettingChange:s,disabled:n.startOnRoot}),(0,Lo.jsx)($l,{label:"Use Drone",settingKey:"useDrone",settings:n,onSettingChange:s})]}),(0,Lo.jsxs)(Bl,{title:"Key & Scale Options",isOpen:c.key,onToggle:()=>d("key"),children:[(0,Lo.jsx)(Ul,{settingKey:"notePool",settings:n,onSettingChange:s,options:[{value:"Diatonic",label:"Diatonic"},{value:"Chromatic",label:"Chromatic"}]}),"Diatonic"===n.notePool&&(0,Lo.jsx)(Ul,{settingKey:"diatonicMode",settings:n,onSettingChange:s,options:[{value:"Major",label:"Major"},{value:"Minor",label:"Minor"}]}),(0,Lo.jsx)(Ul,{label:"Key Mode",settingKey:"rootNoteMode",settings:n,onSettingChange:s,options:[{value:"Fixed",label:"Fixed Key"},{value:"Roving",label:"Roving Key"}]}),"Fixed"===n.rootNoteMode&&(0,Lo.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,Lo.jsx)("select",{value:n.fixedKey,onChange:e=>s("fixedKey",e.target.value),className:"w-full p-2 bg-slate-700 rounded-md text-white border border-slate-500",children:Gl.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))}),(0,Lo.jsx)("button",{onClick:r,className:"p-2 bg-blue-600 hover:bg-blue-500 rounded-md font-semibold",children:"Random"})]}),"Roving"===n.rootNoteMode&&(0,Lo.jsxs)("div",{className:"flex items-center justify-between p-2 bg-slate-700 rounded-md",children:[(0,Lo.jsx)("label",{htmlFor:"qpr",children:"Questions per Key:"}),(0,Lo.jsx)("input",{type:"number",id:"qpr",min:"1",max:"20",value:n.questionsPerRoot,onChange:e=>s("questionsPerRoot",Number(e.target.value)),className:"w-16 p-1 bg-slate-600 rounded-md text-center"})]})]}),(0,Lo.jsxs)("div",{className:"border-t border-slate-600 pt-4 mt-4 space-y-2",children:[(0,Lo.jsx)("button",{onClick:l,className:"w-full py-2 rounded-lg font-bold bg-green-600 hover:bg-green-500 text-white",children:"Apply & Start New"}),(0,Lo.jsx)("button",{onClick:a,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})]})]})},Hl=e=>{let{settings:t,userAnswer:n,setUserAnswer:s,isAnswered:r,currentInput:a,setCurrentInput:o}=e;const i="Scale Degrees"===t.answerMode?["1","2","3","4","5","6","7"]:["A","B","C","D","E","F","G"],l=e=>{if(r||n.length>=t.melodyLength||!e)return;const a=e.replace("natural",""),i=[...n,a];s(i),o("")};return(0,Lo.jsxs)("div",{className:"w-full max-w-md mt-4 flex flex-col items-center",children:[(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-2 h-14 bg-slate-900/50 rounded-md px-4 w-full mb-4",children:[(0,Lo.jsx)("span",{className:"flex-1 text-left font-mono text-xl text-gray-400",children:"Your Answer:"}),(0,Lo.jsx)("span",{className:"font-mono text-2xl text-teal-300 tracking-wider",children:n.map(e=>e.replace("#","\u266f").replace("b","\u266d")).join(" - ")}),(0,Lo.jsx)("span",{className:"w-8 h-8 flex items-center justify-center bg-slate-700 rounded text-blue-300 font-bold text-xl",children:a.replace("#","\u266f").replace("b","\u266d")||""})]}),(0,Lo.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,Lo.jsx)("div",{className:"grid grid-cols-3 gap-2",children:[{id:"b",display:"\u266d"},{id:"natural",display:"\u266e"},{id:"#",display:"\u266f"}].map(e=>(0,Lo.jsx)("button",{onClick:()=>{return n=e.id,void(r||("natural"===n?a&&l(a):"Scale Degrees"===t.answerMode?o(n):a&&1===a.length&&l(a+n)));var n},disabled:r,className:"py-3 bg-teal-700 hover:bg-teal-600 rounded-md text-xl disabled:opacity-50",children:e.display},e.id))}),(0,Lo.jsx)("div",{className:"grid grid-cols-7 gap-2",children:i.map(e=>(0,Lo.jsx)("button",{onClick:()=>(e=>{"Scale Degrees"===t.answerMode?l(a+e):(a&&l(a),o(e))})(e),disabled:r,className:"py-3 bg-teal-600 hover:bg-teal-500 rounded-md text-xl disabled:opacity-50",children:e},e))}),(0,Lo.jsx)("button",{onClick:()=>{r||(a?o(""):s(e=>e.slice(0,-1)))},disabled:r,className:"w-full mt-2 py-2 bg-yellow-600/80 hover:bg-yellow-700/80 rounded-md disabled:opacity-50",children:"Backspace"})]})]})},Ql=t=>{var n;let{onProgressUpdate:s}=t;const{addLogEntry:r,savePreset:a,presetToLoad:o,clearPresetToLoad:i,fretboardVolume:l,setFretboardVolume:c}=Vo(),[u,d]=(0,e.useState)({autoAdvance:!0,answerMode:"Scale Degrees",octaveRange:1,melodyLength:4,startOnRoot:!0,playRootFirst:!1,useDrone:!0,notePool:"Diatonic",diatonicMode:"Major",rootNoteMode:"Roving",fixedKey:"C",questionsPerRoot:5,replayOnAnswer:!1}),[h,m]=(0,e.useState)(!1),[f,p]=(0,e.useState)(!1),[g,x]=(0,e.useState)([]),[b,v]=(0,e.useState)(""),{score:y,totalAsked:w,feedback:j,isAnswered:k,currentQuestion:N,history:C,reviewIndex:_,setReviewIndex:S,generateNewQuestion:T,checkAnswer:A,handleReviewNav:M,startReview:E,playMelody:D,playUserAnswer:R}=((t,n)=>{const{bpm:s,fretboardPlayers:r,areFretboardSoundsReady:a,unlockAudio:o,setDroneNote:i}=Vo(),[l,c]=(0,e.useState)(0),[u,d]=(0,e.useState)(0),[h,m]=(0,e.useState)({message:"",type:""}),[f,p]=(0,e.useState)(!1),[g,x]=(0,e.useState)(null),[b,v]=(0,e.useState)([]),[y,w]=(0,e.useState)(null),j=(0,e.useRef)(null),k=(0,e.useRef)(0),N=(0,e.useRef)("C");(0,e.useEffect)(()=>{let e=null;t.useDrone&&(null!==y&&b[y]?e=b[y].question.key:g&&(e=g.key)),i(e?ql[e]||e:null)},[t.useDrone,g,y,b,i]);const C=(0,e.useCallback)(()=>{clearTimeout(j.current),w(null);let e=!1;const{melodyLength:n,notePool:s,diatonicMode:r,octaveRange:a,startOnRoot:o,rootNoteMode:i,fixedKey:l,questionsPerRoot:c}=t;if("Roving"===i&&k.current>0&&k.current%c===0){const t=["C","G","D","A","E","F","Bb"];let n=N.current;for(;n===N.current;)n=t[Math.floor(Math.random()*t.length)];N.current=n,e=!0}else if("Fixed"===i)N.current=l;else if("Random"===i){const e=["C","G","D","A","E","F","Bb","Eb","Ab","Db","F#"];N.current=e[Math.floor(Math.random()*e.length)]}const u=Ao[N.current],d="Minor"===r?"Natural Minor":"Major",h=Mo(N.current,d);let f=[];if("Diatonic"===s)for(let t=0;t<a;t++)h.forEach(e=>f.push({name:e,midi:Ao[e]+12*t}));else for(let t=0;t<a;t++)Ol.forEach(e=>f.push({name:e,midi:Ao[e]+12*t}));const g=f.filter(e=>e.midi>=Fl&&e.midi<=Ll);if(0===g.length||o&&g.length<n-1)return void console.error("Not enough playable notes with current settings. Try a lower octave range.");const b=[];if(o){const e={name:N.current,midi:u,degree:"1"};e.midi>=Fl&&e.midi<=Ll&&b.push(e)}for(;b.length<n;){const e=g[Math.floor(Math.random()*g.length)],t=ho[(e.midi-u+120)%12];b.push({...e,degree:t})}const v={key:N.current,melody:b,answerDegrees:b.map(e=>e.degree),answerNotes:b.map(e=>e.name),keyChanged:e};x(v),p(!1),m({message:"",type:""}),k.current+=1},[t]),_=(0,e.useCallback)(async e=>{const n=e||g;if(!n||!a||!r.current)return;await o(),lo.cancel(),r.current.stopAll();const i=120/s;let l=0;if(t.playRootFirst&&!t.startOnRoot){const e=Ao[n.key];if(void 0!==e){let t=e-12,n=e;t<Fl&&(t=e,n=e+12>Ll?Ll:e+12),n>Ll&&(n=e,t=e-12<Fl?Fl:e-12);const s=zl(t),a=zl(n);s&&r.current.player(s).start(io()),a&&a!==s&&r.current.player(a).start(io()+.4),l=2.2}}n.melody.forEach((e,t)=>{const n=zl(e.midi);n&&r.current.has(n)&&r.current.player(n).start(io()+l+t*i)})},[g,a,o,r,s,t.playRootFirst,t.startOnRoot]),S=(0,e.useCallback)(e=>{if(f)return;const{answerMode:s,autoAdvance:r}=t,a="Scale Degrees"===s?g.answerDegrees:g.answerNotes,o=e.length===a.length&&e.every((e,t)=>e===a[t]),i=o?l+1:l,h=u+1;if(o?(c(i),m({message:"Correct!",type:"correct"})):m({message:`Incorrect. The answer was: ${a.join(" - ")}`,type:"incorrect"}),d(h),v(t=>[...t,{question:g,userAnswer:e,wasCorrect:o,answerMode:s}]),p(!0),t.replayOnAnswer&&setTimeout(()=>_(g),500),n&&n({wasCorrect:o,score:i,totalAsked:h}),r&&o){const e=t.replayOnAnswer?5e3:2e3;j.current=setTimeout(C,e)}},[f,g,t,C,n,l,u,_]),T=(0,e.useCallback)(async(e,t)=>{if(!e||0===e.length||!t||!a)return;await o(),lo.cancel(),r.current.stopAll();const n=120/s,i=Ao[t.question.key];void 0!==i&&e.forEach((e,s)=>{let a;if("Scale Degrees"===t.answerMode){const t=Vl[e];void 0!==t&&(a=i+t)}else a=Ao[e];if(void 0===a)return;a<Fl&&(a+=12),a>Ll&&(a-=12);const o=zl(a);o&&r.current.has(o)&&r.current.player(o).start(io()+s*n)})},[a,o,s,r]);return(0,e.useEffect)(()=>{C()},[C]),{score:l,totalAsked:u,feedback:h,isAnswered:f,currentQuestion:g,history:b,reviewIndex:y,setReviewIndex:w,generateNewQuestion:C,checkAnswer:S,handleReviewNav:e=>w(t=>{const n=t+e;return n>=0&&n<b.length?n:t}),startReview:()=>{b.length>0&&(clearTimeout(j.current),w(b.length-1))},playMelody:_,playUserAnswer:T}})(u,s);(0,e.useEffect)(()=>{o&&"melodic-ear-trainer"===o.gameId&&(d(o.settings),i())},[o,i]),(0,e.useEffect)(()=>{x([]),v("")},[N]);const I=null!==_;(0,e.useEffect)(()=>{if(N&&!k&&!I){const e=N.keyChanged?3e3:500,t=setTimeout(()=>D(),e);return()=>clearTimeout(t)}},[N,k,I,D]);const P=(0,e.useMemo)(()=>b?[...g,b.replace("natural","")]:g,[g,b]),O=(0,e.useCallback)(()=>{k||A(P)},[k,A,P]);(0,e.useEffect)(()=>{if(u.autoAdvance&&!k&&P.length===u.melodyLength){const e=setTimeout(()=>O(),1e3);return()=>clearTimeout(e)}},[u.autoAdvance,k,P,u.melodyLength,O]),(0,e.useEffect)(()=>{const e=e=>{if("Enter"!==e.key)return;const t=!(C.length>0)||C[C.length-1].wasCorrect;!k||u.autoAdvance&&t?k||P.length!==u.melodyLength||(e.preventDefault(),O()):(e.preventDefault(),x([]),T())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[k,P,u,C,O,T]);const F=(e,t)=>{d(n=>({...n,[e]:t}))},L=()=>{const e=["C","G","D","A","E","B","F#","F","Bb","Eb","Ab","Db"],t=e[Math.floor(Math.random()*e.length)];F("fixedKey",t)},q=()=>{const e=prompt("Enter a name for your preset:","Melody Trainer Setting");e&&""!==e.trim()&&(a({id:Date.now().toString(),name:e.trim(),gameId:"melodic-ear-trainer",gameName:"Melodic Ear Trainer",settings:{...u,fretboardVolume:l}}),alert(`Preset "${e.trim()}" saved!`))},V=(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Auto-Advance"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:u.autoAdvance,onChange:e=>F("autoAdvance",e.target.checked),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),z=!(C.length>0)||C[C.length-1].wasCorrect,G=I?(0,Lo.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Lo.jsx)("button",{onClick:()=>M(-1),disabled:0===_,className:"p-3 rounded-lg bg-slate-600 hover:bg-slate-500",children:"Prev"}),(0,Lo.jsx)("button",{onClick:()=>S(null),className:"bg-purple-600 p-3 rounded-lg font-bold",children:"Return to Quiz"}),(0,Lo.jsx)("button",{onClick:()=>M(1),disabled:_===C.length-1,className:"p-3 rounded-lg bg-slate-600 hover:bg-slate-500",children:"Next"})]}):(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)("button",{onClick:O,disabled:k||P.length!==u.melodyLength,className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg disabled:bg-gray-500",children:"Submit (Enter)"}),k&&(!u.autoAdvance||!z)&&(0,Lo.jsx)("button",{onClick:()=>{x([]),T()},className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg animate-pulse",children:"Next"})]});return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsxs)($o,{isOpen:h,onClose:()=>m(!1),title:"Melodic Ear Trainer Guide",children:[(0,Lo.jsx)("p",{children:"This tool plays a short melody and asks you to identify the notes you heard."}),(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-2",children:"How to Play"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside text-sm space-y-1",children:[(0,Lo.jsx)("li",{children:'Press "Apply & Start New" in the controls to begin.'}),(0,Lo.jsx)("li",{children:'Listen to the melody. You can press "Replay Melody" to hear it again.'}),(0,Lo.jsx)("li",{children:"Use the keypad to build your answer one note/degree at a time. It will be added to your answer sequence automatically."}),(0,Lo.jsx)("li",{children:'Press "Submit" or the Enter key once the sequence is full.'})]}),(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-2",children:"Controls Explained"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside text-sm space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Answer Mode:"})," Guess note names (C, F\u266f, B\u266d) or scale degrees (1, 5, \u266d7)."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Melody Options:"}),' Control the number of notes and the octave range. "Always Start on Root" forces the first note to be the tonic.']}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Reference Note:"}),' "Play Root Note First" plays the tonic before the melody begins. "Use Drone" plays a continuous drone of the root note.']}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Key & Scale:"})," Practice with all 12 notes (Chromatic) or within a specific key (Diatonic). You can fix the key, have it change after a set number of questions (Roving), or get a new random key every question."]})]})]}),(0,Lo.jsx)(Wo,{title:"Melodic Ear Trainer",score:y,totalAsked:w,history:C,isReviewing:I,onStartReview:E,topControls:V,footerContent:G,onLogProgress:()=>{const e=prompt("Enter any remarks for this session:",`Score: ${y}/${w}`);null!==e&&(r({game:"Melodic Ear Trainer",date:(new Date).toLocaleDateString(),remarks:e}),alert("Session logged!"))},onToggleControls:()=>p(e=>!e),onShowInfo:()=>m(!0),children:(0,Lo.jsxs)("div",{className:"w-full max-w-2xl mx-auto flex flex-col items-center",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,Lo.jsx)("button",{onClick:()=>D(I?C[_].question:N),className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg",children:"Replay Melody"}),I&&!C[_].wasCorrect&&(0,Lo.jsx)("button",{onClick:()=>R(C[_].userAnswer,C[_]),className:"bg-orange-600 hover:bg-orange-500 text-white font-bold py-3 px-8 rounded-lg",children:"Replay Your Answer"})]}),(!I&&"Note Names"===u.answerMode||I&&"Note Names"===(null===(n=C[_])||void 0===n?void 0:n.answerMode))&&(0,Lo.jsx)("div",{className:"text-center p-2 rounded-lg bg-slate-900/40 mb-4",children:(0,Lo.jsxs)("p",{className:"font-semibold text-gray-200 text-lg",children:["Key: ",(0,Lo.jsx)("span",{className:"text-teal-300 font-bold",children:I?C[_].question.key:null===N||void 0===N?void 0:N.key})]})}),(0,Lo.jsx)("div",{className:"text-xl my-4 min-h-[28px] "+("correct"===j.type?"text-green-400":"text-red-400"),children:j.message||(0,Lo.jsx)(Lo.Fragment,{children:"\xa0"})}),I?(0,Lo.jsxs)("div",{className:"text-center p-3 rounded-lg bg-slate-900/50 space-y-2",children:[(0,Lo.jsxs)("p",{className:"font-bold text-gray-200",children:["Correct Answer: ",(0,Lo.jsx)("span",{className:"text-teal-300 font-semibold",children:("Scale Degrees"===C[_].answerMode?C[_].question.answerDegrees:C[_].question.answerNotes).join(" - ")})]}),!C[_].wasCorrect&&(0,Lo.jsxs)("p",{className:"font-bold text-gray-400",children:["Your Answer: ",(0,Lo.jsx)("span",{className:"text-red-400 font-semibold",children:C[_].userAnswer.join(" - ")})]})]}):(0,Lo.jsx)(Hl,{settings:u,userAnswer:g,setUserAnswer:x,isAnswered:k,currentQuestion:N,currentInput:b,setCurrentInput:v})]})}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 "+(f?"w-80 p-4":"w-0 overflow-hidden"),children:f&&(0,Lo.jsxs)("div",{className:"flex flex-col h-full",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4 flex-shrink-0",children:"Settings & Controls"}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(Wl,{settings:u,onSettingChange:F,onRandomKey:L,onSavePreset:q,volume:l,onVolumeChange:c,onApplySettings:()=>{x([]),T()}})})]})}),f&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>p(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(Wl,{settings:u,onSettingChange:F,onRandomKey:L,onSavePreset:q,volume:l,onVolumeChange:c,onApplySettings:()=>{x([]),T()}})})]})})]})},Kl={Db:"C#",Eb:"D#",Gb:"F#",Ab:"G#",Bb:"A#"},Yl=(t,n)=>{const{areFretboardSoundsReady:s,unlockAudio:r,setDroneNote:a,playChord:o}=Vo(),[i,l]=(0,e.useState)(0),[c,u]=(0,e.useState)(0),[d,h]=(0,e.useState)({message:"",type:""}),[m,f]=(0,e.useState)(!1),[p,g]=(0,e.useState)(null),[x,b]=(0,e.useState)([]),[v,y]=(0,e.useState)(null),w=(0,e.useRef)(null),j=(0,e.useRef)("C"),k=(0,e.useRef)(0);(0,e.useEffect)(()=>{let e=null;if(t.useDrone&&(null!==v&&x[v]?e=x[v].question.rootNote:p&&(e=p.rootNote)),e){a(Kl[e]||e)}else a(null)},[t.useDrone,p,v,x,a]);const N=(0,e.useCallback)(()=>{clearTimeout(w.current),y(null);const{keyMode:e,fixedKey:n,qualities:s,questionsPerKey:r}=t;let a=!1;if("Roving"===e){if(k.current>0&&k.current%r===0){const e=["C","G","D","A","E","F","Bb"];let t=j.current;for(;t===j.current;)t=e[Math.floor(Math.random()*e.length)];j.current=t,a=!0}}else j.current=n;const o=Object.keys(s).filter(e=>s[e]);if(0===o.length)return void g({noOptions:!0});const i=o[Math.floor(Math.random()*o.length)],l=So[i];if(!l)return;const c=j.current,u=Ao[c],d=l.intervals.map(e=>["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][(u+e)%12]),m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Do;const n=new Set(e.map(e=>Ao[e]%12));for(let s=5;s>=2;s--)for(let e=0;e<=5;e++){const r=t[s][e];if(n.has(r.midi%12)){const a=[{string:6-s,fret:e,midi:r.midi}],o=new Set(n);o.delete(r.midi%12);for(let n=s-1;n>=0&&0!==o.size;n--)for(let s=Math.max(0,e-2);s<=e+2;s++){const e=t[n][s];if(o.has(e.midi%12)){a.push({string:6-n,fret:s,midi:e.midi}),o.delete(e.midi%12);break}}if(0===o.size)return a}}return null}(d);if(!m)return void setTimeout(N,50);g({rootNote:c,quality:i,noteNames:d,voicing:m,answer:i,keyChanged:a}),f(!1),h({message:"",type:""})},[t]),C=(0,e.useCallback)(async e=>{const n=e||p;n&&n.noteNames&&s&&(await r(),lo.cancel(),o(n.noteNames,t.playbackStyle))},[p,s,r,o,t.playbackStyle]),_=(0,e.useCallback)(e=>{if(m)return;k.current+=1;const s=e===p.answer,r=s?i+1:i,a=c+1;s?(l(r),h({message:"Correct!",type:"correct"})):h({message:`Incorrect. The answer was: ${p.answer}`,type:"incorrect"}),u(a),b(t=>[...t,{question:p,userAnswer:e,wasCorrect:s}]),f(!0),n&&n({wasCorrect:s,score:r,totalAsked:a}),t.autoAdvance&&s&&(w.current=setTimeout(N,2e3))},[m,p,t.autoAdvance,n,i,c,N]);(0,e.useEffect)(()=>{N()},[JSON.stringify(t)]);return{score:i,totalAsked:c,feedback:d,isAnswered:m,currentQuestion:p,history:x,reviewIndex:v,setReviewIndex:y,generateNewQuestion:N,checkAnswer:_,handleReviewNav:e=>y(t=>{const n=t+e;return n>=0&&n<x.length?n:t}),startReview:()=>{x.length>0&&(clearTimeout(w.current),y(x.length-1))},playQuestionAudio:C}},Xl=["Major","Minor","Diminished","Augmented","Sus2","Sus4"],Zl=["Major 7th","Minor 7th","Dominant 7th","Half-Diminished 7th","Diminished 7th"],Jl=["C","G","D","A","E","B","F#","F","Bb","Eb","Ab","Db"],ec=e=>{let{title:t,isOpen:n,onToggle:s,children:r}=e;return(0,Lo.jsxs)("div",{className:"border-t border-slate-600/80 pt-3 mt-3",children:[(0,Lo.jsxs)("button",{onClick:s,className:"w-full flex justify-between items-center text-left text-lg font-bold text-teal-300 hover:text-teal-200",children:[(0,Lo.jsx)("span",{children:t}),(0,Lo.jsx)("span",{className:"text-xl",children:n?"\u2212":"+"})]}),n&&(0,Lo.jsx)("div",{className:"pt-3 space-y-3",children:r})]})},tc=e=>{let{label:t,settingKey:n,options:s,settings:r,onSettingChange:a}=e;return(0,Lo.jsxs)("div",{children:[t&&(0,Lo.jsx)("h4",{className:"font-semibold text-gray-300 mb-1",children:t}),(0,Lo.jsx)("div",{className:"flex bg-slate-600 rounded-md p-1",children:s.map(e=>(0,Lo.jsx)("button",{onClick:()=>a(n,e.value),className:"flex-1 rounded-md py-1 text-sm font-semibold "+(r[n]===e.value?"bg-blue-600 text-white":"text-gray-300"),children:e.label},e.value))})]})},nc=t=>{let{settings:n,onSettingChange:s,onRandomKey:r,onSavePreset:a}=t;const[o,i]=(0,e.useState)({playback:!0,chords:!0,key:!1}),l=e=>{i(t=>({...t,[e]:!t[e]}))},c=e=>{s("qualities",{...n.qualities,[e]:!n.qualities[e]})};return(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsx)(ec,{title:"Playback Options",isOpen:o.playback,onToggle:()=>l("playback"),children:(0,Lo.jsx)(tc,{label:"Playback Style",settingKey:"playbackStyle",settings:n,onSettingChange:s,options:[{value:"Melodic",label:"Arpeggio"},{value:"Harmonic",label:"Chord"}]})}),(0,Lo.jsxs)(ec,{title:"Chord Selection",isOpen:o.chords,onToggle:()=>l("chords"),children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold text-gray-300 mb-2",children:"Triads"}),(0,Lo.jsx)("div",{className:"grid grid-cols-3 gap-2",children:Xl.map(e=>(0,Lo.jsx)("button",{onClick:()=>c(e),className:"p-2 rounded-md font-semibold text-xs "+(n.qualities[e]?"bg-blue-600 text-white":"bg-slate-600"),children:e},e))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-semibold text-gray-300 mb-2 mt-3",children:"7th Chords"}),(0,Lo.jsx)("div",{className:"grid grid-cols-3 gap-2",children:Zl.map(e=>(0,Lo.jsx)("button",{onClick:()=>c(e),className:"p-2 rounded-md font-semibold text-xs "+(n.qualities[e]?"bg-blue-600 text-white":"bg-slate-600"),children:e},e))})]})]}),(0,Lo.jsxs)(ec,{title:"Key Options",isOpen:o.key,onToggle:()=>l("key"),children:[(0,Lo.jsx)(tc,{label:"Key Mode",settingKey:"keyMode",settings:n,onSettingChange:s,options:[{value:"Fixed",label:"Fixed Key"},{value:"Roving",label:"Roving Key"}]}),"Fixed"===n.keyMode&&(0,Lo.jsxs)("div",{className:"flex gap-2 items-center mt-2",children:[(0,Lo.jsx)("select",{value:n.fixedKey,onChange:e=>s("fixedKey",e.target.value),className:"w-full p-2 bg-slate-700 rounded-md text-white border border-slate-500",children:Jl.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))}),(0,Lo.jsx)("button",{onClick:r,className:"p-2 bg-blue-600 hover:bg-blue-500 rounded-md font-semibold",children:"Random"})]}),"Roving"===n.keyMode&&(0,Lo.jsxs)("div",{className:"flex items-center justify-between p-2 bg-slate-700 rounded-md mt-2",children:[(0,Lo.jsx)("label",{htmlFor:"qpk",className:"font-semibold",children:"Questions per Key:"}),(0,Lo.jsx)("input",{type:"number",id:"qpk",min:"1",max:"20",value:n.questionsPerKey,onChange:e=>s("questionsPerKey",Number(e.target.value)),className:"w-16 p-1 bg-slate-600 rounded-md text-center"})]})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:a,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},sc=t=>{let{onProgressUpdate:n}=t;const{addLogEntry:s,savePreset:r,presetToLoad:a,clearPresetToLoad:o}=Vo(),[i,l]=(0,e.useState)({autoAdvance:!0,playbackStyle:"Harmonic",qualities:{Major:!0,Minor:!0,Diminished:!1,Augmented:!1,Sus2:!1,Sus4:!1,"Major 7th":!1,"Minor 7th":!1,"Dominant 7th":!1,"Half-Diminished 7th":!1,"Diminished 7th":!1},keyMode:"Fixed",fixedKey:"C",questionsPerKey:5,useDrone:!0}),[c,u]=(0,e.useState)(!1),[d,h]=(0,e.useState)(!1),{score:m,totalAsked:f,feedback:p,isAnswered:g,currentQuestion:x,history:b,reviewIndex:v,setReviewIndex:y,generateNewQuestion:w,checkAnswer:j,handleReviewNav:k,startReview:N,playQuestionAudio:C}=Yl(i,n);(0,e.useEffect)(()=>{a&&"chord-ear-trainer"===a.gameId&&(l(a.settings),o())},[a,o]);const _=null!==v;(0,e.useEffect)(()=>{if(x&&!x.noOptions&&!g&&!_){const e=x.keyChanged?2500:500,t=setTimeout(()=>C(),e);return()=>clearTimeout(t)}},[x,g,_,C]);const S=(e,t)=>{l(n=>({...n,[e]:t}))},T=()=>{const e=["C","G","D","A","E","B","F#","F","Bb","Eb","Ab","Db"],t=e[Math.floor(Math.random()*e.length)];S("fixedKey",t)},A=()=>{const e=prompt("Enter a name for your preset:","Chord Recognition Custom");e&&""!==e.trim()&&(r({id:`cet-${Date.now()}`,name:e.trim(),gameId:"chord-ear-trainer",gameName:"Chord Recognition",settings:i}),alert(`Preset "${e.trim()}" saved!`))},M=_?b[v]:{question:x},E=null===M||void 0===M?void 0:M.question,D=(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Auto-Advance"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:i.autoAdvance,onChange:e=>S("autoAdvance",e.target.checked),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R=!(b.length>0)||b[b.length-1].wasCorrect,I=_?(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-4 w-full",children:[(0,Lo.jsx)("button",{onClick:()=>k(-1),disabled:0===v,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Prev"}),(0,Lo.jsx)("button",{onClick:()=>y(null),className:"bg-purple-600 hover:bg-purple-500 font-bold p-3 rounded-lg text-xl",children:"Return to Quiz"}),(0,Lo.jsx)("button",{onClick:()=>k(1),disabled:v===b.length-1,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Next"})]}):!g||i.autoAdvance&&R?null:(0,Lo.jsx)("button",{onClick:w,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg animate-pulse",children:"Next Question"}),P=Object.keys(So).filter(e=>i.qualities[e]);return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsxs)($o,{isOpen:c,onClose:()=>u(!1),title:"Chord Recognition Guide",children:[(0,Lo.jsx)("p",{children:"Listen to the chord and identify its quality."}),(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-4",children:"How to Play"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside text-sm space-y-1",children:[(0,Lo.jsx)("li",{children:"A chord will be played either as a block chord (Harmonic) or an arpeggio (Melodic)."}),(0,Lo.jsx)("li",{children:"Click the button corresponding to the chord quality you heard."}),(0,Lo.jsx)("li",{children:'Use the "Replay Sound" button to hear the chord again.'})]}),(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-4",children:"Controls"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside text-sm space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Playback Style:"}),' Choose between hearing the notes as an "Arpeggio" or a "Chord".']}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Chord Selection:"})," Select which triad and 7th chord qualities you want to be tested on."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Key Options:"})," Practice with a fixed root note or have it change to a new random key (Roving)."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("b",{children:"Drone:"})," Enable the global drone player to hear a constant root note for reference. The drone will automatically follow the key."]})]})]}),(0,Lo.jsx)(Wo,{title:"Chord Recognition",score:m,totalAsked:f,history:b,isReviewing:_,onStartReview:N,topControls:D,footerContent:I,onLogProgress:()=>{const e=prompt("Enter any remarks for this session:",`Score: ${m}/${f}`);null!==e&&(s({game:"Chord Recognition",date:(new Date).toLocaleDateString(),remarks:e}),alert("Session logged!"))},onToggleControls:()=>h(e=>!e),onShowInfo:()=>u(!0),children:(0,Lo.jsx)("div",{className:"w-full max-w-2xl mx-auto flex flex-col items-center",children:null!==E&&void 0!==E&&E.noOptions?(0,Lo.jsx)("p",{className:"text-yellow-400 text-center my-8",children:"Please select at least one chord quality in the controls to begin."}):(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)("div",{className:"w-full bg-slate-900/50 p-4 rounded-lg text-center min-h-[80px] flex justify-center items-center flex-wrap gap-x-2 mb-4",children:(0,Lo.jsx)("button",{onClick:()=>C(E),className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg text-xl",children:"Replay Sound"})}),(0,Lo.jsx)("div",{className:"text-xl my-4 min-h-[28px] "+("correct"===p.type?"text-green-400":"text-red-400"),children:_?`Your Answer: ${M.userAnswer} | Correct: ${E.answer}`:p.message||(0,Lo.jsx)(Lo.Fragment,{children:"\xa0"})}),(0,Lo.jsx)("div",{className:"w-full grid grid-cols-2 md:grid-cols-4 gap-2",children:P.map(e=>(0,Lo.jsx)("button",{onClick:()=>j(e),disabled:g||_,className:"py-4 rounded-lg font-semibold text-base transition-colors disabled:opacity-30 bg-teal-600 hover:bg-teal-500",children:e},e))})]})})}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out "+(d?"w-80 p-4":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!d&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(nc,{settings:i,onSettingChange:S,onRandomKey:T,onSavePreset:A})]})}),d&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>h(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(nc,{settings:i,onSettingChange:S,onRandomKey:T,onSavePreset:A})})]})})]})},rc={Db:"C#",Eb:"D#",Gb:"F#",Ab:"G#",Bb:"A#"},ac=["C","G","D","A","E","B","F#","F","Bb","Eb","Ab","Db"],oc=e=>{let{title:t,isOpen:n,onToggle:s,children:r}=e;return(0,Lo.jsxs)("div",{className:"border-t border-slate-600/80 pt-3 mt-3",children:[(0,Lo.jsxs)("button",{onClick:s,className:"w-full flex justify-between items-center text-left text-lg font-bold text-teal-300 hover:text-teal-200",children:[(0,Lo.jsx)("span",{children:t}),(0,Lo.jsx)("span",{className:"text-xl",children:n?"\u2212":"+"})]}),n&&(0,Lo.jsx)("div",{className:"pt-3 space-y-3",children:r})]})},ic=e=>{let{label:t,settingKey:n,options:s,settings:r,onSettingChange:a}=e;return(0,Lo.jsxs)("div",{children:[t&&(0,Lo.jsx)("h4",{className:"font-semibold text-gray-300 mb-1",children:t}),(0,Lo.jsx)("div",{className:"flex bg-slate-600 rounded-md p-1",children:s.map(e=>(0,Lo.jsx)("button",{onClick:()=>a(n,e.value),className:"flex-1 rounded-md py-1 text-sm font-semibold "+(r[n]===e.value?"bg-blue-600 text-white":"text-gray-300"),children:e.label},e.value))})]})},lc=e=>{let{label:t,settingKey:n,settings:s,onSettingChange:r}=e;return(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 cursor-pointer p-2 rounded-md bg-slate-700",children:[(0,Lo.jsx)("span",{className:"font-semibold",children:t}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:s[n],onChange:e=>r(n,e.target.checked),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})},cc=t=>{let{settings:n,onSettingChange:s,onRandomKey:r,onSavePreset:a}=t;const[o,i]=(0,e.useState)({progression:!0,key:!1}),l=e=>{i(t=>({...t,[e]:!t[e]}))};return(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsxs)(oc,{title:"Progression Options",isOpen:o.progression,onToggle:()=>l("progression"),children:[(0,Lo.jsx)(ic,{label:"Key Type",settingKey:"keyType",settings:n,onSettingChange:s,options:[{value:"Major",label:"Major"},{value:"Natural Minor",label:"Minor"}]}),(0,Lo.jsx)(ic,{label:"Chord Filter",settingKey:"chordFilter",settings:n,onSettingChange:s,options:[{value:"All",label:"All Chords"},{value:"Major Only",label:"Major Only"},{value:"Minor Only",label:"Minor Only"}]}),(0,Lo.jsx)(lc,{label:"Always Start on I / i",settingKey:"startOnTonic",settings:n,onSettingChange:s}),(0,Lo.jsx)(lc,{label:"Exclude Diminished Chords",settingKey:"excludeDiminished",settings:n,onSettingChange:s})]}),(0,Lo.jsxs)(oc,{title:"Key Options",isOpen:o.key,onToggle:()=>l("key"),children:[(0,Lo.jsx)(ic,{label:"Key Mode",settingKey:"keyMode",settings:n,onSettingChange:s,options:[{value:"Fixed",label:"Fixed Key"},{value:"Roving",label:"Roving Key"}]}),"Fixed"===n.keyMode&&(0,Lo.jsxs)("div",{className:"flex gap-2 items-center mt-2",children:[(0,Lo.jsx)("select",{value:n.fixedKey,onChange:e=>s("fixedKey",e.target.value),className:"w-full p-2 bg-slate-700 rounded-md text-white border border-slate-500",children:ac.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))}),(0,Lo.jsx)("button",{onClick:r,className:"p-2 bg-blue-600 hover:bg-blue-500 rounded-md font-semibold",children:"Random"})]}),"Roving"===n.keyMode&&(0,Lo.jsxs)("div",{className:"flex items-center justify-between p-2 bg-slate-700 rounded-md mt-2",children:[(0,Lo.jsx)("label",{htmlFor:"qpk",className:"font-semibold",children:"Questions per Key:"}),(0,Lo.jsx)("input",{type:"number",id:"qpk",min:"1",max:"20",value:n.questionsPerKey,onChange:e=>s("questionsPerKey",Number(e.target.value)),className:"w-16 p-1 bg-slate-600 rounded-md text-center"})]})]}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:a,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:"Save Preset"})})]})},uc=e=>{let{userAnswer:t,onUserAnswerChange:n,currentQuestion:s,isAnswered:r}=e;if(!s||!s.progression)return null;const a=s.progression.length,o=Eo(s.key,s.keyType,"Triads");return(0,Lo.jsxs)("div",{className:"w-full max-w-lg mt-4 flex flex-col items-center",children:[(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-2 h-14 bg-slate-900/50 rounded-md px-4 w-full mb-4",children:[(0,Lo.jsx)("span",{className:"flex-1 text-left font-mono text-xl text-gray-400",children:"Your Answer:"}),(0,Lo.jsx)("span",{className:"font-mono text-2xl text-teal-300 tracking-wider",children:t.join(" - ")})]}),(0,Lo.jsxs)("div",{className:"grid grid-cols-4 gap-2 w-full",children:[o.map(e=>(0,Lo.jsx)("button",{onClick:()=>(e=>{if(r||t.length>=a)return;const s=[...t,e];n(s)})(e.roman),disabled:r||t.length>=a,className:"py-4 bg-teal-600 hover:bg-teal-500 rounded-md text-xl font-semibold disabled:opacity-50",children:e.roman},e.roman)),(0,Lo.jsx)("button",{onClick:()=>{if(r)return;const e=t.slice(0,-1);n(e)},disabled:r||0===t.length,className:"col-span-4 py-3 bg-yellow-600/80 hover:bg-yellow-700/80 rounded-md text-lg font-semibold disabled:opacity-50",children:"Backspace"})]})]})},dc=t=>{let{onProgressUpdate:n}=t;const{addLogEntry:s,savePreset:r,presetToLoad:a,clearPresetToLoad:o}=Vo(),[i,l]=(0,e.useState)({autoAdvance:!0,keyType:"Major",keyMode:"Fixed",fixedKey:"C",questionsPerKey:3,chordFilter:"All",excludeDiminished:!0,startOnTonic:!0,useDrone:!0}),[c,u]=(0,e.useState)(!1),[d,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)([]),{score:p,totalAsked:g,feedback:x,isAnswered:b,currentQuestion:v,history:y,reviewIndex:w,setReviewIndex:j,isNewKey:k,generateNewQuestion:N,checkAnswer:C,handleReviewNav:_,startReview:S,playQuestionAudio:T}=((t,n)=>{const{areFretboardSoundsReady:s,unlockAudio:r,setDroneNote:a,playChord:o}=Vo(),[i,l]=(0,e.useState)(0),[c,u]=(0,e.useState)(0),[d,h]=(0,e.useState)({message:"",type:""}),[m,f]=(0,e.useState)(!1),[p,g]=(0,e.useState)(null),[x,b]=(0,e.useState)([]),[v,y]=(0,e.useState)(null),[w,j]=(0,e.useState)(!1),k=(0,e.useRef)(null),N=(0,e.useRef)("C"),C=(0,e.useRef)(0);(0,e.useEffect)(()=>{let e=null;t.useDrone&&(null!==v&&x[v]?e=x[v].question.key:p&&(e=p.key)),a(e?rc[e]||e:null)},[t.useDrone,p,v,x,a]);const _=(0,e.useCallback)(()=>{clearTimeout(k.current),y(null),j(!1);const{keyMode:e,fixedKey:n,keyType:s,chordFilter:r,excludeDiminished:a,startOnTonic:o,questionsPerKey:i}=t;if("Roving"===e){if(C.current>0&&C.current%i===0){const e=["C","G","D","A","E","F","Bb"];let t;do{t=e[Math.floor(Math.random()*e.length)]}while(t===N.current);N.current=t,j(!0)}}else N.current=n;let l=Eo(N.current,s,"Triads");if(a&&(l=l.filter(e=>"Diminished"!==e.quality)),"Major Only"===r?l=l.filter(e=>"Major"===e.quality):"Minor Only"===r&&(l=l.filter(e=>"Minor"===e.quality)),l.length<2)return void g({noOptions:!0,error:"Not enough chords available with current filters."});const c=[];if(o){const e=l.find(e=>e.roman.toUpperCase().startsWith("I"));e?c.push(e):c.push(l[0])}else c.push(l[Math.floor(Math.random()*l.length)]);for(;c.length<4;){const e=l[Math.floor(Math.random()*l.length)];e.roman!==c[c.length-1].roman&&c.push(e)}const u=c.map(e=>e.roman),d={key:N.current,keyType:s,progression:c,answer:u};g(d),f(!1),h({message:"",type:""})},[t]),S=(0,e.useCallback)(async e=>{const t=e||p;if(t&&t.progression&&s){await r();for(const e of t.progression){const t=Ao[e.root],n=("Major"===e.quality?[0,4,7]:"Minor"===e.quality?[0,3,7]:[0,3,6]).map(e=>["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][(t+e)%12]);o(n,"Harmonic"),await new Promise(e=>setTimeout(e,1500))}}},[p,s,r,o]),T=(0,e.useCallback)(e=>{if(m)return;C.current+=1;const s=p.answer,r=e.length===s.length&&e.every((e,t)=>e===s[t]),a=r?i+1:i,o=c+1;r?(l(a),h({message:"Correct!",type:"correct"})):h({message:`Incorrect. The answer was: ${s.join(" - ")}`,type:"incorrect"}),u(o),b(t=>[...t,{question:p,userAnswer:e,wasCorrect:r}]),f(!0),n&&n({wasCorrect:r,score:a,totalAsked:o}),t.autoAdvance&&r&&(k.current=setTimeout(_,2500))},[m,p,t.autoAdvance,n,i,c,_]);return(0,e.useEffect)(()=>{_()},[JSON.stringify(t)]),{score:i,totalAsked:c,feedback:d,isAnswered:m,currentQuestion:p,history:x,reviewIndex:v,setReviewIndex:y,isNewKey:w,generateNewQuestion:_,checkAnswer:T,handleReviewNav:e=>y(t=>{const n=t+e;return n>=0&&n<x.length?n:t}),startReview:()=>{x.length>0&&(clearTimeout(k.current),y(x.length-1))},playQuestionAudio:S}})(i,n),A=(0,e.useCallback)(e=>{b||(f(e),4===e.length&&C(e))},[b,C]);(0,e.useEffect)(()=>{a&&"progression-ear-trainer"===a.gameId&&(l(a.settings),o())},[a,o]),(0,e.useEffect)(()=>{f([])},[v]);const M=null!==w;(0,e.useEffect)(()=>{if(v&&!v.noOptions&&!b&&!M){const e=setTimeout(()=>T(),k?3e3:500);return()=>clearTimeout(e)}},[v,b,M,T,k]),(0,e.useEffect)(()=>{const e=v&&v.key?Eo(v.key,v.keyType,"Triads"):[],t=t=>{const n=t.target.tagName.toLowerCase();if("input"===n||"textarea"===n||"select"===n)return;if(b&&"Enter"!==t.key)return;const s=parseInt(t.key,10);if(s>=1&&s<=7&&m.length<4){const t=s-1;if(e[t]){const n=[...m,e[t].roman];A(n)}return}if("Backspace"===t.key){const e=m.slice(0,-1);return void A(e)}if("Enter"===t.key){t.preventDefault();const e=y.length>0&&y[y.length-1].wasCorrect;!b||i.autoAdvance&&e||N()}};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[b,m,i.autoAdvance,y,N,v,A]);const E=(e,t)=>l(n=>({...n,[e]:t})),D=()=>{const e=["C","G","D","A","E","B","F#","F","Bb","Eb","Ab","Db"];E("fixedKey",e[Math.floor(Math.random()*e.length)])},R=()=>{const e=prompt("Enter a name for your preset:","Progression Recognition Custom");e&&""!==e.trim()&&(r({id:`pet-${Date.now()}`,name:e.trim(),gameId:"progression-ear-trainer",gameName:"Progression Recognition",settings:i}),alert(`Preset "${e.trim()}" saved!`))},I=M?y[w]:{question:v},P=null===I||void 0===I?void 0:I.question,O=(0,Lo.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer font-semibold",children:[(0,Lo.jsx)("span",{children:"Auto-Advance"}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:i.autoAdvance,onChange:e=>E("autoAdvance",e.target.checked),className:"sr-only peer"}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),F=y.length>0&&y[y.length-1].wasCorrect,L=M?(0,Lo.jsxs)("div",{className:"flex items-center justify-center gap-4 w-full",children:[(0,Lo.jsx)("button",{onClick:()=>_(-1),disabled:0===w,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Prev"}),(0,Lo.jsx)("button",{onClick:()=>j(null),className:"bg-purple-600 hover:bg-purple-500 font-bold p-3 rounded-lg text-xl",children:"Return to Quiz"}),(0,Lo.jsx)("button",{onClick:()=>_(1),disabled:w===y.length-1,className:"bg-slate-600 hover:bg-slate-500 font-bold p-3 rounded-lg disabled:opacity-50",children:"Next"})]}):(0,Lo.jsx)("div",{className:"flex items-center justify-center gap-4 min-h-[52px]",children:b&&(!i.autoAdvance||!F)&&(0,Lo.jsx)("button",{onClick:N,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg animate-pulse",children:"Next Question"})});return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsxs)($o,{isOpen:c,onClose:()=>u(!1),title:"Progression Recognition Guide",children:[(0,Lo.jsx)("p",{children:"Listen to the chord progression and identify the sequence of chords by their Roman numerals."}),(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-4",children:"How to Play"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside text-sm space-y-1",children:[(0,Lo.jsx)("li",{children:"A 4-chord progression will be played."}),(0,Lo.jsx)("li",{children:"Use the Roman numeral buttons or your keyboard's number keys (1-7) to build your answer sequence."}),(0,Lo.jsx)("li",{children:"Your answer is automatically submitted after the 4th chord is selected."}),(0,Lo.jsx)("li",{children:"If you are correct, the next question will start automatically (if Auto-Advance is on)."}),(0,Lo.jsx)("li",{children:'If you are incorrect, review the answer and press "Next Question" or Enter to continue.'})]})]}),(0,Lo.jsx)(Wo,{title:"Progression Recognition",score:p,totalAsked:g,history:y,isReviewing:M,onStartReview:S,topControls:O,footerContent:L,onLogProgress:()=>{const e=prompt("Enter any remarks for this session:",`Score: ${p}/${g}`);null!==e&&(s({game:"Progression Recognition",date:(new Date).toLocaleDateString(),remarks:e}),alert("Session logged!"))},onToggleControls:()=>h(e=>!e),onShowInfo:()=>u(!0),children:(0,Lo.jsx)("div",{className:"w-full max-w-2xl mx-auto flex flex-col items-center",children:null!==P&&void 0!==P&&P.noOptions?(0,Lo.jsx)("p",{className:"text-yellow-400 text-center my-8",children:P.error}):(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)("div",{className:"w-full bg-slate-900/50 p-4 rounded-lg text-center min-h-[80px] flex justify-center items-center flex-wrap gap-x-2 mb-4",children:(0,Lo.jsx)("button",{onClick:()=>T(P),className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg text-xl",children:"Replay Progression"})}),(0,Lo.jsx)("div",{className:"text-xl my-4 min-h-[28px] "+("correct"===x.type?"text-green-400":"text-red-400"),children:M?`Your Answer: ${I.userAnswer.join(" - ")} | Correct: ${P.answer.join(" - ")}`:x.message||(0,Lo.jsx)(Lo.Fragment,{children:"\xa0"})}),!M&&(0,Lo.jsx)(uc,{userAnswer:m,onUserAnswerChange:A,currentQuestion:v,isAnswered:b})]})})}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out "+(d?"w-80 p-4":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!d&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(cc,{settings:i,onSettingChange:E,onRandomKey:D,onSavePreset:R})]})}),d&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>h(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(cc,{settings:i,onSettingChange:E,onRandomKey:D,onSavePreset:R})})]})})]})},hc=e=>{let{routine:t,folders:n,onToggleFolder:s}=e;return(0,Lo.jsxs)("div",{className:"bg-slate-800 p-4 rounded-b-lg -mt-2 animate-fade-in-down",children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-2",children:"Assign to Folders:"}),(0,Lo.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[n.map(e=>(0,Lo.jsxs)("label",{className:"flex items-center gap-3 p-2 bg-slate-900/50 rounded-md cursor-pointer hover:bg-slate-700/50",children:[(0,Lo.jsx)("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 bg-slate-700",checked:t.folderIds.includes(e.id),onChange:()=>s(t.id,e.id)}),(0,Lo.jsx)("span",{className:"font-semibold",children:e.name})]},e.id)),0===n.length&&(0,Lo.jsx)("p",{className:"text-gray-400 col-span-full",children:"No folders created yet."})]})]})},mc=e=>{let{routines:t=[],folders:n=[],onStart:s,onEdit:r,onExport:a,onShowCreator:o,onToggleManageFolders:i,onToggleFolder:l,managingFoldersForId:c,isSelectionMode:u,selectedRoutineIds:d,onToggleSelection:h}=e;const m=e=>{switch(e){case"PracticeRoutine":return"border-blue-600";case"Gauntlet":return"border-yellow-500";case"Streak":return"border-green-600";default:return"border-slate-700"}};return t&&0!==t.length?(0,Lo.jsx)("div",{className:"space-y-4",children:t.map(e=>{const t=d.has(e.id);return(0,Lo.jsxs)("div",{children:[(0,Lo.jsxs)("div",{onClick:u?()=>h(e.id):void 0,className:`p-4 flex items-center justify-between gap-4 border-2 transition-all duration-150\n                                ${c===e.id?"rounded-t-lg":"rounded-lg"}\n                                ${u?"cursor-pointer":""}\n                                ${t?`bg-indigo-800 ring-2 ring-indigo-400 ${m(e.type)}`:`bg-slate-700 ${m(e.type)}`}\n                            `,children:[(0,Lo.jsxs)("div",{className:"flex-grow",children:[(0,Lo.jsx)("h3",{className:"font-bold text-xl text-teal-300",children:e.name}),(0,Lo.jsxs)("p",{className:"text-sm text-gray-400 capitalize",children:[e.type.replace(/([A-Z])/g," $1").trim()," \u2022 ",e.steps.length," Steps"]}),e.createdAt&&(0,Lo.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Created: ",new Date(e.createdAt).toLocaleString()]})]}),(0,Lo.jsxs)("div",{className:"flex flex-shrink-0 gap-2 flex-wrap items-center",children:[(0,Lo.jsx)("button",{onClick:t=>{t.stopPropagation(),i(e.id)},disabled:u,className:(c===e.id?"bg-indigo-600":"bg-gray-700 hover:bg-gray-600")+" text-white font-bold py-2 px-4 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Manage Folders"}),(0,Lo.jsx)("button",{onClick:t=>{t.stopPropagation(),s(e)},disabled:u,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-4 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Start"}),(0,Lo.jsx)("button",{onClick:t=>{t.stopPropagation(),r(e)},disabled:u,className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Edit"}),(0,Lo.jsx)("button",{onClick:t=>{t.stopPropagation(),a(e)},disabled:u,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Export"})]})]}),c===e.id&&(0,Lo.jsx)(hc,{routine:e,folders:n,onToggleFolder:l})]},e.id)})}):o?(0,Lo.jsxs)("div",{className:"text-center p-8 bg-slate-700/50 rounded-lg",children:[(0,Lo.jsx)("h3",{className:"text-xl font-semibold text-gray-300",children:"No Routines Found"}),(0,Lo.jsx)("p",{className:"text-gray-400 mt-2",children:"You haven't created any routines yet. Get started by building a new one!"}),(0,Lo.jsx)("button",{onClick:o,className:"mt-4 bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg",children:"Create Your First Routine"})]}):(0,Lo.jsx)("p",{className:"text-center text-gray-400 py-4",children:"No routines in this folder match your current filters."})};var fc=n(950);const pc="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;function gc(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function xc(e){return"nodeType"in e}function bc(e){var t,n;return e?gc(e)?e:xc(e)&&null!=(t=null==(n=e.ownerDocument)?void 0:n.defaultView)?t:window:window}function vc(e){const{Document:t}=bc(e);return e instanceof t}function yc(e){return!gc(e)&&e instanceof bc(e).HTMLElement}function wc(e){return e instanceof bc(e).SVGElement}function jc(e){return e?gc(e)?e.document:xc(e)?vc(e)?e:yc(e)||wc(e)?e.ownerDocument:document:document:document}const kc=pc?e.useLayoutEffect:e.useEffect;function Nc(t){const n=(0,e.useRef)(t);return kc(()=>{n.current=t}),(0,e.useCallback)(function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return null==n.current?void 0:n.current(...t)},[])}function Cc(t,n){void 0===n&&(n=[t]);const s=(0,e.useRef)(t);return kc(()=>{s.current!==t&&(s.current=t)},n),s}function _c(t,n){const s=(0,e.useRef)();return(0,e.useMemo)(()=>{const e=t(s.current);return s.current=e,e},[...n])}function Sc(t){const n=Nc(t),s=(0,e.useRef)(null),r=(0,e.useCallback)(e=>{e!==s.current&&(null==n||n(e,s.current)),s.current=e},[]);return[s,r]}function Tc(t){const n=(0,e.useRef)();return(0,e.useEffect)(()=>{n.current=t},[t]),n.current}let Ac={};function Mc(t,n){return(0,e.useMemo)(()=>{if(n)return n;const e=null==Ac[t]?0:Ac[t]+1;return Ac[t]=e,t+"-"+e},[t,n])}function Ec(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];return s.reduce((t,n)=>{const s=Object.entries(n);for(const[r,a]of s){const n=t[r];null!=n&&(t[r]=n+e*a)}return t},{...t})}}const Dc=Ec(1),Rc=Ec(-1);function Ic(e){if(!e)return!1;const{KeyboardEvent:t}=bc(e.target);return t&&e instanceof t}function Pc(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=bc(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const Oc=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Oc.Translate.toString(e),Oc.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),Fc="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Lc(e){return e.matches(Fc)?e:e.querySelector(Fc)}const qc={display:"none"};function Vc(t){let{id:n,value:s}=t;return e.createElement("div",{id:n,style:qc},s)}function zc(t){let{id:n,announcement:s,ariaLiveType:r="assertive"}=t;return e.createElement("div",{id:n,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":r,"aria-atomic":!0},s)}const Gc=(0,e.createContext)(null);const Bc={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},$c={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Uc(t){let{announcements:n=$c,container:s,hiddenTextDescribedById:r,screenReaderInstructions:a=Bc}=t;const{announce:o,announcement:i}=function(){const[t,n]=(0,e.useState)("");return{announce:(0,e.useCallback)(e=>{null!=e&&n(e)},[]),announcement:t}}(),l=Mc("DndLiveRegion"),[c,u]=(0,e.useState)(!1);if((0,e.useEffect)(()=>{u(!0)},[]),function(t){const n=(0,e.useContext)(Gc);(0,e.useEffect)(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(t)},[t,n])}((0,e.useMemo)(()=>({onDragStart(e){let{active:t}=e;o(n.onDragStart({active:t}))},onDragMove(e){let{active:t,over:s}=e;n.onDragMove&&o(n.onDragMove({active:t,over:s}))},onDragOver(e){let{active:t,over:s}=e;o(n.onDragOver({active:t,over:s}))},onDragEnd(e){let{active:t,over:s}=e;o(n.onDragEnd({active:t,over:s}))},onDragCancel(e){let{active:t,over:s}=e;o(n.onDragCancel({active:t,over:s}))}}),[o,n])),!c)return null;const d=e.createElement(e.Fragment,null,e.createElement(Vc,{id:r,value:a.draggable}),e.createElement(zc,{id:l,announcement:i}));return s?(0,fc.createPortal)(d,s):d}var Wc;function Hc(){}!function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"}(Wc||(Wc={}));const Qc=Object.freeze({x:0,y:0});function Kc(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Yc(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function Xc(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function Zc(e,t,n){return void 0===t&&(t=e.left),void 0===n&&(n=e.top),{x:t+.5*e.width,y:n+.5*e.height}}const Jc=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const r=Zc(t,t.left,t.top),a=[];for(const o of s){const{id:e}=o,t=n.get(e);if(t){const n=Kc(Zc(t),r);a.push({id:e,data:{droppableContainer:o,value:n}})}}return a.sort(Yc)};function eu(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),r=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height),o=r-s,i=a-n;if(s<r&&n<a){const n=t.width*t.height,s=e.width*e.height,r=o*i;return Number((r/(n+s-r)).toFixed(4))}return 0}const tu=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const r=[];for(const a of s){const{id:e}=a,s=n.get(e);if(s){const n=eu(s,t);n>0&&r.push({id:e,data:{droppableContainer:a,value:n}})}}return r.sort(Xc)};function nu(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Qc}function su(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];return s.reduce((t,n)=>({...t,top:t.top+e*n.y,bottom:t.bottom+e*n.y,left:t.left+e*n.x,right:t.right+e*n.x}),{...t})}}const ru=su(1);function au(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}const ou={ignoreTransform:!1};function iu(e,t){void 0===t&&(t=ou);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:s}=bc(e).getComputedStyle(e);t&&(n=function(e,t,n){const s=au(t);if(!s)return e;const{scaleX:r,scaleY:a,x:o,y:i}=s,l=e.left-o-(1-r)*parseFloat(n),c=e.top-i-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),u=r?e.width/r:e.width,d=a?e.height/a:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}(n,t,s))}const{top:s,left:r,width:a,height:o,bottom:i,right:l}=n;return{top:s,left:r,width:a,height:o,bottom:i,right:l}}function lu(e){return iu(e,{ignoreTransform:!0})}function cu(e,t){const n=[];return e?function s(r){if(null!=t&&n.length>=t)return n;if(!r)return n;if(vc(r)&&null!=r.scrollingElement&&!n.includes(r.scrollingElement))return n.push(r.scrollingElement),n;if(!yc(r)||wc(r))return n;if(n.includes(r))return n;const a=bc(e).getComputedStyle(r);return r!==e&&function(e,t){void 0===t&&(t=bc(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const s=t[e];return"string"===typeof s&&n.test(s)})}(r,a)&&n.push(r),function(e,t){return void 0===t&&(t=bc(e).getComputedStyle(e)),"fixed"===t.position}(r,a)?n:s(r.parentNode)}(e):n}function uu(e){const[t]=cu(e,1);return null!=t?t:null}function du(e){return pc&&e?gc(e)?e:xc(e)?vc(e)||e===jc(e).scrollingElement?window:yc(e)?e:null:null:null}function hu(e){return gc(e)?e.scrollX:e.scrollLeft}function mu(e){return gc(e)?e.scrollY:e.scrollTop}function fu(e){return{x:hu(e),y:mu(e)}}var pu;function gu(e){return!(!pc||!e)&&e===document.scrollingElement}function xu(e){const t={x:0,y:0},n=gu(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=s.y,isRight:e.scrollLeft>=s.x,maxScroll:s,minScroll:t}}!function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"}(pu||(pu={}));const bu={x:.2,y:.2};function vu(e,t,n,s,r){let{top:a,left:o,right:i,bottom:l}=n;void 0===s&&(s=10),void 0===r&&(r=bu);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=xu(e),m={x:0,y:0},f={x:0,y:0},p=t.height*r.y,g=t.width*r.x;return!c&&a<=t.top+p?(m.y=pu.Backward,f.y=s*Math.abs((t.top+p-a)/p)):!u&&l>=t.bottom-p&&(m.y=pu.Forward,f.y=s*Math.abs((t.bottom-p-l)/p)),!h&&i>=t.right-g?(m.x=pu.Forward,f.x=s*Math.abs((t.right-g-i)/g)):!d&&o<=t.left+g&&(m.x=pu.Backward,f.x=s*Math.abs((t.left+g-o)/g)),{direction:m,speed:f}}function yu(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:n,right:s,bottom:r}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:r,width:e.clientWidth,height:e.clientHeight}}function wu(e){return e.reduce((e,t)=>Dc(e,fu(t)),Qc)}function ju(e,t){if(void 0===t&&(t=iu),!e)return;const{top:n,left:s,bottom:r,right:a}=t(e);uu(e)&&(r<=0||a<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const ku=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+hu(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+mu(t),0)}]];class Nu{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=cu(t),s=wu(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[r,a,o]of ku)for(const e of a)Object.defineProperty(this,e,{get:()=>{const t=o(n),a=s[r]-t;return this.rect[e]+a},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Cu{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,n){var s;null==(s=this.target)||s.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function _u(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return"number"===typeof t?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t&&s>t.y}var Su,Tu;function Au(e){e.preventDefault()}function Mu(e){e.stopPropagation()}!function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"}(Su||(Su={})),function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"}(Tu||(Tu={}));const Eu={start:[Tu.Space,Tu.Enter],cancel:[Tu.Esc],end:[Tu.Space,Tu.Enter,Tu.Tab]},Du=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Tu.Right:return{...n,x:n.x+25};case Tu.Left:return{...n,x:n.x-25};case Tu.Down:return{...n,y:n.y+25};case Tu.Up:return{...n,y:n.y-25}}};class Ru{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new Cu(jc(t)),this.windowListeners=new Cu(bc(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Su.Resize,this.handleCancel),this.windowListeners.add(Su.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Su.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&ju(n),t(Qc)}handleKeyDown(e){if(Ic(e)){const{active:t,context:n,options:s}=this.props,{keyboardCodes:r=Eu,coordinateGetter:a=Du,scrollBehavior:o="smooth"}=s,{code:i}=e;if(r.end.includes(i))return void this.handleEnd(e);if(r.cancel.includes(i))return void this.handleCancel(e);const{collisionRect:l}=n.current,c=l?{x:l.left,y:l.top}:Qc;this.referenceCoordinates||(this.referenceCoordinates=c);const u=a(e,{active:t,context:n.current,currentCoordinates:c});if(u){const t=Rc(u,c),s={x:0,y:0},{scrollableAncestors:r}=n.current;for(const n of r){const r=e.code,{isTop:a,isRight:i,isLeft:l,isBottom:c,maxScroll:d,minScroll:h}=xu(n),m=yu(n),f={x:Math.min(r===Tu.Right?m.right-m.width/2:m.right,Math.max(r===Tu.Right?m.left:m.left+m.width/2,u.x)),y:Math.min(r===Tu.Down?m.bottom-m.height/2:m.bottom,Math.max(r===Tu.Down?m.top:m.top+m.height/2,u.y))},p=r===Tu.Right&&!i||r===Tu.Left&&!l,g=r===Tu.Down&&!c||r===Tu.Up&&!a;if(p&&f.x!==u.x){const e=n.scrollLeft+t.x,a=r===Tu.Right&&e<=d.x||r===Tu.Left&&e>=h.x;if(a&&!t.y)return void n.scrollTo({left:e,behavior:o});s.x=a?n.scrollLeft-e:r===Tu.Right?n.scrollLeft-d.x:n.scrollLeft-h.x,s.x&&n.scrollBy({left:-s.x,behavior:o});break}if(g&&f.y!==u.y){const e=n.scrollTop+t.y,a=r===Tu.Down&&e<=d.y||r===Tu.Up&&e>=h.y;if(a&&!t.x)return void n.scrollTo({top:e,behavior:o});s.y=a?n.scrollTop-e:r===Tu.Down?n.scrollTop-d.y:n.scrollTop-h.y,s.y&&n.scrollBy({top:-s.y,behavior:o});break}}this.handleMove(e,Dc(Rc(u,this.referenceCoordinates),s))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function Iu(e){return Boolean(e&&"distance"in e)}function Pu(e){return Boolean(e&&"delay"in e)}Ru.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=Eu,onActivation:r}=t,{active:a}=n;const{code:o}=e.nativeEvent;if(s.start.includes(o)){const t=a.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==r||r({event:e.nativeEvent}),!0)}return!1}}];class Ou{constructor(e,t,n){var s;void 0===n&&(n=function(e){const{EventTarget:t}=bc(e);return e instanceof t?e:jc(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:r}=e,{target:a}=r;this.props=e,this.events=t,this.document=jc(a),this.documentListeners=new Cu(this.document),this.listeners=new Cu(n),this.windowListeners=new Cu(bc(a)),this.initialCoordinates=null!=(s=Pc(r))?s:Qc,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Su.Resize,this.handleCancel),this.windowListeners.add(Su.DragStart,Au),this.windowListeners.add(Su.VisibilityChange,this.handleCancel),this.windowListeners.add(Su.ContextMenu,Au),this.documentListeners.add(Su.Keydown,this.handleKeydown),t){if(null!=n&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Pu(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(Iu(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:s}=this.props;s(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Su.Click,Mu,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Su.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:s,props:r}=this,{onMove:a,options:{activationConstraint:o}}=r;if(!s)return;const i=null!=(t=Pc(e))?t:Qc,l=Rc(s,i);if(!n&&o){if(Iu(o)){if(null!=o.tolerance&&_u(l,o.tolerance))return this.handleCancel();if(_u(l,o.distance))return this.handleStart()}return Pu(o)&&_u(l,o.tolerance)?this.handleCancel():void this.handlePending(o,l)}e.cancelable&&e.preventDefault(),a(i)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===Tu.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const Fu={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Lu extends Ou{constructor(e){const{event:t}=e,n=jc(t.target);super(e,Fu,n)}}Lu.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!(!n.isPrimary||0!==n.button)&&(null==s||s({event:n}),!0)}}];const qu={move:{name:"mousemove"},end:{name:"mouseup"}};var Vu;!function(e){e[e.RightClick=2]="RightClick"}(Vu||(Vu={}));(class extends Ou{constructor(e){super(e,qu,jc(e.event.target))}}).activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button!==Vu.RightClick&&(null==s||s({event:n}),!0)}}];const zu={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var Gu,Bu;function $u(t){let{acceleration:n,activator:s=Gu.Pointer,canScroll:r,draggingRect:a,enabled:o,interval:i=5,order:l=Bu.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:m}=t;const f=function(e){let{delta:t,disabled:n}=e;const s=Tc(t);return _c(e=>{if(n||!s||!e)return Uu;const r={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[pu.Backward]:e.x[pu.Backward]||-1===r.x,[pu.Forward]:e.x[pu.Forward]||1===r.x},y:{[pu.Backward]:e.y[pu.Backward]||-1===r.y,[pu.Forward]:e.y[pu.Forward]||1===r.y}}},[n,t,s])}({delta:h,disabled:!o}),[p,g]=function(){const t=(0,e.useRef)(null);return[(0,e.useCallback)((e,n)=>{t.current=setInterval(e,n)},[]),(0,e.useCallback)(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]}(),x=(0,e.useRef)({x:0,y:0}),b=(0,e.useRef)({x:0,y:0}),v=(0,e.useMemo)(()=>{switch(s){case Gu.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Gu.DraggableRect:return a}},[s,a,c]),y=(0,e.useRef)(null),w=(0,e.useCallback)(()=>{const e=y.current;if(!e)return;const t=x.current.x*b.current.x,n=x.current.y*b.current.y;e.scrollBy(t,n)},[]),j=(0,e.useMemo)(()=>l===Bu.TreeOrder?[...u].reverse():u,[l,u]);(0,e.useEffect)(()=>{if(o&&u.length&&v){for(const e of j){if(!1===(null==r?void 0:r(e)))continue;const t=u.indexOf(e),s=d[t];if(!s)continue;const{direction:a,speed:o}=vu(e,s,v,n,m);for(const e of["x","y"])f[e][a[e]]||(o[e]=0,a[e]=0);if(o.x>0||o.y>0)return g(),y.current=e,p(w,i),x.current=o,void(b.current=a)}x.current={x:0,y:0},b.current={x:0,y:0},g()}else g()},[n,w,r,g,o,i,JSON.stringify(v),JSON.stringify(f),p,u,j,d,JSON.stringify(m)])}(class extends Ou{constructor(e){super(e,zu)}static setup(){return window.addEventListener(zu.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(zu.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:r}=n;return!(r.length>1)&&(null==s||s({event:n}),!0)}}],function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"}(Gu||(Gu={})),function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"}(Bu||(Bu={}));const Uu={x:{[pu.Backward]:!1,[pu.Forward]:!1},y:{[pu.Backward]:!1,[pu.Forward]:!1}};var Wu,Hu;!function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"}(Wu||(Wu={})),function(e){e.Optimized="optimized"}(Hu||(Hu={}));const Qu=new Map;function Ku(e,t){return _c(n=>e?n||("function"===typeof t?t(e):e):null,[t,e])}function Yu(t){let{callback:n,disabled:s}=t;const r=Nc(n),a=(0,e.useMemo)(()=>{if(s||"undefined"===typeof window||"undefined"===typeof window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(r)},[s]);return(0,e.useEffect)(()=>()=>null==a?void 0:a.disconnect(),[a]),a}function Xu(e){return new Nu(iu(e),e)}function Zu(t,n,s){void 0===n&&(n=Xu);const[r,a]=(0,e.useState)(null);function o(){a(e=>{if(!t)return null;var r;if(!1===t.isConnected)return null!=(r=null!=e?e:s)?r:null;const a=n(t);return JSON.stringify(e)===JSON.stringify(a)?e:a})}const i=function(t){let{callback:n,disabled:s}=t;const r=Nc(n),a=(0,e.useMemo)(()=>{if(s||"undefined"===typeof window||"undefined"===typeof window.MutationObserver)return;const{MutationObserver:e}=window;return new e(r)},[r,s]);return(0,e.useEffect)(()=>()=>null==a?void 0:a.disconnect(),[a]),a}({callback(e){if(t)for(const n of e){const{type:e,target:s}=n;if("childList"===e&&s instanceof HTMLElement&&s.contains(t)){o();break}}}}),l=Yu({callback:o});return kc(()=>{o(),t?(null==l||l.observe(t),null==i||i.observe(document.body,{childList:!0,subtree:!0})):(null==l||l.disconnect(),null==i||i.disconnect())},[t]),r}const Ju=[];function ed(t,n){void 0===n&&(n=[]);const s=(0,e.useRef)(null);return(0,e.useEffect)(()=>{s.current=null},n),(0,e.useEffect)(()=>{const e=t!==Qc;e&&!s.current&&(s.current=t),!e&&s.current&&(s.current=null)},[t]),s.current?Rc(t,s.current):Qc}function td(t){return(0,e.useMemo)(()=>t?function(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}(t):null,[t])}const nd=[];function sd(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return yc(t)?t:e}const rd=[{sensor:Lu,options:{}},{sensor:Ru,options:{}}],ad={current:{}},od={draggable:{measure:lu},droppable:{measure:lu,strategy:Wu.WhileDragging,frequency:Hu.Optimized},dragOverlay:{measure:iu}};class id extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return null!=(t=null==(n=this.get(e))?void 0:n.node.current)?t:void 0}}const ld={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new id,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Hc},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:od,measureDroppableContainers:Hc,windowRect:null,measuringScheduled:!1},cd={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Hc,draggableNodes:new Map,over:null,measureDroppableContainers:Hc},ud=(0,e.createContext)(cd),dd=(0,e.createContext)(ld);function hd(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new id}}}function md(e,t){switch(t.type){case Wc.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Wc.DragMove:return null==e.draggable.active?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Wc.DragEnd:case Wc.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Wc.RegisterDroppable:{const{element:n}=t,{id:s}=n,r=new id(e.droppable.containers);return r.set(s,n),{...e,droppable:{...e.droppable,containers:r}}}case Wc.SetDroppableDisabled:{const{id:n,key:s,disabled:r}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const o=new id(e.droppable.containers);return o.set(n,{...a,disabled:r}),{...e,droppable:{...e.droppable,containers:o}}}case Wc.UnregisterDroppable:{const{id:n,key:s}=t,r=e.droppable.containers.get(n);if(!r||s!==r.key)return e;const a=new id(e.droppable.containers);return a.delete(n),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function fd(t){let{disabled:n}=t;const{active:s,activatorEvent:r,draggableNodes:a}=(0,e.useContext)(ud),o=Tc(r),i=Tc(null==s?void 0:s.id);return(0,e.useEffect)(()=>{if(!n&&!r&&o&&null!=i){if(!Ic(o))return;if(document.activeElement===o.target)return;const e=a.get(i);if(!e)return;const{activatorNode:t,node:n}=e;if(!t.current&&!n.current)return;requestAnimationFrame(()=>{for(const e of[t.current,n.current]){if(!e)continue;const t=Lc(e);if(t){t.focus();break}}})}},[r,n,a,i,o]),null}function pd(e,t){let{transform:n,...s}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...s}),n):n}const gd=(0,e.createContext)({...Qc,scaleX:1,scaleY:1});var xd;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(xd||(xd={}));const bd=(0,e.memo)(function(t){var n,s,r,a;let{id:o,accessibility:i,autoScroll:l=!0,children:c,sensors:u=rd,collisionDetection:d=tu,measuring:h,modifiers:m,...f}=t;const p=(0,e.useReducer)(md,void 0,hd),[g,x]=p,[b,v]=function(){const[t]=(0,e.useState)(()=>new Set),n=(0,e.useCallback)(e=>(t.add(e),()=>t.delete(e)),[t]);return[(0,e.useCallback)(e=>{let{type:n,event:s}=e;t.forEach(e=>{var t;return null==(t=e[n])?void 0:t.call(e,s)})},[t]),n]}(),[y,w]=(0,e.useState)(xd.Uninitialized),j=y===xd.Initialized,{draggable:{active:k,nodes:N,translate:C},droppable:{containers:_}}=g,S=null!=k?N.get(k):null,T=(0,e.useRef)({initial:null,translated:null}),A=(0,e.useMemo)(()=>{var e;return null!=k?{id:k,data:null!=(e=null==S?void 0:S.data)?e:ad,rect:T}:null},[k,S]),M=(0,e.useRef)(null),[E,D]=(0,e.useState)(null),[R,I]=(0,e.useState)(null),P=Cc(f,Object.values(f)),O=Mc("DndDescribedBy",o),F=(0,e.useMemo)(()=>_.getEnabled(),[_]),L=(q=h,(0,e.useMemo)(()=>({draggable:{...od.draggable,...null==q?void 0:q.draggable},droppable:{...od.droppable,...null==q?void 0:q.droppable},dragOverlay:{...od.dragOverlay,...null==q?void 0:q.dragOverlay}}),[null==q?void 0:q.draggable,null==q?void 0:q.droppable,null==q?void 0:q.dragOverlay]));var q;const{droppableRects:V,measureDroppableContainers:z,measuringScheduled:G}=function(t,n){let{dragging:s,dependencies:r,config:a}=n;const[o,i]=(0,e.useState)(null),{frequency:l,measure:c,strategy:u}=a,d=(0,e.useRef)(t),h=function(){switch(u){case Wu.Always:return!1;case Wu.BeforeDragging:return s;default:return!s}}(),m=Cc(h),f=(0,e.useCallback)(function(e){void 0===e&&(e=[]),m.current||i(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[m]),p=(0,e.useRef)(null),g=_c(e=>{if(h&&!s)return Qu;if(!e||e===Qu||d.current!==t||null!=o){const e=new Map;for(let n of t){if(!n)continue;if(o&&o.length>0&&!o.includes(n.id)&&n.rect.current){e.set(n.id,n.rect.current);continue}const t=n.node.current,s=t?new Nu(c(t),t):null;n.rect.current=s,s&&e.set(n.id,s)}return e}return e},[t,o,s,h,c]);return(0,e.useEffect)(()=>{d.current=t},[t]),(0,e.useEffect)(()=>{h||f()},[s,h]),(0,e.useEffect)(()=>{o&&o.length>0&&i(null)},[JSON.stringify(o)]),(0,e.useEffect)(()=>{h||"number"!==typeof l||null!==p.current||(p.current=setTimeout(()=>{f(),p.current=null},l))},[l,h,f,...r]),{droppableRects:g,measureDroppableContainers:f,measuringScheduled:null!=o}}(F,{dragging:j,dependencies:[C.x,C.y],config:L.droppable}),B=function(e,t){const n=null!=t?e.get(t):void 0,s=n?n.node.current:null;return _c(e=>{var n;return null==t?null:null!=(n=null!=s?s:e)?n:null},[s,t])}(N,k),$=(0,e.useMemo)(()=>R?Pc(R):null,[R]),U=function(){const e=!1===(null==E?void 0:E.autoScrollEnabled),t="object"===typeof l?!1===l.enabled:!1===l,n=j&&!e&&!t;if("object"===typeof l)return{...l,enabled:n};return{enabled:n}}(),W=function(e,t){return Ku(e,t)}(B,L.draggable.measure);!function(t){let{activeNode:n,measure:s,initialRect:r,config:a=!0}=t;const o=(0,e.useRef)(!1),{x:i,y:l}="boolean"===typeof a?{x:a,y:a}:a;kc(()=>{if(!i&&!l||!n)return void(o.current=!1);if(o.current||!r)return;const e=null==n?void 0:n.node.current;if(!e||!1===e.isConnected)return;const t=nu(s(e),r);if(i||(t.x=0),l||(t.y=0),o.current=!0,Math.abs(t.x)>0||Math.abs(t.y)>0){const n=uu(e);n&&n.scrollBy({top:t.y,left:t.x})}},[n,i,l,r,s])}({activeNode:null!=k?N.get(k):null,config:U.layoutShiftCompensation,initialRect:W,measure:L.draggable.measure});const H=Zu(B,L.draggable.measure,W),Q=Zu(B?B.parentElement:null),K=(0,e.useRef)({activatorEvent:null,active:null,activeNode:B,collisionRect:null,collisions:null,droppableRects:V,draggableNodes:N,draggingNode:null,draggingNodeRect:null,droppableContainers:_,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Y=_.getNodeFor(null==(n=K.current.over)?void 0:n.id),X=function(t){let{measure:n}=t;const[s,r]=(0,e.useState)(null),a=Yu({callback:(0,e.useCallback)(e=>{for(const{target:t}of e)if(yc(t)){r(e=>{const s=n(t);return e?{...e,width:s.width,height:s.height}:s});break}},[n])}),o=(0,e.useCallback)(e=>{const t=sd(e);null==a||a.disconnect(),t&&(null==a||a.observe(t)),r(t?n(t):null)},[n,a]),[i,l]=Sc(o);return(0,e.useMemo)(()=>({nodeRef:i,rect:s,setRef:l}),[s,i,l])}({measure:L.dragOverlay.measure}),Z=null!=(s=X.nodeRef.current)?s:B,J=j?null!=(r=X.rect)?r:H:null,ee=Boolean(X.nodeRef.current&&X.rect),te=nu(ne=ee?null:H,Ku(ne));var ne;const se=td(Z?bc(Z):null),re=function(t){const n=(0,e.useRef)(t),s=_c(e=>t?e&&e!==Ju&&t&&n.current&&t.parentNode===n.current.parentNode?e:cu(t):Ju,[t]);return(0,e.useEffect)(()=>{n.current=t},[t]),s}(j?null!=Y?Y:B:null),ae=function(t,n){void 0===n&&(n=iu);const[s]=t,r=td(s?bc(s):null),[a,o]=(0,e.useState)(nd);function i(){o(()=>t.length?t.map(e=>gu(e)?r:new Nu(n(e),e)):nd)}const l=Yu({callback:i});return kc(()=>{null==l||l.disconnect(),i(),t.forEach(e=>null==l?void 0:l.observe(e))},[t]),a}(re),oe=pd(m,{transform:{x:C.x-te.x,y:C.y-te.y,scaleX:1,scaleY:1},activatorEvent:R,active:A,activeNodeRect:H,containerNodeRect:Q,draggingNodeRect:J,over:K.current.over,overlayNodeRect:X.rect,scrollableAncestors:re,scrollableAncestorRects:ae,windowRect:se}),ie=$?Dc($,C):null,le=function(t){const[n,s]=(0,e.useState)(null),r=(0,e.useRef)(t),a=(0,e.useCallback)(e=>{const t=du(e.target);t&&s(e=>e?(e.set(t,fu(t)),new Map(e)):null)},[]);return(0,e.useEffect)(()=>{const e=r.current;if(t!==e){n(e);const o=t.map(e=>{const t=du(e);return t?(t.addEventListener("scroll",a,{passive:!0}),[t,fu(t)]):null}).filter(e=>null!=e);s(o.length?new Map(o):null),r.current=t}return()=>{n(t),n(e)};function n(e){e.forEach(e=>{const t=du(e);null==t||t.removeEventListener("scroll",a)})}},[a,t]),(0,e.useMemo)(()=>t.length?n?Array.from(n.values()).reduce((e,t)=>Dc(e,t),Qc):wu(t):Qc,[t,n])}(re),ce=ed(le),ue=ed(le,[H]),de=Dc(oe,ce),he=J?ru(J,oe):null,me=A&&he?d({active:A,collisionRect:he,droppableRects:V,droppableContainers:F,pointerCoordinates:ie}):null,fe=function(e,t){if(!e||0===e.length)return null;const[n]=e;return t?n[t]:n}(me,"id"),[pe,ge]=(0,e.useState)(null),xe=function(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}(ee?oe:Dc(oe,ue),null!=(a=null==pe?void 0:pe.rect)?a:null,H),be=(0,e.useRef)(null),ve=(0,e.useCallback)((e,t)=>{let{sensor:n,options:s}=t;if(null==M.current)return;const r=N.get(M.current);if(!r)return;const a=e.nativeEvent,o=new n({active:M.current,activeNode:r,event:a,options:s,context:K,onAbort(e){if(!N.get(e))return;const{onDragAbort:t}=P.current,n={id:e};null==t||t(n),b({type:"onDragAbort",event:n})},onPending(e,t,n,s){if(!N.get(e))return;const{onDragPending:r}=P.current,a={id:e,constraint:t,initialCoordinates:n,offset:s};null==r||r(a),b({type:"onDragPending",event:a})},onStart(e){const t=M.current;if(null==t)return;const n=N.get(t);if(!n)return;const{onDragStart:s}=P.current,r={activatorEvent:a,active:{id:t,data:n.data,rect:T}};(0,fc.unstable_batchedUpdates)(()=>{null==s||s(r),w(xd.Initializing),x({type:Wc.DragStart,initialCoordinates:e,active:t}),b({type:"onDragStart",event:r}),D(be.current),I(a)})},onMove(e){x({type:Wc.DragMove,coordinates:e})},onEnd:i(Wc.DragEnd),onCancel:i(Wc.DragCancel)});function i(e){return async function(){const{active:t,collisions:n,over:s,scrollAdjustedTranslate:r}=K.current;let o=null;if(t&&r){const{cancelDrop:i}=P.current;if(o={activatorEvent:a,active:t,collisions:n,delta:r,over:s},e===Wc.DragEnd&&"function"===typeof i){await Promise.resolve(i(o))&&(e=Wc.DragCancel)}}M.current=null,(0,fc.unstable_batchedUpdates)(()=>{x({type:e}),w(xd.Uninitialized),ge(null),D(null),I(null),be.current=null;const t=e===Wc.DragEnd?"onDragEnd":"onDragCancel";if(o){const e=P.current[t];null==e||e(o),b({type:t,event:o})}})}}be.current=o},[N]),ye=(0,e.useCallback)((e,t)=>(n,s)=>{const r=n.nativeEvent,a=N.get(s);if(null!==M.current||!a||r.dndKit||r.defaultPrevented)return;const o={active:a};!0===e(n,t.options,o)&&(r.dndKit={capturedBy:t.sensor},M.current=s,ve(n,t))},[N,ve]),we=function(t,n){return(0,e.useMemo)(()=>t.reduce((e,t)=>{const{sensor:s}=t;return[...e,...s.activators.map(e=>({eventName:e.eventName,handler:n(e.handler,t)}))]},[]),[t,n])}(u,ye);!function(t){(0,e.useEffect)(()=>{if(!pc)return;const e=t.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(const t of e)null==t||t()}},t.map(e=>{let{sensor:t}=e;return t}))}(u),kc(()=>{H&&y===xd.Initializing&&w(xd.Initialized)},[H,y]),(0,e.useEffect)(()=>{const{onDragMove:e}=P.current,{active:t,activatorEvent:n,collisions:s,over:r}=K.current;if(!t||!n)return;const a={active:t,activatorEvent:n,collisions:s,delta:{x:de.x,y:de.y},over:r};(0,fc.unstable_batchedUpdates)(()=>{null==e||e(a),b({type:"onDragMove",event:a})})},[de.x,de.y]),(0,e.useEffect)(()=>{const{active:e,activatorEvent:t,collisions:n,droppableContainers:s,scrollAdjustedTranslate:r}=K.current;if(!e||null==M.current||!t||!r)return;const{onDragOver:a}=P.current,o=s.get(fe),i=o&&o.rect.current?{id:o.id,rect:o.rect.current,data:o.data,disabled:o.disabled}:null,l={active:e,activatorEvent:t,collisions:n,delta:{x:r.x,y:r.y},over:i};(0,fc.unstable_batchedUpdates)(()=>{ge(i),null==a||a(l),b({type:"onDragOver",event:l})})},[fe]),kc(()=>{K.current={activatorEvent:R,active:A,activeNode:B,collisionRect:he,collisions:me,droppableRects:V,draggableNodes:N,draggingNode:Z,draggingNodeRect:J,droppableContainers:_,over:pe,scrollableAncestors:re,scrollAdjustedTranslate:de},T.current={initial:J,translated:he}},[A,B,me,he,N,Z,J,V,_,pe,re,de]),$u({...U,delta:C,draggingRect:he,pointerCoordinates:ie,scrollableAncestors:re,scrollableAncestorRects:ae});const je=(0,e.useMemo)(()=>({active:A,activeNode:B,activeNodeRect:H,activatorEvent:R,collisions:me,containerNodeRect:Q,dragOverlay:X,draggableNodes:N,droppableContainers:_,droppableRects:V,over:pe,measureDroppableContainers:z,scrollableAncestors:re,scrollableAncestorRects:ae,measuringConfiguration:L,measuringScheduled:G,windowRect:se}),[A,B,H,R,me,Q,X,N,_,V,pe,z,re,ae,L,G,se]),ke=(0,e.useMemo)(()=>({activatorEvent:R,activators:we,active:A,activeNodeRect:H,ariaDescribedById:{draggable:O},dispatch:x,draggableNodes:N,over:pe,measureDroppableContainers:z}),[R,we,A,H,x,O,N,pe,z]);return e.createElement(Gc.Provider,{value:v},e.createElement(ud.Provider,{value:ke},e.createElement(dd.Provider,{value:je},e.createElement(gd.Provider,{value:xe},c)),e.createElement(fd,{disabled:!1===(null==i?void 0:i.restoreFocus)})),e.createElement(Uc,{...i,hiddenTextDescribedById:O}))}),vd=(0,e.createContext)(null),yd="button";function wd(t){let{id:n,data:s,disabled:r=!1,attributes:a}=t;const o=Mc("Draggable"),{activators:i,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:m}=(0,e.useContext)(ud),{role:f=yd,roleDescription:p="draggable",tabIndex:g=0}=null!=a?a:{},x=(null==c?void 0:c.id)===n,b=(0,e.useContext)(x?gd:vd),[v,y]=Sc(),[w,j]=Sc(),k=function(t,n){return(0,e.useMemo)(()=>t.reduce((e,t)=>{let{eventName:s,handler:r}=t;return e[s]=e=>{r(e,n)},e},{}),[t,n])}(i,n),N=Cc(s);kc(()=>(h.set(n,{id:n,key:o,node:v,activatorNode:w,data:N}),()=>{const e=h.get(n);e&&e.key===o&&h.delete(n)}),[h,n]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:(0,e.useMemo)(()=>({role:f,tabIndex:g,"aria-disabled":r,"aria-pressed":!(!x||f!==yd)||void 0,"aria-roledescription":p,"aria-describedby":d.draggable}),[r,f,g,x,p,d.draggable]),isDragging:x,listeners:r?void 0:k,node:v,over:m,setNodeRef:y,setActivatorNodeRef:j,transform:b}}function jd(){return(0,e.useContext)(dd)}const kd={timeout:25};function Nd(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function Cd(e,t){return e.reduce((e,n,s)=>{const r=t.get(n);return r&&(e[s]=r),e},Array(e.length))}function _d(e){return null!==e&&e>=0}const Sd=e=>{let{rects:t,activeIndex:n,overIndex:s,index:r}=e;const a=Nd(t,s,n),o=t[r],i=a[r];return i&&o?{x:i.left-o.left,y:i.top-o.top,scaleX:i.width/o.width,scaleY:i.height/o.height}:null},Td={scaleX:1,scaleY:1},Ad=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:r,rects:a,overIndex:o}=e;const i=null!=(t=a[n])?t:s;if(!i)return null;if(r===n){const e=a[o];return e?{x:0,y:n<o?e.top+e.height-(i.top+i.height):e.top-i.top,...Td}:null}const l=function(e,t,n){const s=e[t],r=e[t-1],a=e[t+1];if(!s)return 0;if(n<t)return r?s.top-(r.top+r.height):a?a.top-(s.top+s.height):0;return a?a.top-(s.top+s.height):r?s.top-(r.top+r.height):0}(a,r,n);return r>n&&r<=o?{x:0,y:-i.height-l,...Td}:r<n&&r>=o?{x:0,y:i.height+l,...Td}:{x:0,y:0,...Td}};const Md="Sortable",Ed=e.createContext({activeIndex:-1,containerId:Md,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Sd,disabled:{draggable:!1,droppable:!1}});function Dd(t){let{children:n,id:s,items:r,strategy:a=Sd,disabled:o=!1}=t;const{active:i,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=jd(),h=Mc(Md,s),m=Boolean(null!==l.rect),f=(0,e.useMemo)(()=>r.map(e=>"object"===typeof e&&"id"in e?e.id:e),[r]),p=null!=i,g=i?f.indexOf(i.id):-1,x=u?f.indexOf(u.id):-1,b=(0,e.useRef)(f),v=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(f,b.current),y=-1!==x&&-1===g||v,w=function(e){return"boolean"===typeof e?{draggable:e,droppable:e}:e}(o);kc(()=>{v&&p&&d(f)},[v,f,p,d]),(0,e.useEffect)(()=>{b.current=f},[f]);const j=(0,e.useMemo)(()=>({activeIndex:g,containerId:h,disabled:w,disableTransforms:y,items:f,overIndex:x,useDragOverlay:m,sortedRects:Cd(f,c),strategy:a}),[g,h,w.draggable,w.droppable,y,f,x,c,m,a]);return e.createElement(Ed.Provider,{value:j},n)}const Rd=e=>{let{id:t,items:n,activeIndex:s,overIndex:r}=e;return Nd(n,s,r).indexOf(t)},Id=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:r,items:a,newIndex:o,previousItems:i,previousContainerId:l,transition:c}=e;return!(!c||!s)&&((i===a||r!==o)&&(!!n||o!==r&&t===l))},Pd={duration:200,easing:"ease"},Od="transform",Fd=Oc.Transition.toString({property:Od,duration:0,easing:"linear"}),Ld={roleDescription:"sortable"};function qd(t){let{animateLayoutChanges:n=Id,attributes:s,disabled:r,data:a,getNewIndex:o=Rd,id:i,strategy:l,resizeObserverConfig:c,transition:u=Pd}=t;const{items:d,containerId:h,activeIndex:m,disabled:f,disableTransforms:p,sortedRects:g,overIndex:x,useDragOverlay:b,strategy:v}=(0,e.useContext)(Ed),y=function(e,t){var n,s;if("boolean"===typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(n=null==e?void 0:e.draggable)?n:t.draggable,droppable:null!=(s=null==e?void 0:e.droppable)?s:t.droppable}}(r,f),w=d.indexOf(i),j=(0,e.useMemo)(()=>({sortable:{containerId:h,index:w,items:d},...a}),[h,a,w,d]),k=(0,e.useMemo)(()=>d.slice(d.indexOf(i)),[d,i]),{rect:N,node:C,isOver:_,setNodeRef:S}=function(t){let{data:n,disabled:s=!1,id:r,resizeObserverConfig:a}=t;const o=Mc("Droppable"),{active:i,dispatch:l,over:c,measureDroppableContainers:u}=(0,e.useContext)(ud),d=(0,e.useRef)({disabled:s}),h=(0,e.useRef)(!1),m=(0,e.useRef)(null),f=(0,e.useRef)(null),{disabled:p,updateMeasurementsFor:g,timeout:x}={...kd,...a},b=Cc(null!=g?g:r),v=Yu({callback:(0,e.useCallback)(()=>{h.current?(null!=f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{u(Array.isArray(b.current)?b.current:[b.current]),f.current=null},x)):h.current=!0},[x]),disabled:p||!i}),y=(0,e.useCallback)((e,t)=>{v&&(t&&(v.unobserve(t),h.current=!1),e&&v.observe(e))},[v]),[w,j]=Sc(y),k=Cc(n);return(0,e.useEffect)(()=>{v&&w.current&&(v.disconnect(),h.current=!1,v.observe(w.current))},[w,v]),(0,e.useEffect)(()=>(l({type:Wc.RegisterDroppable,element:{id:r,key:o,disabled:s,node:w,rect:m,data:k}}),()=>l({type:Wc.UnregisterDroppable,key:o,id:r})),[r]),(0,e.useEffect)(()=>{s!==d.current.disabled&&(l({type:Wc.SetDroppableDisabled,id:r,key:o,disabled:s}),d.current.disabled=s)},[r,o,s,l]),{active:i,rect:m,isOver:(null==c?void 0:c.id)===r,node:w,over:c,setNodeRef:j}}({id:i,data:j,disabled:y.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:T,activatorEvent:A,activeNodeRect:M,attributes:E,setNodeRef:D,listeners:R,isDragging:I,over:P,setActivatorNodeRef:O,transform:F}=wd({id:i,data:j,attributes:{...Ld,...s},disabled:y.draggable}),L=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return(0,e.useMemo)(()=>e=>{n.forEach(t=>t(e))},n)}(S,D),q=Boolean(T),V=q&&!p&&_d(m)&&_d(x),z=!b&&I,G=z&&V?F:null,B=V?null!=G?G:(null!=l?l:v)({rects:g,activeNodeRect:M,activeIndex:m,overIndex:x,index:w}):null,$=_d(m)&&_d(x)?o({id:i,items:d,activeIndex:m,overIndex:x}):w,U=null==T?void 0:T.id,W=(0,e.useRef)({activeId:U,items:d,newIndex:$,containerId:h}),H=d!==W.current.items,Q=n({active:T,containerId:h,isDragging:I,isSorting:q,id:i,index:w,items:d,newIndex:W.current.newIndex,previousItems:W.current.items,previousContainerId:W.current.containerId,transition:u,wasDragging:null!=W.current.activeId}),K=function(t){let{disabled:n,index:s,node:r,rect:a}=t;const[o,i]=(0,e.useState)(null),l=(0,e.useRef)(s);return kc(()=>{if(!n&&s!==l.current&&r.current){const e=a.current;if(e){const t=iu(r.current,{ignoreTransform:!0}),n={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(n.x||n.y)&&i(n)}}s!==l.current&&(l.current=s)},[n,s,r,a]),(0,e.useEffect)(()=>{o&&i(null)},[o]),o}({disabled:!Q,index:w,node:C,rect:N});return(0,e.useEffect)(()=>{q&&W.current.newIndex!==$&&(W.current.newIndex=$),h!==W.current.containerId&&(W.current.containerId=h),d!==W.current.items&&(W.current.items=d)},[q,$,h,d]),(0,e.useEffect)(()=>{if(U===W.current.activeId)return;if(null!=U&&null==W.current.activeId)return void(W.current.activeId=U);const e=setTimeout(()=>{W.current.activeId=U},50);return()=>clearTimeout(e)},[U]),{active:T,activeIndex:m,attributes:E,data:j,rect:N,index:w,newIndex:$,items:d,isOver:_,isSorting:q,isDragging:I,listeners:R,node:C,overIndex:x,over:P,setNodeRef:L,setActivatorNodeRef:O,setDroppableNodeRef:S,setDraggableNodeRef:D,transform:null!=K?K:B,transition:function(){if(K||H&&W.current.newIndex===w)return Fd;if(z&&!Ic(A)||!u)return;if(q||Q)return Oc.Transition.toString({...u,property:Od});return}()}}Tu.Down,Tu.Right,Tu.Up,Tu.Left;const Vd=e=>{let{step:t,index:n,onRemove:s,getPresetInfo:r}=e;const{attributes:a,listeners:o,setNodeRef:i,transform:l,transition:c}=qd({id:t.id}),u={transform:Oc.Transform.toString(l),transition:c},d=r(t.presetId);return(0,Lo.jsxs)("div",{ref:i,style:u,...a,className:"bg-slate-800 p-3 rounded-md flex items-center justify-between touch-none",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-4 flex-grow min-w-0",children:[(0,Lo.jsx)("button",{...o,className:"cursor-grab text-gray-400 p-2",children:(0,Lo.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Lo.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,Lo.jsxs)("div",{className:"flex-grow min-w-0",children:[(0,Lo.jsxs)("span",{className:"font-semibold text-gray-200 truncate block",children:[n+1,". ",d.name]}),(0,Lo.jsx)("p",{className:"text-xs text-gray-400",children:d.gameName}),t.instruction&&(0,Lo.jsxs)("p",{className:"text-sm text-amber-300 mt-1 italic truncate",children:['"',t.instruction,'"']})]})]}),(0,Lo.jsxs)("div",{className:"flex items-center gap-4 flex-shrink-0",children:[t.goalType&&(0,Lo.jsx)("span",{className:"text-sm text-gray-400",children:"time"===t.goalType?t.goalValue/60+" min":`${t.goalValue} questions`}),(0,Lo.jsx)("button",{onClick:()=>s(n),className:"text-red-500 hover:text-red-400 font-bold text-2xl px-2",children:"\xd7"})]})]})},zd=t=>{let{steps:n,onRemoveStep:s,onReorderSteps:r,getPresetInfo:a}=t;const o=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return(0,e.useMemo)(()=>[...n].filter(e=>null!=e),[...n])}((i=Lu,l={activationConstraint:{distance:8}},(0,e.useMemo)(()=>({sensor:i,options:null!=l?l:{}}),[i,l])));var i,l;return(0,Lo.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,Lo.jsx)(bd,{sensors:o,collisionDetection:Jc,onDragEnd:e=>{const{active:t,over:s}=e;if(s&&t.id!==s.id){const e=n.findIndex(e=>e.id===t.id),a=n.findIndex(e=>e.id===s.id);r(e,a)}},children:(0,Lo.jsx)(Dd,{items:n,strategy:Ad,children:n.map((e,t)=>(0,Lo.jsx)(Vd,{id:e.id,step:e,index:t,onRemove:s,getPresetInfo:a},e.id))})}),0===n.length&&(0,Lo.jsx)("p",{className:"text-center text-gray-400",children:"No steps added yet."})]})},Gd=[{name:"Generators",modules:["Note Generator","Interval Generator","Chord Progression Generator"]},{name:"Theory",modules:["Interval Practice","Triad & Tetrads Quiz","Chord Trainer"]},{name:"Fretboard",modules:["Fretboard Intervals","CAGED System Quiz","Fretboard Triads"]},{name:"Ear Training",modules:["Interval Recognition","Melodic Recognition","Chord Recognition","Progression Recognition"]}],Bd=t=>{let{presets:n,selectedPresetId:s,onSelectPreset:r}=t;const[a,o]=(0,e.useState)(!1),i=(0,e.useRef)(null),l=(0,e.useMemo)(()=>[...n].sort((e,t)=>e.name.localeCompare(t.name)).reduce((e,t)=>(e[t.gameName]||(e[t.gameName]=[]),e[t.gameName].push(t),e),{}),[n]);(0,e.useEffect)(()=>{const e=e=>{i.current&&!i.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const c=(u=s,n.find(e=>e.id===u)||{name:"Loading...",gameName:""});var u;return(0,Lo.jsxs)("div",{className:"relative",ref:i,children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Preset"}),(0,Lo.jsxs)("button",{onClick:()=>o(e=>!e),className:"w-full p-2 rounded-md bg-slate-600 text-white text-left flex justify-between items-center",children:[(0,Lo.jsxs)("span",{children:[c.name," ",(0,Lo.jsxs)("span",{className:"text-gray-400 text-xs",children:["(",c.gameName,")"]})]}),(0,Lo.jsx)("span",{children:"\u25bc"})]}),a&&(0,Lo.jsx)("div",{className:"absolute top-full left-0 right-0 z-10 bg-slate-700 border border-slate-600 rounded-md mt-1 max-h-64 overflow-y-auto",children:Gd.map(e=>(0,Lo.jsxs)("details",{className:"group",open:!0,children:[(0,Lo.jsx)("summary",{className:"list-none cursor-pointer p-2 bg-slate-800 font-bold text-indigo-300 text-sm sticky top-0",children:e.name}),e.modules.map(e=>{const t=l[e];return t&&0!==t.length?(0,Lo.jsxs)("details",{className:"group/module",children:[(0,Lo.jsx)("summary",{className:"list-none cursor-pointer pl-4 py-1 font-semibold text-teal-300 hover:bg-slate-600",children:e}),(0,Lo.jsx)("div",{className:"pl-6",children:t.map(e=>(0,Lo.jsx)("button",{onClick:()=>(e=>{r(e),o(!1)})(e.id),className:"block w-full text-left p-1 text-gray-200 hover:bg-slate-600 rounded",children:e.name},e.id))})]},e):null})]},e.name))})]})},$d={"Note Generator":"Generators","Interval Generator":"Generators","Chord Progression Generator":"Generators","Diagram Maker":"Generators","Interval Practice":"Theory","Triad & Tetrads Quiz":"Theory","Chord Trainer":"Theory","Fretboard Intervals":"Fretboard","CAGED System Quiz":"Fretboard","Fretboard Triads":"Fretboard","Interval Recognition":"Ear Training","Melodic Recognition":"Ear Training","Chord Recognition":"Ear Training","Progression Recognition":"Ear Training"},Ud=t=>{let{routineType:n,presets:s,onAddStep:r}=t;const[a,o]=(0,e.useState)(""),[i,l]=(0,e.useState)("time"),[c,u]=(0,e.useState)(5),[d,h]=(0,e.useState)(""),[m,f]=(0,e.useState)(3),p=(0,e.useMemo)(()=>"Gauntlet"===n||"Streak"===n?s.filter(e=>"Generators"!==$d[e.gameName]):s,[s,n]);(0,e.useEffect)(()=>{const e=[...p].sort((e,t)=>e.name.localeCompare(t.name));e.length>0?e.some(e=>e.id===a)||o(e[0].id):o("")},[p,a]),(0,e.useEffect)(()=>{if(!a)return;const e=s.find(e=>e.id===a);if(!e)return;"Generators"===$d[e.gameName]&&"PracticeRoutine"===n&&l("time")},[a,s,n]);const g=(0,e.useMemo)(()=>{const e=s.find(e=>e.id===a);return e&&"Generators"===$d[e.gameName]},[a,s]);return(0,Lo.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-lg space-y-4",children:[(0,Lo.jsx)(Bd,{presets:p,selectedPresetId:a,onSelectPreset:o}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Custom Note (Optional)"}),(0,Lo.jsx)("input",{type:"text",value:d,onChange:e=>h(e.target.value),placeholder:"e.g., Use a pick, focus on rhythm...",className:"w-full p-2 rounded-md bg-slate-600 text-white"})]}),(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:["PracticeRoutine"===n&&(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)("div",{className:"flex-grow w-full",children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Goal"}),(0,Lo.jsxs)("select",{value:i,onChange:e=>l(e.target.value),disabled:g,className:"w-full p-2 rounded-md bg-slate-600 text-white disabled:bg-slate-700 disabled:cursor-not-allowed",children:[(0,Lo.jsx)("option",{value:"time",children:"Time"}),(0,Lo.jsx)("option",{value:"questions",children:"Questions"})]}),g&&(0,Lo.jsx)("p",{className:"text-xs text-amber-300 mt-1",children:"Generators can only use a time-based goal."})]}),(0,Lo.jsxs)("div",{className:"w-full md:w-40",children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"time"===i?"Minutes":"Count"}),(0,Lo.jsx)("input",{type:"number",value:c,onChange:e=>u(Number(e.target.value)),min:"1",className:"w-full p-2 rounded-md bg-slate-600 text-white"})]})]}),"Gauntlet"===n&&(0,Lo.jsxs)("div",{className:"w-full md:w-40 flex-grow",children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Questions"}),(0,Lo.jsx)("input",{type:"number",value:c,onChange:e=>u(Number(e.target.value)),min:"1",className:"w-full p-2 rounded-md bg-slate-600 text-white"})]}),"Streak"===n&&(0,Lo.jsxs)("div",{className:"w-full md:w-56 flex-grow",children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Questions in a Row"}),(0,Lo.jsx)("input",{type:"number",value:m,onChange:e=>f(Number(e.target.value)),min:"1",className:"w-full p-2 rounded-md bg-slate-600 text-white"})]}),(0,Lo.jsx)("button",{onClick:()=>{if(!a)return void alert("No presets available for this routine type.");let e=null,t=null,s=null;"PracticeRoutine"===n?(e=i,t="time"===i?60*c:c):"Gauntlet"===n?(e="questions",t=c):"Streak"===n&&(s=m),r({presetId:a,goalType:e,goalValue:t,instruction:d.trim(),questionsInARow:s}),h("")},className:"w-full md:w-auto bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg flex-shrink-0",children:"Streak"===n?"Add to Pool":"Add Step"})]})]})},Wd=t=>{let{routineToEdit:n,onSave:s,onCancel:r}=t;const{presets:a}=Vo(),[o,i]=(0,e.useState)(""),[l,c]=(0,e.useState)("PracticeRoutine"),[u,d]=(0,e.useState)([]),[h,m]=(0,e.useState)("sequential");(0,e.useEffect)(()=>{n?(i(n.name),c(n.type),d(n.steps.map(e=>({...e,id:e.id||`step_${Math.random()}`}))),m(n.executionOrder||"sequential")):(i(""),c("PracticeRoutine"),d([]),m("sequential"))},[n]);return(0,Lo.jsxs)("div",{className:"bg-slate-700/50 p-6 rounded-lg space-y-6",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-lg font-semibold text-gray-300 mb-2",htmlFor:"routine-name",children:"Routine Name"}),(0,Lo.jsx)("input",{id:"routine-name",type:"text",value:o,onChange:e=>i(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",placeholder:"e.g., Daily Fretboard Workout"})]}),(0,Lo.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-lg font-semibold text-gray-300 mb-2",htmlFor:"routine-type",children:"Routine Type"}),(0,Lo.jsxs)("select",{id:"routine-type",value:l,onChange:e=>c(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",children:[(0,Lo.jsx)("option",{value:"PracticeRoutine",children:"Practice Routine"}),(0,Lo.jsx)("option",{value:"Gauntlet",children:"The Gauntlet (Race)"}),(0,Lo.jsx)("option",{value:"Streak",children:"The Streak (Consistency)"})]})]}),("PracticeRoutine"===l||"Gauntlet"===l)&&(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-lg font-semibold text-gray-300 mb-2",htmlFor:"execution-order",children:"Execution Order"}),(0,Lo.jsxs)("select",{id:"execution-order",value:h,onChange:e=>m(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",children:[(0,Lo.jsx)("option",{value:"sequential",children:"Sequential"}),(0,Lo.jsx)("option",{value:"random",children:"Random"})]})]})]}),(0,Lo.jsxs)("div",{className:"border-t border-slate-600 pt-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Streak"===l?"Preset Pool":"Routine Steps"}),(0,Lo.jsx)(zd,{steps:u,onRemoveStep:e=>{d(t=>t.filter((t,n)=>n!==e))},onReorderSteps:(e,t)=>{d(n=>Nd(n,e,t))},getPresetInfo:e=>a.find(t=>t.id===e)||{name:"Unknown Preset",gameName:"N/A"}}),(0,Lo.jsx)(Ud,{routineType:l,presets:a,onAddStep:e=>{const t={id:`step_${Date.now()}`,...e};d(e=>[...e,t])}})]}),(0,Lo.jsxs)("div",{className:"flex justify-end gap-4 pt-6 border-t border-slate-600",children:[(0,Lo.jsx)("button",{onClick:r,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-lg",children:"Cancel"}),(0,Lo.jsx)("button",{onClick:()=>{if(""===o.trim()||0===u.length)return void alert("Please provide a name and add at least one step to the routine.");const e=u.map((e,t)=>({...e,stepOrder:t+1})),t={id:n?n.id:`routine_${Date.now()}`,name:o.trim(),type:l,executionOrder:"PracticeRoutine"===l||"Gauntlet"===l?h:"sequential",steps:e};s(t)},className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg",children:"Save Routine"})]})]})},Hd=t=>{let{isOpen:n,onClose:s,folders:r,onConfirm:a}=t;const[o,i]=(0,e.useState)(new Set);if(!n)return null;return(0,Lo.jsx)("div",{className:"fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:s,children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-md bg-slate-800 rounded-2xl p-6 shadow-2xl flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Add Selected Routines to Folders"}),(0,Lo.jsx)("div",{className:"flex-grow space-y-2 max-h-64 overflow-y-auto pr-2",children:r.length>0?r.map(e=>(0,Lo.jsxs)("label",{className:"flex items-center gap-3 p-3 bg-slate-900/50 rounded-md cursor-pointer hover:bg-slate-700/50",children:[(0,Lo.jsx)("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-400 text-indigo-600 bg-slate-700 focus:ring-indigo-500",checked:o.has(e.id),onChange:()=>(e=>{const t=new Set(o);t.has(e)?t.delete(e):t.add(e),i(t)})(e.id)}),(0,Lo.jsx)("span",{className:"font-semibold text-white",children:e.name})]},e.id)):(0,Lo.jsx)("p",{className:"text-gray-400",children:"You haven't created any custom folders yet."})}),(0,Lo.jsxs)("div",{className:"flex justify-end gap-4 pt-4 mt-4 border-t border-slate-700",children:[(0,Lo.jsx)("button",{onClick:s,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-lg",children:"Cancel"}),(0,Lo.jsx)("button",{onClick:()=>{a(o),i(new Set)},disabled:0===o.size,className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-6 rounded-lg disabled:opacity-50",children:"Apply"})]})]})})},Qd=e=>{let{selectedCount:t,onMove:n,onExport:s,onDelete:r,onCancel:a}=e;return(0,Lo.jsxs)("div",{className:"bg-slate-900/80 backdrop-blur-sm p-4 rounded-lg mb-6 flex justify-between items-center sticky top-4 z-20 border border-yellow-500",children:[(0,Lo.jsxs)("span",{className:"font-bold text-lg text-yellow-300",children:[t," Routine(s) Selected"]}),(0,Lo.jsxs)("div",{className:"flex gap-2",children:[(0,Lo.jsx)("button",{onClick:n,disabled:0===t,className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-6 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Move"}),(0,Lo.jsx)("button",{onClick:s,disabled:0===t,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Export"}),(0,Lo.jsx)("button",{onClick:r,disabled:0===t,className:"bg-red-700 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete"}),(0,Lo.jsx)("button",{onClick:a,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-lg",children:"Cancel"})]})]})},Kd=[{id:"folder_default_practice",name:"Practice Routines"},{id:"folder_default_gauntlet",name:"The Gauntlet"},{id:"folder_default_streak",name:"The Streak"}],Yd=e=>{let{folder:t,isSelectionMode:n,selectedRoutineIds:s,handleSelectAllInFolder:r,onExportFolder:a,onRename:o,onDelete:i,...l}=e;const c=t.id.startsWith("folder_default_"),u=t.routines.map(e=>e.id),d=u.length>0&&u.every(e=>s.has(e));return 0===t.routines.length?null:(0,Lo.jsxs)("details",{className:"group",open:!0,children:[(0,Lo.jsx)("summary",{className:"list-none",children:(0,Lo.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-800 rounded-t-lg cursor-pointer hover:bg-slate-700/50 transition-colors",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Lo.jsx)("span",{className:"transform transition-transform duration-200 group-open:rotate-90",children:"\u25b6"}),(0,Lo.jsxs)("h3",{className:"flex-grow text-xl font-bold text-indigo-300",children:[t.name," (",t.routines.length,")"]})]}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[n&&(0,Lo.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),r(u,d)},className:"text-xs font-semibold bg-slate-700 hover:bg-slate-600 px-3 py-1 rounded-md flex-shrink-0",children:d?"Deselect All":"Select All"}),(0,Lo.jsxs)("div",{className:"flex gap-2 "+(n?"hidden":""),children:[(0,Lo.jsx)("button",{onClick:e=>{e.preventDefault(),a(t.id)},disabled:c,className:"text-xs py-1 px-3 bg-gray-600 hover:bg-gray-500 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Export"}),(0,Lo.jsx)("button",{onClick:e=>{e.preventDefault(),o(t)},disabled:c,className:"text-xs py-1 px-3 bg-gray-600 hover:bg-gray-500 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Rename"}),(0,Lo.jsx)("button",{onClick:e=>{e.preventDefault(),i(t.id)},disabled:c,className:"text-xs py-1 px-3 bg-red-700 hover:bg-red-600 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete"})]})]})]})}),(0,Lo.jsx)("div",{className:"p-4 border border-t-0 border-slate-700 rounded-b-lg",children:(0,Lo.jsx)(mc,{routines:t.routines,isSelectionMode:n,selectedRoutineIds:s,...l})})]})},Xd=e=>{let{title:t,children:n,hasContent:s}=e;return s?(0,Lo.jsxs)("details",{className:"bg-slate-800/50 rounded-lg border-2 border-slate-700 group",open:!0,children:[(0,Lo.jsxs)("summary",{className:"list-none p-4 cursor-pointer hover:bg-slate-700/50 rounded-lg flex items-center gap-3",children:[(0,Lo.jsx)("span",{className:"transform transition-transform duration-200 group-open:rotate-90",children:"\u25b6"}),(0,Lo.jsx)("h2",{className:"text-2xl font-bold text-teal-300",children:t})]}),(0,Lo.jsx)("div",{className:"p-4 border-t border-slate-700",children:n})]}):null},Zd=()=>{const[t,n]=(0,e.useState)("list"),[s,r]=(0,e.useState)(null),[a,o]=(0,e.useState)(!1),[i,l]=(0,e.useState)(null),c=(0,e.useRef)(null),[u,d]=(0,e.useState)(!1),[h,m]=(0,e.useState)(new Set),[f,p]=(0,e.useState)(!1),{routines:g,saveRoutine:x,deleteRoutine:b,exportRoutine:v,startRoutine:y,folders:w,addFolder:j,renameFolder:k,deleteFolder:N,toggleRoutineInFolder:C,exportFolder:_,importRoutines:S}=Vo(),[T,A]=(0,e.useState)(""),[M,E]=(0,e.useState)("All"),[D,R]=(0,e.useState)("newest"),I=e=>{const t=prompt(`Enter a new name for the "${e.name}" folder:`,e.name);t&&k(e.id,t)},P=(e,t)=>{const n=new Set(h);t?e.forEach(e=>n.delete(e)):e.forEach(e=>n.add(e)),m(n)},{defaultCategorized:O,customCategorized:F}=(0,e.useMemo)(()=>{const e=g.map(e=>{const t=new Set(e.folderIds||[]);switch(e.type){case"PracticeRoutine":t.add("folder_default_practice");break;case"Gauntlet":t.add("folder_default_gauntlet");break;case"Streak":t.add("folder_default_streak")}return{...e,folderIds:Array.from(t)}}).filter(e=>{const t=e.name.toLowerCase().includes(T.toLowerCase()),n="All"===M||e.type===M;return t&&n});switch(D){case"oldest":e.sort((e,t)=>new Date(e.createdAt||0)-new Date(t.createdAt||0));break;case"lastPlayed":e.sort((e,t)=>{const n=e.lastPlayed?new Date(e.lastPlayed).getTime():0;return(t.lastPlayed?new Date(t.lastPlayed).getTime():0)-n});break;default:e.sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0))}return{defaultCategorized:Kd.map(t=>({...t,routines:e.filter(e=>e.folderIds&&e.folderIds.includes(t.id))})),customCategorized:w.map(t=>({...t,routines:e.filter(e=>e.folderIds&&e.folderIds.includes(t.id))})).sort((e,t)=>e.name.localeCompare(t.name))}},[g,w,T,M,D]),L={folders:w,onStart:y,onEdit:e=>{r(e),n("editor")},onExport:v,onDelete:b,onToggleManageFolders:e=>{l(t=>t===e?null:e)},onToggleFolder:C,managingFoldersForId:i,selectedRoutineIds:h,onToggleSelection:e=>{const t=new Set(h);t.has(e)?t.delete(e):t.add(e),m(t)}},q=O.some(e=>e.routines.length>0),V=F.some(e=>e.routines.length>0);return(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)($o,{isOpen:a,onClose:()=>o(!1),title:"Routine Hub Guide",verticalAlign:"top",children:(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsxs)("p",{children:["The ",(0,Lo.jsx)("strong",{children:"Routine Hub"})," is where you can build, manage, and launch structured, multi-step practice sessions. Think of a routine as a custom workout playlist, combining your favorite presets into a single, repeatable exercise."]}),(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-4",children:"The Three Types of Routines"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside ml-2 space-y-2",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Practice Routine (Flexibility):"})," The standard workout format. You can set goals for each step by either ",(0,Lo.jsx)("strong",{children:"time"}),' (e.g., "practice for 5 minutes") or ',(0,Lo.jsx)("strong",{children:"questions"}),' (e.g., "answer 10 correctly"). You can also choose to run the steps in sequential or random order.']}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"The Gauntlet (Speed & Accuracy):"})," A race against the clock. Your goal is to complete a set number of questions for all steps as quickly as you can. The stopwatch runs automatically, and your final time is saved to the Scoreboard."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"The Streak (Perfection):"})," A test of consistency. The routine randomly picks from your list of presets and continues as long as you answer correctly. One wrong answer ends the routine, and your score is your streak of correct answers."]})]}),(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-4",children:"Managing Your Routines"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Folders:"})," Organize your routines into default folders (based on type) or create your own custom folders."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Selection Mode:"}),' Click the "Select Routines" button to enter batch-edit mode. This allows you to Export, Delete, or Move multiple routines at once.']}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Import / Export:"})," You can share any routine or folder with others by exporting it to a file. Likewise, you can import routines that others have shared with you."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Scoreboard:"})," Every completed routine is automatically saved to the Scoreboard, giving you a detailed history of your performance and progress over time."]})]})]})}),(0,Lo.jsx)(Hd,{isOpen:f,onClose:()=>p(!1),folders:w,onConfirm:e=>{g.filter(e=>h.has(e.id)).forEach(t=>{e.forEach(e=>{t.folderIds&&t.folderIds.includes(e)||C(t.id,e)})}),p(!1),alert(`${h.size} routine(s) were added to the selected folders.`)}}),(0,Lo.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[(0,Lo.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-6",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("h1",{className:"text-3xl font-extrabold text-indigo-300",children:"Routine Hub"}),(0,Lo.jsx)(Uo,{onClick:()=>o(!0)})]}),"list"===t&&(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[!u&&(0,Lo.jsx)("button",{onClick:()=>d(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-4 rounded-lg",children:"Select Routines"}),(0,Lo.jsx)("button",{onClick:()=>{r(null),n("editor")},className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-4 rounded-lg",children:"Create Routine"})]})]}),"list"===t?(0,Lo.jsxs)(Lo.Fragment,{children:[u&&(0,Lo.jsx)(Qd,{selectedCount:h.size,onMove:()=>p(!0),onExport:()=>{if(0===h.size)return alert("No routines selected.");_(Array.from(h),`custom_routines_export_${(new Date).toISOString().split("T")[0]}`)},onDelete:()=>{if(0===h.size)return alert("No routines selected.");if(window.confirm(`Are you sure you want to delete ${h.size} selected routine(s)?`)){for(const e of h)b(e);d(!1),m(new Set)}},onCancel:()=>{d(!1),m(new Set)}}),(0,Lo.jsxs)("div",{className:"flex justify-between items-center gap-4",children:[(0,Lo.jsx)(Go,{title:"My Routines"}),(0,Lo.jsxs)("div",{className:"flex gap-2",children:[(0,Lo.jsx)("button",{onClick:()=>c.current.click(),className:"bg-blue-700 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg",children:"Import"}),(0,Lo.jsx)("button",{onClick:()=>{const e=prompt("Enter a name for the new folder:");e&&j(e)},className:"bg-teal-600 hover:bg-teal-500 text-white font-bold py-2 px-4 rounded-lg",children:"Create Custom Folder"})]})]}),(0,Lo.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 my-6 p-4 bg-slate-700/50 rounded-lg",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Filter by Name"}),(0,Lo.jsx)("input",{type:"text",placeholder:"Enter routine name...",value:T,onChange:e=>A(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white"})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Filter by Type"}),(0,Lo.jsxs)("select",{value:M,onChange:e=>E(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",children:[(0,Lo.jsx)("option",{value:"All",children:"All Types"}),(0,Lo.jsx)("option",{value:"PracticeRoutine",children:"Practice Routine"}),(0,Lo.jsx)("option",{value:"Gauntlet",children:"The Gauntlet"}),(0,Lo.jsx)("option",{value:"Streak",children:"The Streak"})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Sort by"}),(0,Lo.jsxs)("select",{value:D,onChange:e=>R(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",children:[(0,Lo.jsx)("option",{value:"newest",children:"Date Created (Newest)"}),(0,Lo.jsx)("option",{value:"oldest",children:"Date Created (Oldest)"}),(0,Lo.jsx)("option",{value:"lastPlayed",children:"Last Played"})]})]})]}),(0,Lo.jsxs)("div",{className:"space-y-8",children:[(0,Lo.jsx)(Xd,{title:"Default Folders",hasContent:q,children:(0,Lo.jsx)("div",{className:"space-y-6",children:O.map(e=>(0,Lo.jsx)(Yd,{folder:e,isSelectionMode:u,handleSelectAllInFolder:P,onExportFolder:_,...L},e.id))})}),(0,Lo.jsx)(Xd,{title:"My Custom Folders",hasContent:V,children:(0,Lo.jsx)("div",{className:"space-y-6",children:F.length>0?F.map(e=>(0,Lo.jsx)(Yd,{folder:e,isSelectionMode:u,handleSelectAllInFolder:P,onRename:I,onDelete:N,onExportFolder:_,...L},e.id)):(0,Lo.jsx)("p",{className:"text-gray-400 text-center mt-4",children:"No custom folders created yet."})})})]})]}):(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)(Go,{title:s?"Edit Routine":"Create New Routine"}),(0,Lo.jsx)("div",{className:"mt-6",children:(0,Lo.jsx)(Wd,{routineToEdit:s,onSave:e=>{x(e),n("list")},onCancel:()=>n("list")})})]})]}),(0,Lo.jsx)("input",{type:"file",ref:c,onChange:e=>{const t=e.target.files[0];t&&S(t),e.target.value=null},accept:".json",className:"hidden"})]})},Jd=e=>{let{routine:t,stepIndex:n,progress:s,timeLeft:r,stopwatchTime:a,onEndRoutine:o}=e;const i=t.steps[n],l=s||{};let c="",u="Goal";if("PracticeRoutine"===t.type&&"time"===i.goalType)u="Time Left",c=(e=>{const t=Math.floor(e/6e4),n=Math.floor(e%6e4/1e3);return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`})(1e3*r);else if("PracticeRoutine"===t.type&&"questions"===i.goalType||"Gauntlet"===t.type){u="Answered";const e=l.stepResults?l.stepResults[n]:{asked:0};c=`${(null===e||void 0===e?void 0:e.asked)||0} / ${i.goalValue}`}else"Streak"===t.type&&(u="Current Streak",c=`${l.streak||0}`);const d=e=>{let{label:t,value:n}=e;return(0,Lo.jsxs)("div",{className:"bg-slate-800/50 p-3 rounded-lg text-center",children:[(0,Lo.jsx)("div",{className:"text-sm text-gray-400",children:t}),(0,Lo.jsx)("div",{className:"text-2xl font-bold font-mono text-white",children:n})]})};return(0,Lo.jsxs)("div",{className:"bg-slate-900/70 border border-slate-700 p-4 rounded-lg flex flex-col gap-4 h-full",children:[(0,Lo.jsx)("h2",{className:"text-xl font-bold text-teal-300 text-center border-b border-slate-700 pb-3",children:t.name}),(0,Lo.jsxs)("div",{className:"space-y-3",children:["Streak"!==t.type&&(0,Lo.jsx)(d,{label:"Step",value:`${n+1} / ${t.steps.length}`}),(0,Lo.jsx)(d,{label:u,value:c}),"Gauntlet"===t.type&&(0,Lo.jsx)(d,{label:"Total Time",value:new Date(a).toISOString().slice(14,22)})]}),i.instruction&&(0,Lo.jsxs)("div",{className:"bg-slate-800/50 p-3 rounded-lg text-center",children:[(0,Lo.jsx)("div",{className:"text-sm text-amber-400 font-bold",children:"Your Note"}),(0,Lo.jsxs)("p",{className:"text-md text-white italic mt-1",children:['"',i.instruction,'"']})]}),(0,Lo.jsx)("div",{className:"flex-grow"}),(0,Lo.jsx)("button",{onClick:o,className:"w-full bg-red-700 hover:bg-red-600 text-white font-bold py-3 rounded-lg text-lg",children:"End Routine"})]})},eh=(e,t)=>{if(!e||!e.gameId)return null;switch(e.gameId){case"caged-system-quiz":return(0,Lo.jsx)(pl,{...t});case"fretboard-triads":return(0,Lo.jsx)(kl,{...t});case"chord-trainer":return(0,Lo.jsx)(Ci,{...t,challengeSettings:e.settings});case"interval-ear-trainer":return(0,Lo.jsx)(Pl,{...t});case"melodic-ear-trainer":return(0,Lo.jsx)(Ql,{...t});case"chord-ear-trainer":return(0,Lo.jsx)(sc,{...t});case"progression-ear-trainer":return(0,Lo.jsx)(dc,{...t});case"interval-fretboard-quiz":return(0,Lo.jsx)(Fi,{...t});case"intervals-quiz":return(0,Lo.jsx)(ti,{...t});case"triad-quiz":return(0,Lo.jsx)(cl,{...t});case"chord-progression-generator":return(0,Lo.jsx)(Yi,{});case"interval-generator":return(0,Lo.jsx)(Ji,{});case"note-generator":return(0,Lo.jsx)(ai,{});default:return(0,Lo.jsxs)("p",{children:['Error: Unknown game ID "',e.gameId,'"']})}},th=e=>{let{routine:t,stepIndex:n,progress:s,timeLeft:r,stopwatchTime:a,onEndRoutine:o}=e;const i=t.steps[n],l=s||{};let c="";if("PracticeRoutine"===t.type&&"time"===i.goalType)c=`Time Left: ${(e=>{const t=Math.floor(e/6e4),n=Math.floor(e%6e4/1e3);return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`})(1e3*r)}`;else if("PracticeRoutine"===t.type&&"questions"===i.goalType||"Gauntlet"===t.type){const e=l.stepResults?l.stepResults[n]:{asked:0};c=`Answered: ${(null===e||void 0===e?void 0:e.asked)||0} / ${i.goalValue}`}else"Streak"===t.type&&(c=`Current Streak: ${l.streak||0}`);return(0,Lo.jsxs)("div",{className:"w-full bg-slate-900 border-b-4 border-indigo-500 p-4 mb-8 rounded-lg text-center shadow-lg",children:[" ",(0,Lo.jsx)("h2",{className:"text-2xl font-bold text-teal-300",children:t.name})," ",(0,Lo.jsxs)("div",{className:"grid grid-cols-3 justify-items-center items-center mt-2 text-lg",children:[(0,Lo.jsxs)("span",{className:"font-semibold text-gray-300 justify-self-start",children:["Step: ",n+1," / ",t.steps.length]}),(0,Lo.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Lo.jsx)("span",{className:"font-bold text-amber-300",children:c}),"Gauntlet"===t.type&&void 0!==a&&(0,Lo.jsx)("span",{className:"font-mono text-xl text-yellow-300",children:new Date(a).toISOString().slice(14,22)})]}),(0,Lo.jsx)("button",{onClick:o,className:"bg-red-700 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg text-sm justify-self-end",children:"End Routine"})]})," "]})},nh=()=>{var t;const{activeRoutine:n,routineStepIndex:s,routineProgress:r,setRoutineProgress:a,presets:o,loadPreset:i,nextRoutineStep:l,endRoutine:c,updateRoutineProgress:u,finishRoutine:d,isStopwatchRunning:h,toggleStopwatch:m,resetStopwatch:f,stopwatchTime:p}=Vo(),[g,x]=(0,e.useState)(0),b=(0,e.useRef)(null),v=(0,e.useRef)(null),y=(0,e.useRef)(!1),w=(0,e.useRef)(null),[j,k]=(0,e.useState)({currentStepIndex:0,questionsAsked:0}),N=(0,e.useRef)();(0,e.useEffect)(()=>{N.current={finishRoutine:d,nextRoutineStep:l,setRoutineProgress:a,routineProgress:r,activeRoutine:n,routineStepIndex:s}},[d,l,a,r,n,s]),(0,e.useEffect)(()=>{if(!n)return y.current=!1,void(w.current=null);let e=s;"Streak"===n.type&&(e=j.currentStepIndex);const t=n.steps[e],r=o.find(e=>e.id===(null===t||void 0===t?void 0:t.presetId));if(t&&r)if(r.id!==w.current&&(i(r),w.current=r.id),"Gauntlet"!==n.type||0!==s||y.current){if("Streak"===n.type&&0===s&&0===j.questionsAsked&&!w.current){const e=Math.floor(Math.random()*n.steps.length);k({currentStepIndex:e,questionsAsked:0})}}else f(),m(),y.current=!0},[n,s,o,i,f,m,j]),(0,e.useEffect)(()=>{var e;if("PracticeRoutine"===(null===n||void 0===n?void 0:n.type)&&"time"===(null===(e=n.steps[s])||void 0===e?void 0:e.goalType)){const e=n.steps[s];x(e.goalValue)}},[n,s]),(0,e.useEffect)(()=>{var e;if("PracticeRoutine"!==(null===n||void 0===n?void 0:n.type)||"time"!==(null===(e=n.steps[s])||void 0===e?void 0:e.goalType)||g<=0)return;return b.current=setTimeout(()=>{const e=g-1;if(e<=0){const{routineStepIndex:e,activeRoutine:t,finishRoutine:n,nextRoutineStep:s,routineProgress:r}=N.current;e>=t.steps.length-1?n(r):s()}else x(e)},1e3),()=>clearTimeout(b.current)},[n,s,g]);const C=(0,e.useCallback)(e=>{if(!n)return;let t="Streak"===n.type?j.currentStepIndex:s;const a=u(t,e,r),o=n.steps[t],i=s>=n.steps.length-1,c=(e,t)=>{b.current=setTimeout(()=>{e?(h&&m(),d(t)):l()},2e3)};if("Streak"===n.type)if(e.wasCorrect)b.current=setTimeout(()=>{const e=j.questionsAsked+1,t=o.questionsInARow||1;if(e>=t){let e;do{e=Math.floor(Math.random()*n.steps.length)}while(n.steps.length>1&&e===j.currentStepIndex);k({currentStepIndex:e,questionsAsked:0})}else k(t=>({...t,questionsAsked:e}))},2e3);else{c(!0,{...a,streak:r.streak||0})}else{const e=a.stepResults[t].asked;"PracticeRoutine"===n.type&&"questions"===o.goalType?e>=o.goalValue&&c(i,a):"Gauntlet"===n.type&&e>=o.goalValue&&c(i,a)}},[n,s,r,h,l,m,u,d,j]);(0,e.useEffect)(()=>()=>clearTimeout(b.current),[]);let _=null===n||void 0===n||null===(t=n.steps[s])||void 0===t?void 0:t.presetId;var S;"Streak"===(null===n||void 0===n?void 0:n.type)&&(_=null===(S=n.steps[j.currentStepIndex])||void 0===S?void 0:S.presetId);const T=o.find(e=>e.id===_);if(!n||!T)return(0,Lo.jsx)("div",{className:"text-center p-8",children:(0,Lo.jsx)("h2",{className:"text-2xl font-bold text-gray-400",children:"Loading Routine..."})});const A={routine:n,stepIndex:s,progress:r,timeLeft:g,stopwatchTime:p,onEndRoutine:()=>c()};return(0,Lo.jsxs)("div",{className:"w-full h-full md:flex md:flex-row md:gap-8",children:[(0,Lo.jsx)("div",{className:"md:hidden flex-shrink-0",children:(0,Lo.jsx)(th,{...A})}),(0,Lo.jsx)("div",{ref:v,className:"bg-slate-900/50 rounded-lg flex-grow overflow-y-auto min-h-0",children:(0,Lo.jsx)("div",{className:"p-4",children:eh(T,{onProgressUpdate:C})})}),(0,Lo.jsx)("div",{className:"hidden md:block md:w-56 lg:w-64 flex-shrink-0",children:(0,Lo.jsx)(Jd,{...A})})]})},sh=e=>{let{result:t,onDelete:n,isSummary:s=!1}=e;const{presets:r}=Vo(),a=e=>{var t;return(null===(t=r.find(t=>t.id===e))||void 0===t?void 0:t.name)||"Unknown Preset"},o=t.totalAsked>0?(t.totalScore/t.totalAsked*100).toFixed(0):0,i=()=>{if(s)return"border-indigo-500";switch(t.routineType){case"PracticeRoutine":return"border-blue-600";case"Gauntlet":return"border-yellow-500";case"Streak":return"border-green-600";default:return"border-slate-700"}},l=()=>(0,Lo.jsx)("summary",{className:"list-none cursor-pointer p-4 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors",children:(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center",children:[(0,Lo.jsxs)("div",{className:"flex-grow",children:[(0,Lo.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Lo.jsx)("h3",{className:"text-xl font-semibold text-teal-300",children:t.routineName})," ",n&&(0,Lo.jsx)("button",{onClick:e=>{e.preventDefault(),n()},className:"md:hidden text-red-500 hover:text-red-400 font-bold text-3xl px-2 leading-none flex-shrink-0 ml-4",children:"-"})]}),(0,Lo.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:new Date(t.completionTime).toLocaleString()})]}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2 md:ml-4 mt-4 md:mt-0 flex-shrink-0",children:[(0,Lo.jsxs)("div",{className:"text-left w-24",children:[(0,Lo.jsx)("span",{className:"text-sm text-gray-400",children:"Score"}),(0,Lo.jsxs)("p",{className:"font-bold text-lg",children:[t.totalScore,"/",t.totalAsked]})]}),(0,Lo.jsxs)("div",{className:"text-left w-24",children:[(0,Lo.jsx)("span",{className:"text-sm text-gray-400",children:"Accuracy"}),(0,Lo.jsxs)("p",{className:"font-bold text-lg",children:[o,"%"]})]}),(0,Lo.jsxs)("div",{className:"text-left w-24",children:[(0,Lo.jsx)("span",{className:"text-sm text-gray-400",children:"Time"}),"Gauntlet"===t.routineType?(0,Lo.jsx)("p",{className:"font-bold text-lg font-mono",children:new Date(t.finalTime).toISOString().slice(14,22)}):(0,Lo.jsx)("p",{className:"font-bold text-lg text-gray-500",children:"-"})]}),(0,Lo.jsxs)("div",{className:"text-left w-24",children:[(0,Lo.jsx)("span",{className:"text-sm text-gray-400",children:"Streak"}),"Streak"===t.routineType?(0,Lo.jsx)("p",{className:"font-bold text-lg",children:t.streak}):(0,Lo.jsx)("p",{className:"font-bold text-lg text-gray-500",children:"-"})]}),n&&(0,Lo.jsx)("button",{onClick:e=>{e.preventDefault(),n()},className:"hidden md:block text-red-500 hover:text-red-400 font-bold text-3xl px-2 leading-none flex-shrink-0 ml-4",children:"-"})]})]})}),c=()=>"Streak"===t.routineType?null:(0,Lo.jsxs)("div",{className:"p-4 border-t border-slate-600/50",children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-2",children:"Step Breakdown"}),(0,Lo.jsx)("div",{className:"space-y-3",children:t.steps.map((e,n)=>(0,Lo.jsxs)("div",{className:"p-3 bg-slate-800 rounded-lg text-left",children:[(0,Lo.jsxs)("p",{className:"font-semibold text-gray-200",children:["Step ",n+1,": ",a(e.presetId)]}),(0,Lo.jsxs)("div",{className:"flex justify-between text-sm mt-1",children:[(0,Lo.jsxs)("span",{className:"text-gray-400",children:["Goal: ","time"===e.goalType?e.goalValue/60+" min":`${e.goalValue||"N/A"} questions`]}),(0,Lo.jsxs)("span",{className:"font-semibold text-white",children:["Result: ",t.stepResults[n].score," / ",t.stepResults[n].asked]})]})]},n))})]});return s?(0,Lo.jsxs)("div",{className:`bg-slate-800 rounded-lg w-full max-w-2xl mx-auto border-2 ${i()} shadow-lg`,children:[(0,Lo.jsx)("div",{className:"p-0",children:(0,Lo.jsx)(l,{})}),(0,Lo.jsx)(c,{})]}):(0,Lo.jsxs)("details",{className:`bg-slate-800 rounded-lg w-full max-w-2xl mx-auto border-2 ${i()}`,children:[(0,Lo.jsx)(l,{}),(0,Lo.jsx)(c,{})]})},rh=["Note Generator","Interval Generator","Chord Progression Generator","Interval Practice","Triad & Tetrads Quiz","Chord Trainer","Fretboard Intervals","CAGED System Quiz","Fretboard Triads","Interval Recognition","Melodic Recognition","Chord Recognition","Progression Recognition"],ah=()=>{const{scores:t,presets:n,folders:s,routines:r,lastRoutineResultId:a,setLastRoutineResultId:o,clearScoreboard:i,deleteScore:l,startRoutine:c}=Vo(),[u,d]=(0,e.useState)(""),[h,m]=(0,e.useState)("All"),[f,p]=(0,e.useState)("All"),[g,x]=(0,e.useState)("All"),[b,v]=(0,e.useState)(!1),y=(0,e.useMemo)(()=>a?t.find(e=>e.id===a):null,[a,t]),w=(0,e.useMemo)(()=>["All",...rh],[]),j=(0,e.useMemo)(()=>t.filter(e=>{if(e.id===a)return!1;const t=r.find(t=>t.id===e.routineId),s=e.routineName.toLowerCase().includes(u.toLowerCase()),o="All"===h||e.routineType===h,i="All"===f||e.steps.some(e=>{const t=n.find(t=>t.id===e.presetId);return t&&t.gameName===f}),l="All"===g||"Uncategorized"===g&&(!t||!t.folderIds||0===t.folderIds.length)||t&&t.folderIds&&t.folderIds.includes(g);return s&&o&&i&&l}),[t,u,h,f,g,a,n,r]);return(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)($o,{isOpen:b,onClose:()=>v(!1),title:"Scoreboard Guide",verticalAlign:"top",children:[(0,Lo.jsx)("p",{children:"The Scoreboard tracks your performance every time you complete a routine."})," ",(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mt-4",children:"Features"}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside text-sm space-y-1",children:[(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Routine Complete Screen:"})," After finishing a routine, you'll see a detailed summary of your results. From here, you can retry the same routine or view the full scoreboard."]})," ",(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Color-Coded Entries:"})," Each result is framed in a color that matches its routine type for quick identification (Blue for Routines, Yellow for Gauntlets, Green for Streaks)."]})," ",(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Detailed View:"})," Click on any scoreboard entry to expand it (like an accordion) and see a step-by-step breakdown of your performance."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Advanced Filtering:"})," Use the filter controls to find specific results by name, type, the games included, or the folder it belongs to."]}),(0,Lo.jsxs)("li",{children:[(0,Lo.jsx)("strong",{children:"Managing Scores:"}),' You can delete any individual result by clicking the "-" button, or clear your entire history with the "Clear All History" button.']})]})]}),(0,Lo.jsx)("div",{className:"max-w-4xl mx-auto",children:y?(0,Lo.jsxs)("div",{className:"mb-12",children:[(0,Lo.jsx)("h2",{className:"text-4xl font-bold text-green-400 text-center mb-4",children:"Routine Complete!"})," ",(0,Lo.jsx)(sh,{result:y,isSummary:!0})," ",(0,Lo.jsxs)("div",{className:"text-center mt-6 flex justify-center gap-4",children:[(0,Lo.jsx)("button",{onClick:()=>{if(!y)return;const e=r.find(e=>e.id===y.routineId);e?(o(null),c(e)):alert("Error: Could not find the original routine to retry.")},className:"bg-green-600 hover:bg-green-500 text-white font-bold py-3 px-8 rounded-lg",children:"Retry Routine"})," ",(0,Lo.jsx)("button",{onClick:()=>o(null),className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-lg",children:"View Full Scoreboard"})]})]}):(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)(Go,{title:"Routine Scoreboard"})," ",(0,Lo.jsx)(Uo,{onClick:()=>v(!0)})]}),(0,Lo.jsx)("button",{onClick:i,className:"bg-red-800 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg text-sm flex-shrink-0",children:"Clear All History"})]}),(0,Lo.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 my-6 p-4 bg-slate-700/50 rounded-lg",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Filter by Name"}),(0,Lo.jsx)("input",{type:"text",placeholder:"Enter routine name...",value:u,onChange:e=>d(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white"})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Filter by Type"}),(0,Lo.jsxs)("select",{value:h,onChange:e=>m(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",children:[(0,Lo.jsx)("option",{value:"All",children:"All Types"}),(0,Lo.jsx)("option",{value:"PracticeRoutine",children:"Practice Routine"}),(0,Lo.jsx)("option",{value:"Gauntlet",children:"The Gauntlet"}),(0,Lo.jsx)("option",{value:"Streak",children:"The Streak"})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Filter by Game"}),(0,Lo.jsx)("select",{value:f,onChange:e=>p(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",children:w.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))})]}),(0,Lo.jsxs)("div",{className:"md:col-span-3",children:[(0,Lo.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-1",children:"Filter by Folder"}),(0,Lo.jsxs)("select",{value:g,onChange:e=>x(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",children:[(0,Lo.jsx)("option",{value:"All",children:"All Folders"}),(0,Lo.jsx)("option",{value:"Uncategorized",children:"Uncategorized"}),s.map(e=>(0,Lo.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,Lo.jsx)("div",{className:"space-y-4",children:j.length>0?j.map(e=>(0,Lo.jsx)(sh,{result:e,onDelete:()=>l(e.id)},e.id)):(0,Lo.jsxs)("div",{className:"text-center p-8 bg-slate-700/50 rounded-lg",children:[(0,Lo.jsx)("h3",{className:"text-xl font-semibold text-gray-300",children:"No Results Found"}),(0,Lo.jsx)("p",{className:"text-gray-400 mt-2",children:"No scoreboard entries match your current filter criteria."})]})})]})})]})},oh={"note-generator":si,"interval-generator":Xi,"chord-progression-generator":Ui,"intervals-quiz":Jo,"triad-quiz":ll,"interval-fretboard-quiz":Pi,"caged-system-quiz":ml,"interval-ear-trainer":Il,"melodic-ear-trainer":Wl,"chord-trainer":wi,"fretboard-triads":jl,"chord-ear-trainer":nc,"progression-ear-trainer":cc},ih=t=>{let{preset:n,onSave:s,onCancel:r}=t;const[a,o]=(0,e.useState)({...n}),[i,l]=(0,e.useState)({general:!0,quiz:!0,selection:!0,playback:!0,question:!0,options:!0,display:!0,automation:!0}),c=oh[n.gameId],u=(e,t)=>{o(n=>({...n,settings:{...n.settings,[e]:t}}))},d=e=>{l(t=>({...t,[e]:!t[e]}))};return(0,Lo.jsx)($o,{isOpen:!0,onClose:r,title:`Editing Preset: ${n.name}`,children:(0,Lo.jsxs)("div",{className:"space-y-4",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{className:"block text-lg font-semibold text-gray-300 mb-2",children:"Preset Name"}),(0,Lo.jsx)("input",{type:"text",value:a.name,onChange:e=>o(t=>({...t,name:e.target.value})),className:"w-full p-2 rounded-md bg-slate-600 text-white"})]}),(0,Lo.jsx)("div",{className:"max-h-80 overflow-y-auto p-3 bg-slate-800 rounded-lg",children:c?e.createElement(c,(()=>{var e,t,s;const r={settings:a.settings,onSettingChange:u,onSavePreset:()=>{}};switch(n.gameId){case"intervals-quiz":const m=Xo.map(e=>e.name);return{...r,audioDirection:a.settings.audioDirection,onAudioDirectionChange:e=>u("audioDirection",e),localVolume:a.settings.fretboardVolume,onLocalVolumeChange:e=>u("fretboardVolume",e),onVolumeSet:()=>{},onIntervalSelectionChange:e=>u("selectedIntervals",{...a.settings.selectedIntervals,[e]:!a.settings.selectedIntervals[e]}),onQuickSelect:e=>{const t={...a.settings.selectedIntervals};Xo.forEach(n=>{n.quality===e&&(t[n.name]=!t[n.name])}),u("selectedIntervals",t)},onSelectAll:e=>{const t={};m.forEach(n=>{t[n]=e}),u("selectedIntervals",t)},openControlSections:i,onToggleSection:d};case"interval-fretboard-quiz":return{...r,volume:a.settings.fretboardVolume,onVolumeChange:e=>u("fretboardVolume",e)};case"melodic-ear-trainer":case"chord-ear-trainer":case"progression-ear-trainer":return{...r,onRandomKey:()=>{},onApplySettings:()=>{}};case"caged-system-quiz":return{...r,quizMode:a.settings.quizMode,onQuizModeChange:e=>u("quizMode",e),onSettingToggle:(e,t)=>{"shapes"===e?u("shapes",{...a.settings.shapes,[t]:!a.settings.shapes[t]}):u(t,!a.settings[t])}};case"chord-progression-generator":return{...r,openSections:i,onToggleSection:d,onSettingChange:(e,t)=>o(n=>({...n,settings:{...n.settings,[e]:t}})),onQualityFilterChange:e=>o(t=>({...t,settings:{...t.settings,qualityFilter:e,useCommonPatterns:"all"===e&&t.settings.useCommonPatterns}})),onRandomRootNote:()=>{},isAutoGenerateOn:(null===(e=a.automation)||void 0===e?void 0:e.isAutoGenerateOn)||!1,onAutoGenerateToggle:()=>o(e=>{var t;return{...e,automation:{...e.automation,isAutoGenerateOn:!(null!==(t=e.automation)&&void 0!==t&&t.isAutoGenerateOn)}}}),autoGenerateInterval:(null===(t=a.automation)||void 0===t?void 0:t.autoGenerateInterval)||1,onIntervalChange:e=>o(t=>({...t,automation:{...t.automation,autoGenerateInterval:e}})),countdownClicks:(null===(s=a.automation)||void 0===s?void 0:s.countdownClicks)||0,onCountdownChange:e=>o(t=>({...t,automation:{...t.automation,countdownClicks:e}}))};case"fretboard-triads":return{...r,onSettingChange:(e,t)=>{o(n=>({...n,settings:{...n.settings,[e]:t}}))}};default:var l,c,h;return"note-generator"===n.gameId||"interval-generator"===n.gameId?{...r,isAutoGenerateOn:(null===(l=a.automation)||void 0===l?void 0:l.isAutoGenerateOn)||!1,onAutoGenerateToggle:()=>o(e=>{var t;return{...e,automation:{...e.automation,isAutoGenerateOn:!(null!==(t=e.automation)&&void 0!==t&&t.isAutoGenerateOn)}}}),autoGenerateInterval:(null===(c=a.automation)||void 0===c?void 0:c.autoGenerateInterval)||1,onIntervalChange:e=>o(t=>({...t,automation:{...t.automation,autoGenerateInterval:e}})),countdownClicks:(null===(h=a.automation)||void 0===h?void 0:h.countdownClicks)||0,onCountdownChange:e=>o(t=>({...t,automation:{...t.automation,countdownClicks:e}}))}:r}})()):(0,Lo.jsx)("p",{children:"No editor available for this preset type."})}),(0,Lo.jsxs)("div",{className:"flex justify-end gap-4 pt-4 border-t border-slate-700",children:[(0,Lo.jsx)("button",{onClick:r,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-lg",children:"Cancel"}),(0,Lo.jsx)("button",{onClick:()=>{s(a)},className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg",children:"Save Changes"})]})]})})},lh={"Note Generator":"Generators","Interval Generator":"Generators","Chord Progression Generator":"Generators","Diagram Maker":"Generators","Interval Practice":"Theory","Triad & Tetrads Quiz":"Theory","Chord Trainer":"Theory","Fretboard Intervals":"Fretboard","CAGED System Quiz":"Fretboard","Fretboard Triads":"Fretboard","Interval Recognition":"Ear Training","Melodic Recognition":"Ear Training","Chord Recognition":"Ear Training","Progression Recognition":"Ear Training"},ch=[{name:"Generators",modules:["Note Generator","Interval Generator","Chord Progression Generator","Diagram Maker"]},{name:"Theory",modules:["Interval Practice","Triad & Tetrads Quiz","Chord Trainer"]},{name:"Fretboard",modules:["Fretboard Intervals","CAGED System Quiz","Fretboard Triads"]},{name:"Ear Training",modules:["Interval Recognition","Melodic Recognition","Chord Recognition","Progression Recognition"]}],uh=t=>{let{presetsFromFile:n,onImport:s,onCancel:r}=t;const[a,o]=(0,e.useState)(()=>n.map(e=>e.id)),i=e=>{o(e?n.map(e=>e.id):[])};return(0,Lo.jsx)($o,{isOpen:!0,onClose:r,title:`Import Presets (${n.length} found)`,children:(0,Lo.jsxs)("div",{className:"text-sm space-y-3",children:[(0,Lo.jsx)("p",{children:"Select the presets you want to import from the file."}),(0,Lo.jsxs)("div",{className:"flex gap-2",children:[(0,Lo.jsx)("button",{onClick:()=>i(!0),className:"flex-1 bg-slate-600 hover:bg-slate-500 py-1 rounded",children:"Select All"}),(0,Lo.jsx)("button",{onClick:()=>i(!1),className:"flex-1 bg-slate-600 hover:bg-slate-500 py-1 rounded",children:"Deselect All"})]}),(0,Lo.jsx)("ul",{className:"max-h-64 overflow-y-auto space-y-2 p-2 bg-slate-800 rounded",children:n.map(e=>(0,Lo.jsx)("li",{children:(0,Lo.jsxs)("label",{className:"flex items-center gap-3 p-2 bg-slate-900/50 rounded cursor-pointer",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:a.includes(e.id),onChange:()=>{return t=e.id,void o(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"h-5 w-5 rounded text-indigo-600 bg-slate-700"}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("span",{className:"font-semibold",children:e.name}),(0,Lo.jsx)("span",{className:"block text-xs text-gray-400",children:e.gameName})]})]})},e.id))}),(0,Lo.jsxs)("button",{onClick:()=>{const e=n.filter(e=>a.includes(e.id));s(e)},className:"w-full bg-blue-700 hover:bg-blue-600 text-white font-bold py-2 rounded-lg",children:["Import ",a.length," Selected"]})]})})},dh=()=>{const{presets:t,loadPreset:n,updatePreset:s,deleteSelectedPresets:r,saveMultiplePresets:a,exportSelectedPresets:o,removePresets:i}=Vo(),[l,c]=(0,e.useState)(""),[u,d]=(0,e.useState)("All"),[h,m]=(0,e.useState)("All"),[f,p]=(0,e.useState)(new Set),[g,x]=(0,e.useState)(!1),[b,v]=(0,e.useState)(null),[y,w]=(0,e.useState)(null),[j,k]=(0,e.useState)(!1),[N,C]=(0,e.useState)(!1),[_,S]=(0,e.useState)(""),T=(0,e.useRef)(null);(0,e.useEffect)(()=>{const e=Array.from(new Set(t.filter(e=>!e.isDefault).map(e=>e.gameName))).sort();(e.length>0&&!_||e.length>0&&!e.includes(_))&&S(e[0])},[t,_]);const A=(0,e.useMemo)(()=>{let e=[...t];return l&&(e=e.filter(e=>e.name.toLowerCase().includes(l.toLowerCase()))),"All"!==u&&(e=e.filter(e=>e.gameName===u)),"Default"===h?e=e.filter(e=>e.isDefault):"Custom"===h&&(e=e.filter(e=>!e.isDefault)),e.reduce((e,t)=>{const n=lh[t.gameName]||"Other";return e[n]||(e[n]={}),e[n][t.gameName]||(e[n][t.gameName]=[]),e[n][t.gameName].push(t),e},{})},[t,l,u,h]),M=e=>{const t=e.map(e=>e.id),n=t.every(e=>f.has(e));p(e=>{const s=new Set(e);return n?t.forEach(e=>s.delete(e)):t.forEach(e=>s.add(e)),s})},E=e=>{i(e),C(!1)};return(0,Lo.jsxs)("div",{className:"max-w-4xl mx-auto",children:[y&&(0,Lo.jsx)(uh,{presetsFromFile:y,onImport:e=>{const t=a(e);alert(`${t} presets imported successfully!`),w(null)},onCancel:()=>w(null)}),b&&(0,Lo.jsx)(ih,{preset:b,onSave:e=>{s(e.id,e),v(null),alert(`Preset "${e.name}" updated successfully!`)},onCancel:()=>v(null)}),j&&(0,Lo.jsx)($o,{isOpen:j,onClose:()=>k(!1),title:"Preset Manager Guide",children:(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsx)("p",{children:"This is your hub for managing all saved presets for every tool."}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Normal Mode"}),(0,Lo.jsx)("p",{children:'By default, you can browse and load presets. Click the "Load" button to activate a preset, or "Edit" to modify a custom one.'})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Selection Mode"}),(0,Lo.jsx)("p",{children:'Click the "Select Presets" button to enter selection mode. In this mode:'}),(0,Lo.jsxs)("ul",{className:"list-disc list-inside ml-4 mt-1 space-y-1",children:[(0,Lo.jsx)("li",{children:"Clicking a preset card will select/deselect it."}),(0,Lo.jsx)("li",{children:'A **"Select All"** button will appear in each folder header to quickly select an entire group.'}),(0,Lo.jsx)("li",{children:"The top action bar allows you to **Export** or **Delete** all selected custom presets at once."}),(0,Lo.jsx)("li",{children:'Click "Done" to exit selection mode.'})]})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("h4",{className:"font-bold text-indigo-300 mb-1",children:"Importing & Bulk Remove"}),(0,Lo.jsx)("p",{children:'Use the "Import" button to load presets from a file. The "Bulk Remove" button provides powerful options to clean up presets that are old, duplicated, or not used in any routines.'})]})]})}),N&&(0,Lo.jsx)($o,{isOpen:N,onClose:()=>C(!1),title:"Bulk Preset Management",children:(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsx)("p",{className:"text-gray-400",children:"Use these actions to clean up your custom presets. Default presets will not be affected."}),(0,Lo.jsxs)("div",{className:"p-2 bg-slate-800 rounded",children:[(0,Lo.jsx)("label",{className:"font-bold text-indigo-300 block mb-2",children:"Remove by Tool"}),(0,Lo.jsxs)("div",{className:"flex gap-2",children:[(0,Lo.jsx)("select",{value:_,onChange:e=>S(e.target.value),className:"flex-grow bg-slate-600 rounded p-1",children:Array.from(new Set(t.filter(e=>!e.isDefault).map(e=>e.gameName))).sort().map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))}),(0,Lo.jsx)("button",{onClick:()=>E({type:"byGame",value:_}),disabled:!_,className:"bg-red-700 hover:bg-red-600 px-3 py-1 rounded font-semibold disabled:opacity-50",children:"Remove"})]})]}),(0,Lo.jsxs)("div",{className:"p-2 bg-slate-800 rounded",children:[(0,Lo.jsx)("label",{className:"font-bold text-indigo-300 block mb-2",children:"Remove Unused Presets"}),(0,Lo.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Lo.jsx)("button",{onClick:()=>E({type:"unusedSince",value:7}),className:"bg-red-700 hover:bg-red-600 p-2 rounded font-semibold",children:"Not used in 7 days"}),(0,Lo.jsx)("button",{onClick:()=>E({type:"unusedSince",value:30}),className:"bg-red-700 hover:bg-red-600 p-2 rounded font-semibold",children:"Not used in 30 days"})]})]}),(0,Lo.jsxs)("div",{className:"p-2 bg-slate-800 rounded space-y-2",children:[(0,Lo.jsx)("label",{className:"font-bold text-indigo-300 block",children:"Other Actions"}),(0,Lo.jsx)("button",{onClick:()=>E({type:"notInRoutine"}),className:"w-full bg-red-700 hover:bg-red-600 p-2 rounded font-semibold",children:"Remove presets not in any Routine"}),(0,Lo.jsx)("button",{onClick:()=>E({type:"duplicates"}),className:"w-full bg-red-700 hover:bg-red-600 p-2 rounded font-semibold",children:"Remove all duplicate presets"})]})]})}),(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)(Go,{title:"Preset Manager"}),(0,Lo.jsx)(Uo,{onClick:()=>k(!0)})]}),(0,Lo.jsxs)("div",{className:"my-6 p-3 bg-slate-700/50 rounded-lg flex items-center justify-between gap-2",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("button",{onClick:()=>T.current.click(),className:"bg-blue-700 hover:bg-blue-600 font-bold py-2 px-4 rounded-lg",children:"Import"}),(0,Lo.jsx)("button",{onClick:()=>C(!0),className:"bg-yellow-700 hover:bg-yellow-600 font-bold py-2 px-4 rounded-lg ml-2",children:"Bulk Remove..."})]}),g?(0,Lo.jsxs)("div",{className:"flex items-center gap-2 animate-fade-in",children:[(0,Lo.jsxs)("span",{className:"font-semibold",children:[f.size," selected"]}),(0,Lo.jsx)("button",{onClick:()=>o(Array.from(f)),disabled:0===f.size,className:"bg-green-600 hover:bg-green-500 font-bold py-2 px-4 rounded-lg disabled:opacity-50",children:"Export"}),(0,Lo.jsx)("button",{onClick:()=>r(Array.from(f)),disabled:0===f.size,className:"bg-red-700 hover:bg-red-600 font-bold py-2 px-4 rounded-lg disabled:opacity-50",children:"Delete"}),(0,Lo.jsx)("button",{onClick:()=>{x(!1),p(new Set)},className:"bg-gray-600 hover:bg-gray-500 font-bold py-2 px-4 rounded-lg",children:"Done"})]}):(0,Lo.jsx)("button",{onClick:()=>x(!0),className:"bg-indigo-600 hover:bg-indigo-500 font-bold py-2 px-4 rounded-lg",children:"Select Presets"})]}),(0,Lo.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 my-6 p-4 bg-slate-700/50 rounded-lg",children:[(0,Lo.jsx)("input",{type:"text",placeholder:"Search by name...",value:l,onChange:e=>c(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white"}),(0,Lo.jsxs)("select",{value:u,onChange:e=>d(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",children:[(0,Lo.jsx)("option",{value:"All",children:"All Tools"}),ch.map(e=>(0,Lo.jsx)("optgroup",{label:e.name,children:e.modules.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))},e.name))]}),(0,Lo.jsxs)("select",{value:h,onChange:e=>m(e.target.value),className:"w-full p-2 rounded-md bg-slate-600 text-white",children:[(0,Lo.jsx)("option",{value:"All",children:"All Presets"}),(0,Lo.jsx)("option",{value:"Custom",children:"My Presets"}),(0,Lo.jsx)("option",{value:"Default",children:"Defaults"})]})]}),(0,Lo.jsxs)("div",{className:"space-y-4",children:[ch.map(e=>{const t=e.name,s=A[t];if(!s)return null;const a=Object.values(s).flat(),o=a.length>0&&a.every(e=>f.has(e.id));return(0,Lo.jsxs)("details",{className:"bg-slate-800 rounded-lg",children:[(0,Lo.jsx)("summary",{className:"list-none",children:(0,Lo.jsxs)("div",{className:"flex items-center gap-3 p-4 cursor-pointer hover:bg-slate-700/50 rounded-t-lg",children:[(0,Lo.jsx)("span",{className:"transform transition-transform duration-200 group-open:rotate-90",children:"\u25b6"}),(0,Lo.jsx)("h2",{className:"flex-grow text-2xl font-bold text-teal-300",children:t}),g&&(0,Lo.jsx)("button",{onClick:e=>{e.preventDefault(),M(a)},className:"text-sm font-semibold bg-slate-600 hover:bg-slate-500 px-3 py-1 rounded-md flex-shrink-0",children:o?"Deselect All":"Select All"})]})}),(0,Lo.jsx)("div",{className:"p-2 md:p-4 border-t border-slate-700 space-y-3",children:e.modules.map(e=>{const t=s[e];if(!t)return null;const a=t.length>0&&t.every(e=>f.has(e.id));return(0,Lo.jsxs)("details",{className:"group bg-slate-900/50 rounded-lg",open:!0,children:[(0,Lo.jsx)("summary",{className:"list-none",children:(0,Lo.jsxs)("div",{className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-slate-800/50 rounded-t-lg",children:[(0,Lo.jsx)("span",{className:"transform transition-transform duration-200 group-open:rotate-90 text-sm",children:"\u25b6"}),(0,Lo.jsxs)("h3",{className:"flex-grow text-lg font-semibold text-indigo-300",children:[e," ",(0,Lo.jsxs)("span",{className:"text-gray-400 font-normal text-sm",children:["(",t.length,")"]})]}),g&&(0,Lo.jsx)("button",{onClick:e=>{e.preventDefault(),M(t)},className:"text-xs font-semibold bg-slate-700 hover:bg-slate-600 px-3 py-1 rounded-md flex-shrink-0",children:a?"Deselect All":"Select All"})]})}),(0,Lo.jsx)("div",{className:"p-2 space-y-2",children:t.map(e=>{const t=f.has(e.id);return(0,Lo.jsxs)("div",{onClick:g?()=>{return t=e.id,void p(e=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n});var t}:void 0,className:`p-3 rounded-lg flex items-center gap-4 transition-all duration-150 \n                                                            ${g?"cursor-pointer":""}\n                                                            ${t?"bg-indigo-800 ring-2 ring-indigo-400":"bg-slate-700"}\n                                                        `,children:[(0,Lo.jsxs)("div",{className:"flex-grow",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)("span",{className:"font-bold text-teal-300",children:e.name}),e.isDefault&&(0,Lo.jsx)("span",{className:"text-xs bg-gray-600 text-gray-300 font-semibold px-2 py-0.5 rounded-full",children:"Default"})]}),e.lastUsed&&!e.isDefault&&(0,Lo.jsxs)("span",{className:"text-xs text-gray-500 italic mt-1 block",children:["Used: ",new Date(e.lastUsed).toLocaleDateString()]})]}),!g&&(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex gap-2",children:[(0,Lo.jsx)("button",{onClick:()=>n(e),className:"bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-3 rounded text-sm",children:"Load"}),!e.isDefault&&(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)("button",{onClick:()=>v(e),className:"bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-2 px-3 rounded text-sm",children:"Edit"}),(0,Lo.jsx)("button",{onClick:()=>r([e.id]),className:"bg-red-700 hover:bg-red-600 text-white font-bold py-2 px-3 rounded text-sm",children:"Delete"})]})]})]},e.id)})})]},e)})})]},t)}),0===Object.keys(A).length&&(0,Lo.jsx)("p",{className:"text-center text-gray-400 py-4",children:"No presets match your filters."})]}),(0,Lo.jsx)("input",{type:"file",ref:T,onChange:e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=e=>{try{const t=JSON.parse(e.target.result);Array.isArray(t)?w(t):alert("Import failed: The JSON file does not contain a valid presets array.")}catch(t){alert("Import failed: The selected file is not a valid JSON file.")}},n.readAsText(t),e.target.value=null},accept:".json",className:"hidden"})]})},hh=[{value:"Notes",label:"Notes"},{value:"Scale",label:"Scales"},{value:"Chord",label:"Chords"}],mh=["Major","Natural Minor","Harmonic Minor","Melodic Minor","Major Pentatonic","Minor Pentatonic","Blues","Whole Tone","Chromatic"],fh=[{value:7,label:"Circle of 5ths"},{value:5,label:"Circle of 4ths"},{value:4,label:"Major 3rds"},{value:3,label:"Minor 3rds"},{value:2,label:"Major 2nds (Whole Steps)"},{value:1,label:"Minor 2nds (Half-Steps)"}],ph=["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"],gh=e=>{let{title:t,children:n}=e;return(0,Lo.jsxs)("details",{className:"border-t border-slate-600/80 pt-3 mt-3",open:!0,children:[(0,Lo.jsxs)("summary",{className:"w-full flex justify-between items-center text-left text-lg font-bold text-teal-300 hover:text-teal-200 cursor-pointer list-none",children:[(0,Lo.jsx)("span",{children:t}),(0,Lo.jsx)("span",{className:"text-xl transition-transform transform duration-200 group-open:rotate-90",children:"\u25b6"})]}),(0,Lo.jsx)("div",{className:"pt-3 space-y-3",children:n})]})},xh=e=>{let{label:t,settingKey:n,options:s,settings:r,onSettingChange:a}=e;return(0,Lo.jsxs)("div",{children:[t&&(0,Lo.jsx)("h4",{className:"font-semibold text-gray-300 mb-1",children:t}),(0,Lo.jsx)("div",{className:"flex bg-slate-600 rounded-md p-1",children:s.map(e=>(0,Lo.jsx)("button",{onClick:()=>a(n,e.value),className:"flex-1 rounded-md py-1 text-sm font-semibold "+(r[n]===e.value?"bg-blue-600 text-white":"text-gray-300"),children:e.label},e.value))})]})},bh=e=>{let{label:t,settingKey:n,settings:s,onSettingChange:r,disabled:a=!1}=e;return(0,Lo.jsxs)("label",{className:"flex items-center justify-between gap-2 p-2 rounded-md "+(a?"cursor-not-allowed bg-slate-800":"cursor-pointer bg-slate-700"),children:[(0,Lo.jsx)("span",{className:"font-semibold "+(a?"text-gray-500":""),children:t}),(0,Lo.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,Lo.jsx)("input",{type:"checkbox",checked:s[n],onChange:e=>r(n,e.target.checked),className:"sr-only peer",disabled:a}),(0,Lo.jsx)("div",{className:"w-11 h-6 bg-gray-500 rounded-full peer-checked:after:translate-x-full after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})},vh=e=>{let{settings:t,onSettingChange:n,onSavePreset:s}=e;const r="Notes"===t.mode,a="Chord"===t.mode?"Show Roman Numerals":"Show Scale Degrees";return(0,Lo.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,Lo.jsx)(gh,{title:"Circle Mode",children:(0,Lo.jsx)(xh,{settingKey:"mode",options:hh,settings:t,onSettingChange:n})}),(0,Lo.jsxs)(gh,{title:"Configuration",children:["Notes"===t.mode&&(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{htmlFor:"circle-interval",className:"font-semibold text-gray-300 mb-1 block",children:"Note Interval"}),(0,Lo.jsx)("select",{id:"circle-interval",value:t.circleInterval,onChange:e=>n("circleInterval",Number(e.target.value)),className:"w-full p-2 bg-slate-700 rounded-md text-white border border-slate-500",children:fh.map(e=>(0,Lo.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,Lo.jsxs)("div",{className:r?"opacity-50 pointer-events-none":"space-y-3",children:[(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{htmlFor:"root-note",className:"font-semibold text-gray-300 mb-1 block",children:"Root Note"}),(0,Lo.jsx)("select",{id:"root-note",value:t.rootNote,onChange:e=>n("rootNote",e.target.value),className:"w-full p-2 bg-slate-700 rounded-md text-white border border-slate-500",disabled:r,children:ph.map(e=>(0,Lo.jsx)("option",{value:e,children:e.replace("b","\u266d")},e))})]}),(0,Lo.jsxs)("div",{children:[(0,Lo.jsx)("label",{htmlFor:"scale-type",className:"font-semibold text-gray-300 mb-1 block",children:"Scale Type"}),(0,Lo.jsx)("select",{id:"scale-type",value:t.scaleType,onChange:e=>n("scaleType",e.target.value),className:"w-full p-2 bg-slate-700 rounded-md text-white border border-slate-500",disabled:r,children:mh.map(e=>(0,Lo.jsx)("option",{value:e,children:e},e))})]})]})]}),(0,Lo.jsx)(gh,{title:"Display Options",children:(0,Lo.jsx)(bh,{label:a,settingKey:"showLabels",settings:t,onSettingChange:n,disabled:r})}),(0,Lo.jsx)("div",{className:"border-t border-slate-600 pt-4 mt-4",children:(0,Lo.jsx)("button",{onClick:s,className:"w-full py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 text-white",children:" Save Preset "})})]})},yh=Object.fromEntries([{name:"C",midiClass:0},{name:"Db",midiClass:1},{name:"D",midiClass:2},{name:"Eb",midiClass:3},{name:"E",midiClass:4},{name:"F",midiClass:5},{name:"F#",midiClass:6},{name:"G",midiClass:7},{name:"Ab",midiClass:8},{name:"A",midiClass:9},{name:"Bb",midiClass:10},{name:"B",midiClass:11}].map(e=>[e.midiClass,e.name])),wh={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11},jh=t=>{const[n,s]=(0,e.useState)(0),r=(0,e.useMemo)(()=>{let e=[];if("Notes"===t.mode){let n=wh[t.rootNote];do{const s=yh[n];e.push({name:s,midiClass:n,label:s,isActive:!0}),n=(n+t.circleInterval)%12}while(n!==wh[t.rootNote])}else if("Scale"===t.mode){const n=Mo(t.rootNote,t.scaleType),s=wh[t.rootNote],r=["1","b2","2","b3","3","4","#4/b5","5","b6","6","b7","7"];e=n.map(e=>{const n=wh[e],a=r[(n-s+12)%12];return{name:e,midiClass:n,label:t.showLabels?a:e,isActive:!0}})}else if("Chord"===t.mode){e=Eo(t.rootNote,t.scaleType,"Triads").map(e=>({name:e.root,midiClass:wh[e.root],label:t.showLabels?e.roman:e.name,chordName:e.name,isActive:!0}))}const s=(e.length-n)%e.length;return[...e.slice(s),...e.slice(0,s)]},[t,n]),a=(0,e.useCallback)(e=>{const t=r.length||1;s(n=>(n+e+t)%t)},[r.length]);return{circleData:r,rotateCircle:a,setRotationOffset:s}},kh=e=>{let{circleData:t,rotateCircle:n,onNodeClick:s,onNodeDoubleClick:r}=e;return(0,Lo.jsxs)("svg",{viewBox:"0 0 500 500",className:"w-full h-full",children:[(0,Lo.jsxs)("g",{onClick:()=>n(-1),className:"cursor-pointer group",children:[(0,Lo.jsx)("rect",{x:"150",y:"225",width:"50",height:"50",fill:"transparent"}),(0,Lo.jsx)("path",{d:"M 195,250 A 50,50 0 1,1 195,251 Z M 165,235 L 165,265 L 185,250 Z",fill:"rgb(71 85 105)",className:"group-hover:fill-slate-500 transition-colors"})]}),(0,Lo.jsxs)("g",{onClick:()=>n(1),className:"cursor-pointer group",children:[(0,Lo.jsx)("rect",{x:"300",y:"225",width:"50",height:"50",fill:"transparent"}),(0,Lo.jsx)("path",{d:"M 305,250 A 50,50 0 1,0 305,249 Z M 335,235 L 335,265 L 315,250 Z",fill:"rgb(71 85 105)",className:"group-hover:fill-slate-500 transition-colors"})]}),t.map((e,n)=>{const a=n/t.length*2*Math.PI-Math.PI/2,o=250+190*Math.cos(a),i=250+190*Math.sin(a),l=0===n,c=l?"rgb(22 78 99)":"rgb(51 65 85)",u=e.isActive?l?"#67e8f9":"#e2e8f0":"#475569",d=e.label.length>3?"1.8rem":"2.2rem";return(0,Lo.jsxs)("g",{transform:`translate(${o}, ${i})`,onClick:()=>e.isActive&&s(e),onDoubleClick:()=>e.isActive&&r(n),className:e.isActive?"cursor-pointer group":"cursor-default",children:[(0,Lo.jsx)("rect",{x:-40,y:-32.5,width:80,height:65,rx:"15",fill:c,stroke:l?"#06b6d4":"rgb(71 85 105)",strokeWidth:"3",className:e.isActive?"group-hover:fill-slate-600 transition-colors":""}),(0,Lo.jsx)("text",{x:"0",y:"0",textAnchor:"middle",dominantBaseline:"central",fill:u,fontSize:d,fontWeight:"bold",className:"select-none",children:e.label.replace("b","\u266d")})]},`${e.name}-${n}`)})]})},Nh=()=>{const{savePreset:t,playChord:n}=Vo(),[s,r]=(0,e.useState)({mode:"Chromatic",circleInterval:7,rootNote:"C",scaleType:"Major",showLabels:!0}),[a,o]=(0,e.useState)(!1),[i,l]=(0,e.useState)(!1),{circleData:c,rotateCircle:u,setRotationOffset:d}=jh(s),h=(0,e.useCallback)((e,t)=>{r(n=>({...n,[e]:t}))},[]),m=()=>{const e=prompt("Enter a name for your preset:","My Music Circle");e&&""!==e.trim()&&(t({id:`mc-${Date.now()}`,name:e.trim(),gameId:"music-circles",gameName:"Music Circles",settings:s}),alert(`Preset "${e.trim()}" saved!`))},f={0:"C",1:"C#",2:"D",3:"D#",4:"E",5:"F",6:"F#",7:"G",8:"G#",9:"A",10:"A#",11:"B"};return(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row items-start w-full gap-4",children:[(0,Lo.jsx)($o,{isOpen:a,onClose:()=>o(!1),title:"Music Circles Guide",children:(0,Lo.jsx)("p",{children:"This is a placeholder for the guide."})}),(0,Lo.jsxs)("div",{className:"w-full flex-1 bg-slate-800 p-4 rounded-lg flex flex-col",children:[(0,Lo.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Lo.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Lo.jsx)(Go,{title:"Music Circles"}),(0,Lo.jsx)(Uo,{onClick:()=>o(!0)})]}),(0,Lo.jsx)("button",{onClick:()=>l(e=>!e),className:"p-2 rounded-md bg-slate-700 hover:bg-slate-600 text-sm font-semibold",children:"Controls"})]}),(0,Lo.jsx)("div",{className:"w-full aspect-square",children:(0,Lo.jsx)(kh,{circleData:c,rotateCircle:u,onNodeClick:e=>{if("Chord"===s.mode&&e.chordName){const t=({"":[0,4,7],m:[0,3,7],dim:[0,3,6]}[e.chordName.replace(e.name,"")]||[0,4,7]).map(t=>f[(e.midiClass+t)%12]);n(t,"Harmonic")}else n([e.name],"Harmonic")},onNodeDoubleClick:e=>{const t=c.findIndex(t=>t.name===c[e].name);d(t)}})})]}),(0,Lo.jsx)("div",{className:"hidden md:block bg-slate-700 rounded-lg transition-all duration-300 ease-in-out sticky top-6 max-h-[calc(100vh-3rem)] "+(i?"w-80 p-4 overflow-y-auto":"w-0 p-0 overflow-hidden"),children:(0,Lo.jsxs)("div",{className:`${!i&&"hidden"}`,children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300 mb-4",children:"Settings & Controls"}),(0,Lo.jsx)(vh,{settings:s,onSettingChange:h,onSavePreset:m})]})}),i&&(0,Lo.jsx)("div",{className:"md:hidden fixed inset-0 z-50 flex justify-center items-center bg-black/60",onClick:()=>l(!1),children:(0,Lo.jsxs)("div",{className:"w-11/12 max-w-sm bg-slate-800 rounded-2xl p-4 max-h-[85vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Lo.jsxs)("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[(0,Lo.jsx)("h3",{className:"text-xl font-bold text-teal-300",children:"Settings & Controls"}),(0,Lo.jsx)("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-white text-2xl font-bold",children:"\xd7"})]}),(0,Lo.jsx)("div",{className:"flex-grow overflow-y-auto pr-2",children:(0,Lo.jsx)(vh,{settings:s,onSettingChange:h,onSavePreset:m})})]})})]})},Ch=()=>{const{activeTab:t,navigate:n,openCategory:s,handleCategoryClick:r,activeTool:a,activeRoutine:o,presetToLoad:i,lastRoutineResultId:l}=Vo(),c="true"==={NODE_ENV:"production",PUBLIC_URL:"/musical-tools-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SHOW_MUSIC_CIRCLES;(0,e.useEffect)(()=>{i&&!o&&n(i.gameId)},[i,n,o]),(0,e.useEffect)(()=>{l&&n("scoreboard")},[l,n]);const u=[{name:"Generators",tools:[{id:"note-generator",name:"Note Generator"},{id:"interval-generator",name:"Interval Generator"},{id:"chord-progression-generator",name:"Chord Progression Generator"},{id:"diagram-maker",name:"Diagram Maker"},...c?[{id:"music-circles",name:"Music Circles"}]:[]]},{name:"Theory",tools:[{id:"intervals-quiz",name:"Interval Practice"},{id:"triad-quiz",name:"Triad & Tetrads Quiz"},{id:"chord-trainer",name:"Chord Trainer"}]},{name:"Fretboard",tools:[{id:"interval-fretboard-quiz",name:"Fretboard Intervals"},{id:"caged-system-quiz",name:"CAGED System Quiz"},{id:"fretboard-triads",name:"Fretboard Triads"}]},{name:"Ear Training",tools:[{id:"interval-ear-trainer",name:"Interval Recognition"},{id:"melodic-ear-trainer",name:"Melodic Recognition"},{id:"chord-ear-trainer",name:"Chord Recognition"},{id:"progression-ear-trainer",name:"Progression Recognition"}]},{name:"Presets & Routines",tools:[{id:"presets-manager",name:"Preset Manager"},{id:"routines-hub",name:"Routine Hub"},{id:"scoreboard",name:"Scoreboard"}]}];return(0,Lo.jsxs)("div",{className:"min-h-screen bg-slate-900 font-inter text-gray-200 p-4 pb-32 md:p-6 transition-all duration-300 "+("log"===a||"presets"===a?"md:pl-96":"md:pl-72"),children:[(0,Lo.jsx)("div",{className:"hidden md:block fixed top-5 left-0 z-50 px-5",children:(0,Lo.jsx)("a",{href:"https://www.willmetzacademy.com/library",target:"_blank",rel:"noopener noreferrer",children:(0,Lo.jsx)("img",{src:"/musical-tools-app/WillMetz2.png",alt:"Will Metz Academy Logo",className:"h-16 lg:h-20 xl:h-24 w-auto"})})}),(0,Lo.jsx)(Ri,{}),(0,Lo.jsxs)("header",{className:"w-full max-w-5xl mx-auto bg-slate-800 shadow-lg rounded-xl p-6 mb-8 text-center",children:[(0,Lo.jsx)("h1",{className:"text-3xl md:text-5xl font-extrabold text-teal-400 leading-tight",children:"Musical Practice Tools"}),(0,Lo.jsx)("p",{className:"text-md md:text-lg text-gray-300",children:"Your comprehensive companion for musical growth!"})]}),(0,Lo.jsx)("nav",{className:"w-full max-w-5xl mx-auto bg-slate-800 shadow-md rounded-xl p-4 md:p-6 mb-8",children:(0,Lo.jsxs)("div",{className:"flex flex-col md:flex-row justify-around gap-y-4 md:gap-x-6 flex-wrap",children:[(0,Lo.jsx)("div",{className:"flex-1 text-center min-w-[150px]",children:(0,Lo.jsx)("button",{onClick:()=>n("welcome"),className:"px-6 py-3 rounded-lg text-lg font-bold transition-all w-full "+("welcome"===t?"bg-blue-600 text-white shadow-lg":"bg-slate-700 text-blue-300 hover:bg-slate-600"),children:"Welcome"})}),u.map(e=>(0,Lo.jsxs)("div",{className:"flex-1 flex flex-col items-center gap-2 min-w-[150px]",children:[(0,Lo.jsxs)("button",{onClick:()=>r(e.name),className:"w-full bg-slate-700 hover:bg-slate-600 rounded-lg p-3 flex justify-between items-center",children:[(0,Lo.jsx)("h3",{className:"text-lg font-bold text-teal-300",children:e.name}),(0,Lo.jsx)("span",{className:"transform transition-transform duration-300 "+(s===e.name?"rotate-180":""),children:"\u25bc"})]}),s===e.name&&(0,Lo.jsx)("div",{className:"w-full flex flex-col items-center gap-2 bg-slate-900/50 p-2 rounded-b-lg animate-fade-in-down",children:e.tools.map(e=>(0,Lo.jsx)("button",{onClick:()=>n(e.id),className:"w-full px-4 py-2 rounded-full text-md font-medium "+(t===e.id?"bg-blue-600 text-white":"text-blue-300 hover:bg-slate-700"),children:e.name},e.id))})]},e.name))]})}),(0,Lo.jsx)("main",{className:"w-full max-w-5xl mx-auto bg-slate-800 shadow-2xl rounded-xl p-4 md:p-8 flex-grow",children:o?(0,Lo.jsx)(nh,{}):(0,Lo.jsxs)(Lo.Fragment,{children:["welcome"===t&&(0,Lo.jsx)(Bo,{}),"chord-trainer"===t&&(0,Lo.jsx)(Ci,{}),"intervals-quiz"===t&&(0,Lo.jsx)(ti,{}),"note-generator"===t&&(0,Lo.jsx)(ai,{}),"interval-fretboard-quiz"===t&&(0,Lo.jsx)(Fi,{}),"diagram-maker"===t&&(0,Lo.jsx)(qi,{}),c&&"music-circles"===t&&(0,Lo.jsx)(Nh,{}),"chord-progression-generator"===t&&(0,Lo.jsx)(Yi,{}),"interval-generator"===t&&(0,Lo.jsx)(Ji,{}),"triad-quiz"===t&&(0,Lo.jsx)(cl,{}),"caged-system-quiz"===t&&(0,Lo.jsx)(pl,{}),"fretboard-triads"===t&&(0,Lo.jsx)(kl,{}),"interval-ear-trainer"===t&&(0,Lo.jsx)(Pl,{}),"melodic-ear-trainer"===t&&(0,Lo.jsx)(Ql,{}),"chord-ear-trainer"===t&&(0,Lo.jsx)(sc,{}),"progression-ear-trainer"===t&&(0,Lo.jsx)(dc,{}),"routines-hub"===t&&(0,Lo.jsx)(Zd,{}),"scoreboard"===t&&(0,Lo.jsx)(ah,{}),"presets-manager"===t&&(0,Lo.jsx)(dh,{})]})}),(0,Lo.jsx)("footer",{className:"w-full max-w-5xl mx-auto text-center mt-8 text-gray-400 text-sm",children:(0,Lo.jsx)("p",{children:"\xa9 2025 Toon's Musical Practice Tools. All rights reserved."})})]})};const _h=function(){return(0,Lo.jsx)(zo,{children:(0,Lo.jsx)(Ch,{})})},Sh=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:s,getFCP:r,getLCP:a,getTTFB:o}=t;n(e),s(e),r(e),a(e),o(e)})};t.createRoot(document.getElementById("root")).render((0,Lo.jsx)(e.StrictMode,{children:(0,Lo.jsx)(_h,{})})),Sh()})()})();
//# sourceMappingURL=main.471b2b6b.js.map